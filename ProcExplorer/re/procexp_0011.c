/*
le has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2017 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

signed int __stdcall sub_F71000(_BYTE *a1, unsigned int a2, int a3);
BOOL __stdcall sub_F71063(CHAR *a1);
int __stdcall sub_F71149(int a1, int a2, int a3, int a4);
int sub_F71200();
int dynamic_initializer_for__garrAccountInfo__();
int dynamic_initializer_for__gpszTipText__();
int sub_F71260();
int sub_F71270();
HCURSOR dynamic_initializer_for__ghHandCursor__();
int dynamic_initializer_for__dword_4F48E4__();
int dynamic_initializer_for__gpszSystemPathInfo__();
int dynamic_initializer_for__dword_4F48FC__();
int dynamic_initializer_for__gKeyNameMap__();
int dynamic_initializer_for__dword_4F48F0__();
HCURSOR dynamic_initializer_for__ghWaitCursor__();
int dynamic_initializer_for__dword_4F4C54__();
int dynamic_initializer_for__dword_4F4C50__();
int dynamic_initializer_for__gList5_gList6__();
int dynamic_initializer_for__gList1__();
int dynamic_initializer_for__gList2__();
int dynamic_initializer_for__gList3__();
int dynamic_initializer_for__gMap5__();
int sub_F714A0();
int sub_F714B0();
int sub_F714C0();
int dynamic_initializer_for__gActiveScriptEventConsumer__();
int dynamic_initializer_for__gCommandLineEventConsumer__();
int dynamic_initializer_for__gMap6__();
ATOM dynamic_initializer_for__gAtomTreeListProperty__();
ATOM dynamic_initializer_for__gAtomTreeList__();
BOOL dynamic_initializer_for__gLogPixelSize__();
int dynamic_initializer_for__ghUxthemeModule__();
FARPROC dynamic_initializer_for__gpfnCloseThemeData__();
int (__stdcall *sub_F715E0())(HTHEME hTheme, HDC hdc, int iPartId, int iStateId, LPCRECT pRect, LPCRECT pClipRect);
int (__stdcall *sub_F71610())();
FARPROC sub_F71640();
IAtlStringMgr *sub_F71670();
int dynamic_initializer_for__gList4__();
FARPROC sub_F716A0();
int dynamic_initializer_for__gList7__();
HANDLE dynamic_initializer_for__gProperties__();
DWORD sub_F71700();
FARPROC sub_F71CE0();
int dynamic_initializer_for__gPerformanceInfoInMemory__();
int dynamic_initializer_for__gPerformanceInfo__();
int dynamic_initializer_for__gNullString__();
int dynamic_initializer_for__gWbemServicesList__();
BOOL dynamic_initializer_for__gTime__();
int dynamic_initializer_for__gMap1__();
bool dynamic_initializer_for__gbBitmapOnRight__();
int dynamic_initializer_for__gDiskGraphInfo__();
int dynamic_initializer_for__gIOGraphInfo__();
int dynamic_initializer_for__gNetworkGraphInfo__();
int sub_F71F20();
int sub_F71F40();
int sub_F71F60();
int sub_F71F90();
int sub_F71FC0();
int dynamic_initializer_for__gHttpInfo__();
int sub_F72070();
int sub_F72090();
int sub_F720B0();
int sub_F720D0();
int sub_F720F0();
int sub_F720FC();
int sub_F72112();
int sub_F7211E();
int sub_F7212A();
int sub_F72136();
int dynamic_initializer_for__ATL::_AtlBaseModule___();
_DWORD *__thiscall sub_F72170(_DWORD *this);
void __thiscall sub_F721A0(void ***this);
void __thiscall sub_F721F0(void **this);
void **__thiscall sub_F72250(void **this, const wchar_t **a2);
void **__thiscall sub_F72280(void **this, wchar_t *a2);
int __cdecl PE_CopyString(WCHAR **ppv, WCHAR *lpszText1, LPCWSTR lpszText2);
void *__thiscall CopyStringToString(WCHAR **ppv, WCHAR *lpszText, DWORD dwPos, DWORD dwLength);
void __cdecl sub_F723D0(int a1, void *a2, void *a3);
void *__cdecl sub_F72480(int a1, void *a2, wchar_t *psz, void *a4);
void __stdcall sub_F72BC0(void **a1, void **a2);
char *__cdecl sub_F72BF0(int a1, int a2);
void __thiscall sub_F72C60(int *this);
void __cdecl sub_F72CB0(int a1, void *a2, void *a3, LPCWSTR lpValueName);
void *__cdecl sub_F72D60(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, void *a5);
int __cdecl sub_F73440(int a1, int a2, int a3);
wchar_t **__cdecl sub_F734F0(std__vector *a1, const wchar_t **a2, wchar_t **a3); // idb
_DWORD *__thiscall sub_F73530(void *this, void *a2);
wchar_t ***__thiscall sub_F735A0(wchar_t ***this, const wchar_t ***a2);
BSTR *__thiscall _bstr_t::Data_t::Data_t(Data_t_bstr_t *this, _bstr_t *a2, _bstr_t *a3); // idb
void __thiscall sub_F73750(void *); // idb
BSTR **__thiscall _bstr_t::_bstr_t(_bstr_t *this, OLECHAR *psz); // idb
int __thiscall sub_F73820(int this);
void __thiscall sub_F73850(void *); // idb
void __thiscall _bstr_t::_Free(_bstr_t *this); // idb
int *__thiscall sub_F738F0(int *this, const wchar_t ***a2);
_bstr_t *__thiscall sub_F73A50(_bstr_t *this, _bstr_t *a2);
EventItem *__thiscall _bstr_t::operator=(EventItem *this, OLECHAR *psz);
int __thiscall sub_F73B40(int **this);
_bstr_t *__cdecl _bstr_t::operator+(_bstr_t *a1, OLECHAR *psz, _bstr_t *a2); // idb
_bstr_t *__thiscall _bstr_t::operator+(Data_t_bstr_t **this, _bstr_t *a2, _bstr_t *a3);
BOOL __thiscall sub_F73C30(BSTR **this, BSTR **a2);
OLECHAR ***__thiscall _bstr_t::operator+=(_bstr_t *this, _bstr_t *a2); // idb
char __cdecl sub_F73D40(int a1, const wchar_t **a2, OLECHAR **a3, OLECHAR **a4, OLECHAR **a5, const wchar_t **a6, void **a7, _DWORD *a8);
int __cdecl sub_F73FF0(int a1, int a2, void *ppv1, int a4, WCHAR **ppv3, int a6, int a7); // idb
void __cdecl LoadSystemAccountInfo(HWND hWnd); // idb
char BackendThreadProc();
int __thiscall bstr_t::Data_t::Compare(Data_t_bstr_t *this, Data_t_bstr_t *str); // idb
errno_t __cdecl sub_F747C0(wchar_t *Src, wchar_t *Dst, rsize_t SizeInWords);
BOOL __cdecl TmAdjustPrivilege(LPCWSTR lpszName); // idb
int __cdecl sub_F74890(int, wchar_t *); // idb
int __cdecl sub_F74AC0(int, wchar_t *psz); // idb
PSID __cdecl GetUserSID(wchar_t *lpszUserName); // idb
signed int sub_F74ED0();
int __cdecl sub_F74EE0(int a1, int a2, int a3, int a4);
int __cdecl sub_F74F20(int, int, wchar_t *); // idb
wchar_t **__cdecl sub_F74FB0(WCHAR **ppszArgs, HWND hWndIn, LPCWSTR lpszFileName);
int __cdecl sub_F752B0(int, wchar_t *psz); // idb
int __cdecl sub_F75520(int, wchar_t *psz, int); // idb
wchar_t *InitSystemPath();
char __cdecl sub_F75860(wchar_t **a1, __int16 a2, const wchar_t **a3, char a4);
int (__stdcall *InitApis())(LONG Status);
int __cdecl sub_F75C70(int, wchar_t *); // idb
int __thiscall sub_F75DE0(int **this, int a2, OLECHAR *psz);
char __cdecl sub_F75FD0(wchar_t *a1, wchar_t *a2);
char __cdecl sub_F76090(wchar_t *psz);
char __cdecl sub_F763B0(wchar_t *a1);
int __thiscall std::map<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>>::_Try_emplace<wchar_t const * const &,>(std__tree *this, tagKeyName **a2, tagKeyName *bstrValue, HKEY hRootKey, OLECHAR *lpszKey);
HANDLE __stdcall sub_F76640(OLECHAR *lpszKeyName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile); // idb
LONG __cdecl sub_F76700(OLECHAR *psz, int a2, int a3, int a4, int a5, int a6);
int __cdecl PE_OpenKey(HKEY hRootKey, tagKeyName *lpszKeyName, LONG CreateOptions, DWORD DesiredAccess, PHKEY KeyHandle);
HANDLE AdjustRighToWinLogon();
char __cdecl sub_F76CC0(std__List *a1, int a2); // idb
void __cdecl sub_F76DD0(wchar_t *a1, int a2, int a3, int a4);
void __cdecl sub_F77040(wchar_t *a1, int a2);
wchar_t **__cdecl sub_F770E0(wchar_t **a1, int a2, int a3, void *a4);
int __thiscall sub_F77AB0(std__tree *this, tagKeyName *KeyName, LPCWSTR lpszKey);
int __cdecl sub_F77AE0(DWORD dwMessageId); // idb
unsigned __int16 **__cdecl sub_F77BE0(std__vector *ppszArg, HKEY hKey, LPCWSTR *lpszArg3, LPCWSTR *lpszArg4);
void __cdecl sub_F77CC0(HWND a1, HWND a2);
int __cdecl sub_F784A0(int, wchar_t *); // idb
_bstr_t *__cdecl sub_F785A0(_bstr_t *ret, OLECHAR *psz, int nPos, _bstr_t *str); // idb
void __cdecl sub_F786F0(int a1, void *a2, void *a3);
void *__cdecl sub_F787A0(int a1, void *a2, wchar_t *psz, void *a4);
void __cdecl sub_F79030(void *a1, int a2, void *a3, wchar_t *a4);
void __cdecl sub_F791C0(int a1, int a2, void *a3);
void *__cdecl sub_F79270(int a1, int a2, wchar_t *psz, void *a4);
void __cdecl sub_F79AB0(int a1, void *a2, void *a3, char a4, char a5);
void *__cdecl sub_F79B70(int a1, void *a2, wchar_t *psz, char a4, char a5, void *a6, char a7, char a8);
void __cdecl sub_F7AA30(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, int a5);
void *__cdecl sub_F7AB10(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, int a5, void *a6);
void __cdecl sub_F7B220(DWORD dwType, DWORD dwFlags);
void __cdecl sub_F7F2D0(int a1, void *a2, int a3, char a4, char a5);
char __cdecl sub_F7F610(HWND hWnd, tagAccountInfo *pInfo, DWORD dwMenuId);
int __cdecl sub_F7F8D0(int, wchar_t *); // idb
char __thiscall sub_F7F930(_DWORD *this, unsigned int a2);
_DWORD *std::_Tree_comp_alloc<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::_Buyheadnode();
int __thiscall sub_F7F9D0(int *this, unsigned int a2, int a3);
_DWORD __stdcall nullsub_1(_DWORD, _DWORD); // weak
void __stdcall std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::clear(std__Tree_node *a1); // idb
BOOL __thiscall sub_F7FC40(void *this, int a2, int a3);
int *__thiscall sub_F7FD00(int *this, unsigned int a2);
const wchar_t **__thiscall sub_F7FDF0(std__vector *this, unsigned int a2); // idb
int *__thiscall sub_F7FEE0(int *this, unsigned int a2);
unsigned int __thiscall std::vector<wchar_t const *,std::allocator<wchar_t const *>>::_Reserve(std__vector *this, unsigned int a2); // idb
void *__stdcall sub_F7FFE0(unsigned int a1);
int __thiscall sub_F80010(int *this);
int __thiscall std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::erase(std__tree *this, std__Tree_node **a2, std__Tree_node *a3, std__Tree_node *Node);
int __thiscall std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::erase(std__tree *this, int a2, std__Tree_node *a3); // idb
UINT __thiscall sub_F80440(BSTR **this);
const wchar_t **__thiscall sub_F80460(int *this, const wchar_t **a2);
const wchar_t **__thiscall sub_F80530(std__vector *this, const wchar_t **a2);
void *__cdecl sub_F805A0(int a1, HKEY hKey, LPCWSTR lpszKeyName, LPCWSTR lpValueName);
void *__cdecl sub_F80790(int a1, HKEY hKey, LPCWSTR lpszKeyName, LPCWSTR lpszValueName, HANDLE Handle);
int __cdecl RequerySystemEnvironmentString(WCHAR **ppstr, LPCWSTR lpszName);
HANDLE __cdecl sub_F80FC0(OLECHAR *psz, LPWIN32_FIND_DATAW lpFindFileData);
DWORD __cdecl sub_F81040(OLECHAR *psz);
DWORD_PTR __cdecl sub_F810C0(OLECHAR *psz, DWORD dwFileAttributes, SHFILEINFOW *psfi, UINT cbFileInfo, UINT uFlags);
bool __cdecl sub_F81150(int a1, wchar_t *a2, WCHAR *psz, int a4); // idb
LSTATUS __cdecl PE_LoadKey(HKEY hKey, DWORD dwIndex, WCHAR **ppszKey);
LSTATUS __cdecl sub_F81450(HKEY hKey, DWORD dwIndex, int a3, LPDWORD lpReserved, LPDWORD lpType, int a6);
LSTATUS __cdecl sub_F81520(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, int a5);
LSTATUS __cdecl sub_F815A0(HKEY hKey, LPCWSTR lpSubKey, int a3);
void *__cdecl sub_F81610(int a1, void *a2, wchar_t *psz);
void *__cdecl sub_F82060(int a1, int a2, int *a3);
void *__cdecl sub_F82090(int a1, int a2, int a3, void *a4, char a5);
unsigned __int16 **__cdecl PE_CopyStringEx(WCHAR **ppv, LPCWSTR *lpszText1, LPCWSTR *lpszText2);
void __cdecl sub_F830B0(int a1, void *a2, void *a3);
void *__cdecl sub_F83160(int a1, void *a2, wchar_t *psz, void *a4);
void __cdecl sub_F839D0(int a1, void *a2, void *a3);
void *__cdecl sub_F83A80(int a1, void *a2, wchar_t *psz, void *a4);
void __cdecl sub_F84150(int a1, void *a2, void *a3);
void *__cdecl sub_F84200(int a1, void *a2, wchar_t *psz, void *a4);
void *__cdecl sub_F84E10(int a1, void *a2, OLECHAR *psz);
void *__cdecl sub_F84FF0(int a1, void *a2, wchar_t *psz, void *a4, char a5);
void *__cdecl sub_F85E10(int a1, void *a2, OLECHAR *psz);
void *__cdecl sub_F85FF0(int a1, void *a2, wchar_t *a3, void *a4, char a5);
void *__cdecl sub_F86A10(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, wchar_t *a5, int a6, void *a7);
void *__cdecl sub_F86E10(int a1, void *a2, OLECHAR *psz, LPCWSTR lpValueName);
void *__cdecl sub_F87000(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, int a5);
void __cdecl sub_F87710(int a1, void *a2, void *a3);
void *__cdecl sub_F877C0(int a1, void *a2, wchar_t *psz, void *a4);
void __cdecl sub_F87FE0(int a1, HKEY hKey, WCHAR **ppszKeyName);
void *__cdecl sub_F88050(int a1, HKEY hKey, LPCWSTR lpszKeyName, HANDLE Handle);
void __cdecl sub_F88A90(int a1, void *a2, int a3, int a4);
void *__cdecl sub_F88C20(int a1, void *a2, wchar_t *psz, void *a4, char a5, int a6);
char __cdecl sub_F893C0(LPCWSTR lpServiceName, int a2);
void *__cdecl sub_F89580(int a1, void *a2, wchar_t *psz);
void __cdecl sub_F8A070(int a1, void *a2, void *a3);
void *__cdecl sub_F8A120(int a1, void *a2, wchar_t *psz, void *a4);
_DWORD *__stdcall sub_F8AC50(_DWORD *a1, _DWORD *a2, int a3);
_DWORD *__thiscall sub_F8AC80(_DWORD *this, int a2);
EventItem *__thiscall sub_F8AD20(EventItem *this, VARIANTARG *pvarSrc);
_bstr_t *__thiscall _bstr_t::_bstr_t(_bstr_t *this, LPCSTR lpString);
void __thiscall sub_F8AE80(_DWORD *this);
int *__thiscall sub_F8B0D0(_DWORD *this, int a2);
char __cdecl sub_F8B1A0(int **a1, void **a2);
void *__cdecl sub_F8D790(HWND hWndIn); // idb
_bstr_t *__cdecl sub_F8E1B0(_bstr_t *a1, int a2);
_bstr_t *__cdecl sub_F8E210(_bstr_t *a1);
_DWORD *__stdcall sub_F8E320(_DWORD *a1, _DWORD *a2);
void __thiscall sub_F8E360(_DWORD *this);
void *__cdecl sub_F8E3A0(int a1, void *a2, wchar_t *a3, void *a4, char a5);
void *__cdecl sub_F8EFA0(int a1, int a2, OLECHAR *psz, LPCWSTR lpValueName);
void *__cdecl sub_F8EFE0(int a1, int a2, OLECHAR *psz, LPCWSTR lpValueName, void *a5, char a6);
void *__cdecl sub_F8F0E0(int a1, wchar_t *a2, wchar_t *a3, void *a4, char a5);
int __cdecl PE_CopyString2(WCHAR **pszResult, WCHAR *ppszText1, WCHAR **ppszText2);
void __cdecl sub_F8F260(int a1, int a2, wchar_t *a3, void *a4, int a5);
void __cdecl sub_F90760(int a1);
void __cdecl sub_F90EA0(int a1);
wchar_t *__cdecl sub_F911B0(wchar_t *a1, int a2, wchar_t *a3);
int __cdecl sub_F91290(wchar_t *, int); // idb
CSystemProcessInfoMapNode *__thiscall sub_F91310(CSystemProcessInfoMap *this, int *a2);
_DWORD *__thiscall sub_F91350(_DWORD *this);
void *__thiscall std::_Tree_unchecked_const_iterator<std::_Tree_val<std::_Tree_simple_types<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>>,std::_Iterator_base0>::operator--(void *this);
bool __stdcall sub_F914B0(Data_t_bstr_t *a1, Data_t_bstr_t *a2); // idb
void __cdecl sub_F91590(char a1, int a2, OLECHAR *a3, OLECHAR *a4, OLECHAR *psz, int a6);
CSystemProcessInfoMapNode *std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buyheadnode();
CSystemProcessInfoMapNode *__thiscall std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buynode0(CSystemProcessInfoMap *this); // idb
_DWORD *__thiscall sub_F917F0(int **this, int a2);
void *__cdecl sub_F91840(int a1);
void *__cdecl sub_F91860(int a1, void *a2, char a3);
void __cdecl sub_F92060(int a1, void *a2, void *a3);
void *__cdecl sub_F92110(int a1, void *a2, wchar_t *psz, void *a4);
void __cdecl sub_F927D0(int a1, OLECHAR *psz);
void __cdecl sub_F93190(int a1, OLECHAR *psz);
_DWORD *__thiscall sub_F93B60(_DWORD *this, int a2, _DWORD **a3, int a4);
CSystemProcessInfoMapNode *__thiscall sub_F93BA0(CSystemProcessInfoMap *this, int a2, const wchar_t ***a3, int a4);
int __thiscall sub_F93BE0(_DWORD *this, int a2, char a3, int a4, int a5, void *a6);
int __thiscall sub_F93E00(_DWORD *this, int a2, char a3, int a4, int a5, void *a6);
int __thiscall sub_F94040(_DWORD *this, int a2, int a3, int a4, void *a5);
int __thiscall sub_F94270(_DWORD *this, int a2, int a3, int a4, void *a5);
int __thiscall sub_F944A0(_DWORD *this, int a2, int a3, int a4, void *a5);
int __thiscall sub_F945C0(_DWORD *this, int a2, int a3, int a4, void *a5);
void **__cdecl sub_F94700(const wchar_t **a1, const wchar_t **a2, void **a3);
void *__thiscall ActiveScriptEventConsumer::ActiveScriptEventConsumer(void *this);
void *__thiscall CommandLineEventConsumer::CommandLineEventConsumer(void *this);
_DWORD *__thiscall GetQueryEnumObject(IEnumWbemClassObject **ppEnumOut, IWbemServices *pWbemServices, const wchar_t *lpszQuery);
volatile LONG *__thiscall sub_F94A70(volatile LONG *this, volatile LONG a2);
void __thiscall sub_F94B00(CSystemProcessInfoMap *this);
void **__thiscall sub_F94B60(void **this, void **a2);
_DWORD *__thiscall sub_F94BC0(int *this, _DWORD *a2);
std__Tree_node **__thiscall sub_F94C50(CSystemProcessInfoMap *this, _DWORD *a2);
std__tree *__thiscall sub_F94CE0(std__tree *this);
void *__thiscall std::error_category::`vector deleting destructor'(void *this, char a2);
void sub_F94D60();
HRESULT __cdecl LoadWbemServices(const wchar_t *lpszServerName, IWbemServices **ppv);
HRESULT __thiscall StreamThreadInfo_Load(tagStreamThreadInfo *lpParameter, IWbemServices **ppWbemServices);
void *__cdecl sub_F94FE0(int a1, void *a2);
int __cdecl sub_F95120(IWbemServices *pWbemServices, int a2);
char __stdcall sub_F95350(int a1, void *pClassObject, int a3);
bool __stdcall sub_F95440(int a1, void *lpszName, void *a3);
int __cdecl sub_F955B0(const wchar_t **a1);
char __thiscall sub_F95630(void *this, int a2, wchar_t *lpszName, void **a4);
char __thiscall sub_F956B0(void *this, int a2, wchar_t *lpszName, void **a4);
int __cdecl sub_F95730(LPVOID ppv, int, OLECHAR *psz, void *); // idb
HRESULT __cdecl sub_F95850(LPVOID ppv, wchar_t *psz, int a3);
wchar_t **__stdcall sub_F95910(wchar_t **a1, int a2);
int __stdcall sub_F95940(int, void *); // idb
char __stdcall sub_F95A00(void *lpszName, int a2, int a3);
char __stdcall sub_F95AA0(int a1, int a2, int a3);
int __cdecl GetClassObjectName(wchar_t **lpszName, IWbemClassObject *pClassObject);
HRESULT __cdecl sub_F95BE0(LPVOID *ppv, wchar_t *a2);
bool __stdcall sub_F95C50(void *pClassObject, int a2);
void __thiscall StreamThreadInfo_Release(tagStreamThreadInfo *this); // idb
void __cdecl sub_F95D10(int a1);
unsigned int __cdecl sub_F96830(int a1, int a2, LPVOID ppv, int a4, int a5);
DWORD __stdcall StreamToWbemServicesThreadProc(IWbemLocator *pLocator); // idb
_DWORD *__thiscall sub_F96B70(_DWORD *this);
_DWORD *__thiscall sub_F96BB0(_DWORD *this, int a2, size_t a3);
void __stdcall sub_F96D00(void *a1);
void __stdcall sub_F96D40(void *a1);
void __stdcall sub_F96D60(void *a1);
void __stdcall sub_F96DC0(void *a1);
BOOL __thiscall sub_F96E00(void *this, size_t a2, int a3);
void *__stdcall sub_F96EC0(size_t a1);
_DWORD *__thiscall sub_F96F00(_DWORD *this, int a2, int a3, size_t a4);
_DWORD *__thiscall sub_F97030(int this, void *a2, size_t a3);
int *__stdcall std::_System_error_category::default_error_condition(int *a1, int a2);
bool __thiscall std::error_category_equivalent(void *this, _DWORD *a2, int a3);
bool __thiscall std::error_category_equivalent2(void *this, int a2, _DWORD *a3);
int __thiscall sub_F971F0(CSystemProcessInfoMap *this, int a2, void *a3, int a4);
int __thiscall sub_F972B0(CSystemProcessInfoMap *this, int a2, void *a3);
CSystemProcessInfoMapNode **__thiscall sub_F97560(CSystemProcessInfoMap *this, CSystemProcessInfoMapNode **a2, CSystemProcessInfoMapNode *a3, CSystemProcessInfoMapNode *a4);
CSystemProcessInfoMapNode **__thiscall sub_F97620(CSystemProcessInfoMap *this, CSystemProcessInfoMapNode **a2, CSystemProcessInfoMapNode *a3);
_DWORD *__thiscall sub_F97890(_DWORD *this, unsigned int a2, unsigned int a3);
int __stdcall std::_Generic_error_category_message(int a1, int a2);
int __stdcall std::_Iostream_error_category_message(int a1, int a2);
int __stdcall std::_System_error_category_message(int a1, int a2);
const char *std::_Generic_error_category_name();
const char *std::_Iostream_error_category_name();
const char *std::_System_error_category_name();
_DWORD __stdcall nullsub_2(_DWORD); // weak
int swprintf(wchar_t *pszBuffer, const wchar_t *lpszFormat, ...);
EventItem *__thiscall tagEventItem::tagEventItem(EventItem *this, const GUID *a2, __int16 a3, __int16 a4, char a5); // idb
_DWORD **__cdecl sub_F97B60(int a1, OLECHAR *psz, int a3, int a4);
int *__thiscall sub_F97C40(char *this, _DWORD **a2);
LONG __cdecl sub_F97CE0(int a1);
_bstr_t *__thiscall QueryEventTraceName(tagWbemServicesList *ppWbemServices, GUID *pIID, WORD bVersion, BYTE cLevel, WORD aType);
// signed int __usercall sub_F98250@<eax>(int a1@<edi>, int a2@<esi>, int a3, int a4);
_bstr_t *__thiscall sub_F98730(tagWbemServicesList *pWbemServicesList, GUID *pIID, int Type, int Version, int Level);
_bstr_t *__thiscall QueryEventTraceNameEx(tagWbemServicesList *this, IEnumWbemClassObject *pClassObject_1, const GUID *a3, unsigned __int16 Version, char Level, __int16 Type);
int __cdecl sub_F992A0(wchar_t *Dst, size_t SizeInWords, int); // idb
HRESULT __cdecl SetProxyAccessRight(tagWbemServicesList *pWbemServicesList); // idb
_DWORD *__thiscall sub_F99380(_DWORD *this, int a2);
_WORD *__thiscall sub_F993D0(_WORD *this, OLECHAR *psz);
// int __usercall QueryShellDispatch@<eax>(int a1@<esi>, IShellFolderViewDual *pShellFolderViewDual, GUID *iid, IDispatch *ppDispApplication);
// HRESULT __usercall QueryShellView@<eax>(_GUID *iid, IShellView **ppv);
// int __usercall PE_ShellExecute@<eax>(const wchar_t *lpszFile, const wchar_t *lpszParameters, const wchar_t *lpszDir);
CRYPT_PROVIDER_DATA *__cdecl sub_F99700(CRYPT_PROVIDER_DATA *a1, char a2, WINTRUST_DATA **a3, unsigned int *a4, GUID *a5, int a6);
MACRO_HRESULT __cdecl sub_F99930(HCATADMIN hCatAdmin, int a2, char fdwRevocationChecks, BYTE *pbHash, DWORD cbHash, void *a6, int a7, int a8);
LONG __cdecl sub_F99A40(int a1, char fdwRevocationChecks, int a3, int a4, void *a5, int a6, int a7, int dwIndex); // idb
LONG __cdecl sub_F99BB0(const WCHAR *a1, int a2, HCATADMIN *a3, char a4, int a5, _DWORD *a6, int a7, int a8, int a9, int a10, int a11, wchar_t **a12, int dwIndex); // idb
bool __cdecl LoadWintrust(); // weak
CTreeList *__thiscall CTreeList::CTreeList(CTreeList *this);
HTHEME __thiscall CTreeList::~CTreeList(CTreeList *this);
void __thiscall sub_F9A2C0(tagTreeViewChildItem *this); // idb
_bstr_t *__thiscall sub_F9A320(_bstr_t *this, LPCSTR lpString);
BOOL __thiscall sub_F9A3E0(BSTR **this, BSTR **a2);
void *__thiscall CTreeListData::`scalar deleting destructor'(void *this, char a2);
HWND __cdecl CTreeList::Init(HWND hWndParent, HINSTANCE hInstance, HMENU hMenu, int a4, RECT *lprc); // idb
HWND __stdcall CTreeList::CreateTooltips(HINSTANCE hInstance, HWND hWndParent);
LRESULT __stdcall CThemedWindow::HandleMessage(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
int __stdcall sub_F9A5C0(int);
int __thiscall CTreeList::OnDestroy(CTreeList *this); // idb
bool __thiscall sub_F9A690(HWND *this, WPARAM wParam);
void __thiscall sub_F9A7D0(CTreeList *this, tagTreeViewChildItem *pChild); // idb
signed int __thiscall TreeViewChildItem_GetSiblingCount(tagTreeViewChildItem *this); // idb
void __thiscall CTreeList::DrawHeader(CTreeList *this, int hWndHeader, HDC hDC, RECT rect);
LRESULT __thiscall CTreeList::SendNotify(CTreeList *this, HWND hWnd, int code, int Msg, tagTreeViewChildItem *pSibling, tagTreeViewChildItem *pChild, int nItem);
void __thiscall CTreeList::DrawTree(CTreeList *this, HDC *a2, HRGN a3); // idb
HGDIOBJ __thiscall sub_F9BC20(CThemedWindow *this, int a2, HDC hDC, char a4, LPRECT lprc); // idb
char __thiscall sub_F9BDA0(CTreeList *this, char a2); // idb
char __thiscall CTreeList::UpdateSB(CTreeList *this, char a2); // idb
UINT __thiscall sub_F9BE30(CTreeList *this, signed int a2); // idb
int __thiscall CTreeList::OnMsg2001(CTreeList *thisIn, tagTreeViewChildItem *pItem, char fChild);
signed int __thiscall CTreeList::FindChild(CTreeList *this, tagTreeViewChildItem *pChild); // idb
CTreeList *__cdecl CTreeList::GetTreeList(HWND hWnd);
int __thiscall CTreeList::GetChildWidth(CTreeList *this, int nChildID); // idb
char __thiscall sub_F9C210(HWND *this, int a2, int a3, char a4, char a5, int a6, LPARAM lParam);
int __thiscall sub_F9C420(_DWORD *this);
BOOL __thiscall CTreeList::MapToHeader(CTreeList *this, WPARAM wParam, RECT *lParam); // idb
HWND __thiscall CTreeList::GetTooltipOfRightHeader(CTreeList *this);
int __stdcall sub_F9C4A0(int, int);
int __stdcall sub_F9C530(int a1, int a2);
HIMAGELIST __thiscall CTreeList::GetImageList(CTreeList *this);
char __thiscall sub_F9C550(_DWORD *this, int a2, struct tagRECT *a3);
int __thiscall CTreeList::GetLineHeight(CTreeList *this); // idb
int __thiscall CTreeList::GetScrollInfos(CTreeList *this_, SCROLLINFO *RightScrollInfo, SCROLLINFO *BottomScrollInfo); // idb
signed int __thiscall sub_F9C8A0(CTreeList *this, bool *a2); // idb
int __stdcall CListViewData::GetItemText(tagTreeViewChildItem *pChildItem, UINT iSubItem, WCHAR *pszText, PDWORD cbSize);
const wchar_t *__stdcall sub_F9CA20(int a1, int a2, int a3, int a4);
const wchar_t *CTreeList::GetName();
HWND __thiscall CTreeList::GetTooltipOfTreeList(CTreeList *this);
int __thiscall sub_F9CA50(void *this);
int __thiscall TreeViewChildItem_GetChildCount(tagTreeViewChildItem *this); // idb
LRESULT __thiscall CTreeList::HeaderWndProc(CTreeList *this, HWND hWndFrom, UINT Msg, WPARAM wParam, tagNMLVGETINFOTIPW *lParamIn); // idb
signed int __thiscall CTreeList::Query(CTreeList *this, LONG xPos, LONG yPos, int *pxx, WPARAM *pnItem, tagTreeViewChildItem **pyy); // idb
int __thiscall CTreeList::UpdateHeaderPos(CTreeList *this, HWND hWnd, int a3); // idb
int __thiscall CTreeList::SetHScrollPos(CTreeList *this, HWND hwnd, int a3);
void __thiscall sub_F9D310(CTreeList *this, int a2, int a3); // idb
char __thiscall CTreeList::OnInited(CTreeList *hData); // idb
int *__thiscall sub_F9D640(_DWORD *this, int a2, CListViewData *pListViewData, int (__cdecl *pfnCallback)(int, _DWORD, int, _DWORD), int a5);
char __thiscall sub_F9D750(CTreeList *this, int a2, int a3);
tagTreeViewChildItem *__thiscall sub_F9D7E0(CTreeList *this, int a2, int a3, int (__cdecl *a4)(int, _DWORD, int, _DWORD), int a5);
int __stdcall CTreeList::SetVScrollbarPos(int yPos, int cy);
bool __thiscall sub_F9D980(_DWORD *this, int a2);
tagTreeViewChildItem *__thiscall TreeViewChildItem_GetChild(tagTreeViewChildItem *pItem, int nPos); // idb
int __thiscall CTreeList::GetLineHeight(CTreeList *this); // idb
int __cdecl pfnCallback(CListViewData *pListViewData, int a2, int a3);
int __cdecl sub_F9DBC0(int a1, int a2, int (__stdcall *a3)(_DWORD, _DWORD, int), int a4);
HWND __thiscall CTreeList::HandleListViewMsg(CTreeList *this, HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam); // idb
int __stdcall sub_F9E5D0(int a1);
int __stdcall CTreeList::OnMsg2004(int, int, int);
int __thiscall sub_F9E650(_DWORD *this);
int __thiscall CTreeList::SendNotifyEx(CTreeList *this, HWND hWndParent, TVNMHDR *pNMHDR); // idb
BOOL __thiscall sub_F9E900(_DWORD *this, int a2, int a3, int a4, int a5, const __m128i *a6);
char __stdcall sub_F9E9C0(int a1, int a2, int a3, int a4, int a5);
int __thiscall sub_F9E9D0(_DWORD *this);
int __thiscall CTreeList::Refresh(CTreeList *this);
BOOL __thiscall CTreeList::RefreshHeaderItem(CTreeList *this, int nItem); // idb
int __thiscall CTreeList::RefreshChildItem(CTreeList *thisIn, tagTreeViewChildItem *pChild);
void __thiscall CTreeList::RedrawZone(CTreeList *thisIn, int nStart, int nEnd);
ATOM CTreeList::Register();
int __cdecl CTreeList::RepositionTooltips();
LRESULT __thiscall CTreeList::MoveHeaders(CTreeList *this, int a2); // idb
int __thiscall CTreeList::OnSize(CTreeList *this);
int __cdecl CTreeList::RepositionHeaders();
void __thiscall CTreeList::RedrawChild(CTreeList *pThis, tagTreeViewChildItem *pItem); // idb
LRESULT __thiscall sub_F9F110(HWND *this, int a2, int a3);
int __stdcall CTreeList::OnMsg2000(tagTreeViewChildItem *pItem, char a2);
LRESULT __thiscall CTreeList::SetSortFlagsImageList(CTreeList *this, LPARAM lParam, int a3, int a4);
char __thiscall CTreeList::ResetImageList(CTreeList *this, int a2, char a3); // idb
int __thiscall sub_F9F210(CTreeList *this, int a2); // idb
// void __thiscall CTreeList::SetSplitterCursor(CTreeList *this, HCURSOR a2);
int __thiscall sub_F9F230(CTreeList *this, int a2); // idb
BOOL __thiscall CTreeList::ShowCaption(CTreeList *this, char fVisible); // idb
bool __thiscall CTreeList::UpdateLeftBottomSB(CTreeList *this, HWND hWnd, char a3, char a4); // idb
bool __thiscall CTreeList::UpdateRightRightSB(CTreeList *this, bool fHide, bool fSBVisible);
unsigned int __cdecl sub_F9F500(unsigned int *a1, unsigned int a2, int (__cdecl *a3)(_DWORD, _DWORD, int, int), int a4, int a5, int a6);
LRESULT __stdcall CTreeList::Proxy_HeaderWndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
LRESULT __stdcall CTreeList::Proxy_TooltipWndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
HWND __stdcall CTreeList::WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
tagTreeViewChildItem *__thiscall CTreeList::GetCurScrollChildItem(CTreeList *this);
int __thiscall CTreeList::GetRightScrollbarPos(CTreeList *this); // idb
bool __thiscall CTreeList::InitHeaderColumn(CTreeList *this, HWND hWnd, char a3); // idb
LRESULT __thiscall CTreeList::PopTooltip(CTreeList *this, HWND hWnd, POINT *pt); // idb
unsigned int __thiscall CTreeList::UpdateVScrollBars(CTreeList *this, int nPos); // idb
// unsigned int __userpurge CTreeList::SetVScrollPos@<eax>(CTreeList *this@<ecx>, int a2, int a3);
HWND __thiscall CTreeList::TreeWndProc(CTreeList *this, HWND hWndIn, UINT Msg, WPARAM wParamIn, LPARAM lParam); // idb
CSystemProcessInfoMapNode *__thiscall sub_FA11F0(std__tree *this, int *a2); // idb
int __thiscall sub_FA1240(int *this, int a2, int a3, int a4, void *a5);
int sub_FA13E0(wchar_t *Dst, wchar_t *Format, ...);
void __thiscall sub_FA1400(CSystemProcessInfoMap *this);
void __thiscall sub_FA1430(_bstr_t **this); // idb
_bstr_t *__cdecl sub_FA14F0(_bstr_t *a1, LPCSTR lpString, _bstr_t *a3); // idb
bool __stdcall AskForAgreementLicense(HWND hWnd, OLECHAR *psz, char a3, char a4, int a5);
int __stdcall sub_FA18A0(int, FILETIME *lpFileTime); // idb
int __stdcall sub_FA1BC0(int, OLECHAR *psz); // idb
DWORD __thiscall sub_FA1FC0(_DWORD *this);
Data_t_bstr_t *__thiscall sub_FA37E0(_DWORD *this);
int __stdcall sub_FA4320(int, DWORD dwMessageId); // idb
DWORD __stdcall sub_FA4420(void *a1, int a2, int a3);
BSTR **__thiscall sub_FA4530(void *this, int a2, OLECHAR psz, int a4);
int __stdcall sub_FA4810(int, OLECHAR *psz, __int16); // idb
_bstr_t *__stdcall sub_FA4950(int a1, int a2, void *a3);
DWORD __stdcall sub_FA4AA0(HINTERNET hRequest, int a2);
int __stdcall sub_FA4CA0(HINTERNET hRequest, int, DWORD dwInfoLevel, int); // idb
int __stdcall sub_FA4D50(void *); // idb
DWORD __thiscall HttpInfo_Open(tagHttpInfo *this, HWND hWnd, OLECHAR *psz, char a4, char a5, char a6);
DWORD __thiscall sub_FA4F00(HINTERNET *this, void *a2, void *a3, void *a4, int a5);
std__list_node *__thiscall sub_FA5160(tagHttpInfo *this, char a2);
char __thiscall LoadConfigItemFromRegistry(tagRegKeyInfo *this, tagConfigItem *pConfigItem);
LSTATUS __thiscall RegKeyInfo_LoadDwordArray(tagRegKeyInfo *pThis, LPCWSTR lpValueName, DWORD cbSize, PVOID pMap);
int __thiscall RegKeyInfo_LoadWord(tagRegKeyInfo *this, LPCWSTR lpValueName, WORD *dwValue, DWORD dwDefValue);
LSTATUS __thiscall RegKeyInfo_LoadShortArray(tagRegKeyInfo *pThis, LPCWSTR lpValueName, DWORD dwCount, PVOID pArray);
DWORD __thiscall sub_FA55A0(HINTERNET *this, int a2, OLECHAR psz);
LSTATUS __thiscall SaveConfigItemToRegistry(tagRegKeyInfo *pThis, tagConfigItem *pConfigItem);
LSTATUS __thiscall RegKeyInfo_SaveLongArray(HKEY *this, LPCWSTR lpSubKey, int a3, BYTE *lpData);
LSTATUS __thiscall RegKeyInfo_SaveShortArray(tagRegKeyInfo *pThis, LPCWSTR lpValueName, DWORD dwCount, PVOID pData);
void __stdcall sub_FA6500(void *a1);
CSystemProcessInfoMapNode **__thiscall sub_FA6540(CSystemProcessInfoMap *this, CSystemProcessInfoMapNode **a2, CSystemProcessInfoMapNode *a3, CSystemProcessInfoMapNode *a4);
CSystemProcessInfoMapNode **__thiscall sub_FA6600(CSystemProcessInfoMap *this, CSystemProcessInfoMapNode **a2, CSystemProcessInfoMapNode *a3);
unsigned int __cdecl sub_FA6870(int a1, const unsigned __int16 *a2);
HBRUSH __stdcall DlgLicenseInfo(HWND hDlg, UINT a2, WPARAM a3, LPARAM a4);
_BYTE *sub_FA6A40();
BOOL __cdecl License_IsEulaAccepted(HKEY hKey, LPCWSTR lpSubKey);
BOOL __cdecl License_CheckEulaAccepted(LPCWSTR lpszText); // idb
signed int sub_FA6C00();
signed int sub_FA6CC0();
BOOL __cdecl sub_FA6D40(HWND a1);
BOOL __cdecl LicenseCheck(WCHAR *lpszText, int a2, int a3); // idb
signed int sub_FA7020();
void __noreturn sub_FA7080();
BOOL __cdecl LicensePropSheet(WCHAR *lpszText, BYTE Data); // idb
BOOL __cdecl sub_FA7390(LPARAM a1, int *a2, int a3);
int __stdcall sub_FA7910(int, void *, int, int); // idb
signed int CAboutWnd::HandleInitDialog();
LRESULT __cdecl CAboutWnd::HandleCommand(HWND hWnd, int a2, WPARAM wParam, LPARAM lParam);
int __cdecl Command_OkOrCancel(HWND hDlg); // idb
HBRUSH __stdcall DlgAbout(HWND hDlg, UINT Msg, WPARAM hdc, LPARAM lParam);
int __cdecl Command_About(HWND hWndParent); // idb
int *__cdecl sub_FA7DF0(int *a1, const unsigned __int16 *a2);
struct std::_Facet_base *__cdecl sub_FA8150(int *a1);
_DWORD *__thiscall sub_FA8270(_DWORD *this);
char *__thiscall sub_FA8300(char *this, int a2, int a3);
struct std::_Locinfo *__thiscall sub_FA8360(struct std::_Locinfo *this, char *a2);
std::exception *__thiscall sub_FA8420(std::exception *this, int a2, int a3, int a4);
std::exception *__thiscall sub_FA84F0(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_FA8520(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_FA8550(std::exception *this, struct exception *a2);
_DWORD *__thiscall sub_FA8570(_DWORD *this, int a2);
std::exception *__thiscall sub_FA8600(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_FA8630(std::exception *this, int a2, int a3, void *a4);
int __thiscall sub_FA87D0(_DWORD *this);
int __thiscall sub_FA8880(std::_Lockit *this); // idb
// _DWORD __thiscall std::locale::~locale(std::locale *__hidden this); idb
void __thiscall sub_FA8990(_DWORD *this);
void __fastcall sub_FA8A1C(unsigned int a1, int a2, int a3);
void __fastcall sub_FA8A24(unsigned int a1, int a2, int a3);
char *__thiscall sub_FA8A2C(_DWORD *this, char a2);
void *__thiscall sub_FA8B10(void *this, char a2);
_DWORD *__thiscall sub_FA8B60(void *this, char a2);
_DWORD *__thiscall sub_FA8BC0(struct std::ios_base *this, char a2);
void **__thiscall sub_FA8C00(void *this, char a2);
void *__thiscall sub_FA8C50(void *this, char a2);
struct std::ios_base *__thiscall sub_FA8C80(struct std::ios_base *this, char a2);
void *__thiscall sub_FA8CB0(void *this, char a2);
void __cdecl sub_FA8CE0(int a1, int a2, wchar_t *a3);
int __cdecl sub_FA9000(int a1, int a2, int a3, int a4);
volatile signed __int32 *__thiscall sub_FA9070(volatile signed __int32 *this);
signed int __cdecl sub_FA9090(char **a1, int *a2);
__int64 __thiscall sub_FA9140(_DWORD **this);
signed __int32 __thiscall sub_FA9160(volatile signed __int32 *this);
struct std::locale::_Locimp *__thiscall sub_FA9170(_DWORD *this);
void *__cdecl sub_FA91F0(void *a1, char a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9);
int __thiscall sub_FA92D0(_DWORD *this);
__int64 __thiscall sub_FA9400(_DWORD **this);
_DWORD *__thiscall sub_FA9420(int this);
_DWORD *__thiscall sub_FA9490(void *this, int a2, int a3, int a4);
_DWORD *__thiscall sub_FA9550(void *this, void *a2, size_t a3);
int *__thiscall sub_FA9640(int *this, int *a2, unsigned int a3, unsigned int a4);
int *__thiscall sub_FA9760(int *this, void *a2, int a3);
int __thiscall sub_FA9860(_DWORD *this, char a2);
BOOL __stdcall sub_FA9900(__int16 a1, WCHAR SrcStr);
char __thiscall sub_FA9930(const _Cvtvec *this, wchar_t a2, int a3);
wchar_t *__thiscall sub_FA9980(const _Cvtvec *this, wchar_t *a2, unsigned int a3, char a4, int a5);
unsigned __int16 *__thiscall sub_FA9A20(void *this, int a2, unsigned __int16 *a3, unsigned __int16 *a4);
unsigned __int16 *__thiscall sub_FA9A60(void *this, int a2, unsigned __int16 *a3, unsigned __int16 *a4);
int __thiscall sub_FA9AA0(void *this, wchar_t Src);
wchar_t *__thiscall sub_FA9AC0(char *this, wchar_t *a2, unsigned int a3);
int __thiscall sub_FA9B10(void *this, wchar_t Src);
wchar_t *__thiscall sub_FA9B30(char *this, wchar_t *a2, unsigned int a3);
wchar_t __thiscall sub_FA9B80(const _Cvtvec *this, char a2);
char *__thiscall sub_FA9BD0(const _Cvtvec *this, wchar_t a2, char a3, mbstate_t a4);
_DWORD *__thiscall sub_FA9C60(_DWORD *this, unsigned int a2, unsigned int a3);
char *__thiscall sub_FA9D10(char *this);
int *__thiscall sub_FA9E40(_DWORD *this, int *a2);
void __thiscall sub_FA9E70(struct std::ios_base *this, int a2, char a3);
int __thiscall sub_FA9F90(_DWORD **this, int a2);
__int16 __thiscall sub_FA9FC0(_DWORD *this, __int16 a2);
signed int __stdcall sub_FAA1E0(int a1);
signed __int16 __thiscall sub_FAA1F0(int this, __int16 a2);
_DWORD *__stdcall sub_FAA260(_DWORD *a1, int a2, int a3, int a4, int a5);
signed int *__thiscall sub_FAA290(int this, signed int *a2, __int64 a3, int a4, char a5);
_DWORD *__stdcall sub_FAA480(_DWORD *a1, int a2, int a3, int a4, int a5, int a6, int a7, int a8);
signed int *__thiscall sub_FAA4B0(int this, signed int *a2, __int64 a3, __int64 a4, int a5, int a6, char a7);
void *__thiscall sub_FAA600(void *this, int a2, int a3, int a4);
__int64 sub_FAA610();
void *__thiscall sub_FAA620(_DWORD *this, void *a2);
void *__thiscall sub_FAA6E0(_DWORD *this, void *a2);
signed int __thiscall sub_FAA700(_DWORD **this);
signed int sub_FAA730();
signed __int16 __thiscall sub_FAA740(int this);
unsigned int __thiscall sub_FAA7B0(_DWORD **this, void *a2, int a3, int a4);
unsigned int __thiscall sub_FAA8C0(_DWORD **this, void *a2, int a3, int a4);
void *__thiscall CObjSecurity::`scalar deleting destructor'(void *this, char a2);
int __cdecl CObjSecurity::~CObjSecurity(int a1);
int __cdecl CObjSecurity::Create(tagHANDLELISTITEMPARAM *pItem, LPCWSTR lpszText, CObjSecurity **ppv, int nType, BOOL fObjSecurity);
int __stdcall CObjSecurity::AddRef(int a1);
int __stdcall CObjSecurity::GetAccessRights(int a1, int a2, int a3, _DWORD *a4, _DWORD *a5, _DWORD *a6);
int __stdcall CObjSecurity::GetInheritTypes(int a1, _DWORD *a2, _DWORD *a3);
int __stdcall CObjSecurity::GetObjectInformation(_DWORD *a1, _DWORD *a2);
int __stdcall CObjSecurity::GetSecurity(int, SECURITY_INFORMATION dwSecurityInformation, PSECURITY_DESCRIPTOR lpSecurityDescriptor, int); // idb
int __stdcall CObjSecurity::Init(CObjSecurity *a1, int a2, int a3, int a4, wchar_t *Src, int a6, int a7); // idb
int __cdecl CopyServerName(int, wchar_t *Src); // idb
int __stdcall CObjSecurity::MapGeneric(int, int, int, PDWORD AccessMask); // idb
int __stdcall CObjSecurity::PropertySheetPageCallback(int a1, int a2, int a3, int a4);
signed int __stdcall CObjSecurity::QueryInterface(int a1, _DWORD *a2, _DWORD *a3);
int __stdcall CObjSecurity::Release(_DWORD *a1);
int __stdcall CObjSecurity::SetSecurity(int, SECURITY_INFORMATION dwSecurityInformation, PSECURITY_DESCRIPTOR lpSecurityDescriptor); // idb
int __thiscall sub_FAAEE0(_DWORD *this, int a2, char a3, int a4, int a5, void *a6);
int __thiscall sub_FAB100(_DWORD **this, int a2, int a3, int a4, void *a5);
CString *__thiscall ATL::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>::Format(CString *this, UINT nID); // idb
CString *__thiscall ATL::CSimpleStringT<wchar_t,0>::CSimpleStringT<wchar_t,0>(CString *this);
ATL::CAtlStringMgr *__thiscall ATL::CAtlStringMgr::Clone(ATL::CAtlStringMgr *this);
volatile signed __int32 *__thiscall ATL::CSimpleStringT<wchar_t,0>::~CSimpleStringT<wchar_t,0>(CString *this);
CString *__cdecl ATL::CSimpleStringT<wchar_t,0>::Append(CString *str1, CString *str2, WCHAR *lpszSource2); // idb
void *__thiscall ATL::CAtlStringMgr::`scalar deleting destructor'(void *this, char a2);
void *__thiscall ATL::CWin32Heap::`vector deleting destructor'(void *this, char a2);
ATL::CAtlStringMgr **__thiscall ATL::CAtlStringMgr::Allocate(ATL::CAtlStringMgr *this, int a2, unsigned int a3);
LPVOID __thiscall ATL::CWin32Heap::Allocate(HANDLE *this, SIZE_T dwBytes);
int __cdecl sub_FAB650(int a1);
CHAR *__cdecl ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>::FindStringResourceInstance(int a1, WORD wLanguage);
void __cdecl __noreturn ATL::AtlThrowImpl(int a1);
void __cdecl sub_FAB780(HWND hWnd, CString lpCommandLine);
HANDLE StartBackendThread();
CStringData *__cdecl sub_FAB970(CStringData *a1);
CHAR *__cdecl ATL::CSimpleStringT<wchar_t,0>::Concatenate(CString *this, WCHAR *lpszSource, int nLength, void *lpszSource2, int nLength2); // idb
CStringData *__thiscall ATL::CSimpleStringT<wchar_t,0>::Empty(CString *this);
volatile signed __int32 *__thiscall ATL::CSimpleStringT<wchar_t,0>::Fork(CString *this, int nLength); // idb
int __thiscall ATL::CAtlStringMgr::Free(ATL::CAtlStringMgr *this, struct CStringData *a2);
LPVOID __thiscall ATL::CWin32Heap::Free(HANDLE *this, LPVOID lpMem);
wchar_t *__cdecl sub_FABB70(wchar_t *a1, wchar_t *a2);
IAtlStringMgr *__stdcall ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>::GetDefaultManager();
char *__thiscall ATL::CAtlStringMgr::GetNilString(ATL::CAtlStringMgr *this);
SIZE_T __thiscall ATL::CWin32Heap::GetSize(HANDLE *this, LPCVOID lpMem);
int __thiscall ATL::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>::LoadStringW(CString *this, HMODULE hModule, int nID); // idb
volatile signed __int32 *__thiscall ATL::CSimpleStringT<wchar_t,0>::PrepareWrite2(CString *this, int nLength_1); // idb
volatile signed __int32 *__cdecl sub_FABF00(OLECHAR *lpszText1, OLECHAR *lpszText2, OLECHAR *lpszText3);
CStringData *__thiscall ATL::CSimpleStringT<wchar_t,0>::Reallocate(CString *this, int nLength);
int __thiscall ATL::CAtlStringMgr::Reallocate(ATL::CAtlStringMgr *this, struct CStringData *a2, int a3, unsigned int a4);
LPVOID __thiscall ATL::CWin32Heap::Reallocate(HANDLE *this, LPVOID lpMem, SIZE_T dwBytes);
CStringData *__thiscall ATL::CSimpleStringT<wchar_t,0>::SetString(CString *this, void *Src, int a3); // idb
HGLOBAL __cdecl ATL::AtlGetStringResourceImage(HMODULE hModule, HRSRC hResInfo, int id); // idb
void __stdcall sub_FAC750(void *a1);
Data_t_bstr_t *__thiscall sub_FAC770(_bstr_t *this, _bstr_t *a2); // idb
int __cdecl sub_FAC7E0(int a1, int a2, int a3, _DWORD *a4, unsigned __int8 (__cdecl *a5)(_DWORD, _DWORD));
void *__cdecl sub_FAC880(void *a1, int a2, int a3);
int __cdecl sub_FAC930(int a1, int a2, unsigned __int8 (__cdecl *a3)(_DWORD, _DWORD));
int __cdecl sub_FAC9E0(int *a1, int *a2, int *a3, unsigned __int8 (__cdecl *a4)(int, int));
int __cdecl sub_FACBC0(int a1, int a2, int a3, _DWORD *a4, unsigned __int8 (__cdecl *a5)(_DWORD, _DWORD));
void *__cdecl sub_FACC30(void *a1, int a2, int a3, int a4);
signed int __cdecl sub_FACD10(_DWORD *a1, int a2, unsigned __int8 (__cdecl *a3)(_DWORD, _DWORD));
int **__cdecl sub_FACD70(int **a1, int *a2, int *a3, unsigned __int8 (__cdecl *a4)(int, int));
_DWORD *__cdecl sub_FACF50(_DWORD *a1, _WORD *a2, _WORD *a3, _WORD *a4);
void **__thiscall sub_FACF80(void **this, void *Src, int a3, int a4);
AppDomain *__thiscall AppDomain::AppDomain(AppDomain *this, int a2, int a3);
CString *__thiscall Assembly::Assembly(CString *this, int a2, int a3, void *a4, void *Src);
CResizer *__thiscall CResizer::CResizer(CResizer *this, HWND hWnd);
_DWORD *__thiscall sub_FAD260(_DWORD *this);
Runtime *__thiscall Runtime::Runtime(Runtime *this, unsigned int a2, unsigned __int16 a3);
volatile signed __int32 *__thiscall AppDomain::~AppDomain(void (__stdcall *****this)(signed int));
volatile signed __int32 *__thiscall Assembly::~Assembly(Assembly *this);
HTHEME __thiscall CResizer::~CResizer(CResizer *this);
volatile signed __int32 *__thiscall Process::~Process(void (__stdcall *****this)(signed int));
volatile signed __int32 *__thiscall Runtime::~Runtime(void (__stdcall *****this)(signed int));
CString *__thiscall sub_FAD840(CString *this, void **a2);
void *__thiscall AppDomain::`vector deleting destructor'(void *this, char a2);
void *__thiscall Assembly::`scalar deleting destructor'(void *this, char a2);
void *__thiscall Process::`scalar deleting destructor'(void *this, char a2);
void *__thiscall Runtime::`scalar deleting destructor'(void *this, char a2);
int __thiscall sub_FAD970(_DWORD *this, CTreeList *thisIn);
int __cdecl sub_FADB10(wchar_t *Dst, rsize_t SizeInWords, int); // idb
CHAR *__thiscall sub_FADB40(CString *this, wchar_t *Src);
CHAR *__thiscall sub_FADB80(CString *this, wchar_t *Src, size_t MaxCount);
int __cdecl sub_FADC50(wchar_t *Dst, rsize_t SizeInWords, int); // idb
int __thiscall CResizer::InitWnd(CResizer *hData, HWND hWnd); // idb
// ULONG __userpurge sub_FADD40@<eax>(int a1@<ecx>, int a2@<edi>, int a3@<esi>, int a4, int a5);
// int __userpurge sub_FADE80@<eax>(int a1@<edi>, int *a2);
signed int __thiscall sub_FADEA0(void *this, int a2, DWORD ThreadId);
int __thiscall sub_FADF10(DWORD *this);
int __stdcall PageProcCclr(HWND hWnd, int, WPARAM, int); // idb
BOOL __cdecl sub_FAE780(int a1, int a2);
bool __cdecl sub_FAE7A0(int a1, int a2);
LRESULT __thiscall CResizer::HandleMessage(WNDPROC *this, HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
int __stdcall sub_FAE7F0(int a1);
int __thiscall sub_FAE810(_DWORD *this, int a2, int a3);
struct tagResizerItem *__thiscall CResizer::AddItem(CResizer *this, HWND hWndEdit, int a3); // idb
int __cdecl sub_FAE970(wchar_t *Dst, rsize_t SizeInWords, int, int, int); // idb
__int16 __thiscall sub_FAE9F0(_WORD *this);
__int16 __thiscall sub_FAEA10(_WORD *this);
__int16 __thiscall sub_FAEA30(_WORD *this);
HWND __thiscall CTreeList::GetTooltipOfLeftHeader(CTreeList *this);
const WCHAR **sub_FAEA80();
int __thiscall sub_FAEA90(_WORD *this);
_WORD *__thiscall sub_FAEAB0(_WORD *this);
AppDomain *__thiscall sub_FAEAD0(_DWORD *this, int a2, AppDomain *a3);
Runtime *__thiscall sub_FAEBA0(_DWORD *this, unsigned int a2, Runtime *a3);
int __cdecl ProcessIsNetCclr(DWORD th32ProcessID, PDWORD pdwFlags);
wchar_t *__thiscall sub_FAEE50(_DWORD *this, int a2, int a3, wchar_t *Dst, int a5);
wchar_t *__thiscall sub_FAEEA0(int this, int a2, int a3, wchar_t *Dst, int a5);
wchar_t *__thiscall sub_FAEFF0(int this, int a2, int a3, wchar_t *Dst, int a5);
wchar_t *__stdcall sub_FAF070(int a1, int a2, wchar_t *Dst, int a4);
const wchar_t *CResizer::GetName();
int __thiscall sub_FAF0A0(_DWORD *this, int a2);
int __cdecl sub_FAF690(const unsigned __int16 *a1);
bool __cdecl sub_FAF710(int a1, int a2, int a3);
bool __cdecl sub_FAF730(int a1, int a2);
void **__thiscall sub_FAF760(_DWORD *this, void **a2, int a3);
void **__thiscall sub_FAF790(_DWORD *this, void **a2, int a3, int a4);
signed int __thiscall sub_FAF840(char *this, WCHAR *a2);
BOOL __stdcall CResizer::EnumChildCallback(HWND hWnd, CResizer *a2); // idb
int __thiscall CResizer::Refresh(CResizer *lParam); // idb
int __thiscall sub_FAFE80(const wchar_t **this, wchar_t a2);
CStringData *__thiscall sub_FAFEB0(CString *this, void *Src);
CStringData *__thiscall sub_FAFF00(CString *this, void *Src);
CStringData *__thiscall sub_FAFF50(CString *this, void *Src);
CStringData *__thiscall sub_FAFFA0(CString *this, void *Src);
int __thiscall sub_FAFFF0(CString *this, void *Src);
CStringData *__thiscall sub_FB00E0(CString *this, void *Src);
int __thiscall sub_FB0130(HWND *this);
void *__thiscall sub_FB01B0(int this);
int __cdecl sub_FB01D0(wchar_t *Dst, rsize_t SizeInWords, int); // idb
int __cdecl sub_FB0200(wchar_t *Src, int); // idb
LRESULT __stdcall CResizer::Proxy_WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
char *__thiscall sub_FB0650(const void **this, unsigned int a2);
char *__thiscall std::vector<tagAccountInfo *,std::allocator<tagAccountInfo *>>::_Reallocate(std__vector *this, unsigned int a2); // idb
unsigned int __thiscall sub_FB0750(int this, unsigned int a2);
unsigned int __thiscall std::vector<tagAccountInfo *,std::allocator<tagAccountInfo *>>::_Reserve(std__vector *this, unsigned int a2); // idb
int __thiscall sub_FB0840(_DWORD *this, int a2, void *a3);
__int16 __thiscall sub_FB0880(_DWORD *this, _WORD *a2);
tagAccountInfo *__thiscall std::vector<tagAccountInfo *,std::allocator<tagAccountInfo *>>::push_back(std__vector *this, tagAccountInfo *pInfo); // idb
bool __cdecl ProcessIsNetCclr_0(tagTREEVIEWLISTITEMPARAM *a1); // idb
int __cdecl sub_FB09A0(wchar_t *Dst, int, __int64); // idb
int __cdecl sub_FB09F0(wchar_t *Dst, int, __int64); // idb
errno_t __cdecl sub_FB0A40(wchar_t *a1, int a2, __int64 a3);
int wsprintfW(wchar_t *Dst, wchar_t *Format, ...);
int __thiscall sub_FB0A90(BitmapItem *this, int a2, int a3, int a4, int a5, unsigned int a6, int a7);
char __thiscall BitmapItem_Create(BitmapItem *this, LONG nWidth, signed int nHeight); // idb
char __thiscall BitmapItem_SetRectColor(BitmapItem *this, RECT *lprc, unsigned int color); // idb
int __cdecl sub_FB0E00(wchar_t *Dst, size_t SizeInWords, int, __int64); // idb
char __thiscall sub_FB0E50(BitmapItem *this, int a2, int a3, int a4, int a5, unsigned int a6, int a7);
char __thiscall sub_FB0ED0(_DWORD *this, int a2, int a3, int a4, int a5, unsigned int a6, char a7);
void __cdecl CGraphData_Update(CGraphData *pGraphData, FILETIME time, double dbMemorySize, double a5, wchar_t *a6);
CGraphData *__cdecl InitGraphData(int nCount, int nChildID, BOOL fFlags);
void __cdecl GraphData_Release(CGraphData *pGraphData, int nCount); // idb
HWND __cdecl CreateGraphWindow(HWND hDlg, int nIDDlgItem, PVOID pParam); // idb
HGDIOBJ __cdecl GraphData_DrawGraph(CGraphData *pGraphData, HDC hDC, RECT *lprc);
HICON __cdecl GraphData_DrawChart(CGraphData *pGraphData, HDC hDC, RECT *lprc, COLORREF Color, DWORD dwValue, double dbValue);
char *__cdecl sub_FB1FD0(FILETIME *a1, HDC hDC, RECT *lprc, COLORREF ColorBack); // idb
int __cdecl GraphData_QueryData(CGraphData *pGraphData, double *pArg1, double *pArg2);
int __cdecl sub_FB2200(char, wchar_t *, size_t SizeInWords, __int64, __int64, __int64); // idb
errno_t __cdecl sub_FB2410(wchar_t *a1, rsize_t SizeInWords, int a3, __int64 a4);
void __cdecl sub_FB24C0(int a1);
int __cdecl sub_FB2A70(HWND hWnd); // idb
PerformanceInfo *__thiscall PerformanceInfo::PerformanceInfo(PerformanceInfo *this, HKEY hSubKey); // idb
void __thiscall PerformanceInfo::~PerformanceInfo(void **this);
int __thiscall PerformanceInfo::FindPerf(PerformanceInfo *pThis, LPCWSTR lpszName); // idb
int __thiscall sub_FB2D20(unsigned int *this, unsigned int a2);
LRESULT __cdecl HandleCmdHandler(int a1, HWND hWnd, WPARAM wParam, LPARAM lParam);
LRESULT __cdecl HandleMsgHandler(tagMSGHANDLER *pMsgHander, HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam); // idb
bool __cdecl CDriver::SaveDriverFromResource(LPCWSTR lpName, const wchar_t *lpszFileName);
BOOL __cdecl CDriver::OpenEx(const WCHAR *lpszDriverName, WCHAR *lpszPathName, PHANDLE DriverHandle); // idb
BOOL __cdecl CDriver::Open(const WCHAR *lpszDriverName, PHANDLE DriverHandle); // idb
_DWORD *__stdcall sub_FB3310(_DWORD *a1, _DWORD *a2, _DWORD *a3);
char __cdecl sub_FB3340(HANDLE ProcessHandle, int a2, int a3, int time, int time_4, tagTREEVIEWLISTITEMPARAM *pItemParam, WPARAM wParam);
void __cdecl sub_FB38F0(FILETIME time, signed __int64 a2, int a3, int a4, int a5, CGraphData *a6, CGraphData *a7);
BOOL __cdecl Init3DStatistics(unsigned __int64 *a1, unsigned __int64 *a2);
_DWORD *__stdcall sub_FB4360(_DWORD *a1, _DWORD *a2);
CGraphData *__thiscall sub_FB43A0(tagGraphInfo *pThis); // idb
signed __int64 __thiscall GraphInfo_Refresh(tagGraphInfo *pGrahInfo_1); // idb
void __thiscall sub_FB44A0(tagGraphInfo *this, TreeList_Item1 *pItem); // idb
int __thiscall sub_FB47C0(_DWORD *this, int a2, _DWORD *a3);
int __cdecl CMainWnd::Create(HINSTANCE hInstance, int nCmdShow); // idb
int __cdecl wsprintf(wchar_t *Dst, wchar_t *Format, char ArgList); // idb
int MakeHandlePropSheetCaption(wchar_t *Dst, wchar_t *Format, ...);
CString *__thiscall ATL::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>(CString *this, LPCSTR lpMultiByteStr);
CString *__thiscall ATL::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>::operator=(CString *this, LPCSTR lpMultiByteStr);
int __stdcall sub_FB4D00(HDC hdc, wchar_t *Src, rsize_t SizeInWords, int); // idb
signed int __cdecl sub_FB4EF0(unsigned int *a1, _DWORD *a2);
char __cdecl sub_FB4F50(CRegSettings *pConfig, DWORD *pdwValue, unsigned int a3); // idb
BOOL __stdcall sub_FB55D0(HDC hdc, wchar_t *Src, RECT *lprect, int a4);
char __cdecl sub_FB56D0(char a1, tagTREEVIEWLISTITEMPARAM *pTreeItem, WORD uID, HDC hDC, RECT *lprc); // idb
errno_t __cdecl sub_FB5AD0(int a1, int a2, int a3, int a4, int a5, wchar_t *Dst, rsize_t SizeInWords);
LPCWSTR __cdecl sub_FB5BB0(wchar_t *Dst, __int64 a2);
char __cdecl QueryListItemColor(HWND hWnd, int nItem, BOOL bFocused, COLORREF *pTextColor, COLORREF *pBackColor);
BOOL __cdecl CTreeList::SetHeaderItem(HWND hWndHeader, WPARAM wParam, int fImage); // idb
BOOL __stdcall EnumFunc(HWND, LPARAM); // idb
char __cdecl IsStringID(signed int uID); // idb
unsigned __int16 __cdecl sub_FB6210(double a1, unsigned __int16 a2, unsigned __int16 a3);
int __cdecl sub_FB6270(int a1, int a2);
void __cdecl RegVar_ReadWrite(int fSave, int nCount, CRegVar *pVariable); // idb
int __cdecl sub_FB73D0(HWND hWnd, char); // idb
char __cdecl TreeView_InsertVerifyColumn(HWND hWnd, UINT uID, int *pnIDs, int pnLength); // idb
int __cdecl sub_FB7790(HWND hWnd, char); // idb
wchar_t *__cdecl sub_FB78D0(HWND a1, wchar_t *a2);
int sub_FB7A90(HWND hWnd, ...);
tagTREEVIEWLISTITEMPARAM *__cdecl CTreeList::FindItem(HWND hWnd, LPARAM lParam);
char *__cdecl sub_FB7DD0(HWND hWnd, char a2);
int __cdecl sub_FB7E70(HWND hWnd, char a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12, int a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, int a32, int a33, int a34, int a35, int a36, int a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, int a57, int a58, int a59, int a60, int a61, int a62, int a63);
int __cdecl sub_FB7F20(HWND hWnd, tagTREEVIEWLISTITEMPARAM *pItemParam); // idb
void __cdecl TreeViewItemParam_InitGraph(tagTREEVIEWLISTITEMPARAM *pItem); // idb
struct _IMAGELIST *InitSortableImageList();
HWND __cdecl CreateListCtrl(HWND hWnd, DWORD dwStyle, int a3, int a4, LONG dwNewLong, HMENU hMenu);
void __cdecl sub_FB8460(tagTREEVIEWLISTITEMPARAM *a1); // idb
LRESULT __cdecl sub_FB8570(HWND hWnd, int a2);
void __cdecl DLLLISTITEMPARAM_Release(tagTREEVIEWLISTITEMPARAM *lpAddend); // idb
void __cdecl TreeViewListItemParam_Release(tagTREEVIEWLISTITEMPARAM *a1); // idb
char __cdecl CMainWnd::DrawList(LPDRAWITEMSTRUCT pDrawItemStruct); // idb
int __cdecl UpdateMenuStatus(char bEnabled, int nPos); // idb
BOOL __cdecl sub_FB8DA0(tagTREEVIEWLISTITEMPARAM *pItemParam); // idb
char __cdecl ProcStrings_FindItem(HWND hDlg, HWND hWndList, tagFINDREPLACEW *pFindReplace, LPCWSTR lpszFindWhat, PBOOL pbFound, wchar_t *pszBuffer);
void InitDrawEngine();
BOOL __cdecl sub_FB9980(HWND hWnd);
LRESULT __cdecl sub_FB9BB0(HWND hWnd, LONG dwNewLong, UINT *pnIDs, WORD *pnWidths, char fSortable);
char __cdecl IsColumnIDValid(HWND hWnd, DWORD dwId);
int __stdcall Proxy_ListCtrlWndProc(HWND hWnd, UINT Msg, WPARAM wParamIn, LPARAM lParamIn);
LRESULT __cdecl sub_FBA880(HWND hWnd, WPARAM uMsg, WPARAM wParam_1, RECT *lParam_1); // idb
BOOL __cdecl InitTreeList(HWND hWnd, WPARAM wParam);
int __stdcall PropProcThreadsSortCallback(int a1, int a2, int *a3);
int __stdcall CTreeView::InitListHeader(HWND hWnd, UINT *pnIDs, WORD *pnWidths, DWORD dwColumnCount);
int __cdecl sub_FBCDD0(int a1, int a2);
int __cdecl sub_FBD040(WPARAM uTabID, int pThis); // idb
int __cdecl sub_FBD4B0(signed int a1, int a2);
int __cdecl FillList(int nID); // idb
int __cdecl sub_FBD7A0(int a1);
int __cdecl sub_FBD7B0(signed int a1, int a2);
int __cdecl sub_FBF490(int a1, int a2);
int __cdecl sub_FBF4D0(HMENU hMnu); // idb
int __cdecl UpdateListViewContextMenu(UINT nID, HWND hWnd, POINT *pt);
bool __cdecl CTreeList::InitHeaderColumn(HWND hWnd, WPARAM wParam, HWND nItem, char flags); // idb
LRESULT __cdecl sub_FBFAA0(HWND hWnd);
BOOL __stdcall DlgColumnSets(HWND hWndIn, UINT msg, WPARAM nID, NMLVDISPINFOW *lParam);
BOOL __cdecl CMainWnd::Draw(int nColumn, HDC hdc, COLORREF *pColorReturned); // idb
HCURSOR __cdecl CMainWnd::GetDynamicCursor(int a1, int nIndex); // idb
char __cdecl RedrawColumn(int fRedraw, HWND hWnd, int uID, WPARAM wParam); // idb
BOOL __stdcall DlgColumnSetSave(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam);
void __cdecl UpdateWindowPlacement(HWND hWnd, char bSave); // idb
int __stdcall PropColumnSetsForDlls(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __stdcall PropColumnSetsForHandles(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __stdcall PropColumnSetsForNet(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __stdcall PropColumnSetsForProcess(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __cdecl sub_FC1AF0(_DWORD *a1, _DWORD *a2);
signed int __cdecl sub_FC1B70(int a1, HWND *a2);
signed int __cdecl sub_FC1C50(int a1, int a2);
BOOL RefreshTreeView();
int sub_FC1D60(char *DstBuf, char *Format, ...);
int sub_FC1D80(wchar_t *Dst, wchar_t *Format, ...);
int *__thiscall sub_FC1DA0(int *this, void *a2);
_DWORD *__thiscall sub_FC1E00(void *this, void *a2);
HRESULT __cdecl sub_FC1E50(char a1, OLECHAR *a2);
void *__cdecl sub_FC26B0(void *a1);
errno_t __cdecl sub_FC2850(wchar_t *Dst, rsize_t SizeInWords);
char __cdecl sub_FC2910(int a1, int a2, int a3, wchar_t *Dst, rsize_t SizeInWords);
WCHAR *__cdecl sub_FC29E0(HKEY hKey, LPCWSTR lpValueName);
void __cdecl sub_FC2A70(const __m128i *a1);
char __cdecl WriteMemoryStringToList(HWND hWnd, DWORD dwMinLength, LPVOID pBuffer, DWORD dwLength);
BOOL __cdecl IsServer(LPCWSTR lpszServerName);
_DWORD *__thiscall sub_FC30E0(void *this, int a2, int a3, int a4);
_DWORD *__thiscall sub_FC31B0(void *this, void *a2, int a3);
LPCWSTR __cdecl sub_FC3290(LPCWSTR lpValue, rsize_t SizeInWords);
void __cdecl sub_FC3300(wchar_t *a1);
BOOL __cdecl ReplaceMenuIconFromStockIcon(HMENU hmenu, UINT item);
bool __cdecl sub_FC36B0(int a1, unsigned int a2, char a3, char a4);
HWND __cdecl PropSheet_UpdateTab(HWND hWnd);
signed int __cdecl sub_FC37B0(unsigned __int64 a1, unsigned __int64 a2);
BOOL __cdecl sub_FC37F0(char a1);
LRESULT __cdecl CTreeList::InitToolTips(HWND hWnd);
BOOL __cdecl DrawLine(HWND hWnd, int y);
char __cdecl MakeApplicationName(LPCWSTR lpFileName, wchar_t *Src, int a3, wchar_t *Dst);
HWND __cdecl QueryTopMostWindowByProcessID(int dwProcessId_1); // idb
int __cdecl sub_FC3C40(wchar_t *, size_t SizeInWords, __int64); // idb
char __cdecl UserInfoWithSIDList_Find(PSID pSID, LPWSTR pszName, DWORD cbName, LPWSTR pszDomainName, DWORD cbDomainName); // idb
int *__cdecl sub_FC3E70(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION pSystemLogicalProcessorInfo, int dwCount, signed int dwProcessorID, signed int *pnValue1, int *pnValue2);
int __cdecl sub_FC3F20(_DWORD *a1, unsigned int a2, int a3);
void __cdecl sub_FC3F80(wchar_t *Str, int a2, int a3, int a4, int a5);
wchar_t *__cdecl sub_FC4280(wchar_t *a1);
DWORD __cdecl sub_FC43C0(LPCWSTR lptstrFilename, wchar_t *Dst, rsize_t SizeInWords, DWORD dwLen, int a5);
char __cdecl sub_FC44B0(int a1, char a2, int a3, u_long hostlong, int a5, wchar_t *Dst, size_t SizeInWords);
wchar_t *__cdecl sub_FC4670(char a1, int port, char *proto, wchar_t *Dst, size_t SizeInWords);
wchar_t *__cdecl ProcessComment_Find(wchar_t *ProcessName); // idb
wchar_t *__cdecl sub_FC4730(wchar_t *a1, int a2);
WCHAR *__cdecl sub_FC4780(wchar_t *a1, LPCWSTR lpServiceName);
wchar_t *__cdecl sub_FC4990(int a1);
BOOL __cdecl DrawHungWindow(HWND hWnd);
// bool __usercall IsProcessExplorerRunAtStartup@<al>(int a1@<ebp>, _DWORD *a2@<edi>);
bool IsXPDll();
char __cdecl sub_FC50E0(wchar_t *a1);
char IsPAEEnabled();
char CanReplaceTaskManager();
// int __usercall IsWinServer@<eax>(int a1@<ebx>, int a2@<esi>);
BOOL __cdecl CMainWnd::Hide(HWND hWnd);
// _DWORD __cdecl unknown_libname_2(char); weak
char *__cdecl Fake_GetLogicalProcessorInformation(PDWORD pdwCount);
BOOL __cdecl PE_SetWindowPlacement(HWND hWnd, POINT pt);
char __cdecl LaunchWebBrowser(HWND hWnd, bool flags, LPCWSTR lpszURL);
int __cdecl sub_FC5A60(const void *, const void *); // idb
LSTATUS LoadHiddenProcessesFromRegistry();
LSTATUS LoadProcessCommentsFromRegistry();
char __cdecl ReplaceTaskManager(HWND a1, char a2);
char __thiscall sub_FC5E40(HKEY this);
DWORD __cdecl LaunchProcExplorer64(int a1, WORD a2);
DWORD __cdecl sub_FC6180(const WCHAR *a1, int a2, char a3);
int Fake_IsWow64Process();
LSTATUS __cdecl sub_FC62A0(int a1, wchar_t *a2);
char __cdecl ImportStringsToListFromFile(HWND hWnd, LPCWSTR lpFileName);
HCURSOR __cdecl LoadProcessStringsToList(HWND hWnd, HANDLE ProcessHandle, LPCVOID lpBaseAddress, DWORD dwSize);
int __cdecl PE_FillControl(int, HDC hdc); // idb
int __cdecl QueryTagInformationEx(PVOID *ppv, PDWORD pdwValue2, PDWORD pdwValue3, PDWORD pdwValue4);
BOOL __cdecl TrayIcon_Add(HWND hWnd, UINT nID, CGraphData *pGraphData, LPCWSTR lpszTipText);
BOOL __cdecl TrayIcon_Delete(HWND hWnd, UINT nID);
BOOL __cdecl sub_FC6910(int a1, int a2, int a3, wchar_t *Src);
BOOL __cdecl RefreshVirusTotalMenuItem(tagTREEVIEWLISTITEMPARAM *pItemParam); // idb
BOOL __cdecl RefreshMenuWithTreeViewItemStatus(tagTREEVIEWLISTITEMPARAM *pItem); // idb
bool __cdecl sub_FC6B90(HWND hWnd, int a2, int a3);
LSTATUS SaveHiddenProcessesToRegistry();
HANDLE __cdecl sub_FC6DB0(HANDLE TokenHandle);
BOOL __cdecl QueryCurrentAuthorityInfo(wchar_t **a1);
BOOL __cdecl QueryAuthorityInfoFromSID(PSID pSid, wchar_t *Dst, int a3);
char IsBuiltinAdministrative();
_DWORD *__cdecl sub_FC7450(PSID AccountSid);
int sub_FC7500(wchar_t *Dst, wchar_t *Format, ...);
_DWORD *__thiscall sub_FC7520(_DWORD *this, int (__stdcall ***a2)(_DWORD, GUID *, _DWORD *));
_DWORD *__thiscall sub_FC7560(_DWORD *this, int (__stdcall ***a2)(_DWORD, GUID *, _DWORD *));
_DWORD *__thiscall sub_FC75A0(_DWORD *this);
int __thiscall sub_FC7600(_DWORD *this, int a2);
_DWORD *__thiscall sub_FC7640(void *this, char a2);
unsigned int __thiscall sub_FC76F0(_DWORD *this, int *a2);
_DWORD *__thiscall sub_FC7740(_DWORD *this, int *a2);
void __stdcall sub_FC77E0(int *a1);
void __cdecl sub_FC79A0(_DWORD *a1, int a2);
int __cdecl sub_FC79D0(int a1, unsigned int a2);
int __cdecl sub_FC7A00(HWND hWnd, int, char); // idb
signed int __stdcall sub_FC7DD0(int (__stdcall ***a1)(_DWORD, GUID *, int *));
int __cdecl sub_FC7F10(int, LPCWSTR lpsz, int); // idb
int __thiscall sub_FC7F60(_DWORD *this);
void __thiscall sub_FC7F70(_DWORD *this);
signed int __stdcall sub_FC7FF0(unsigned int a1, _DWORD *a2, unsigned int *a3);
signed int __stdcall sub_FC80C0(int (__stdcall ***a1)(_DWORD, GUID *, int *), _DWORD *a2);
int __stdcall sub_FC86C0(int a1, _DWORD *a2);
int *__cdecl sub_FC86E0(wchar_t *a1, int a2);
int __cdecl sub_FC8790(wchar_t *Src, wchar_t *Dst); // idb
int __stdcall sub_FC87D0(int, DWORD dwThreadId, int, int, int); // idb
char __thiscall sub_FC88A0(const void **this, unsigned int a2);
FARPROC __thiscall sub_FC8940(_DWORD *this, _DWORD *a2);
int __thiscall sub_FC8A30(_DWORD *this, int a2, int a3, int a4, int a5);
int __thiscall sub_FC8A90(_DWORD *this, int a2, int a3, int a4, int a5);
void __thiscall sub_FC8AE0(int *this, unsigned int a2, int *a3, unsigned int a4);
int (__stdcall ***__stdcall sub_FC8C80(int (__stdcall ***a1)(_DWORD, GUID *, int *)))(_DWORD, GUID *, int *);
signed int __thiscall sub_FC8D10(_DWORD *this, int a2);
BOOL __cdecl sub_FC8DE0(int a1);
int __thiscall sub_FC8E20(void *this, int a2, int a3, int *a4, _DWORD *a5, _DWORD *a6, int a7, unsigned int a8, unsigned int *a9);
signed int __thiscall sub_FC9500(_DWORD *this, int a2, int a3, int a4);
signed int __stdcall sub_FC9620(int a1, int a2, int a3, int a4, HMODULE *a5);
signed int __stdcall sub_FC9780(int a1, _DWORD *a2, _DWORD *a3);
signed int __stdcall sub_FC9800(int a1, _DWORD *a2, _DWORD *a3);
signed int __stdcall sub_FC9880(int a1, _DWORD *a2, _DWORD *a3);
signed int __stdcall sub_FC98D0(int a1, int a2, int a3);
int __stdcall sub_FC98E0(int, LPCVOID lpBaseAddress, int, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead); // idb
int __stdcall sub_FC9910(void *); // idb
int __stdcall sub_FC9940(_DWORD *a1);
int __stdcall sub_FC9960(void *); // idb
int __stdcall sub_FC99B0(void *); // idb
int __cdecl sub_FC9A00(void *Dst, void *Src, int); // idb
_DWORD *__thiscall sub_FC9A30(_DWORD *this);
_DWORD *__thiscall sub_FC9AC0(int *this, _DWORD *a2);
int __stdcall sub_FC9B40(DWORD dwThreadId); // idb
char __thiscall sub_FC9B80(int this, unsigned int a2, int a3);
int __thiscall sub_FC9C50(_DWORD *this, int a2, int a3, int a4);
signed int __stdcall sub_FCA3A0(_WORD *a1, unsigned int a2, int a3);
signed int __stdcall sub_FCA440(_WORD *a1, unsigned int a2, int a3, unsigned int a4);
signed int __stdcall sub_FCA490(_WORD *a1, int a2, _DWORD *a3, int a4, int a5);
signed int __stdcall sub_FCA500(_WORD *a1, unsigned int a2, _DWORD *a3, unsigned int a4);
HANDLE __thiscall sub_FCA570(void *this, DWORD dwThreadId, int a3, int a4, int a5, int a6, int a7);
char __cdecl sub_FCA870(int a1, WPARAM wParam);
int __thiscall sub_FCB0A0(_DWORD *this, DWORD dwThreadId, int a3);
int __thiscall sub_FCB680(_DWORD *this, DWORD dwThreadId, int a3, int a4, int a5, int a6, int a7, int a8, int a9, int a10, int a11, int a12);
void LoadNetClrMemoryPerformanceInfo();
void *__cdecl sub_FCB9D0(int a1);
int __stdcall PageProcNet(HWND hWnd, unsigned int a2, WPARAM wParam, int a4);
int dynamic_initializer_for_gPerformanceInfoInMemory__();
char __cdecl sub_FCC540(int a1, WPARAM wParam);
CSystemProcessInfoMapNode *__thiscall std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buynode<std::piecewise_construct_t const &,std::tuple<unsigned long &&>,std::tuple<>>(CSystemProcessInfoMap *this, CSystemProcessInfoMapPair *a1); // idb
CSystemProcessInfoMapNode **__thiscall sub_FCC630(CSystemProcessInfoMap *thisMap, CSystemProcessInfoMapNode **ppNode, char a3, CSystemProcessInfoMapNode *pNode, CSystemProcessInfoMapPair *pair, int a6); // idb
int __thiscall std::map<unsigned long,unsigned long,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,unsigned long>>>::operator[](CSystemProcessInfoMap *thisMap, int a2, _DWORD *a3, _DWORD *dwThreadId, int a5); // idb
signed int __stdcall LogBufferCallback(int a1);
HANDLE ScanAllThreads();
ULONG __thiscall TraceEventThreadProc(EVENT_TRACE_PROPERTIES_EXT *this);
ULONG __stdcall TraceEventThreadProcEx(EVENT_TRACE_PROPERTIES_EXT *a1);
__int64 __thiscall PE_ComputeTime(PE_TIME *this, __int64 time);
unsigned __int8 *__cdecl sub_FCCC70(int a1, int a2, int a3, wchar_t *Dst, rsize_t SizeInWords);
ULONG __thiscall PE_FlushTrace(LPEVENT_TRACE_PROPERTIES_EXT Properties); // idb
int __cdecl NetworkMsgItem2_FindID(WCHAR *lpszText); // idb
std__Tree_node *__cdecl sub_FCD2B0(unsigned int a1);
signed int __thiscall PE_RunTrace(EVENT_TRACE_PROPERTIES_EXT *PropertiesIn, char fStart);
void __cdecl sub_FCD510(EVENT_TRACE *EventTrace, EventList *Param); // idb
void __stdcall LogEventCallback(PEVENT_TRACE EventTrace); // idb
void __cdecl sub_FCDB50(EVENT_TRACE *EventTrace, EventList *a2); // idb
void __cdecl sub_FCDCE0(EVENT_TRACE *EventTrace, EventList *a2); // idb
int **__cdecl sub_FCE310(int a1, int a2);
int __cdecl sub_FCE4E0(int, PSID Sid); // idb
_DWORD *__thiscall sub_FCE560(int *this, _DWORD *a2, unsigned int *a3);
void __stdcall sub_FCE5E0(CSystemProcessInfoMapNode *a1); // idb
CSystemProcessInfoMapNode *__thiscall sub_FCE620(CSystemProcessInfoMap *this);
_DWORD *__thiscall sub_FCE670(_DWORD *this, int a2, int a3, int a4, int a5, int a6);
wchar_t **__thiscall sub_FCE6A0(int **this, wchar_t *a2);
wchar_t **__thiscall sub_FCE760(PerformanceInfo **this, LPCWSTR lpsz);
wchar_t **__thiscall sub_FCE830(int this);
wchar_t **__thiscall sub_FCE840(int this);
int __thiscall sub_FCE850(int *this, wchar_t *Dst, rsize_t SizeInWords);
// PE_PerfInfo *__thiscall unknown_libname_3(PE_PerfInfo *this, int a2, int a3);
PE_PerfInfo_Item *__thiscall PE_PerfInfo::Load(PE_PerfInfo *this, LPCWSTR lpszName);
char __cdecl sub_FCE970(LPCWSTR lpFileName, int a2, HANDLE hObject, LPCVOID lpBaseAddress);
wchar_t **__thiscall sub_FCEC40(wchar_t **this, wchar_t *a2, int a3, void *a4, unsigned int a5);
void __thiscall sub_FCEC80(void **this);
signed int __thiscall sub_FCECA0(int this, _DWORD *a2, int a3);
PE_PerfInfo_Item *__thiscall sub_FCED40(PE_PerfInfo_Item *this, int a2, PerformanceInfo *a3); // idb
_DWORD *__thiscall sub_FCED60(_DWORD *this);
_DWORD *__thiscall sub_FCEE00(_DWORD *this);
PerformanceInfoInMemory *__thiscall PE_PerfInfo::PE_PerfInfo(PerformanceInfoInMemory *this, PerformanceInfo *a2);
int __thiscall PerformanceInfoInMemory::FindPerf(PerformanceInfoInMemory *this, LPCWSTR lpszName, wchar_t *pszBuffer, int nLength); // idb
int __thiscall sub_FCEF90(PerformanceInfoInMemory *this); // idb
WCHAR *__thiscall sub_FCEFA0(PerformanceInfoInMemory *this);
int __thiscall PerformanceInfoInMemory::Load(PerformanceInfoInMemory *pThis, LPCWSTR lpszRootName, LPCWSTR lpszName); // idb
int __cdecl CMainWnd::HandleMsg7FD(int, int, int, void *); // idb
int __cdecl CMainWnd::HandleDeviceChange(HWND a1, unsigned int a2, unsigned int wParam, _DEV_BROADCAST_HDR *lParam); // idb
int __cdecl CMainWnd::HandleMsg7F9(int a1, int a2, int a3, int a4);
int __cdecl Command_CreateDump(HWND a1, __int16 a2);
int Command_RestartProcess();
int Command_KillProcess();
int __cdecl Command_Exit(HWND hWnd); // idb
int Command_OpenProcExp();
int Command_CopyAllThreadStack();
int Command_RefreshNow();
int __cdecl Command_SelectColumn(HWND hWnd, signed __int16 uID); // idb
int __cdecl Command_ShowDllsPane(HWND hWnd); // idb
int __cdecl Command_ShowHandlesPane(HWND hWnd); // idb
int __cdecl Command_ViewDllsProperties(HWND hWnd);
int __cdecl Command_UnnamedHandlesAndMappings(HWND hWnd); // idb
int __cdecl Command_HighlightRelocatedDlls(HWND hWnd); // idb
int __cdecl Command_ScrollToNewProcess(HWND hWnd); // idb
int __cdecl Command_Help(int a1);
int __cdecl Command_SearchOnline(HWND hWnd, __int16 a2);
int __cdecl Command_FindInProcess(HWND a1, __int16 nID); // idb
int __cdecl Command_Cancel(HWND hWnd); // idb
int Options_ShowHiddenProcess();
int __cdecl Command_Font(HWND hWnd); // idb
int Command_OnProperties();
int __cdecl sub_FD0970(int a1, __int16 a2);
int Command_OptionsToConfirmKill();
int Command_ShowNewProcesses();
int Command_SaveHiddenProcesses();
int __cdecl Command_DifferenceHiliteDuration(HWND hWndParent); // idb
int Command_Save();
int __cdecl Command_CpuHistory(HWND hWndParent); // idb
int Command_SaveAs();
int Command_CloseHandle();
int Command_SuspendProcess();
int __cdecl Command_ShowLowerPane(HWND a1);
int __cdecl OnProperties(HWND a1, __int16 a2);
int __cdecl UpdateSpeedOptions_Update(HWND a1, UINT a2);
int OnProcessProperties();
// int __usercall ProcessPriority_Update@<eax>(int a1@<edi>, HWND a2, __int16 a3);
int Options_AllowOneInstance();
int __cdecl Command_Run(HWND hWndParent, int); // idb
int __cdecl Command_RunAs(HWND hWndParent, int); // idb
int __cdecl Options_HideWhenMinimized(HWND hWnd); // idb
int __cdecl OpacityOptions_Update(HWND hWnd, int); // idb
int __cdecl UserAccount_Refresh(HWND a1, __int16 a2);
int __cdecl Command_ReplaceTaskManager(HWND hWnd); // idb
int __cdecl Command_ConfigSymbols(HWND hWndParent); // idb
int Command_SystemInformation();
int __cdecl Command_ConfirmToKillProcess(HWND hWnd); // idb
int __cdecl Command_ConfigColors(HWND hWndParent); // idb
int Process_CleanMemory();
int __cdecl WindowOptions_Refresh(HWND a1, int a2);
int Command_ShowColumnHeatmaps();
int __cdecl Command_VerifyImage(HWND hWnd); // idb
int __cdecl Command_CheckVirusTotalDotCom(HWND hWnd); // idb
int __cdecl Command_SubmitUnkownExecutables(HWND hWnd); // idb
int Command_CheckVirusTotalDotCom();
int Command_Check_VirusTotalDotCom();
int Command_ShowDetailsForAllProcesses();
int __cdecl Command_SetTopmost(HWND hWnd); // idb
int __cdecl Command_ViewCpuHistory(HWND hWnd); // idb
int __cdecl Command_ViewIoHistory(HWND hWnd); // idb
int __cdecl Command_CommitNetworkHistory(HWND hWnd); // idb
int __cdecl Command_CommitDiskHistory(HWND hWnd); // idb
int __cdecl Command_CommitGPUHistory(HWND hWnd); // idb
// int __usercall Command_RunAtLogon@<eax>(_DWORD *a1@<edi>, HWND hWnd);
int __cdecl Command_ViewCommitHistory(HWND hWnd); // idb
int __cdecl Command_ViewPhysicalMemoryHistory(HWND hWnd); // idb
// signed int __usercall Command_SetColumn@<eax>(double a1@<st0>, double a2@<st1>, HWND hWnd, unsigned __int16 uID);
int sub_FD2F00();
int sub_FD2F10();
int __cdecl Command_LaunchDepends(HWND a1, __int16 a2);
int Command_DebugProcess();
int __cdecl Command_ShowProcessesForAllUsers(HWND hWnd); // idb
int __cdecl Command_SaveColumnSet(HWND hWndParent); // idb
int __cdecl Command_OrganizeColumnSets(HWND hWnd); // idb
LRESULT __cdecl CMainWnd::HandleCommand(HWND hWnd, int a2, WPARAM wParam, LPARAM lParam);
int __cdecl CMainWnd::HandlePaint(HWND hWnd); // idb
int __cdecl CMainWnd::HandleSize(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __cdecl CMainWnd::HandleGetMinmaxInfo(HWND a1, unsigned int a2, unsigned int a3, MINMAXINFO *a4); // idb
int __cdecl CMainWnd::HandleLBtnDown(HWND hWnd, int, int, int); // idb
int __cdecl CMainWnd::HandleLBtnUp(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __cdecl CMainWnd::HandleMouseMove(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
BOOL __cdecl CMainWnd::HandleMeasureItem(HWND a1, unsigned int a2, unsigned int a3, LPMEASUREITEMSTRUCT lpmis); // idb
int __cdecl CMainWnd::HandleNotify(HWND hWnd, UINT msg, WPARAM wParam, NMHDR *lParam);
int __cdecl CMainWnd::HandleCreate(HWND hWnd); // idb
int __cdecl CMainWnd::HandleClose(HWND hWnd);
int CMainWnd::HandleEndSession();
int __cdecl CMainWnd::HandleDestroy(HWND hWnd); // idb
int __cdecl CMainWnd::HandleDrawItem(HWND a1, unsigned int a2, unsigned int a3, LPDRAWITEMSTRUCT a4); // idb
signed int __cdecl CMainWnd::HandleSetFocus(HWND a1);
LRESULT __cdecl CMainWnd::HandleContextMenu(HWND hWnd_1, UINT Msg, HWND hWnd, LPARAM a4); // idb
int __cdecl CMainWnd::HandleMsg7EF(int, int, int, void *); // idb
int __cdecl CMainWnd::HandleMsg7F8(HWND a1, unsigned int a2, unsigned int a3, const wchar_t **a4);
int __cdecl CMainWnd::HandleMsg7F6(int, int, int, HWND hWnd); // idb
signed int CMainWnd::HandleKillFocus();
int __cdecl CMainWnd::HandleMsg7F0(HWND a1, unsigned int a2, unsigned int a3, int pListItem); // idb
_DWORD *__cdecl CMainWnd::HandleMsg7EE(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __cdecl CMainWnd::HandleInitMenuPopup(HWND hWnd, unsigned int nPos, HMENU hMenu);
LRESULT __cdecl CMainWnd::HandleMenuCommand(HWND hWnd, int a2, int nPos, HMENU hMenu);
signed int __cdecl CMainWnd::HandleCopyData(HWND hWnd, UINT msg, WPARAM wParam, PCOPYDATASTRUCT lParam);
int __cdecl CMainWnd::HandleMsg7F3(HWND a1, unsigned int a2, unsigned int a3, int a4);
int __cdecl CMainWnd::HandleMsg7E8(int, int, HWND hWnd); // idb
int __cdecl CMainWnd::HandleMsg7E9(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
LRESULT __cdecl CMainWnd::HandleSysCommand(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
int __cdecl CMainWnd::HandleMsg7EB(int, int, WPARAM wParam, WPARAM); // idb
int sub_FD68E0(wchar_t *Dst, wchar_t *Format, ...);
CString *__thiscall ATL::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>(CString *this, LPCSTR lpMultiByteStr, int cbMultiByte);
HBRUSH __stdcall DlgSelectColor(HWND hDlg, UINT uMsg, WPARAM wParam, LPARAM lParam); // idb
int __stdcall PropColumnSetsForStatusBar(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
BOOL __stdcall DialogFunc(HWND, UINT, WPARAM, LPARAM); // idb
void __cdecl sub_FD7930(int a1);
HBRUSH __cdecl BrushFromColor(COLORREF color, HBRUSH *BrushHandle); // idb
char __cdecl sub_FD79E0(char a1);
BOOL __cdecl sub_FD7A60(HWND hWnd);
int __cdecl SelectColor(HWND hWnd, COLORREF *ColorReturned); // idb
int __stdcall CMainWnd::BackendRefreshThreadProc(struct VOID *a1);
BOOL __stdcall sub_FD7F60(HWND, UINT, WPARAM, LPARAM); // idb
int __stdcall sub_FD85F0(HWND hDlg, int, int, int); // idb
BOOL __stdcall DlgSymbolConfig(HWND hDlg, UINT uMsg, WPARAM wParam, LPARAM lParam); // idb
char __cdecl BrowseSymbolPath(HWND hWnd, LPWSTR pszPath); // idb
BOOL BackendSysInfoPropSheetThreadProc();
const wchar_t *__cdecl sub_FD8D50(int a1);
BOOL __stdcall sub_FD8DE0(HWND, UINT, WPARAM, LPARAM); // idb
CGraphData *HandleTaskbarCreated();
void __cdecl ShowSymbolConfigWarning(HWND hWnd); // idb
int __cdecl SearchWindow(HWND hWnd); // idb
LRESULT __stdcall CMainWnd::MainWndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
int __cdecl DumpFileProcess(int, HANDLE Process, char); // idb
int __cdecl sub_FD9660(int, int, wchar_t *Dst); // idb
_DWORD *__thiscall sub_FD9690(_DWORD *this, int a2);
int __thiscall std::_Tree<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Insert_at<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *> &,std::_Tree_node<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>,void *> *>(CSystemProcessInfoMap *this, int a2, char a3, int a4, int a5, CSystemProcessInfoMapNode *_Node); // idb
_DWORD *__thiscall sub_FD98E0(_DWORD *this, _DWORD *a2, char a3, _DWORD *a4, int a5, int a6);
int __thiscall std::_Tree<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Insert_hint<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *> &,std::_Tree_node<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>,void *> *>(CSystemProcessInfoMap *this, int a2, int _Where, int _Val, CSystemProcessInfoMapNode *_Newnode); // idb
int __thiscall sub_FD9C10(_DWORD *this, int a2, _DWORD *a3, _DWORD *a4, int a5);
int MakeDriverName(wchar_t *pszText, wchar_t *lpszFormat, ...); // idb
int wsprintfW(wchar_t *Dst, wchar_t *Format, ...);
int sub_FD9D60(wchar_t *Dst, wchar_t *Format, ...);
int wsprintf_s(wchar_t *Dst, wchar_t *Format, ...);
int sub_FD9DA0(wchar_t *Dst, wchar_t *Format, ...);
int MakeDeviceName(wchar_t *Dst, wchar_t *Format, ...);
int sub_FD9DE0(wchar_t *Dst, wchar_t *Format, ...);
int *__thiscall sub_FD9E00(_DWORD *this, LPCWSTR lpWideCharStr);
CString *__thiscall ATL::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>::CStringT<wchar_t,ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>>(CString *this, LPCSTR lpMultiByteStr); // idb
void __thiscall sub_FD9F20(void **this);
void __thiscall PerformanceInfoInMemory::~PerformanceInfoInMemory(PerformanceInfoInMemory *this); // idb
void __thiscall sub_FD9FB0(CSystemProcessInfoMap *this);
int *__thiscall sub_FD9FE0(int *this, LPCWSTR lpWideCharStr);
char *__cdecl sub_FDA070(HWND hWnd, char a2, int a3, int a4, int a5, int a6, int a7, u_long hostlong, int a9, int port, int a11, int a12, int a13, int a14);
CHAR *__thiscall sub_FDA4A0(CString *this, __int16 a2);
int __cdecl sub_FDA500(SYSTEM_PROCESS_INFORMATION *pSystemProcessInfo); // idb
int __stdcall pfnAclChangeCallback(HWND Owner, HANDLE Instance, PVOID CallbackContext, PSECURITY_DESCRIPTOR NewSD, PSECURITY_DESCRIPTOR NewObjectSD, BOOLEAN ApplyToSubContainers, BOOLEAN ApplyToSubObjects, PDWORD ChangeContextStatus);
HBRUSH __stdcall DlgDllInfo(HWND hWnd, UINT msg, WPARAM uID, DLLINFOLISTITEMPARAM *pListItem); // idb
BOOL __stdcall ProcPropSheet(HWND hDlg, UINT uMsg, WPARAM wParam, PROPITEM *PropItem); // idb
signed int CDriver::Load();
HCURSOR __cdecl sub_FDB490(HWND hWnd, int a2);
_BYTE *__thiscall sub_FDB8D0(_DWORD *this);
void __cdecl QueryProcessCommandLineArgs(HANDLE hProcess, LPCVOID lpBaseAddress, WCHAR **ppCommandBuffer, WCHAR **ppszCurrentDirectory, WCHAR **ppszEnvBlock); // idb
int __stdcall FindDlg_SortCallback(int, int, int); // weak
HANDLE __stdcall FindExecutableImageExW_1(PCWSTR FileName, PCWSTR SymbolPath, PWSTR ImageFilePath, PFIND_EXE_FILE_CALLBACKW Callback, PVOID CallerData);
int __stdcall sub_FDBC50(LPCWSTR, LPCWSTR, int); // idb
// int __userpurge FindDlg_SearchThreadProc@<eax>(signed int a1@<ebx>, _BYTE *wParam);
HWND __cdecl sub_FDBDA0(HWND hWndParent);
int *__thiscall sub_FDBDF0(int *this, int a2);
HLOCAL __cdecl sub_FDBE70(wchar_t *Dst, size_t SizeInWords);
int __cdecl sub_FDBEC0(int, int, wchar_t *Dst, size_t SizeInWords); // idb
unsigned int __cdecl Fake_GetProcessMitigationPolicy(tagTREEVIEWLISTITEMPARAM *pItem, HANDLE ProcessHandle);
int __stdcall BackendQueryObjectThreadProc(void *a1);
int __stdcall sub_FDC090(DWORD nLengthNeeded); // idb
LPVOID __cdecl sub_FDC190(LPCVOID pBlock, int a2, unsigned __int16 a3, int a4);
__int16 *__cdecl sub_FDC270(int a1, rsize_t SizeInWords);
void __cdecl PE_GetFullPathName(LPCWSTR *ppszShortPath); // idb
int __stdcall QueryProcessDebugInforThreadProc(_DWORD *a1);
char __cdecl sub_FDC400(int *a1, _DWORD *a2);
char __cdecl sub_FDC4F0(LPVOID lpInBuffer, int a2, int a3, int a4);
void __cdecl sub_FDC750(wchar_t *a1, int a2, wchar_t *Dst, rsize_t SizeInWords, _DWORD *a5);
int __cdecl sub_FDCE20(DWORD BytesReturned, LPVOID lpOutBuffer); // idb
char __cdecl sub_FDCF30(HANDLE hProcess, WCHAR **ppszFileName);
HICON __cdecl ExtractApplicationIcon(LPCWSTR pszPath, int uFlags); // idb
char __cdecl sub_FDD0C0(HANDLE hProcess, tagTREEVIEWLISTITEMPARAM *pItem);
int __cdecl VerifyImage(tagTREEVIEWLISTITEMPARAM *pItem, char a2); // idb
SYSTEM_HANDLE_INFORMATION *__cdecl sub_FDD9D0(SYSTEM_HANDLE_INFORMATION *a1);
SYSTEM_HANDLE_TABLE_ENTRY_INFO **__cdecl GetHandleTableEntry(SYSTEM_HANDLE_INFORMATION *pHandleInfo, int nIndex, SYSTEM_HANDLE_TABLE_ENTRY_INFO **pEntry);
struct _FILETIME __cdecl GetSystemProcessInfo(SYSTEM_PROCESS_INFORMATION **ppSystemProcessInfo, PULONG cbRet); // idb
FILETIME __cdecl RequerySystemStatus(SYSTEM_PROCESS_INFORMATION **ppSystemProcessInfo, PULONG cbRet, SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION *pSystemProcessorPerformanceInfo, SYSTEM_INTERRUPT_INFORMATION *pSystemInterruptInfo, SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *pSystemProcessorCycleTimeInfo, CSystemProcessInfoMap *pMap, int dwBufLen);
void QueryServiceNames();
void __cdecl sub_FDDD60(char a1, unsigned int a2, int a3, unsigned int a4, int a5, int a6, int a7, unsigned int *a8);
int __cdecl sub_FDE420(HANDLE hObject); // idb
int __cdecl sub_FDE4B0(CSystemProcessInfoMap *theMap, SYSTEM_PROCESS_INFORMATION *pSystemProcessInfo, SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *pProcessorIdleCycleTimeInfo, unsigned int dwProcessorIdleCycleTimeInfoLen); // idb
signed int sub_FDE920();
LPVOID __cdecl sub_FDEAA0(LPCVOID pBlock, int a2);
DWORD __cdecl sub_FDEB20(void *a1, PVOID *a2, DWORD *a3, _DWORD *a4, _DWORD *a5, _DWORD *a6, DWORD *a7);
BOOL __stdcall DlgSystemInfoGPUNodes(HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam);
signed int __cdecl sub_FDF3E0(int ThreadId, int a2, int a3);
char __cdecl sub_FDF460(_DWORD *a1);
int __cdecl sub_FDF4D0(int, SECURITY_INFORMATION SecurityInformation, PSECURITY_DESCRIPTOR SecurityDescriptor, PSECURITY_DESCRIPTOR pSecurityDescriptor, int); // idb
int __stdcall Fake_GetProcessDEPPolicy(HANDLE hProcess, LPDWORD lpFlags, PBOOL lpPermanent);
int __stdcall sub_FDF5C0(int a1, int a2, int a3, int a4);
char __cdecl sub_FDF600(_DWORD *a1, int a2, int a3, int a4);
int __thiscall sub_FDF660(int *this, HMODULE hModule, int a3);
char LoadSystemApis();
char InitTlhlpApis();
void __cdecl QueryProcessArguments(HANDLE hProcess, ULONG_PTR dwProcessId, WCHAR **ppszCommandLine, WCHAR **ppszCurrentDirectory, WCHAR **ppszEnvBlock, PDWORD pbFlagsInExtendedProcessBasicInfo);
char __cdecl QueryProcessImageBase(HANDLE hProcess, DWORD dwPid, LPCWSTR lpszProcessName, LPVOID *ppBufer, PDWORD pdwSize);
DWORD __cdecl LoadSystemModulesSymbolAddress(LPCWSTR lpszName); // idb
char __cdecl sub_FE0A90(HANDLE hProcess, DWORD dwProcessId, LPWSTR *ppszFileName, tagTREEVIEWLISTITEMPARAM *pItem);
int __cdecl sub_FE0D70(wchar_t *); // idb
void __cdecl sub_FE0DD0(wchar_t *a1);
int __cdecl sub_FE0EE0(wchar_t *pszBuffer); // idb
char __cdecl ReportMsg(int ArgList);
// signed int __userpurge PropHandleInfo@<eax>(char a1@<bl>, HWND hWnd, unsigned int a2, unsigned __int16 a3, int a4);
int __stdcall PropSecurity(HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam);
int __cdecl PE_DuplicateProcessHandle(DWORD dwProcessId, HANDLE hSourceHandle, DWORD dwDesiredAccess); // idb
int *__thiscall sub_FE2330(int *this, int a2);
int __stdcall PageProcCPU(HWND hWnd, int, WPARAM wParam, LONG dwNewLong); // idb
int __stdcall PageProcEnv(HWND hWnd, int, WPARAM wParam, int); // idb
HBRUSH __stdcall PageProcInfo(HWND hWnd, UINT a2, WPARAM a3, TreeViewParamInfo *dwNewLong); // idb
int __stdcall PageProcJob(HWND hWnd, int, WPARAM wParam, LONG dwNewLong); // idb
int __stdcall PageProcGPU(HWND hWnd, int, WPARAM wParam, LONG dwNewLong); // idb
signed int __stdcall PageProcPerf(HWND hWnd, unsigned int a2, HDC hdc, int a4);
int __stdcall PageProcPerfETW(HWND hWnd, int, HDC hdc, int); // idb
BOOL __stdcall ProcPropSheet(HWND hDlg, UINT uMsg, WPARAM wParam, PROPITEM *PropItem); // idb
void __cdecl __noreturn CTreeList::BackendFillTreeViewParamThreadProc(tagTREEVIEWLISTITEMPARAM *pItem); // idb
int __stdcall sub_FE7440(volatile LONG *lpAddend); // idb
int __stdcall PageProcSecurity(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
int __stdcall PageProcServices(HWND hDlg, int, WPARAM, int); // idb
// int __userpurge PageProcTcpUdp@<eax>(signed int a1@<ebx>, HWND hWnd, int a3, WPARAM wParam, int a5);
int __stdcall PageProcThreads(HWND hWnd, int uMsg, WPARAM wParam, int a4); // idb
int __stdcall UpdateProcThreadsInfoThreadProc(tagThreadItem *pThreadItem); // idb
int __stdcall sub_FED400(int); // weak
BOOL __stdcall PageProcWMIProviders(HWND hDlg, int a2, WPARAM wParam, int a4);
char __cdecl PE_IsProcessInJob(HANDLE ProcessHandle, DWORD dwProcessId, DWORD *dwValue3, DWORD dwValue4);
HANDLE __cdecl PE_OpenProcess(DWORD dwDesiredAccess, int a2, DWORD dwProcessId);
BOOL __cdecl sub_FEDC50(HWND hWnd_1, tagTREEVIEWLISTITEMPARAM *pItem); // idb
int __thiscall sub_FEDE20(int *this, int a2);
_DWORD *__cdecl sub_FEDE60(DWORD dwProcessId);
int __cdecl TreeViewListItemParam_GetSystemInfo(SYSTEM_PROCESS_INFORMATION *pSystemProcessInfo, HANDLE ProcessHandleIn, int a3, int a4, int a5, int a6, tagTREEVIEWLISTITEMPARAM *pItemParam, WPARAM wParam);
int __thiscall TreeList_Item1::Reset(TreeList_Item1 *this); // idb
// char __usercall sub_FEF870@<al>(int a1@<ebx>, int a2, int a3, int a4, DWORD dwProcessId, int a6, int a7, int a8);
BOOL __stdcall DlgServiceControl(HWND, UINT, WPARAM, LPARAM); // idb
BOOL __cdecl sub_FF0400(HWND hDlg, int nIDDlgItem, int ArgList, int a4);
BOOL __cdecl sub_FF0460(HWND hDlg, int nIDDlgItem, int a3, int a4);
BOOL (__stdcall *__thiscall sub_FF04E0(CResizer *this, int a2, int a3))(HWND hWnd, LPRECT lpRect);
BOOL (__stdcall *__thiscall sub_FF0510(CResizer *this, int a2, int a3, int a4))(HWND hWnd, LPRECT lpRect);
BOOL (__stdcall *__thiscall sub_FF0550(CResizer *this, int a2, int a3))(HWND hWnd, LPRECT lpRect);
BOOL __stdcall sub_FF0640(int a1, int a2, DWORD BytesReturned, LPVOID lpOutBuffer, DWORD nOutBufferSize, int a6);
DWORD __cdecl sub_FF06C0(char a1, int a2, int a3);
DWORD64 __stdcall SymLoadModuleExW_0(HANDLE hProcess, HANDLE hFile, PCWSTR ImageName, PCWSTR ModuleName, DWORD64 BaseOfDll, DWORD DllSize, PMODLOAD_DATA Data, DWORD Flags);
int __stdcall sub_FF08E0(int, int, LPCWSTR, LPCWSTR lpWideCharStr, int, int, int); // idb
int __stdcall PropSystemInfoSumETW(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam);
int __stdcall PropSystemInfoGPU(HWND hDlg, UINT msg, WPARAM wParam, LPARAM lParam);
int __stdcall PropSystemInfoIO(HWND hDlg, int, HDC hdc, int); // idb
int __stdcall PropSystemInfoMem(HWND hWnd, int, HDC hdc, int); // idb
int __stdcall PropSummary(HWND hDlg, int, HDC hdc, int); // idb
_DWORD *__cdecl sub_FF39C0(SYSTEM_HANDLE_INFORMATION *pSystemHandleInfo, int a2); // idb
BOOL __stdcall DlgThreadStack(HWND, UINT, WPARAM, LPARAM); // idb
BOOL __stdcall DlgThreadStack(HWND, UINT, WPARAM, LPARAM); // idb
void __noreturn ATL::CSimpleStringT<wchar_t,0>::ThrowMemoryException();
BOOL __stdcall EnumChildrenWindows(HWND hWnd, LPARAM dwPId); // idb
// signed int __usercall sub_FF5140@<eax>(int a1@<ebx>, int a2, _BYTE *a3);
errno_t __cdecl sub_FF5230(wchar_t *Dst, rsize_t SizeInWords, int a3);
int __cdecl sub_FF5250(int *a1);
int __cdecl sub_FF5310(int *a1);
void __cdecl sub_FF53D0(wchar_t *a1, int a2, wchar_t *a3);
_DWORD *sub_FF5440();
_DWORD *__thiscall sub_FF5470(_DWORD *this);
std__Tree_node *__thiscall sub_FF54B0(std__tree *this, std__Tree_node *_Node); // idb
int **__thiscall sub_FF5510(CSystemProcessInfoMap *this, int **a2, CSystemProcessInfoMapNode *a3, int *a4); // idb
_DWORD *__thiscall sub_FF55B0(CSystemProcessInfoMap *this, _DWORD *a2, _DWORD *a3); // idb
_DWORD *__thiscall sub_FF5820(int *this, _DWORD *a2, unsigned int *a3);
HANDLE __cdecl Fake_OpenThread(HANDLE ThreadHandle, ACCESS_MASK DesiredAccess);
// char __usercall sub_FF58D0@<al>(signed int a1@<ebx>, HWND hWnd, LPARAM a3, LPARAM a4, int a5);
BOOL __cdecl CDriver::Control(DWORD dwIoControlCode, LPVOID lpInBuffer, DWORD nInBufferSize, LPVOID lpOutBuffer, DWORD nOutBufferSize);
int __stdcall CGraphWnd::ChartWndProc(HWND hWnd, UINT Msg, WPARAM wParam, int lParam); // idb
char __cdecl sub_FF6020(int a1);
int *__cdecl FillHandleListParam(HWND hWndList, tagHANDLELISTITEMPARAM *pListParam); // idb
HANDLE __cdecl CTreeList::FillTreeViewParam(tagTREEVIEWLISTITEMPARAM *pInfo); // idb
BOOL __cdecl PropertiesThreadProc(HACCEL hAccTable);
HANDLE CDriver::Close();
bool __cdecl GetProcessDEPStatus(); // weak
BOOL __stdcall DlgFind(HWND hDlg, UINT uMsg, WPARAM wParamIn, LPARAM lParamIn); // idb
void __cdecl sub_FF7400(signed __int64 a1, double *a2, double *a3, double *a4);
int __cdecl sub_FF7720(int, wchar_t *Dst, rsize_t SizeInWords); // idb
int __cdecl sub_FF7790(int, wchar_t *Dst, size_t SizeInWords); // idb
void *__cdecl QuerySystemHandleInfo(ULONG ReturnLength);
signed int OnBeforeInit();
LRESULT __cdecl sub_FF7F90(HWND hWnd, int a2, int a3);
char __cdecl sub_FF8030(int ArgList, DWORD dwProcessId);
void __cdecl sub_FF8140(int ArgList, int a2);
int __cdecl SystemProcessInfo_GetSystemProcessName(DWORD dwProcessId, LARGE_INTEGER *FileTime, WCHAR *pszText, DWORD dwSize);
bool __cdecl QueryProcessUsers(HANDLE ProcessHandle, DWORD dwProcessId, int LowTime, wchar_t *pszUserName, DWORD cbUserName, WCHAR *szDomainName, DWORD cbDomainName, LPWSTR pszText, DWORD cbText, BOOL *pbVirtualizationEnabled, BOOL *pbUIAccess);
int GetDriverNameAndLinkInfo();
char __cdecl sub_FF8A20(int a1);
int __cdecl ReportMsg(int ArgList, HWND hWnd);
int __stdcall PageProcStrings(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
// char __usercall CMainWnd::RefreshDllsView@<al>(signed int a1@<ebx>, HWND hWnd, DWORD dwProcessId, WPARAM wParam);
// char __usercall CMainWnd::RefreshHandlesView@<al>(signed int a1@<ebx>, HWND a2, int a3, _BYTE *a4);
// char __usercall CTreeList::InitTreeList@<al>(HWND hWndListCtrl, char flags);
HCURSOR __cdecl sub_FFE3B0(int a1);
HCURSOR __cdecl SaveProcessStrings(HWND hWnd, LPCWSTR lpszFileName);
BOOL __stdcall sub_FFEDC0(HWND, UINT, WPARAM, LPARAM); // idb
int __cdecl sub_FFEF00(HMENU hmenu, int); // idb
int __cdecl sub_FFEFB0(int);
_DWORD *__cdecl sub_FFF0A0(unsigned __int8 a1, int a2, _DWORD *a3);
bool __cdecl LoadDbgHelp(LPCWSTR lpLibFileName);
BOOL __stdcall SysinfoPropSheet(HWND hDlg, UINT uMsg, WPARAM wParamIn, LPARAM lParamIn);
bool __cdecl sub_FFF8F0(double a1, double *a2);
char __cdecl sub_FFF920(int a1, int a2, _DWORD *a3);
void __cdecl VerifyImageThreadProc(tagTREEVIEWLISTITEMPARAM *pItemParam); // idb
int __thiscall ATL::CComCriticalSection::Init(LPCRITICAL_SECTION lpCriticalSection); // idb
int __cdecl sub_FFF9B0(wchar_t *DstBuf, size_t MaxCount, wchar_t *Format, char ArgList); // idb
LRESULT __cdecl CMainWnd::InitStatusBar(HWND hWnd);
int __cdecl sub_FFFA90(int a1, int a2);
void __cdecl sub_FFFCA0(CGraphData *pGraphData, __int64 a2);
char __cdecl sub_FFFD50(CGraphData *pGraphData, double a2, int a3, double a4);
CGraphData *__cdecl sub_1000010(CGraphData *a1, int a2, __int64 a3, __int64 a4, __int64 a5);
CGraphData *__cdecl sub_1000130(CGraphData *a1, int a2, __int64 a3, __int64 a4, __int64 a5);
CGraphData *__cdecl sub_1000250(CGraphData *a1, int a2, __int64 a3, __int64 a4, __int64 a5);
void __cdecl sub_1000360(CGraphData *pGraphData, __int64 a2);
// double *__usercall sub_1000410@<eax>(double a1@<st0>, double st6_0@<st1>, HWND a2, int a3, double *a4, double *a5);
HWND __cdecl InitToolbar(HWND hWnd, unsigned int nIDToolbar);
LPARAM GetButtonSize();
_DWORD *__stdcall std::_List_buy<tagEventItem *,std::allocator<tagEventItem *>>::_Buynode<tagEventItem * const &>(EventList *a1, _DWORD *a2, _DWORD *a3); // idb
CSystemProcessInfoMapNode **__thiscall sub_1001440(CSystemProcessInfoMap *this, CSystemProcessInfoMapNode **a2, char a3, CSystemProcessInfoMapNode *a4, int *a5, int a6);
int __thiscall sub_1001650(CSystemProcessInfoMap *this, int a2, CSystemProcessInfoMapNode *a3, int *a4, int a5);
char SubmitExeToVirusTotalDotCom();
char __cdecl sub_1001820(ListItemData1 *a1); // idb
BOOL __cdecl sub_1001840(LPCWSTR lpFileName, wchar_t *Dest, int a3);
int __cdecl sub_1001A50(int pHash, wchar_t *Dest); // idb
void StartVirusTotalCheck();
char __cdecl sub_1001C10(ListItemData1 *a1); // idb
void __cdecl sub_1001C30(DLLLISTITEMPARAM *pItemParam, char a2, int a3); // idb
int __stdcall BackendThreadProc2(void *a1);
int __stdcall BackendThreadProc1(int a1);
LRESULT __stdcall EditVTClassCallback(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam, UINT_PTR uIdSubclass, DWORD_PTR dwRefData); // idb
char __cdecl sub_1002910(ListItemData1 *a1); // idb
int __stdcall BackendThreadProc3(void *a1);
_DWORD *__stdcall std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(_DWORD *a1, _DWORD *a2);
void __stdcall sub_1002AB0(void *a1);
_bstr_t *__thiscall sub_1002B40(void *this, _bstr_t *a2);
std__Tree_node *__thiscall sub_1002BB0(std__tree *this, std__Tree_node *a2);
int **__thiscall sub_1002C10(int **this, int **a2, int **a3, int **a4);
_DWORD *__thiscall sub_1002CD0(_DWORD *this, _DWORD *a2, _DWORD *a3);
int *__thiscall sub_1002F90(int *this, int *a2, volatile LONG **a3);
HANDLE LoadSharedMemory();
signed int sub_1003150();
int __stdcall wWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPWSTR lpCmdLine, int nShowCmd);
wchar_t *__cdecl sub_10036C0(wchar_t *Src);
int __cdecl sub_1003720(int, int, wchar_t *, int, int); // idb
int __cdecl sub_10037B0(int *a1, int a2, int a3, _DWORD *a4);
int __cdecl sub_10038A0(wchar_t *, int, int, int, int); // idb
MACRO_HRESULT __cdecl sub_10039A0(int *a1);
int __cdecl sub_1003A00(int ArgList, int a2);
signed int __cdecl sub_1003CB0(int a1, int a2, void **a3);
// DWORD __stdcall WNetGetConnectionW(LPCWSTR lpLocalName, LPWSTR lpRemoteName, LPDWORD lpnLength);
// BOOL __stdcall SetWindowSubclass(HWND hWnd, SUBCLASSPROC pfnSubclass, UINT_PTR uIdSubclass, DWORD_PTR dwRefData);
// LRESULT __stdcall DefSubclassProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam);
// DWORD __stdcall GetFileVersionInfoSizeW(LPCWSTR lptstrFilename, LPDWORD lpdwHandle);
// BOOL __stdcall GetFileVersionInfoW(LPCWSTR lptstrFilename, DWORD dwHandle, DWORD dwLen, LPVOID lpData);
// BOOL __stdcall VerQueryValueW(LPCVOID pBlock, LPCWSTR lpSubBlock, LPVOID *lplpBuffer, PUINT puLen);
// HANDLE __stdcall CreateToolhelp32Snapshot(DWORD dwFlags, DWORD th32ProcessID);
// BOOL __stdcall Process32FirstW(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// BOOL __stdcall Process32NextW(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
// BOOL __stdcall Module32FirstW(HANDLE hSnapshot, LPMODULEENTRY32W lpme);
// BOOL __stdcall Module32NextW(HANDLE hSnapshot, LPMODULEENTRY32W lpme);
// BOOL __stdcall Thread32First(HANDLE hSnapshot, LPTHREADENTRY32 lpte);
// BOOL __stdcall Thread32Next(HANDLE hSnapshot, LPTHREADENTRY32 lpte);
// NTSTATUS __stdcall LsaFreeMemory(PVOID Buffer);
// NTSTATUS __stdcall LsaClose(LSA_HANDLE ObjectHandle);
// NTSTATUS __stdcall LsaOpenPolicy(PLSA_UNICODE_STRING SystemName, PLSA_OBJECT_ATTRIBUTES ObjectAttributes, ACCESS_MASK DesiredAccess, PLSA_HANDLE PolicyHandle);
// NTSTATUS __stdcall LsaEnumerateAccountRights(LSA_HANDLE PolicyHandle, PSID AccountSid, PLSA_UNICODE_STRING *UserRights, PULONG CountOfRights);
// BOOL __stdcall ConvertSidToStringSidW(PSID Sid, LPWSTR *StringSid);
void __stdcall __noreturn _com_issue_error(int a1);
_DWORD *__thiscall sub_1004190(_DWORD *this, int a2);
HLOCAL __thiscall ATL::_com_error::~_com_error(ATL::_com_error *this);
HLOCAL *__thiscall ATL::_com_error::`scalar deleting destructor'(void *this, char a2);
void __cdecl __noreturn sub_1004240(int, int);
CHAR *__stdcall sub_1004270(LPCWSTR lpWideCharStr);
BSTR __stdcall _com_util::ConvertBSTRToString(LPCSTR lpszText); // idb
std::exception *__thiscall sub_1004501(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_100451C(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_1004537(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_1004552(std::exception *this, struct exception *a2);
void __thiscall sub_100456D(std::exception *this);
void *__thiscall sub_1004585(void *this, char a2);
void *__thiscall sub_10045AA(void *this, char a2);
// void __noreturn std::_Xbad_alloc();
// void __cdecl __noreturn std::_Xlength_error(const char *); idb
// void __cdecl __noreturn std::_Xout_of_range(const char *); idb
// void *__cdecl operator new[](unsigned int); idb
int __cdecl sub_100465F(int a1);
int __cdecl sub_1004689(int a1);
// _DWORD __thiscall std::_Init_locks::_Init_locks(std::_Init_locks *__hidden this); idb
// _DWORD __thiscall std::_Lockit::_Lockit(std::_Lockit *this, int); idb
// _DWORD __thiscall std::_Lockit::~_Lockit(std::_Lockit *__hidden this); idb
bool __cdecl __uncaught_exception(); // idb
// _Ctypevec *__cdecl _Getctype(_Ctypevec *__return_ptr __struct_ptr retstr);
// _Cvtvec __cdecl _Getcvt();
// int __cdecl _Wcrtomb(char *, wchar_t, mbstate_t *, const _Cvtvec *);
// int __cdecl _Mbrtowc(wchar_t *, const char *, size_t, mbstate_t *, const _Cvtvec *);
// int __cdecl _Getwctype(WCHAR SrcStr); idb
// int __cdecl _Towlower(wchar_t Src, int); idb
// int __cdecl _Towupper(wchar_t Src, int); idb
// _DWORD __thiscall std::_Fac_tidy_reg_t::~_Fac_tidy_reg_t(std::_Fac_tidy_reg_t *__hidden this); idb
// void __cdecl std::_Facet_Register(struct std::_Facet_base *); idb
int sub_1004C4A();
// struct std::locale::_Locimp *__cdecl std::locale::_Init(bool); idb
// void __cdecl std::_Locinfo::_Locinfo_ctor(struct std::_Locinfo *, const char *); idb
// void __cdecl std::_Locinfo::_Locinfo_dtor(struct std::_Locinfo *); idb
// void __cdecl std::ios_base::_Addstd(struct std::ios_base *); idb
// void __cdecl std::ios_base::_Ios_base_dtor(struct std::ios_base *); idb
// int __cdecl _Mtxdst(LPCRITICAL_SECTION lpCriticalSection); idb
void __cdecl sub_1004F3E(LPCRITICAL_SECTION lpCriticalSection);
void __cdecl sub_1004F4C(LPCRITICAL_SECTION lpCriticalSection);
// _DWORD __thiscall _Init_atexit::~_Init_atexit(_Init_atexit *__hidden this); idb
// char *__cdecl wmemset(char *a1, unsigned __int16 a2, unsigned int a3);
CAtlBaseModule *__thiscall ATL::CAtlWinModule::CAtlWinModule(char *this);
_DWORD *__thiscall ATL::_ATL_WIN_MODULE70::_ATL_WIN_MODULE70(_DWORD *this);
void __thiscall ATL::CAtlBaseModule::~CAtlBaseModule(int this);
int __thiscall ATL::CSimpleArray<HINSTANCE__ *,ATL::CSimpleArrayEqualHelper<HINSTANCE__ *>>::operator[](_DWORD *this, int a2);
CHAR *__thiscall ATL::CAtlBaseModule::GetHInstanceAt(CAtlBaseModule *this, int a2); // idb
void __cdecl j__free(void *);
// void *__cdecl memmove(void *, const void *, size_t);
// wchar_t *__cdecl _wcsdup(const wchar_t *);
// void __cdecl free(void *);
// void *__cdecl malloc(size_t);
// void *__cdecl realloc(void *, size_t);
// void __cdecl __security_check_cookie(char a1);
// enum _EXCEPTION_DISPOSITION __cdecl CatchGuardHandler(struct EHExceptionRecord *, struct CatchGuardRN *, void *, void *); idb
// void *__cdecl _CallCatchBlock2(struct EHRegistrationNode *, const struct _s_FuncInfo *, void *, int, unsigned int); idb
// _DWORD __cdecl __CxxFrameHandler3(PEXCEPTION_RECORD ExceptionRecord, struct EHRegistrationNode *, struct _CONTEXT *, void *); weak
// void *__cdecl memmove_0(void *, const void *, size_t);
// void *__cdecl memset(void *, int, size_t);
// void __stdcall `eh vector constructor iterator'(void *, unsigned int, int, void (__thiscall *)(void *), void (__thiscall *)(void *)); idb
// void __stdcall `eh vector destructor iterator'(void *, unsigned int, int, void (__thiscall *)(void *)); idb
// void __stdcall __ArrayUnwind(void *, unsigned int, int, void (__thiscall *)(void *)); idb
// void *__cdecl operator new(size_t); idb
// int __cdecl atexit(void (__cdecl *)());
// void __cdecl __noreturn __report_gsfailure(char); weak
// int __report_rangecheckfailure(void); weak
// int __cdecl isalpha(int);
// int __cdecl isspace(int);
// int __cdecl toupper(int);
// int __cdecl iswalpha(wint_t);
// int __cdecl iswspace(wint_t);
// errno_t __cdecl memcpy_s(void *Dst, rsize_t DstSize, const void *Src, rsize_t MaxCount);
// wchar_t *__cdecl wcschr(const wchar_t *, wchar_t);
// errno_t __cdecl wcscpy_s(wchar_t *Dst, rsize_t SizeInWords, const wchar_t *Src);
// int __cdecl wcsncmp(const wchar_t *, const wchar_t *, size_t);
// errno_t __cdecl wcsncpy_s(wchar_t *Dst, rsize_t SizeInWords, const wchar_t *Src, rsize_t MaxCount);
// wchar_t *__cdecl wcsrchr(const wchar_t *, wchar_t);
// wchar_t *__cdecl wcsstr(const wchar_t *, const wchar_t *);
// int __cdecl _wcsicmp(const wchar_t *, const wchar_t *);
// int __cdecl _wcsnicmp(const wchar_t *, const wchar_t *, size_t);
// wchar_t *__cdecl _wcslwr(wchar_t *);
// errno_t __cdecl _wcslwr_s(wchar_t *Str, size_t SizeInWords);
// wchar_t *__cdecl _wcsupr(wchar_t *);
// errno_t __cdecl _wcsupr_s(wchar_t *Str, size_t Size);
void **sub_1007B15();
// int __cdecl fputws(const wchar_t *, FILE *);
// int fwprintf(FILE *, const wchar_t *, ...);
// int wprintf(const wchar_t *, ...);
// int wprintf_s(const wchar_t *Format, ...);
// int _snwprintf_s(wchar_t *DstBuf, size_t SizeInWords, size_t MaxCount, const wchar_t *Format, ...);
// int _swprintf(wchar_t *Dest, const wchar_t *Format, ...);
// int swprintf_s(wchar_t *Dst, size_t SizeInWords, const wchar_t *Format, ...);
// int __cdecl scan_fn(wchar_t *, int, int); idb
// int __cdecl vscan_fn(int, wchar_t *, int, int, int); idb
// wint_t __cdecl _fputwc_nolock(wchar_t Ch, FILE *File);
void __cdecl j_j__free(void *);
// int __cdecl _ismbcprint(unsigned int);
// int __cdecl _ismbcprint_l(int, struct localeinfo_struct *); idb
// void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD); weak
// void *__usercall _alloca_probe@<eax>(unsigned int a1@<eax>, int a2@<ecx>);
// void *__cdecl calloc(size_t, size_t);
// int __cdecl _wtoi(const wchar_t *);
// size_t __cdecl wcscspn(const wchar_t *, const wchar_t *);
// int __cdecl _beginthreadex(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, int, int, DWORD dwCreationFlags, LPDWORD lpThreadId); idb
// wchar_t *__cdecl fgetws(wchar_t *, int, FILE *);
// FILE *__cdecl _wfopen(const wchar_t *, const wchar_t *);
// errno_t __cdecl _wfopen_s(FILE **File, const wchar_t *Filename, const wchar_t *Mode);
// int __cdecl fclose(FILE *);
int __thiscall sub_10089CE(_DWORD *this);
void *__thiscall sub_10089FA(void *this, char a2);
// int __cdecl _vsnwprintf_s(wchar_t *DstBuf, size_t SizeInWords, size_t MaxCount, const wchar_t *Format, va_list ArgList);
// int __cdecl vswprintf_s(wchar_t *Dst, size_t SizeInWords, const wchar_t *Format, va_list ArgList);
// int __cdecl _stricmp(const char *, const char *);
// char *__cdecl strrchr(const char *, int);
// errno_t __cdecl wcscat_s(wchar_t *Dst, rsize_t SizeInWords, const wchar_t *Src);
// wchar_t *__cdecl _getws_s(wchar_t *Str, size_t SizeInWords);
int sub_100918B();
// int __cdecl fflush(FILE *);
// _DWORD __cdecl flsall(_DWORD); weak
// int __fastcall _ftol3_except(_DWORD, _DWORD); weak
// void _dtoui3();
// int __usercall _dtol3@<eax>(__m128d a1@<xmm0>);
// void __cdecl __noreturn exit(int);
// int printf(const char *, ...);
// int __cdecl _getch();
// wchar_t *__cdecl wcsncpy(wchar_t *, const wchar_t *, size_t);
std::exception *__thiscall sub_1009CF7(std::exception *this, struct exception *a2);
std::exception *__thiscall sub_1009D12(std::exception *this, char *a2);
// _DWORD __thiscall std::exception::exception(std::exception *this, const char *const *); idb
// _DWORD __thiscall std::exception::exception(std::exception *this, const char *const *, int); idb
// _DWORD __thiscall std::exception::exception(std::exception *this, const struct exception *); idb
void __thiscall sub_1009D91(std::exception *this);
void *__thiscall sub_1009DCF(void *this, char a2);
// void __thiscall std::exception::_Tidy(std::exception *__hidden this); idb
// errno_t __cdecl memmove_s(void *Dst, rsize_t DstSize, const void *Src, rsize_t MaxCount);
// int __cdecl wmemcpy_s(void *, int, void *, int); idb
// HANDLE __cdecl _beginthread(int a1, SIZE_T dwStackSize, int a3);
// int _endthread(void); weak
// DWORD __stdcall _threadstart(LPVOID lpThreadParameter); idb
// size_t __cdecl wcsnlen(const wchar_t *Src, size_t MaxCount);
// size_t __cdecl fwrite(const void *, size_t, size_t, FILE *);
// void __cdecl qsort(void *, size_t, size_t, int (__cdecl *)(const void *, const void *));
// errno_t __cdecl strcpy_s(char *Dst, rsize_t SizeInBytes, const char *Src);
// errno_t __cdecl _strlwr_s(char *Str, size_t Size);
// int __cdecl vsprintf_s(char *DstBuf, size_t SizeInBytes, const char *Format, va_list ArgList);
// errno_t __cdecl _wsplitpath_s(const wchar_t *FullPath, wchar_t *Drive, size_t DriveSize, wchar_t *Dir, size_t DirSize, wchar_t *Filename, size_t FilenameSize, wchar_t *Ext, size_t ExtSize);
// wchar_t *__cdecl wcstok_s(wchar_t *Str, const wchar_t *Delim, wchar_t **Context);
// wchar_t *__cdecl _wctime32(const __time32_t *Time);
// _DWORD __cdecl _dosmaperr(_DWORD); weak
// int *__cdecl _errno();
// errno_t __cdecl _get_errno(int *Value);
// _DWORD __cdecl _get_errno_from_oserr(_DWORD); weak
// errno_t __cdecl _set_errno(int Value);
// unsigned int __cdecl wcstoul(const wchar_t *, wchar_t **, int);
std::exception *__thiscall sub_100B822(std::exception *this, struct exception *a2);
void __thiscall sub_100B83D(std::exception *this);
void *__thiscall sub_100B848(void *this, char a2);
// _DWORD __cdecl _calloc_crt(_DWORD, _DWORD); weak
// int __crtIsPackagedApp(void); weak
// int __cdecl __crtSetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter); idb
void __cdecl sub_100D342(DWORD dwMilliseconds);
// size_t __cdecl wcslen(const wchar_t *);
void *__cdecl sub_100F821(void *a1);
// int _invalid_parameter_noinfo(void); weak
// int __cdecl _invoke_watson(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
void *__cdecl sub_100F8CF(void *a1);
DWORD sub_100FAF6();
// int _getptd(void); weak
// _DWORD __cdecl _initptd(_DWORD, _DWORD); weak
// _DWORD __stdcall _CallSettingFrame(_DWORD, _DWORD, _DWORD); weak
void sub_101007A();
// int __cdecl _winput_l(int, int, struct localeinfo_struct *, int); idb
void *__cdecl sub_101533B(void *a1);
// _DWORD __cdecl unknown_libname_8(_DWORD); weak
void sub_1017C9C();
void __cdecl sub_1017CBC(); // idb
PVOID sub_1017CDC();
int __cdecl sub_1017EFA(int a1);
HANDLE sub_1018B73();
// int __stdcall __CxxUnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo); idb
int sub_1019F90();
int __cdecl sub_101A2BD(int a1);
// const WCHAR **_wwincmdln();
int *sub_101B1A0();
int *sub_101B1A6();
int *sub_101B1AC();
void **sub_101B1B2();
signed int __cdecl sub_101B1B8(_DWORD *a1);
signed int __cdecl sub_101B1E2(_DWORD *a1);
signed int __cdecl sub_101B20C(_DWORD *a1);
int __cdecl sub_101B5FC(const WCHAR *a1, int a2, int a3);
int sub_101F550();
signed int __cdecl sub_101FE30(unsigned __int16 *a1, int *a2);
signed int __cdecl sub_10203A2(unsigned __int16 *a1, int *a2);
signed int __cdecl sub_1021B17(_DWORD *a1);
HANDLE sub_1021C0E();
// DWORD __stdcall GetModuleFileNameExW(HANDLE hProcess, HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
int __cdecl SEH_402480(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_402D60(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_403440(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4035A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4038F0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4314F0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_403D40(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_404130(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_404890(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_404AC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_404F20(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_404FB0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4052B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_405520(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_405C70(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_406440(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_406090(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4067A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_406CC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_406DD0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4070E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_407CC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4085A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4087A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_409270(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_409B70(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425730(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40AB10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40B220(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40F2D0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40F610(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40F9D0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40FD00(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_40FDF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_410460(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_410790(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_411150(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_411610(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_412090(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_413160(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_413A80(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_414200(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_414FF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_415FF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_416A10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_416E10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_417000(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4177C0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_417FE0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_418050(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_418A90(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_418C20(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4193C0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_419580(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41A120(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41AD20(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45ED60(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41B1A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41D790(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41E3A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41EFE0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41F0E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_41F260(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_420760(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_420EA0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4211B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4013A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_421590(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_421860(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_422060(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_422110(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4227D0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_423190(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_424040(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_424270(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4244A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4245C0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_424740(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_424920(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_424FE0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425120(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425350(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425440(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425850(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425940(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425AB0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_425D10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_426830(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4269A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_426BB0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_427AC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45E760(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_428730(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_428970(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_429580(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_42A1F0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_42FAF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_431240(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_431560(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4318A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_431BC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_431FC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4337E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_434530(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_434810(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_434AA0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_434F00(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4355A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_437DF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_438150(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_438360(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_438570(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_438630(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_438CE0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_439090(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4391F0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4392D0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_439D10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_439E70(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43B100(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43B460(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43B780(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43BF00(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43D080(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43D1D0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43D3B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43D590(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43D670(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43DF10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43E1A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43EAD0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43EBA0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43EEA0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43F0A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_43FFF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_469E00(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_445F60(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_446270(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_451E50(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4526B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_457640(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_457740(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4577E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_457DD0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4580C0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_458AE0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_458C80(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_458D10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_458E20(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_459500(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_459C50(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45A570(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45B0A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45B680(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45B8A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45C840(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45EE00(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45D510(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45DCE0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45E4E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_45E8B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_466900(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_469AF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_469C10(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_469EA0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46A670(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46ADD0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46B930(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46BC50(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46C350(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46DAF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46DD60(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_46EC30(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4703E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4723A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_472810(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_472C20(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_473C50(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_474990(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4766A0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_477710(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_478E00(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_479A30(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_47ACF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_47D5B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4808E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4809B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4818B0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_482010(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_4825E0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_483260(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_483AF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_483FC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_491650(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_401FF0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_491C30(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_491EC0(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_492230(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl SEH_494270(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl sub_102A093(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
int __cdecl sub_102A0AE(EXCEPTION_RECORD *a1, struct EHRegistrationNode *a2, struct _CONTEXT *a3, void *a4);
void __cdecl sub_102A0D0(); // idb
void __thiscall sub_102A0F0(void *this);
void __cdecl sub_102A150(); // idb
void __cdecl sub_102A160(); // idb
void __cdecl sub_102A1C0(); // idb
void __cdecl sub_102A220(); // idb
void __cdecl sub_102A230(); // idb
void __cdecl sub_102A240(); // idb
void __cdecl dynamic_atexit_destructor_for__gKeyNameMap__(); // idb
void __cdecl sub_102A2D0(); // idb
void __cdecl sub_102A2E0(); // idb
void __cdecl sub_102A2F0(); // idb
void __cdecl sub_102A300(); // idb
void __cdecl sub_102A310(); // idb
void __cdecl sub_102A320(); // idb
void __cdecl sub_102A3F0(); // idb
void __cdecl sub_102A4C0(); // idb
void __cdecl sub_102A590(); // idb
void __cdecl sub_102A610(); // idb
void __cdecl sub_102A620(); // idb
void __cdecl sub_102A630(); // idb
void __cdecl sub_102A640(); // idb
void __cdecl sub_102A660(); // idb
void __cdecl sub_102A680(); // idb
void __cdecl sub_102A700(); // idb
void __cdecl sub_102A720(); // idb
void __cdecl sub_102A7F0(); // idb
void __cdecl sub_102A820(); // idb
void __cdecl sub_102A840(); // idb
void __cdecl sub_102A910(); // idb
void __cdecl sub_102A970(); // idb
void __cdecl sub_102A9D0(); // idb
void __cdecl sub_102A9E0(); // idb
void __cdecl sub_102A9F0(); // idb
void __cdecl sub_102AA50(); // idb
void __cdecl sub_102AB20(); // idb
void __cdecl sub_102ABA0(); // idb
void __cdecl sub_102AC00(); // idb
void __cdecl sub_102AC60(); // idb
void __cdecl sub_102ACC0(); // idb
void __cdecl sub_102AD40(); // idb
void __cdecl sub_102ADC0(); // idb
void __cdecl HttpInfo_Release(); // idb
void __cdecl sub_102AE00(); // idb
void __cdecl sub_102AED0(); // idb
void __cdecl sub_102AFA0(); // idb
void __cdecl sub_102B070(); // idb
void __cdecl sub_102B0F0(); // idb
void __cdecl sub_102B0FC(); // idb
void __cdecl sub_102B106(); // idb
void __cdecl sub_102B110(); // idb
void __cdecl sub_102B11A(); // idb
void __cdecl sub_102B124(); // idb
void __cdecl ATL::_dynamic_atexit_destructor_for___AtlBaseModule__(); // idb
// LSTATUS __stdcall RegOpenKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LSTATUS __stdcall RegOpenKeyExA(HKEY hKey, LPCSTR lpSubKey, DWORD ulOptions, REGSAM samDesired, PHKEY phkResult);
// LSTATUS __stdcall RegQueryValueExA(HKEY hKey, LPCSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// BOOL __stdcall LookupPrivilegeNameW(LPCWSTR lpSystemName, PLUID lpLuid, LPWSTR lpName, LPDWORD cchName);
// BOOL __stdcall SetKernelObjectSecurity(HANDLE Handle, SECURITY_INFORMATION SecurityInformation, PSECURITY_DESCRIPTOR SecurityDescriptor);
// BOOL __stdcall IsValidSecurityDescriptor(PSECURITY_DESCRIPTOR pSecurityDescriptor);
// BOOL __stdcall GetKernelObjectSecurity(HANDLE Handle, SECURITY_INFORMATION RequestedInformation, PSECURITY_DESCRIPTOR pSecurityDescriptor, DWORD nLength, LPDWORD lpnLengthNeeded);
// BOOL __stdcall CreateProcessAsUserW(HANDLE hToken, LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// LSTATUS __stdcall RegConnectRegistryW(LPCWSTR lpMachineName, HKEY hKey, PHKEY phkResult);
// ULONG __stdcall FlushTraceW(TRACEHANDLE TraceHandle, LPCWSTR InstanceName, PEVENT_TRACE_PROPERTIES Properties);
// LSTATUS __stdcall RegCloseKey(HKEY hKey);
// DWORD __stdcall SetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE ObjectType, SECURITY_INFORMATION SecurityInfo, PSID psidOwner, PSID psidGroup, PACL pDacl, PACL pSacl);
// DWORD __stdcall GetSecurityInfo(HANDLE handle, SE_OBJECT_TYPE ObjectType, SECURITY_INFORMATION SecurityInfo, PSID *ppsidOwner, PSID *ppsidGroup, PACL *ppDacl, PACL *ppSacl, PSECURITY_DESCRIPTOR *ppSecurityDescriptor);
// BOOL __stdcall AddAccessAllowedAce(PACL pAcl, DWORD dwAceRevision, DWORD AccessMask, PSID pSid);
// BOOL __stdcall GetAce(PACL pAcl, DWORD dwAceIndex, LPVOID *pAce);
// BOOL __stdcall AddAce(PACL pAcl, DWORD dwAceRevision, DWORD dwStartingAceIndex, LPVOID pAceList, DWORD nAceListLength);
// BOOL __stdcall InitializeAcl(PACL pAcl, DWORD nAclLength, DWORD dwAclRevision);
// PUCHAR __stdcall GetSidSubAuthorityCount(PSID pSid);
// PDWORD __stdcall GetSidSubAuthority(PSID pSid, DWORD nSubAuthority);
// PSID_IDENTIFIER_AUTHORITY __stdcall GetSidIdentifierAuthority(PSID pSid);
// BOOL __stdcall IsValidSid(PSID pSid);
// BOOL __stdcall SetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, LPVOID TokenInformation, DWORD TokenInformationLength);
// BOOL __stdcall QueryServiceConfigW(SC_HANDLE hService, LPQUERY_SERVICE_CONFIGW lpServiceConfig, DWORD cbBufSize, LPDWORD pcbBytesNeeded);
// BOOL __stdcall CopySid(DWORD nDestinationSidLength, PSID pDestinationSid, PSID pSourceSid);
// BOOL __stdcall RevertToSelf();
// BOOL __stdcall OpenProcessToken(HANDLE ProcessHandle, DWORD DesiredAccess, PHANDLE TokenHandle);
// BOOL __stdcall GetTokenInformation(HANDLE TokenHandle, TOKEN_INFORMATION_CLASS TokenInformationClass, LPVOID TokenInformation, DWORD TokenInformationLength, PDWORD ReturnLength);
// BOOL __stdcall AdjustTokenPrivileges(HANDLE TokenHandle, BOOL DisableAllPrivileges, PTOKEN_PRIVILEGES NewState, DWORD BufferLength, PTOKEN_PRIVILEGES PreviousState, PDWORD ReturnLength);
// BOOL __stdcall EqualSid(PSID pSid1, PSID pSid2);
// BOOL __stdcall AllocateAndInitializeSid(PSID_IDENTIFIER_AUTHORITY pIdentifierAuthority, BYTE nSubAuthorityCount, DWORD nSubAuthority0, DWORD nSubAuthority1, DWORD nSubAuthority2, DWORD nSubAuthority3, DWORD nSubAuthority4, DWORD nSubAuthority5, DWORD nSubAuthority6, DWORD nSubAuthority7, PSID *pSid);
// DWORD __stdcall GetLengthSid(PSID pSid);
// ULONG __stdcall CloseTrace(TRACEHANDLE TraceHandle);
// ULONG __stdcall ProcessTrace(PTRACEHANDLE HandleArray, ULONG HandleCount, LPFILETIME StartTime, LPFILETIME EndTime);
// TRACEHANDLE __stdcall OpenTraceW(PEVENT_TRACE_LOGFILEW Logfile);
// ULONG __stdcall ControlTraceW(TRACEHANDLE TraceHandle, LPCWSTR InstanceName, PEVENT_TRACE_PROPERTIES Properties, ULONG ControlCode);
// ULONG __stdcall StartTraceW(PTRACEHANDLE TraceHandle, LPCWSTR InstanceName, PEVENT_TRACE_PROPERTIES Properties);
// BOOL __stdcall SetServiceObjectSecurity(SC_HANDLE hService, SECURITY_INFORMATION dwSecurityInformation, PSECURITY_DESCRIPTOR lpSecurityDescriptor);
// BOOL __stdcall QueryServiceObjectSecurity(SC_HANDLE hService, SECURITY_INFORMATION dwSecurityInformation, PSECURITY_DESCRIPTOR lpSecurityDescriptor, DWORD cbBufSize, LPDWORD pcbBytesNeeded);
// void __stdcall MapGenericMask(PDWORD AccessMask, PGENERIC_MAPPING GenericMapping);
// LSTATUS __stdcall RegCreateKeyW(HKEY hKey, LPCWSTR lpSubKey, PHKEY phkResult);
// BOOL __stdcall StartServiceW(SC_HANDLE hService, DWORD dwNumServiceArgs, LPCWSTR *lpServiceArgVectors);
// BOOL __stdcall QueryServiceStatus(SC_HANDLE hService, LPSERVICE_STATUS lpServiceStatus);
// PVOID __stdcall FreeSid(PSID pSid);
// BOOL __stdcall LookupAccountSidW(LPCWSTR lpSystemName, PSID Sid, LPWSTR Name, LPDWORD cchName, LPWSTR ReferencedDomainName, LPDWORD cchReferencedDomainName, PSID_NAME_USE peUse);
// BOOL __stdcall LookupAccountNameW(LPCWSTR lpSystemName, LPCWSTR lpAccountName, PSID Sid, LPDWORD cbSid, LPWSTR ReferencedDomainName, LPDWORD cchReferencedDomainName, PSID_NAME_USE peUse);
// BOOL __stdcall LookupPrivilegeValueW(LPCWSTR lpSystemName, LPCWSTR lpName, PLUID lpLuid);
// BOOL __stdcall ImpersonateLoggedOnUser(HANDLE hToken);
// BOOL __stdcall DuplicateTokenEx(HANDLE hExistingToken, DWORD dwDesiredAccess, LPSECURITY_ATTRIBUTES lpTokenAttributes, SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, TOKEN_TYPE TokenType, PHANDLE phNewToken);
// LSTATUS __stdcall RegCreateKeyExW(HKEY hKey, LPCWSTR lpSubKey, DWORD Reserved, LPWSTR lpClass, DWORD dwOptions, REGSAM samDesired, const LPSECURITY_ATTRIBUTES lpSecurityAttributes, PHKEY phkResult, LPDWORD lpdwDisposition);
// LSTATUS __stdcall RegDeleteKeyW(HKEY hKey, LPCWSTR lpSubKey);
// LSTATUS __stdcall RegEnumKeyW(HKEY hKey, DWORD dwIndex, LPWSTR lpName, DWORD cchName);
// LSTATUS __stdcall RegEnumValueW(HKEY hKey, DWORD dwIndex, LPWSTR lpValueName, LPDWORD lpcchValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// LSTATUS __stdcall RegLoadKeyW(HKEY hKey, LPCWSTR lpSubKey, LPCWSTR lpFile);
// LSTATUS __stdcall RegOpenKeyW(HKEY hKey, LPCWSTR lpSubKey, PHKEY phkResult);
// LSTATUS __stdcall RegQueryInfoKeyW(HKEY hKey, LPWSTR lpClass, LPDWORD lpcchClass, LPDWORD lpReserved, LPDWORD lpcSubKeys, LPDWORD lpcbMaxSubKeyLen, LPDWORD lpcbMaxClassLen, LPDWORD lpcValues, LPDWORD lpcbMaxValueNameLen, LPDWORD lpcbMaxValueLen, LPDWORD lpcbSecurityDescriptor, PFILETIME lpftLastWriteTime);
// LSTATUS __stdcall RegQueryValueExW(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, LPBYTE lpData, LPDWORD lpcbData);
// LSTATUS __stdcall RegSetValueExW(HKEY hKey, LPCWSTR lpValueName, DWORD Reserved, DWORD dwType, const BYTE *lpData, DWORD cbData);
// LSTATUS __stdcall RegUnLoadKeyW(HKEY hKey, LPCWSTR lpSubKey);
// LSTATUS __stdcall RegQueryValueW(HKEY hKey, LPCWSTR lpSubKey, LPWSTR lpData, PLONG lpcbData);
// BOOL __stdcall CryptAcquireContextW(HCRYPTPROV *phProv, LPCWSTR szContainer, LPCWSTR szProvider, DWORD dwProvType, DWORD dwFlags);
// BOOL __stdcall CryptReleaseContext(HCRYPTPROV hProv, DWORD dwFlags);
// BOOL __stdcall CryptGetHashParam(HCRYPTHASH hHash, DWORD dwParam, BYTE *pbData, DWORD *pdwDataLen, DWORD dwFlags);
// BOOL __stdcall CryptCreateHash(HCRYPTPROV hProv, ALG_ID Algid, HCRYPTKEY hKey, DWORD dwFlags, HCRYPTHASH *phHash);
// BOOL __stdcall CryptHashData(HCRYPTHASH hHash, const BYTE *pbData, DWORD dwDataLen, DWORD dwFlags);
// BOOL __stdcall CryptDestroyHash(HCRYPTHASH hHash);
// LSTATUS __stdcall RegDeleteValueW(HKEY hKey, LPCWSTR lpValueName);
// BOOL __stdcall CloseServiceHandle(SC_HANDLE hSCObject);
// SC_HANDLE __stdcall OpenSCManagerW(LPCWSTR lpMachineName, LPCWSTR lpDatabaseName, DWORD dwDesiredAccess);
// SC_HANDLE __stdcall OpenServiceW(SC_HANDLE hSCManager, LPCWSTR lpServiceName, DWORD dwDesiredAccess);
// BOOL __stdcall ControlService(SC_HANDLE hService, DWORD dwControl, LPSERVICE_STATUS lpServiceStatus);
// HIMAGELIST __stdcall ImageList_Create(int cx, int cy, UINT flags, int cInitial, int cGrow);
// HWND __stdcall CreateStatusWindowW(LONG style, LPCWSTR lpszText, HWND hwndParent, UINT wID);
// HPROPSHEETPAGE __stdcall CreatePropertySheetPageW(LPCPROPSHEETPAGEW constPropSheetPagePointer);
// HWND __stdcall CreateToolbarEx(HWND hwnd, DWORD ws, UINT wID, int nBitmaps, HINSTANCE hBMInst, UINT_PTR wBMID, LPCTBBUTTON lpButtons, int iNumButtons, int dxButton, int dyButton, int dxBitmap, int dyBitmap, UINT uStructSize);
// int __stdcall ImageList_ReplaceIcon(HIMAGELIST himl, int i, HICON hicon);
// int __stdcall ImageList_Add(HIMAGELIST himl, HBITMAP hbmImage, HBITMAP hbmMask);
// BOOL __stdcall InitCommonControlsEx(const INITCOMMONCONTROLSEX *picce);
// BOOL __stdcall ImageList_Destroy(HIMAGELIST himl);
// BOOL __stdcall ImageList_DrawEx(HIMAGELIST himl, int i, HDC hdcDst, int x, int y, int dx, int dy, COLORREF rgbBk, COLORREF rgbFg, UINT fStyle);
// void __stdcall InitCommonControls();
// INT_PTR __stdcall PropertySheetW(LPCPROPSHEETHEADERW);
// HWND __stdcall FindTextW(LPFINDREPLACEW);
// BOOL __stdcall ChooseColorW(LPCHOOSECOLORW);
// BOOL __stdcall GetSaveFileNameW(LPOPENFILENAMEW);
// BOOL __stdcall GetOpenFileNameW(LPOPENFILENAMEW);
// BOOL __stdcall PrintDlgW(LPPRINTDLGW pPD);
// BOOL __stdcall ChooseFontW(LPCHOOSEFONTW);
// PCCERT_CONTEXT __stdcall CertDuplicateCertificateContext(PCCERT_CONTEXT pCertContext);
// DWORD __stdcall CertGetNameStringW(PCCERT_CONTEXT pCertContext, DWORD dwType, DWORD dwFlags, void *pvTypePara, LPWSTR pszNameString, DWORD cchNameString);
// int __stdcall StartDocW(HDC hdc, const DOCINFOW *lpdi);
// int __stdcall SetMapMode(HDC hdc, int iMode);
// COLORREF __stdcall SetBkColor(HDC hdc, COLORREF color);
// int __stdcall SetBkMode(HDC hdc, int mode);
// COLORREF __stdcall SetTextColor(HDC hdc, COLORREF color);
// BOOL __stdcall GetTextMetricsW(HDC hdc, LPTEXTMETRICW lptm);
// int __stdcall EndDoc(HDC hdc);
// int __stdcall StartPage(HDC hdc);
// int __stdcall EndPage(HDC hdc);
// HFONT __stdcall CreateFontIndirectW(const LOGFONTW *lplf);
// BOOL __stdcall GetTextExtentPoint32W(HDC hdc, LPCWSTR lpString, int c, LPSIZE psizl);
// UINT __stdcall SetTextAlign(HDC hdc, UINT align);
// BOOL __stdcall Polyline(HDC hdc, const POINT *apt, int cpt);
// BOOL __stdcall MoveToEx(HDC hdc, int x, int y, LPPOINT lppt);
// int __stdcall SetROP2(HDC hdc, int rop2);
// int __stdcall SaveDC(HDC hdc);
// BOOL __stdcall RestoreDC(HDC hdc, int nSavedDC);
// BOOL __stdcall Rectangle(HDC hdc, int left, int top, int right, int bottom);
// BOOL __stdcall LineTo(HDC hdc, int x, int y);
// HBITMAP __stdcall CreateDIBSection(HDC hdc, const BITMAPINFO *lpbmi, UINT usage, void **ppvBits, HANDLE hSection, DWORD offset);
// int __stdcall GetObjectW(HANDLE h, int c, LPVOID pv);
// BOOL __stdcall DeleteObject(HGDIOBJ ho);
// BOOL __stdcall BitBlt(HDC hdc, int x, int y, int cx, int cy, HDC hdcSrc, int x1, int y1, DWORD rop);
// HBITMAP __stdcall CreateCompatibleBitmap(HDC hdc, int cx, int cy);
// HDC __stdcall CreateCompatibleDC(HDC hdc);
// HPEN __stdcall CreatePen(int iStyle, int cWidth, COLORREF color);
// HRGN __stdcall CreateRectRgn(int x1, int y1, int x2, int y2);
// HRGN __stdcall CreateRectRgnIndirect(const RECT *lprect);
// HBRUSH __stdcall CreateSolidBrush(COLORREF color);
// BOOL __stdcall DeleteDC(HDC hdc);
// COLORREF __stdcall GetBkColor(HDC hdc);
// int __stdcall GetBkMode(HDC hdc);
// int __stdcall GetDeviceCaps(HDC hdc, int index);
// HGDIOBJ __stdcall GetStockObject(int i);
// BOOL __stdcall RectInRegion(HRGN hrgn, const RECT *lprect);
// int __stdcall SelectClipRgn(HDC hdc, HRGN hrgn);
// HGDIOBJ __stdcall SelectObject(HDC hdc, HGDIOBJ h);
// BOOL __stdcall ExtTextOutW(HDC hdc, int x, int y, UINT options, const RECT *lprect, LPCWSTR lpString, UINT c, const INT *lpDx);
// DWORD __stdcall GetEnvironmentVariableW(LPCWSTR lpName, LPWSTR lpBuffer, DWORD nSize);
// SIZE_T __stdcall VirtualQueryEx(HANDLE hProcess, LPCVOID lpAddress, PMEMORY_BASIC_INFORMATION lpBuffer, SIZE_T dwLength);
// BOOL __stdcall GetProcessAffinityMask(HANDLE hProcess, PDWORD_PTR lpProcessAffinityMask, PDWORD_PTR lpSystemAffinityMask);
// DWORD __stdcall GetCurrentProcessId();
// DWORD_PTR __stdcall SetThreadAffinityMask(HANDLE hThread, DWORD_PTR dwThreadAffinityMask);
// DWORD __stdcall SetFilePointer(HANDLE hFile, LONG lDistanceToMove, PLONG lpDistanceToMoveHigh, DWORD dwMoveMethod);
// UINT __stdcall GetSystemDirectoryW(LPWSTR lpBuffer, UINT uSize);
// BOOL __stdcall DeleteFileW(LPCWSTR lpFileName);
// DWORD __stdcall SearchPathW(LPCWSTR lpPath, LPCWSTR lpFileName, LPCWSTR lpExtension, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart);
// HANDLE __stdcall OpenThread(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwThreadId);
// BOOL __stdcall GetThreadContext(HANDLE hThread, LPCONTEXT lpContext);
// DWORD __stdcall SuspendThread(HANDLE hThread);
// DWORD __stdcall ResumeThread(HANDLE hThread);
// BOOL __stdcall ResetEvent(HANDLE hEvent);
// BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount);
// BOOL __stdcall QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency);
// int __stdcall lstrcmpiW(LPCWSTR lpString1, LPCWSTR lpString2);
// void __stdcall GlobalMemoryStatus(LPMEMORYSTATUS lpBuffer);
// BOOL __stdcall SetProcessWorkingSetSize(HANDLE hProcess, SIZE_T dwMinimumWorkingSetSize, SIZE_T dwMaximumWorkingSetSize);
// BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT uExitCode);
// DWORD __stdcall GetProcessId(HANDLE Process);
// BOOL __stdcall PulseEvent(HANDLE hEvent);
// BOOL __stdcall SetPriorityClass(HANDLE hProcess, DWORD dwPriorityClass);
// BOOL __stdcall GetComputerNameW(LPWSTR lpBuffer, LPDWORD nSize);
// LPVOID __stdcall VirtualAlloc(LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);
// BOOL __stdcall VirtualFree(LPVOID lpAddress, SIZE_T dwSize, DWORD dwFreeType);
// BOOL __stdcall GetProcessWorkingSetSize(HANDLE hProcess, PSIZE_T lpMinimumWorkingSetSize, PSIZE_T lpMaximumWorkingSetSize);
// BOOL __stdcall DeviceIoControl(HANDLE hDevice, DWORD dwIoControlCode, LPVOID lpInBuffer, DWORD nInBufferSize, LPVOID lpOutBuffer, DWORD nOutBufferSize, LPDWORD lpBytesReturned, LPOVERLAPPED lpOverlapped);
// BOOL __stdcall DuplicateHandle(HANDLE hSourceProcessHandle, HANDLE hSourceHandle, HANDLE hTargetProcessHandle, LPHANDLE lpTargetHandle, DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwOptions);
// UINT __stdcall GetDriveTypeW(LPCWSTR lpRootPathName);
// DWORD __stdcall GetCurrentDirectoryW(DWORD nBufferLength, LPWSTR lpBuffer);
// int __stdcall WideCharToMultiByte(UINT CodePage, DWORD dwFlags, LPCWSTR lpWideCharStr, int cchWideChar, LPSTR lpMultiByteStr, int cbMultiByte, LPCSTR lpDefaultChar, LPBOOL lpUsedDefaultChar);
// PVOID __stdcall DecodePointer(PVOID Ptr);
// void __stdcall RaiseException(DWORD dwExceptionCode, DWORD dwExceptionFlags, DWORD nNumberOfArguments, const ULONG_PTR *lpArguments);
// BOOL __stdcall InitializeCriticalSectionAndSpinCount(LPCRITICAL_SECTION lpCriticalSection, DWORD dwSpinCount);
// void __stdcall GetSystemInfo(LPSYSTEM_INFO lpSystemInfo);
// DWORD __stdcall ExpandEnvironmentStringsA(LPCSTR lpSrc, LPSTR lpDst, DWORD nSize);
// HMODULE __stdcall LoadLibraryA(LPCSTR lpLibFileName);
// BOOL __stdcall IsDebuggerPresent();
// PVOID __stdcall EncodePointer(PVOID Ptr);
// int __stdcall lstrlenA(LPCSTR lpString);
// int __stdcall lstrcmpW(LPCWSTR lpString1, LPCWSTR lpString2);
// BOOL __stdcall ReadProcessMemory(HANDLE hProcess, LPCVOID lpBaseAddress, LPVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesRead);
// HANDLE __stdcall OpenEventW(DWORD dwDesiredAccess, BOOL bInheritHandle, LPCWSTR lpName);
// void __stdcall SetLastError(DWORD dwErrCode);
// BOOL __stdcall IsBadStringPtrW(LPCWSTR lpsz, UINT_PTR ucchMax);
// BOOL __stdcall SystemTimeToFileTime(const SYSTEMTIME *lpSystemTime, LPFILETIME lpFileTime);
// void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime);
// void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime);
// void __stdcall DeleteCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall TerminateThread(HANDLE hThread, DWORD dwExitCode);
// BOOL __stdcall GlobalUnlock(HGLOBAL hMem);
// LPVOID __stdcall GlobalLock(HGLOBAL hMem);
// HGLOBAL __stdcall GlobalReAlloc(HGLOBAL hMem, SIZE_T dwBytes, UINT uFlags);
// HGLOBAL __stdcall GlobalAlloc(UINT uFlags, SIZE_T dwBytes);
// HRSRC __stdcall FindResourceExW(HMODULE hModule, LPCWSTR lpType, LPCWSTR lpName, WORD wLanguage);
// HRSRC __stdcall FindResourceW(HMODULE hModule, LPCWSTR lpName, LPCWSTR lpType);
// DWORD __stdcall SizeofResource(HMODULE hModule, HRSRC hResInfo);
// HGLOBAL __stdcall LoadResource(HMODULE hModule, HRSRC hResInfo);
// HANDLE __stdcall GetProcessHeap();
// SIZE_T __stdcall HeapSize(HANDLE hHeap, DWORD dwFlags, LPCVOID lpMem);
// BOOL __stdcall HeapFree(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem);
// LPVOID __stdcall HeapReAlloc(HANDLE hHeap, DWORD dwFlags, LPVOID lpMem, SIZE_T dwBytes);
// LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// BOOL __stdcall HeapDestroy(HANDLE hHeap);
// LPVOID __stdcall LockResource(HGLOBAL hResData);
// LPWSTR __stdcall GetCommandLineW();
// DWORD __stdcall GetFileType(HANDLE hFile);
// HLOCAL __stdcall LocalAlloc(UINT uFlags, SIZE_T uBytes);
// DWORD __stdcall FormatMessageW(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPWSTR lpBuffer, DWORD nSize, va_list *Arguments);
// ATOM __stdcall GlobalAddAtomW(LPCWSTR lpString);
// DWORD __stdcall GetTickCount();
// int __stdcall MulDiv(int nNumber, int nNumerator, int nDenominator);
// BOOL __stdcall GetFileSizeEx(HANDLE hFile, PLARGE_INTEGER lpFileSize);
// BOOL __stdcall GetExitCodeThread(HANDLE hThread, LPDWORD lpExitCode);
// HANDLE __stdcall CreateThread(LPSECURITY_ATTRIBUTES lpThreadAttributes, SIZE_T dwStackSize, LPTHREAD_START_ROUTINE lpStartAddress, LPVOID lpParameter, DWORD dwCreationFlags, LPDWORD lpThreadId);
// HANDLE __stdcall CreateEventW(LPSECURITY_ATTRIBUTES lpEventAttributes, BOOL bManualReset, BOOL bInitialState, LPCWSTR lpName);
// DWORD __stdcall WaitForMultipleObjects(DWORD nCount, const HANDLE *lpHandles, BOOL bWaitAll, DWORD dwMilliseconds);
// DWORD __stdcall WaitForSingleObject(HANDLE hHandle, DWORD dwMilliseconds);
// BOOL __stdcall SetEvent(HANDLE hEvent);
// void __stdcall EnterCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// HANDLE __stdcall GetCurrentThread();
// void __stdcall LeaveCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// BOOL __stdcall FindNextFileW(HANDLE hFindFile, LPWIN32_FIND_DATAW lpFindFileData);
// BOOL __stdcall FindClose(HANDLE hFindFile);
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// HMODULE __stdcall GetModuleHandleW(LPCWSTR lpModuleName);
// BOOL __stdcall ReadFile(HANDLE hFile, LPVOID lpBuffer, DWORD nNumberOfBytesToRead, LPDWORD lpNumberOfBytesRead, LPOVERLAPPED lpOverlapped);
// HMODULE __stdcall LoadLibraryExW(LPCWSTR lpLibFileName, HANDLE hFile, DWORD dwFlags);
// BOOL __stdcall FreeLibrary(HMODULE hLibModule);
// DWORD __stdcall GetPrivateProfileStringW(LPCWSTR lpAppName, LPCWSTR lpKeyName, LPCWSTR lpDefault, LPWSTR lpReturnedString, DWORD nSize, LPCWSTR lpFileName);
// HANDLE __stdcall FindFirstFileW(LPCWSTR lpFileName, LPWIN32_FIND_DATAW lpFindFileData);
// DWORD __stdcall GetFileAttributesW(LPCWSTR lpFileName);
// int __stdcall GetNumberFormatW(LCID Locale, DWORD dwFlags, LPCWSTR lpValue, const NUMBERFMTW *lpFormat, LPWSTR lpNumberStr, int cchNumber);
// int __stdcall GetDateFormatW(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpDate, LPCWSTR lpFormat, LPWSTR lpDateStr, int cchDate);
// int __stdcall GetTimeFormatW(LCID Locale, DWORD dwFlags, const SYSTEMTIME *lpTime, LPCWSTR lpFormat, LPWSTR lpTimeStr, int cchTime);
// int __stdcall GetLocaleInfoW(LCID Locale, LCTYPE LCType, LPWSTR lpLCData, int cchData);
// HANDLE __stdcall CreateFileW(LPCWSTR lpFileName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile);
// DWORD __stdcall GetFullPathNameW(LPCWSTR lpFileName, DWORD nBufferLength, LPWSTR lpBuffer, LPWSTR *lpFilePart);
// UINT __stdcall GetWindowsDirectoryW(LPWSTR lpBuffer, UINT uSize);
// void __stdcall OutputDebugStringW(LPCWSTR lpOutputString);
// DWORD __stdcall ExpandEnvironmentStringsW(LPCWSTR lpSrc, LPWSTR lpDst, DWORD nSize);
// BOOL __stdcall SetEnvironmentVariableW(LPCWSTR lpName, LPCWSTR lpValue);
// BOOL __stdcall CreateProcessW(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
// DWORD __stdcall GetModuleFileNameW(HMODULE hModule, LPWSTR lpFilename, DWORD nSize);
// HMODULE __stdcall LoadLibraryW(LPCWSTR lpLibFileName);
// HANDLE __stdcall CreateFileMappingW(HANDLE hFile, LPSECURITY_ATTRIBUTES lpFileMappingAttributes, DWORD flProtect, DWORD dwMaximumSizeHigh, DWORD dwMaximumSizeLow, LPCWSTR lpName);
// BOOL __stdcall TlsSetValue(DWORD dwTlsIndex, LPVOID lpTlsValue);
// DWORD __stdcall TlsAlloc();
// int __stdcall lstrlenW(LPCWSTR lpString);
// BOOL __stdcall UnmapViewOfFile(LPCVOID lpBaseAddress);
// LPVOID __stdcall MapViewOfFile(HANDLE hFileMappingObject, DWORD dwDesiredAccess, DWORD dwFileOffsetHigh, DWORD dwFileOffsetLow, SIZE_T dwNumberOfBytesToMap);
// DWORD __stdcall FormatMessageA(DWORD dwFlags, LPCVOID lpSource, DWORD dwMessageId, DWORD dwLanguageId, LPSTR lpBuffer, DWORD nSize, va_list *Arguments);
// BOOL __stdcall FileTimeToSystemTime(const FILETIME *lpFileTime, LPSYSTEMTIME lpSystemTime);
// BOOL __stdcall FileTimeToLocalFileTime(const FILETIME *lpFileTime, LPFILETIME lpLocalFileTime);
// BOOL __stdcall CloseHandle(HANDLE hObject);
// BOOL __stdcall GetFileTime(HANDLE hFile, LPFILETIME lpCreationTime, LPFILETIME lpLastAccessTime, LPFILETIME lpLastWriteTime);
// BOOL __stdcall WriteFile(HANDLE hFile, LPCVOID lpBuffer, DWORD nNumberOfBytesToWrite, LPDWORD lpNumberOfBytesWritten, LPOVERLAPPED lpOverlapped);
// HANDLE __stdcall GetStdHandle(DWORD nStdHandle);
// DWORD __stdcall GetFileSize(HANDLE hFile, LPDWORD lpFileSizeHigh);
// void __stdcall Sleep(DWORD dwMilliseconds);
// void __stdcall InitializeCriticalSection(LPCRITICAL_SECTION lpCriticalSection);
// UINT __stdcall SetErrorMode(UINT uMode);
// DWORD __stdcall GetLastError();
// void __stdcall __noreturn ExitThread(DWORD dwExitCode);
// HANDLE __stdcall GetCurrentProcess();
// HANDLE __stdcall OpenProcess(DWORD dwDesiredAccess, BOOL bInheritHandle, DWORD dwProcessId);
// HLOCAL __stdcall LocalFree(HLOCAL hMem);
// DWORD __stdcall GetVersion();
// FARPROC __stdcall GetProcAddress(HMODULE hModule, LPCSTR lpProcName);
// LONG __stdcall InterlockedDecrement(volatile LONG *lpAddend);
// LONG __stdcall InterlockedIncrement(volatile LONG *lpAddend);
// LPVOID __stdcall TlsGetValue(DWORD dwTlsIndex);
// BOOL __stdcall IsBadReadPtr(const void *lp, UINT_PTR ucb);
// HRESULT __stdcall SafeArrayGetLBound(SAFEARRAY *psa, UINT nDim, LONG *plLbound);
// BSTR __stdcall SysAllocStringLen(const OLECHAR *strIn, UINT ui);
// HRESULT __stdcall SafeArrayGetElement(SAFEARRAY *psa, LONG *rgIndices, void *pv);
// HRESULT __stdcall SafeArrayUnaccessData(SAFEARRAY *psa);
// HRESULT __stdcall SafeArrayAccessData(SAFEARRAY *psa, void **ppvData);
// BSTR __stdcall SysAllocString(const OLECHAR *psz);
// void __stdcall SysFreeString(BSTR bstrString);
// UINT __stdcall SysStringLen(BSTR);
// BSTR __stdcall SysAllocStringByteLen(LPCSTR psz, UINT len);
// void __stdcall VariantInit(VARIANTARG *pvarg);
// HRESULT __stdcall VariantClear(VARIANTARG *pvarg);
// HRESULT __stdcall VariantChangeType(VARIANTARG *pvargDest, const VARIANTARG *pvarSrc, USHORT wFlags, VARTYPE vt);
// HRESULT __stdcall SafeArrayDestroy(SAFEARRAY *psa);
// HRESULT __stdcall SafeArrayGetUBound(SAFEARRAY *psa, UINT nDim, LONG *plUbound);
// HDEVINFO __stdcall SetupDiGetClassDevsW(const GUID *ClassGuid, PCWSTR Enumerator, HWND hwndParent, DWORD Flags);
// BOOL __stdcall SetupDiGetDeviceInterfaceDetailW(HDEVINFO DeviceInfoSet, PSP_DEVICE_INTERFACE_DATA DeviceInterfaceData, PSP_DEVICE_INTERFACE_DETAIL_DATA_W DeviceInterfaceDetailData, DWORD DeviceInterfaceDetailDataSize, PDWORD RequiredSize, PSP_DEVINFO_DATA DeviceInfoData);
// BOOL __stdcall SetupDiEnumDeviceInterfaces(HDEVINFO DeviceInfoSet, PSP_DEVINFO_DATA DeviceInfoData, const GUID *InterfaceClassGuid, DWORD MemberIndex, PSP_DEVICE_INTERFACE_DATA DeviceInterfaceData);
// BOOL __stdcall SetupDiDestroyDeviceInfoList(HDEVINFO DeviceInfoSet);
// BOOL __stdcall SHGetPathFromIDListW(LPCITEMIDLIST pidl, LPWSTR pszPath);
// HRESULT __stdcall SHGetSpecialFolderLocation(HWND hwnd, int csidl, LPITEMIDLIST *ppidl);
// LPITEMIDLIST __stdcall SHBrowseForFolderW(LPBROWSEINFOW lpbi);
// HRESULT __stdcall SHGetMalloc(IMalloc **ppMalloc);
// BOOL __stdcall Shell_NotifyIconW(DWORD dwMessage, PNOTIFYICONDATAW lpData);
// BOOL __stdcall ShellExecuteExW(SHELLEXECUTEINFOW *pExecInfo);
// DWORD_PTR __stdcall SHGetFileInfoW(LPCWSTR pszPath, DWORD dwFileAttributes, SHFILEINFOW *psfi, UINT cbFileInfo, UINT uFlags);
// HINSTANCE __stdcall ShellExecuteW(HWND hwnd, LPCWSTR lpOperation, LPCWSTR lpFile, LPCWSTR lpParameters, LPCWSTR lpDirectory, INT nShowCmd);
// COLORREF __stdcall ColorHLSToRGB(WORD wHue, WORD wLuminance, WORD wSaturation);
// void __stdcall ColorRGBToHLS(COLORREF clrRGB, WORD *pwHue, WORD *pwLuminance, WORD *pwSaturation);
// HRESULT __stdcall IUnknown_QueryService(IUnknown *punk, const GUID *const guidService, const IID *const riid, void **ppvOut);
// HRESULT __stdcall UrlUnescapeW(LPWSTR pszUrl, LPWSTR pszUnescaped, LPDWORD pcchUnescaped, DWORD dwFlags);
// HWND __stdcall GetWindow(HWND hWnd, UINT uCmd);
// HWND __stdcall GetDesktopWindow();
// BOOL __stdcall KillTimer(HWND hWnd, UINT_PTR uIDEvent);
// DWORD __stdcall MsgWaitForMultipleObjects(DWORD nCount, const HANDLE *pHandles, BOOL fWaitAll, DWORD dwMilliseconds, DWORD dwWakeMask);
// int __stdcall GetDlgCtrlID(HWND hWnd);
// BOOL __stdcall CheckRadioButton(HWND hDlg, int nIDFirstButton, int nIDLastButton, int nIDCheckButton);
// LRESULT __stdcall SendMessageTimeoutW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam, UINT fuFlags, UINT uTimeout, PDWORD_PTR lpdwResult);
// BOOL __stdcall PeekMessageW(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax, UINT wRemoveMsg);
// BOOL __stdcall GetUserObjectSecurity(HANDLE hObj, PSECURITY_INFORMATION pSIRequested, PSECURITY_DESCRIPTOR pSID, DWORD nLength, LPDWORD lpnLengthNeeded);
// BOOL __stdcall SetUserObjectSecurity(HANDLE hObj, PSECURITY_INFORMATION pSIRequested, PSECURITY_DESCRIPTOR pSID);
// BOOL __stdcall IsDialogMessageW(HWND hDlg, LPMSG lpMsg);
// BOOL __stdcall DrawIconEx(HDC hdc, int xLeft, int yTop, HICON hIcon, int cxWidth, int cyWidth, UINT istepIfAniCur, HBRUSH hbrFlickerFreeDraw, UINT diFlags);
// BOOL __stdcall CheckMenuRadioItem(HMENU hmenu, UINT first, UINT last, UINT check, UINT flags);
// HWND __stdcall WindowFromPoint(POINT Point);
// BOOL __stdcall RedrawWindow(HWND hWnd, const RECT *lprcUpdate, HRGN hrgnUpdate, UINT flags);
// BOOL __stdcall TrackPopupMenu(HMENU hMenu, UINT uFlags, int x, int y, int nReserved, HWND hWnd, const RECT *prcRect);
// BOOL __stdcall RemoveMenu(HMENU hMenu, UINT uPosition, UINT uFlags);
// HMENU __stdcall CreateMenu();
// BOOL __stdcall DrawMenuBar(HWND hWnd);
// HMENU __stdcall LoadMenuW(HINSTANCE hInstance, LPCWSTR lpMenuName);
// int __stdcall TranslateAcceleratorW(HWND hWnd, HACCEL hAccTable, LPMSG lpMsg);
// HACCEL __stdcall LoadAcceleratorsW(HINSTANCE hInstance, LPCWSTR lpTableName);
// BOOL __stdcall IsWindowEnabled(HWND hWnd);
// UINT __stdcall GetDlgItemTextW(HWND hDlg, int nIDDlgItem, LPWSTR lpString, int cchMax);
// HWND __stdcall CreateDialogParamW(HINSTANCE hInstance, LPCWSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);
// BOOL __stdcall IsWindow(HWND hWnd);
// void __stdcall PostQuitMessage(int nExitCode);
// BOOL __stdcall ExitWindowsEx(UINT uFlags, DWORD dwReason);
// LRESULT __stdcall DispatchMessageW(const MSG *lpMsg);
// BOOL __stdcall TranslateMessage(const MSG *lpMsg);
// BOOL __stdcall GetMessageW(LPMSG lpMsg, HWND hWnd, UINT wMsgFilterMin, UINT wMsgFilterMax);
// BOOL __stdcall DrawEdge(HDC hdc, LPRECT qrc, UINT edge, UINT grfFlags);
// UINT __stdcall RegisterWindowMessageW(LPCWSTR lpString);
// HDC __stdcall GetWindowDC(HWND hWnd);
// BOOL __stdcall SetMenuItemInfoW(HMENU hmenu, UINT item, BOOL fByPositon, LPCMENUITEMINFOW lpmii);
// BOOL __stdcall IsIconic(HWND hWnd);
// BOOL __stdcall ShowWindowAsync(HWND hWnd, int nCmdShow);
// BOOL __stdcall SystemParametersInfoW(UINT uiAction, UINT uiParam, PVOID pvParam, UINT fWinIni);
// BOOL __stdcall EnumWindows(WNDENUMPROC lpEnumFunc, LPARAM lParam);
// DWORD __stdcall SetClassLongW(HWND hWnd, int nIndex, LONG dwNewLong);
// int __stdcall GetWindowTextW(HWND hWnd, LPWSTR lpString, int nMaxCount);
// BOOL __stdcall InvalidateRgn(HWND hWnd, HRGN hRgn, BOOL bErase);
// BOOL __stdcall TrackPopupMenuEx(HMENU, UINT, int, int, HWND, LPTPMPARAMS);
// BOOL __stdcall ModifyMenuW(HMENU hMnu, UINT uPosition, UINT uFlags, UINT_PTR uIDNewItem, LPCWSTR lpNewItem);
// BOOL __stdcall AppendMenuW(HMENU hMenu, UINT uFlags, UINT_PTR uIDNewItem, LPCWSTR lpNewItem);
// int __stdcall GetMenuItemCount(HMENU hMenu);
// UINT __stdcall GetMenuItemID(HMENU hMenu, int nPos);
// BOOL __stdcall EnableMenuItem(HMENU hMenu, UINT uIDEnableItem, UINT uEnable);
// HMENU __stdcall CreatePopupMenu();
// BOOL __stdcall EnableWindow(HWND hWnd, BOOL bEnable);
// UINT __stdcall IsDlgButtonChecked(HWND hDlg, int nIDButton);
// BOOL __stdcall CheckDlgButton(HWND hDlg, int nIDButton, UINT uCheck);
// BOOL __stdcall GetWindowPlacement(HWND hWnd, WINDOWPLACEMENT *lpwndpl);
// HANDLE __stdcall LoadImageW(HINSTANCE hInst, LPCWSTR name, UINT type, int cx, int cy, UINT fuLoad);
// BOOL __stdcall SetWindowPlacement(HWND hWnd, const WINDOWPLACEMENT *lpwndpl);
// ATOM __stdcall RegisterClassW(const WNDCLASSW *lpWndClass);
// LRESULT __stdcall DefFrameProcW(HWND hWnd, HWND hWndMDIClient, UINT uMsg, WPARAM wParam, LPARAM lParam);
// LRESULT __stdcall DefDlgProcW(HWND hDlg, UINT Msg, WPARAM wParam, LPARAM lParam);
// HICON __stdcall CreateIconIndirect(PICONINFO piconinfo);
// int __stdcall FrameRect(HDC hDC, const RECT *lprc, HBRUSH hbr);
// BOOL __stdcall ClientToScreen(HWND hWnd, LPPOINT lpPoint);
// BOOL __stdcall IsWindowVisible(HWND hWnd);
// BOOL __stdcall DestroyWindow(HWND hWnd);
// int __stdcall GetClassNameW(HWND hWnd, LPWSTR lpClassName, int nMaxCount);
// BOOL __stdcall EnumChildWindows(HWND hWndParent, WNDENUMPROC lpEnumFunc, LPARAM lParam);
// BOOL __stdcall PtInRect(const RECT *lprc, POINT pt);
// BOOL __stdcall UnionRect(LPRECT lprcDst, const RECT *lprcSrc1, const RECT *lprcSrc2);
// BOOL __stdcall CopyRect(LPRECT lprcDst, const RECT *lprcSrc);
// BOOL __stdcall ScreenToClient(HWND hWnd, LPPOINT lpPoint);
// BOOL __stdcall EmptyClipboard();
// HANDLE __stdcall SetClipboardData(UINT uFormat, HANDLE hMem);
// BOOL __stdcall CloseClipboard();
// BOOL __stdcall OpenClipboard(HWND hWndNewOwner);
// BOOL __stdcall IsZoomed(HWND hWnd);
// BOOL __stdcall EndDeferWindowPos(HDWP hWinPosInfo);
// HDWP __stdcall DeferWindowPos(HDWP hWinPosInfo, HWND hWnd, HWND hWndInsertAfter, int x, int y, int cx, int cy, UINT uFlags);
// HDWP __stdcall BeginDeferWindowPos(int nNumWindows);
// BOOL __stdcall DrawFrameControl(HDC, LPRECT, UINT, UINT);
// HWND __stdcall ChildWindowFromPoint(HWND hWndParent, POINT Point);
// BOOL __stdcall SetDlgItemTextW(HWND hDlg, int nIDDlgItem, LPCWSTR lpString);
// INT_PTR __stdcall DialogBoxParamW(HINSTANCE hInstance, LPCWSTR lpTemplateName, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);
// BOOL __stdcall MoveWindow(HWND hWnd, int X, int Y, int nWidth, int nHeight, BOOL bRepaint);
// BOOL __stdcall SetWindowTextW(HWND hWnd, LPCWSTR lpString);
// HWND __stdcall GetDlgItem(HWND hDlg, int nIDDlgItem);
// BOOL __stdcall EndDialog(HWND hDlg, INT_PTR nResult);
// INT_PTR __stdcall DialogBoxIndirectParamW(HINSTANCE hInstance, LPCDLGTEMPLATEW hDialogTemplate, HWND hWndParent, DLGPROC lpDialogFunc, LPARAM dwInitParam);
// BOOL __stdcall GetScrollInfo(HWND hwnd, int nBar, LPSCROLLINFO lpsi);
// int __stdcall SetScrollInfo(HWND hwnd, int nBar, LPCSCROLLINFO lpsi, BOOL redraw);
// HWND __stdcall GetParent(HWND hWnd);
// DWORD __stdcall GetClassLongW(HWND hWnd, int nIndex);
// LONG __stdcall SetWindowLongW(HWND hWnd, int nIndex, LONG dwNewLong);
// LONG __stdcall GetWindowLongW(HWND hWnd, int nIndex);
// BOOL __stdcall OffsetRect(LPRECT lprc, int dx, int dy);
// BOOL __stdcall IntersectRect(LPRECT lprcDst, const RECT *lprcSrc1, const RECT *lprcSrc2);
// BOOL __stdcall InflateRect(LPRECT lprc, int dx, int dy);
// int __stdcall FillRect(HDC hDC, const RECT *lprc, HBRUSH hbr);
// HBRUSH __stdcall GetSysColorBrush(int nIndex);
// DWORD __stdcall GetSysColor(int nIndex);
// int __stdcall MapWindowPoints(HWND hWndFrom, HWND hWndTo, LPPOINT lpPoints, UINT cPoints);
// BOOL __stdcall GetCursorPos(LPPOINT lpPoint);
// LRESULT __stdcall SendMessageW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// DWORD __stdcall WaitForInputIdle(HANDLE hProcess, DWORD dwMilliseconds);
// BOOL __stdcall ShowWindow(HWND hWnd, int nCmdShow);
// HWND __stdcall SetFocus(HWND hWnd);
// HMENU __stdcall GetMenu(HWND hWnd);
// DWORD __stdcall CheckMenuItem(HMENU hMenu, UINT uIDCheckItem, UINT uCheck);
// HMENU __stdcall GetSubMenu(HMENU hMenu, int nPos);
// BOOL __stdcall InsertMenuW(HMENU hMenu, UINT uPosition, UINT uFlags, UINT_PTR uIDNewItem, LPCWSTR lpNewItem);
// BOOL __stdcall DeleteMenu(HMENU hMenu, UINT uPosition, UINT uFlags);
// BOOL __stdcall GetWindowRect(HWND hWnd, LPRECT lpRect);
// BOOL __stdcall GetClientRect(HWND hWnd, LPRECT lpRect);
// HANDLE __stdcall GetPropW(HWND hWnd, LPCWSTR lpString);
// BOOL __stdcall SetPropW(HWND hWnd, LPCWSTR lpString, HANDLE hData);
// int __stdcall ScrollWindowEx(HWND hWnd, int dx, int dy, const RECT *prcScroll, const RECT *prcClip, HRGN hrgnUpdate, LPRECT prcUpdate, UINT flags);
// BOOL __stdcall ValidateRect(HWND hWnd, const RECT *lpRect);
// BOOL __stdcall InvalidateRect(HWND hWnd, const RECT *lpRect, BOOL bErase);
// int __stdcall GetUpdateRgn(HWND hWnd, HRGN hRgn, BOOL bErase);
// BOOL __stdcall GetUpdateRect(HWND hWnd, LPRECT lpRect, BOOL bErase);
// BOOL __stdcall EndPaint(HWND hWnd, const PAINTSTRUCT *lpPaint);
// HDC __stdcall BeginPaint(HWND hWnd, LPPAINTSTRUCT lpPaint);
// BOOL __stdcall UpdateWindow(HWND hWnd);
// int __stdcall DrawTextW(HDC hdc, LPCWSTR lpchText, int cchText, LPRECT lprc, UINT format);
// int __stdcall GetSystemMetrics(int nIndex);
// UINT_PTR __stdcall SetTimer(HWND hWnd, UINT_PTR nIDEvent, UINT uElapse, TIMERPROC lpTimerFunc);
// BOOL __stdcall ReleaseCapture();
// BOOL __stdcall SetForegroundWindow(HWND hWnd);
// int __stdcall MessageBoxW(HWND hWnd, LPCWSTR lpText, LPCWSTR lpCaption, UINT uType);
// HCURSOR __stdcall SetCursor(HCURSOR hCursor);
// HWND __stdcall FindWindowW(LPCWSTR lpClassName, LPCWSTR lpWindowName);
// HWND __stdcall FindWindowExW(HWND hWndParent, HWND hWndChildAfter, LPCWSTR lpszClass, LPCWSTR lpszWindow);
// DWORD __stdcall GetWindowThreadProcessId(HWND hWnd, LPDWORD lpdwProcessId);
// HCURSOR __stdcall LoadCursorW(HINSTANCE hInstance, LPCWSTR lpCursorName);
// HICON __stdcall LoadIconW(HINSTANCE hInstance, LPCWSTR lpIconName);
// BOOL __stdcall DestroyIcon(HICON hIcon);
// BOOL __stdcall EnumDisplaySettingsW(LPCWSTR lpszDeviceName, DWORD iModeNum, DEVMODEW *lpDevMode);
// HDC __stdcall GetDC(HWND hWnd);
// int __stdcall ReleaseDC(HWND hWnd, HDC hDC);
// int __stdcall LoadStringW(HINSTANCE hInstance, UINT uID, LPWSTR lpBuffer, int cchBufferMax);
// HWND __stdcall SetCapture(HWND hWnd);
// HWND __stdcall GetCapture();
// SHORT __stdcall GetKeyState(int nVirtKey);
// HWND __stdcall GetFocus();
// BOOL __stdcall SetWindowPos(HWND hWnd, HWND hWndInsertAfter, int X, int Y, int cx, int cy, UINT uFlags);
// HWND __stdcall CreateWindowExW(DWORD dwExStyle, LPCWSTR lpClassName, LPCWSTR lpWindowName, DWORD dwStyle, int X, int Y, int nWidth, int nHeight, HWND hWndParent, HMENU hMenu, HINSTANCE hInstance, LPVOID lpParam);
// ATOM __stdcall RegisterClassExW(const WNDCLASSEXW *);
// LRESULT __stdcall CallWindowProcW(WNDPROC lpPrevWndFunc, HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// LRESULT __stdcall DefWindowProcW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// BOOL __stdcall PostMessageW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam);
// LRESULT __stdcall DefMDIChildProcW(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam);
// HINTERNET __stdcall WinHttpOpenRequest(HINTERNET hConnect, LPCWSTR pwszVerb, LPCWSTR pwszObjectName, LPCWSTR pwszVersion, LPCWSTR pwszReferrer, LPCWSTR *ppwszAcceptTypes, DWORD dwFlags);
// BOOL __stdcall WinHttpSetOption(HINTERNET hInternet, DWORD dwOption, LPVOID lpBuffer, DWORD dwBufferLength);
// BOOL __stdcall WinHttpQueryDataAvailable(HINTERNET hRequest, LPDWORD lpdwNumberOfBytesAvailable);
// BOOL __stdcall WinHttpSendRequest(HINTERNET hRequest, LPCWSTR lpszHeaders, DWORD dwHeadersLength, LPVOID lpOptional, DWORD dwOptionalLength, DWORD dwTotalLength, DWORD_PTR dwContext);
// BOOL __stdcall WinHttpReadData(HINTERNET hRequest, LPVOID lpBuffer, DWORD dwNumberOfBytesToRead, LPDWORD lpdwNumberOfBytesRead);
// HINTERNET __stdcall WinHttpConnect(HINTERNET hSession, LPCWSTR pswzServerName, INTERNET_PORT nServerPort, DWORD dwReserved);
// BOOL __stdcall WinHttpCloseHandle(HINTERNET hInternet);
// HINTERNET __stdcall WinHttpOpen(LPCWSTR pszAgentW, DWORD dwAccessType, LPCWSTR pszProxyW, LPCWSTR pszProxyBypassW, DWORD dwFlags);
// BOOL __stdcall WinHttpReceiveResponse(HINTERNET hRequest, LPVOID lpReserved);
// BOOL __stdcall WinHttpQueryHeaders(HINTERNET hRequest, DWORD dwInfoLevel, LPCWSTR pwszName, LPVOID lpBuffer, LPDWORD lpdwBufferLength, LPDWORD lpdwIndex);
// BOOL __stdcall WinHttpGetProxyForUrl(HINTERNET hSession, LPCWSTR lpcwszUrl, WINHTTP_AUTOPROXY_OPTIONS *pAutoProxyOptions, WINHTTP_PROXY_INFO *pProxyInfo);
// BOOL __stdcall WinHttpWriteData(HINTERNET hRequest, LPCVOID lpBuffer, DWORD dwNumberOfBytesToWrite, LPDWORD lpdwNumberOfBytesWritten);
// u_long __stdcall ntohl(u_long netlong);
// u_long __stdcall htonl(u_long hostlong);
// u_short __stdcall htons(u_short hostshort);
// struct hostent *__stdcall gethostbyaddr(const char *addr, int len, int type);
// struct servent *__stdcall getservbyport(int port, const char *proto);
// int __stdcall WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData);
// u_short __stdcall ntohs(u_short netshort);
// int __stdcall CredUIPromptForCredentialsW(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
// HRESULT __stdcall CoGetInterfaceAndReleaseStream(LPSTREAM pStm, const IID *const iid, LPVOID *ppv);
// HRESULT __stdcall CoInitialize(LPVOID pvReserved);
// HRESULT __stdcall CoInitializeEx(LPVOID pvReserved, DWORD dwCoInit);
// HRESULT __stdcall CoCreateInstance(const IID *const rclsid, LPUNKNOWN pUnkOuter, DWORD dwClsContext, const IID *const riid, LPVOID *ppv);
// void __stdcall CoUninitialize();
// HRESULT __stdcall CoSetProxyBlanket(IUnknown *pProxy, DWORD dwAuthnSvc, DWORD dwAuthzSvc, OLECHAR *pServerPrincName, DWORD dwAuthnLevel, DWORD dwImpLevel, RPC_AUTH_IDENTITY_HANDLE pAuthInfo, DWORD dwCapabilities);
// HRESULT __stdcall CoMarshalInterThreadInterfaceInStream(const IID *const riid, LPUNKNOWN pUnk, LPSTREAM *ppStm);
// void __stdcall CoTaskMemFree(LPVOID pv);
LSTATUS __stdcall RegDeleteKeyExW(HKEY hKey, LPCWSTR lpSubKey, REGSAM samDesired, DWORD Reserved);
HRESULT __stdcall SHGetFolderPathW(HWND hwnd, int csidl, HANDLE hToken, DWORD dwFlags, LPWSTR pszPath);
LONG __stdcall WinVerifyTrust(HWND hwnd, GUID *ActionID, WINTRUST_DATA_EX *ActionData);
CRYPT_PROVIDER_SGNR *__stdcall WTHelperGetProvSignerFromChain(CRYPT_PROVIDER_DATA *pProvData, DWORD idxSigner, BOOL fCounterSigner, DWORD idxCounterSigner);
CRYPT_PROVIDER_DATA *__stdcall WTHelperProvDataFromStateData(HANDLE hStateData);
BOOL __stdcall CryptCATAdminReleaseContext(HCATADMIN hCatAdmin, DWORD dwFlags);
BOOL __stdcall CryptCATAdminReleaseCatalogContext(HCATADMIN hCatAdmin, HCATINFO hCatInfo, DWORD dwFlags);
BOOL __stdcall CryptCATCatalogInfoFromContext(HCATINFO hCatInfo, CATALOG_INFO *psCatInfo, DWORD dwFlags);
HCATINFO __stdcall CryptCATAdminEnumCatalogFromHash(HCATADMIN hCatAdmin, BYTE *pbHash, DWORD cbHash, DWORD dwFlags, HCATINFO *phPrevCatInfo);
BOOL __stdcall CryptCATAdminCalcHashFromFileHandle(HANDLE hFile, DWORD *pcbHash, BYTE *pbHash, DWORD dwFlags);
BOOL __stdcall CryptCATAdminAcquireContext(HCATADMIN *phCatAdmin, const GUID *pgSubsystem, DWORD dwFlags);
DWORD __stdcall CertNameToStrW(DWORD dwCertEncodingType, PCERT_NAME_BLOB pName, DWORD dwStrType, LPWSTR psz, DWORD csz);
HCATINFO __stdcall CryptCATAdminAddCatalog(HCATADMIN hCatAdmin, PWSTR pwszCatalogFile, PWSTR pwszSelectBaseName, DWORD dwFlags);
BOOL __stdcall CryptCATAdminRemoveCatalog(HCATADMIN hCatAdmin, LPCWSTR pwszCatalogFile, DWORD dwFlags);
BOOL __stdcall IsCatalogFile(HANDLE hFile, WCHAR *pwszFileName);
void __stdcall gpfnRtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
HMONITOR __stdcall MonitorFromPoint(POINT pt, DWORD dwFlags);
BOOL __stdcall GetMonitorInfoA(HMONITOR hMonitor, LPMONITORINFO lpmi);
TRACEHANDLE __stdcall OpenTraceW_0(PEVENT_TRACE_LOGFILEW Logfile);
ULONG __stdcall ProcessTrace_0(PTRACEHANDLE HandleArray, ULONG HandleCount, LPFILETIME StartTime, LPFILETIME EndTime);
BOOLEAN __stdcall SetSuspendState(BOOLEAN bHibernate, BOOLEAN bForce, BOOLEAN bWakeupEventsDisabled);
BOOL __stdcall LockWorkStation();
BOOLEAN __stdcall IsPwrHibernateAllowed();
BOOLEAN __stdcall IsPwrSuspendAllowed();
HPROPSHEETPAGE __stdcall CreateSecurityPage(LPSECURITYINFO psi);
DWORD __stdcall GetGuiResources(HANDLE hProcess, DWORD uiFlags);
DWORD __stdcall GetMappedFileNameW(HANDLE hProcess, LPVOID lpv, LPWSTR lpFilename, DWORD nSize);
DWORD __stdcall GetLongPathNameW(LPCWSTR lpszShortPath, LPWSTR lpszLongPath, DWORD cchBuffer);
BOOL __stdcall EnumServicesStatusExW(SC_HANDLE hSCManager, SC_ENUM_TYPE InfoLevel, DWORD dwServiceType, DWORD dwServiceState, LPBYTE lpServices, DWORD cbBufSize, LPDWORD pcbBytesNeeded, LPDWORD lpServicesReturned, LPDWORD lpResumeHandle, LPCWSTR pszGroupName);
BOOL __stdcall QueryServiceConfig2W(SC_HANDLE hService, DWORD dwInfoLevel, LPBYTE lpBuffer, DWORD cbBufSize, LPDWORD pcbBytesNeeded);
BOOL __stdcall QueryInformationJobObject(HANDLE hJob, JOBOBJECTINFOCLASS JobObjectInformationClass, LPVOID lpJobObjectInformation, DWORD cbJobObjectInformationLength, LPDWORD lpReturnLength);
DWORD __stdcall SymGetOptions();
PVOID __stdcall SymFunctionTableAccess64(HANDLE hProcess, DWORD64 AddrBase);
BOOL __stdcall SymFromAddrW(HANDLE hProcess, DWORD64 Address, PDWORD64 Displacement, PSYMBOL_INFOW Symbol);
BOOL __stdcall StackWalk64(DWORD MachineType, HANDLE hProcess, HANDLE hThread, LPSTACKFRAME64 StackFrame, PVOID ContextRecord, PREAD_PROCESS_MEMORY_ROUTINE64 ReadMemoryRoutine, PFUNCTION_TABLE_ACCESS_ROUTINE64 FunctionTableAccessRoutine, PGET_MODULE_BASE_ROUTINE64 GetModuleBaseRoutine, PTRANSLATE_ADDRESS_ROUTINE64 TranslateAddress);
BOOL __stdcall QueryWorkingSet(HANDLE hProcess, PVOID pv, DWORD cb);
DWORD64 __stdcall SymLoadModule64(HANDLE hProcess, HANDLE hFile, PCSTR ImageName, PCSTR ModuleName, DWORD64 BaseOfDll, DWORD SizeOfDll);
DWORD64 __stdcall SymLoadModuleExW(HANDLE hProcess, HANDLE hFile, PCWSTR ImageName, PCWSTR ModuleName, DWORD64 BaseOfDll, DWORD DllSize, PMODLOAD_DATA Data, DWORD Flags);
BOOL __stdcall SymUnloadModule64(HANDLE hProcess, DWORD64 BaseOfDll);
BOOL __stdcall SymGetModuleInfoW64(HANDLE hProcess, DWORD64 qwAddr, PIMAGEHLP_MODULEW64 ModuleInfo);
BOOL __stdcall EnumerateLoadedModulesW64(HANDLE hProcess, PENUMLOADED_MODULES_CALLBACKW64 EnumLoadedModulesCallback, PVOID UserContext);
BOOL __stdcall EnumProcessModulesEx(HANDLE hProcess, HMODULE *lphModule, DWORD cb, LPDWORD lpcbNeeded, DWORD dwFilterFlag);
BOOL __stdcall SymRegisterCallback64(HANDLE hProcess, PSYMBOL_REGISTERED_CALLBACK64 CallbackFunction, ULONG64 UserContext);
DWORD64 __stdcall SymGetModuleBase64(HANDLE hProcess, DWORD64 qwAddr);
PIMAGE_NT_HEADERS __stdcall ImageNtHeader(PVOID Base);
HANDLE __stdcall FindExecutableImageExW_0(PCWSTR FileName, PCWSTR SymbolPath, PWSTR ImageFilePath, PFIND_EXE_FILE_CALLBACKW Callback, PVOID CallerData);
HANDLE __stdcall FindExecutableImageExW(PCWSTR FileName, PCWSTR SymbolPath, PWSTR ImageFilePath, PFIND_EXE_FILE_CALLBACKW Callback, PVOID CallerData);
BOOL __stdcall SetProcessAffinityMask(HANDLE hProcess, DWORD dwProcessAffinityMask);
DWORD __stdcall GetExtendedTcpTable(PVOID pTcpTable, PDWORD pdwSize, BOOL bOrder, ULONG ulAf, TCP_TABLE_CLASS TableClass, ULONG Reserved);
DWORD __stdcall GetExtendedUdpTable(PVOID pUdpTable, PDWORD pdwSize, BOOL bOrder, ULONG ulAf, UDP_TABLE_CLASS TableClass, ULONG Reserved);
ULONG __stdcall GetTcpTable(PMIB_TCPTABLE TcpTable, PULONG SizePointer, BOOL Order);
ULONG __stdcall GetUdpTable(PMIB_UDPTABLE UdpTable, PULONG SizePointer, BOOL Order);
DWORD __stdcall WTSGetActiveConsoleSessionId();
HANDLE __stdcall CreateJobObjectW(LPSECURITY_ATTRIBUTES lpJobAttributes, LPCWSTR lpName);
HANDLE __stdcall CreateToolhelp32Snapshot_0(DWORD dwFlags, DWORD th32ProcessID);
BOOL __stdcall Process32FirstW_0(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
BOOL __stdcall Process32NextW_0(HANDLE hSnapshot, LPPROCESSENTRY32W lppe);
BOOL __stdcall Thread32First_0(HANDLE hSnapshot, LPTHREADENTRY32 lpte);
BOOL __stdcall Thread32Next_0(HANDLE hSnapshot, LPTHREADENTRY32 lpte);
BOOL __stdcall Module32FirstW_0(HANDLE hSnapshot, LPMODULEENTRY32W lpme);
BOOL __stdcall Module32NextW_0(HANDLE hSnapshot, LPMODULEENTRY32W lpme);
BOOL __stdcall IsProcessInJob(HANDLE ProcessHandle, HANDLE JobHandle, PBOOL Result);
BOOL __stdcall GetLogicalProcessorInformation(PSYSTEM_LOGICAL_PROCESSOR_INFORMATION Buffer, PDWORD ReturnedLength);
BOOL __stdcall GetMenuInfo(HMENU, LPMENUINFO);
BOOL __stdcall SetMenuInfo(HMENU, LPCMENUINFO);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_FA8A40; // weak
_UNKNOWN loc_FA8A70; // weak
char algn_FC2FF0[16] = { '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '' }; // weak
char algn_FE224B[5] = { '', '', '', '', '' }; // weak
_UNKNOWN loc_FFFFFE; // weak
_UNKNOWN loc_1005090; // weak
const WCHAR *gszNullString = NULL;
GUID CLSID_IShellItem2 = { 2124394707u, 37279u, 17159u, { 171u, 46u, 155u, 24u, 96u, 49u, 12u, 147u } }; // weak
GUID CLSID_ITask = { 344708388u, 41643u, 4558u, { 177u, 31u, 0u, 170u, 0u, 83u, 5u, 3u } }; // weak
IID CLSID_ITaskScheduler = { 344708391u, 41643u, 4558u, { 177u, 31u, 0u, 170u, 0u, 83u, 5u, 3u } }; // idb
IID CLSID_CLSID_CTaskScheduler = { 344708394u, 41643u, 4558u, { 177u, 31u, 0u, 170u, 0u, 83u, 5u, 3u } }; // idb
wchar_t aWinIni[9] = L"\\win.ini"; // weak
void *std::error_category::`vftable' = &std::error_category::`vector deleting destructor'; // weak
IID CLSID_IWbemServices = { 2505497753u, 33420u, 4559u, { 163u, 126u, 0u, 170u, 0u, 50u, 64u, 199u } }; // idb
IID IID_IWbemLocator = { 3692209799u, 29567u, 4559u, { 136u, 77u, 0u, 170u, 0u, 75u, 46u, 36u } }; // idb
void *EventConsumerDescBase::`vftable' = &_purecall; // weak
void *CommandLineEventConsumer::`vftable' = &sub_F95940; // weak
void *ActiveScriptEventConsumer::`vftable' = &sub_F95910; // weak
__m128i GUID_PROCEXP_EVENT = { { 0, 217, 253, 104, 62, 74, 209, 17, 132, 244, 0, 0, 248, 4, 100, 227 } }; // idb
GUID CLSID_IDispatch = { 132096u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // weak
IID CLSID_IShellBrowser = { 136418u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // idb
GUID CLSID_IShellFolderViewDual = { 3886133120u, 19862u, 4559u, { 150u, 12u, 0u, 128u, 199u, 244u, 238u, 133u } }; // weak
GUID CLSID_IShellView = { 136419u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // idb
IID CLSID_IShellWindows = { 2244700416u, 19861u, 4559u, { 150u, 12u, 0u, 128u, 199u, 244u, 238u, 133u } }; // idb
GUID CLSID_IShellDispatch2 = { 2764474668u, 15273u, 4562u, { 157u, 234u, 0u, 192u, 79u, 177u, 97u, 98u } }; // idb
void *CThemedWindow::`vftable' = &_purecall; // weak
void *CTreeListData::`vftable' = &CTreeListData::`scalar deleting destructor'; // weak
void *CTreeList::`vftable' = &CTreeList::GetName; // weak
CHAR gszStatusBarText[4] = { '\0', '\0', '\0', '\0' }; // idb
void *CListViewData::`vftable' = &CTreeListData::`scalar deleting destructor'; // weak
RECT stru_1034280 = { 1, 1, 1, 1 }; // weak
RECT stru_1034290 = { 0, 0, 500, 500 }; // weak
void *std::runtime_error::`vftable' = &sub_FA8CB0; // weak
void *std::_Facet_base::`vftable' = &sub_FA8C50; // weak
void *std::ctype<unsigned short>::`vftable' = &sub_FA8C00; // weak
void *std::_System_error::`vftable' = &sub_FA8CB0; // weak
_UNKNOWN unk_103BEA4; // weak
void *std::system_error::`vftable' = &sub_FA8CB0; // weak
void *std::ios_base::failure::`vftable' = &sub_FA8CB0; // weak
void *std::ios_base::`vftable' = &sub_FA8C80; // weak
void *std::basic_ostream<unsigned short,std::char_traits<unsigned short>>::`vftable' = &sub_FA8A2C; // weak
void *std::basic_streambuf<unsigned short,std::char_traits<unsigned short>>::`vftable' = &sub_FA8B10; // weak
void *std::basic_istream<unsigned short,std::char_traits<unsigned short>>::`vftable' = &sub_FA8A24; // weak
void *std::basic_iostream<unsigned short,std::char_traits<unsigned short>>::`vftable' = &sub_FA8A1C; // weak
void *std::basic_stringbuf<unsigned short,std::char_traits<unsigned short>,std::allocator<unsigned short>>::`vftable' = &sub_FA8B60; // weak
void *std::basic_stringstream<unsigned short,std::char_traits<unsigned short>,std::allocator<unsigned short>>::`vftable' = &loc_FA8A34; // weak
_UNKNOWN unk_103BFB0; // weak
_DWORD dword_103BFB8[2] = { 0, 88 }; // idb
GUID CLSID_IObjectSecurity = { 2522858336u, 5887u, 4560u, { 145u, 203u, 0u, 170u, 0u, 187u, 183u, 35u } }; // weak
void *CObjSecurity::`vftable' = &CObjSecurity::QueryInterface; // weak
void *ATL::CWin32Heap::`vftable' = &ATL::CWin32Heap::Allocate; // weak
void *ATL::CAtlStringMgr::`vftable' = &ATL::CAtlStringMgr::Allocate; // weak
void *CResizer::`vftable' = &CResizer::GetName; // weak
void *Process::`vftable' = &Process::`scalar deleting destructor'; // weak
void *Runtime::`vftable' = &Runtime::`scalar deleting destructor'; // weak
void *Appdomain::`vftable' = &AppDomain::`vector deleting destructor'; // weak
void *Assembly::`vftable' = &Assembly::`scalar deleting destructor'; // weak
double db_one =  1.0;
double db_four =  4.0; // weak
RECT stru_103CB40 = { 0, 0, 10, 10 }; // weak
RECT stru_103CB50 = { 0, 3220176896, 0, 3220176896 }; // weak
double db_onehundred =  100.0; // weak
__int64 dbl_103CDD8 = -4616189618054758400i64; // idb
GUID CLSID_GUID_DISPLAY_DEVICE_ARRIVAL = { 480268672u, 42649u, 17674u, { 154u, 12u, 222u, 79u, 190u, 61u, 221u, 137u } }; // idb
double qword_103D110[2] = {  0.0,  4.294967296e9 }; // idb
wchar_t aLight[] = L"-Light"; // idb
double db_zeropointzerozerofive =  0.005; // weak
double db_two =  2.0; // weak
double db_six =  6.0; // weak
double db_twenty21 =  21.0; // weak
double db_twohundred =  200.0; // weak
double dbl_103EA08 =  8213.0; // weak
double dbl_103EA10 =  27856.0; // weak
double dbl_103EA18 =  4605695.0; // weak
double dbl_103EA20 =  4652870.0; // weak
double dbl_103EA28 =  8388863.0; // weak
double dbl_103EA30 =  8421504.0; // weak
__int64 qword_103EA38 = 4711926293971599360i64; // weak
__int64 qword_103EA40 = 4751297606873776128i64; // weak
RECT gIntArray = { 0, 1, 2, 3 }; // weak
IID stru_103F100 = { 260519583u, 42213u, 19708u, { 189u, 62u, 115u, 230u, 21u, 69u, 114u, 221u } }; // idb
IID CLSID_ITaskService = { 799777991u, 19881u, 16403u, { 150u, 151u, 32u, 204u, 63u, 212u, 15u, 133u } }; // idb
RECT stru_103F270 = { 0, 0, 15, 15 }; // weak
IID stru_103F3AC = { 75143744u, 25982u, 4563u, { 141u, 91u, 0u, 16u, 75u, 53u, 231u, 239u } }; // idb
IID stru_103F3BC = { 2517868775u, 23144u, 4563u, { 143u, 132u, 0u, 160u, 201u, 180u, 213u, 12u } }; // idb
GUID stru_103F3CC = { 2108457479u, 54190u, 19573u, { 155u, 103u, 146u, 128u, 26u, 73u, 125u, 68u } }; // weak
GUID stru_103F3DC = { 3532602458u, 38452u, 16902u, { 165u, 9u, 71u, 117u, 82u, 238u, 251u, 16u } }; // weak
GUID stru_103F3EC = { 3133953933u, 64477u, 18596u, { 150u, 159u, 2u, 217u, 50u, 183u, 70u, 52u } }; // weak
GUID stru_103F3FC = { 827441293u, 19721u, 20379u, { 136u, 56u, 40u, 128u, 191u, 24u, 254u, 81u } }; // weak
GUID stru_103F40C =
{
  3882671458u,
  18253u,
  17613u,
  { 186u, 105u, 55u, 183u, 149u, 119u, 37u, 173u }
}; // weak
void *SymbolInfo::`vftable' = &sub_FC98D0; // weak
void *NativeFrame::`vftable' = &sub_FC98D0; // weak
void *CCorDebugDataTarget::`vftable' = &sub_FC9800; // weak
void *CCLRDebuggingLibraryProvider::`vftable' = &sub_FC9780; // weak
void *MixedModeStackWalker::`vftable' = &sub_FC9880; // weak
GUID stru_103FB98 =
{
  4261862440u,
  18939u,
  17974u,
  { 164u, 163u, 232u, 13u, 180u, 174u, 17u, 108u }
}; // weak
GUID stru_103FBA8 = { 1030709092u, 30008u, 4563u, { 141u, 91u, 0u, 16u, 75u, 53u, 231u, 239u } }; // weak
GUID stru_103FBB8 = { 65168145u, 20342u, 4563u, { 136u, 198u, 0u, 96u, 151u, 148u, 84u, 24u } }; // weak
GUID stru_103FBC8 = { 3106719735u, 40237u, 17860u, { 188u, 43u, 98u, 31u, 204u, 157u, 251u, 244u } }; // weak
GUID stru_103FBD8 =
{
  2275191818u,
  19027u,
  18024u,
  { 184u, 227u, 203u, 132u, 115u, 203u, 24u, 127u }
}; // weak
GUID stru_103FC40 = { 3229703132u, 53163u, 17534u, { 167u, 121u, 193u, 22u, 180u, 84u, 235u, 91u } }; // weak
GUID stru_103FC50 = { 4166274755u, 24142u, 18119u, { 141u, 62u, 165u, 43u, 132u, 5u, 177u, 245u } }; // weak
GUID stru_103FC60 = { 892903409u, 13956u, 19541u, { 162u, 238u, 33u, 15u, 38u, 198u, 14u, 94u } }; // weak
GUID stru_103FD30 = { 65168148u, 20342u, 4563u, { 136u, 198u, 0u, 96u, 151u, 148u, 84u, 24u } }; // weak
GUID stru_10400E0 = { 2659273389u, 12804u, 4562u, { 154u, 130u, 0u, 96u, 8u, 168u, 105u, 57u } }; // weak
NetworkMsgItem gNetworkMsgItem2[] =
{
  { 17040048, 1 },
  { 17040068, 2 },
  { 17040084, 3 },
  { 17040096, 4 },
  { 17040084, 3 },
  { 17040096, 4 },
  { 17040108, 5 },
  { 17040120, 6 },
  { 17040132, 7 },
  { 17038720, 8 },
  { 17038728, 12 },
  { 17038752, 13 },
  { 17038772, 14 },
  { 17038800, 15 },
  { 17038820, 16 },
  { 17038844, 17 },
  { 17038868, 18 },
  { 17038876, 19 },
  { 17038916, 20 },
  { 17038948, 9 },
  { 17038980, 10 },
  { 17039008, 11 },
  { 17039032, 21 },
  { 17039048, 22 },
  { 17039064, 23 },
  { 17039080, 24 },
  { 17039096, 25 },
  { 17039112, 26 },
  { 17039128, 27 },
  { 17039144, 28 },
  { 17039160, 29 },
  { 17039176, 30 },
  { 17039192, 31 },
  { 17039208, 32 },
  { 17039224, 33 },
  { 17039240, 34 },
  { 17039256, 35 },
  { 17039272, 36 },
  { 17039288, 37 },
  { 17039304, 38 },
  { 17039320, 39 },
  { 17039336, 40 },
  { 17039352, 41 },
  { 17039368, 42 },
  { 17039384, 43 },
  { 17039400, 44 },
  { 17039416, 45 },
  { 17039432, 46 },
  { 17039448, 47 },
  { 17039464, 48 },
  { 17039480, 49 },
  { 17039496, 50 },
  { 17039512, 51 },
  { 17039528, 52 },
  { 17039544, 53 },
  { 17039564, 54 }
}; // idb
OLECHAR strIn = 0u; // idb
NetworkMsgItem gNetworkMsgItem[] =
{
  { 17040592, 2 },
  { 17040604, 2 },
  { 17040624, 2 },
  { 17040644, 3 },
  { 17040656, 3 },
  { 17040676, 3 },
  { 17040696, 4 },
  { 17040712, 4 },
  { 17040736, 4 },
  { 17040760, 5 },
  { 17040776, 5 },
  { 17040800, 5 },
  { 17040824, 6 },
  { 17040848, 6 },
  { 17040880, 6 },
  { 17040912, 7 },
  { 17040932, 7 },
  { 17040960, 7 },
  { 17040988, 8 },
  { 17041012, 8 },
  { 17041044, 8 },
  { 17041076, 9 },
  { 17041092, 9 },
  { 17041116, 9 }
}; // idb
NetworkMsgItem gReadWriteMsgItem[3] = { { 17023612, 11 }, { 17023600, 10 }, { 17041172, 12 } }; // weak
wchar_t off_104421C = 77u; // idb
__int128 xmmword_1046C30 = 0x16000000150000000400000003i64; // weak
__int128 xmmword_1046C40 = 0x435000004440000041F00000434i64; // weak
__int128 xmmword_1046C50 = 0x4A4000004A2000004A0000004A5i64; // weak
__int128 xmmword_1046C60 = 0x53F000004440000041F00000434i64; // weak
RECT stru_1046C70 = { 0, 1072693248, 0, 1072693248 }; // weak
wchar_t off_1046EFC = 46u; // idb
__int128 xmmword_1047010 = 0x10000000100000000000000000i64; // weak
__int128 xmmword_1047624 = 0x4500520041005700540046004F0053i64; // weak
__int128 xmmword_1047634 = 0x730065007300730061006C0043005Ci64; // weak
__int128 xmmword_1047644 = 0x5C004400490053004C0043005Ci64; // weak
IID riid = { 799777991u, 19881u, 16403u, { 150u, 151u, 32u, 204u, 63u, 212u, 15u, 133u } }; // idb
_UNKNOWN unk_104776C; // weak
_UNKNOWN unk_104781C; // weak
_UNKNOWN unk_104783C; // weak
IID stru_10478CC = { 260519583u, 42213u, 19708u, { 189u, 62u, 115u, 230u, 21u, 69u, 114u, 221u } }; // idb
IID IID_IWbemLocator = { 3692209799u, 29567u, 4559u, { 136u, 77u, 0u, 170u, 0u, 75u, 46u, 36u } }; // idb
IID CLSID_WbemLocator = { 1167128593u, 7482u, 4560u, { 137u, 31u, 0u, 170u, 0u, 75u, 46u, 36u } }; // idb
IID CLSID_IShellLinkW = { 136441u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // idb
GUID CLSID_SID_STopLevelBrowser = { 1284947520u, 37212u, 4559u, { 153u, 211u, 0u, 170u, 0u, 74u, 232u, 55u } }; // idb
GUID CLSID_IPersistFile = { 267u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // weak
GUID CLSID_IShellItemImageFactory = { 3166800761u, 47638u, 17455u, { 128u, 196u, 138u, 89u, 195u, 12u, 70u, 59u } }; // weak
IID CLSID_ShellLink = { 136193u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // idb
IID CLSID_IXMLDOMDocument = { 691257217u, 31542u, 4562u, { 178u, 14u, 0u, 192u, 79u, 152u, 62u, 96u } }; // idb
IID CLSID_ShellWindows = { 2610977138u, 63144u, 4559u, { 164u, 66u, 0u, 160u, 201u, 10u, 143u, 57u } }; // idb
GUID CLSID_IUnknown = { 0u, 0u, 0u, { 192u, 0u, 0u, 0u, 0u, 0u, 0u, 70u } }; // weak
int (__thiscall *ATL::_com_error::`vftable')(void *, char) = &ATL::_com_error::`scalar deleting destructor'; // weak
void *std::bad_alloc::`vftable' = &sub_1004585; // weak
void *std::logic_error::`vftable' = &sub_10045AA; // weak
void *std::length_error::`vftable' = &sub_10045AA; // weak
void *std::out_of_range::`vftable' = &sub_10045AA; // weak
int dword_1047C10 = 5; // weak
_UNKNOWN unk_1047E68; // weak
GUID GUID_ATLVer110 =
{
  3544786984u,
  16696u,
  20436u,
  { 179u, 236u, 219u, 153u, 19u, 94u, 174u, 134u }
}; // weak
void *type_info::`vftable' = &sub_10089FA; // weak
void *std::exception::`vftable' = &sub_1009DCF; // weak
void *std::bad_cast::`vftable' = &sub_1009DCF; // weak
void *std::bad_exception::`vftable' = &sub_100B848; // weak
IID rclsid = { 4110913330u, 50513u, 4563u, { 137u, 185u, 0u, 0u, 248u, 31u, 226u, 33u } }; // idb
_UNKNOWN unk_104F88C; // weak
_UNKNOWN unk_104F894; // weak
int _TI2_AVruntime_error_std__ = 0; // weak
int _TI5_AVfailure_ios_base_std__ = 0; // weak
int _TI2_AVbad_cast_std__ = 0; // weak
int _TI1_AVCAtlException_ATL__ = 0; // weak
int _TI1J = 0; // weak
int _TI1_AV_com_error__ = 0; // weak
HKEY ghLocalMachineKey = (HKEY)0x80000002; // idb
HKEY ghCurrentUserKey = (HKEY)0x80000001; // idb
wchar_t *off_105AA18 = L"Task Scheduler"; // idb
OLECHAR *off_105AA1C = L"InprocServer32"; // idb
wchar_t *off_105AA2C = L"Task Scheduler"; // idb
DWORD gdwTimeout = 5000u; // idb
char bInited = '\x01'; // weak
int (__thiscall **off_105AA3C[3])(void *, char) =
{
  &std::_Generic_error_category::`vftable',
  &std::_Iostream_error_category::`vftable',
  &std::_System_error_category::`vftable'
}; // weak
int (__thiscall **off_105AA40[2])(void *, char) =
{
  &std::_Iostream_error_category::`vftable',
  &std::_System_error_category::`vftable'
}; // weak
int (__thiscall **off_105AA44)(void *, char) = &std::_System_error_category::`vftable'; // weak
GUID GUID_ActionID_0 = { 11191659u, 52548u, 4560u, { 140u, 194u, 0u, 192u, 79u, 194u, 149u, 238u } }; // idb
GUID GUID_ActionID = { 11191659u, 52548u, 4560u, { 140u, 194u, 0u, 192u, 79u, 194u, 149u, 238u } }; // idb
wchar_t aYouMustAgreeTo[175] = L"You must agree to the VirusTotal Terms of Service and Privacy Policy before\ncontinuing. A browser window will open to:\n\n     https://www.virustotal.com/about/terms-of-service"; // weak
WCHAR pConfigItem = 17056u; // idb
char *off_105C4C8[48] =
{
  "{\\rtf1\\ansi\\ansicpg1252\\deff0\\nouicompat\\deflang1033{\\fonttbl{\\f0\\fswiss\\fprq2\\fcharset0 Tahoma;}{\\f1\\fnil\\fcharset0 Calibri;}}",
  "{\\colortbl ;\\red0\\green0\\blue255;\\red0\\green0\\blue0;}",
  "{\\*\\generator Riched20 10.0.10240}\\viewkind4\\uc1 ",
  "\\pard\\brdrb\\brdrs\\brdrw10\\brsp20 \\sb120\\sa120\\b\\f0\\fs24 SYSINTERNALS SOFTWARE LICENSE TERMS\\fs28\\par",
  "\\pard\\sb120\\sa120\\b0\\fs19 These license terms are an agreement between Sysinternals (a wholly owned subsidiary of Microsoft Corporation) and you.  Please read them.  They apply to the software you are downloading from Systinternals.com, which includes the media on which you received it, if any.  The terms also apply to any Sysinternals\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\tx720\\'b7\\tab updates,\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\'b7\\tab supplements,\\par",
  "\\'b7\\tab Internet-based services, and \\par",
  "\\'b7\\tab support services\\par",
  "\\pard\\sb120\\sa120 for this software, unless other terms accompany those items.  If so, those terms apply.\\par",
  "\\b BY USING THE SOFTWARE, YOU ACCEPT THESE TERMS.  IF YOU DO NOT ACCEPT THEM, DO NOT USE THE SOFTWARE.\\par",
  "\\pard\\brdrt\\brdrs\\brdrw10\\brsp20 \\sb120\\sa120 If you comply with these license terms, you have the rights below.\\par",
  "\\pard\\fi-357\\li357\\sb120\\sa120\\tx360\\fs20 1.\\tab\\fs19 INSTALLATION AND USE RIGHTS.  \\b0 You may install and use any number of copies of the software on your devices.\\b\\par",
  "\\caps\\fs20 2.\\tab\\fs19 Scope of License\\caps0 .\\b0   The software is licensed, not sold. This agreement only gives you some rights to use the software.  Sysinternals reserves all other rights.  Unless applicable law gives you more rights despite this limitation, you may use the software only as expressly permitted in this agreement.  In doing so, you must comply with any technical limitations in the software that only allow you to use it in certain ways.    You may not\\b\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\tx720\\b0\\'b7\\tab work around any technical limitations in the binary versions of the software;\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\'b7\\tab reverse engineer, decompile or disassemble the binary versions of the software, except and only to the extent that applicable law expressly permits, despite this limitation;\\par",
  "\\'b7\\tab make more copies of the software than specified in this agreement or allowed by applicable law, despite this limitation;\\par",
  "\\'b7\\tab publish the software for others to copy;\\par",
  "\\'b7\\tab rent, lease or lend the software;\\par",
  "\\'b7\\tab transfer the software or this agreement to any third party; or\\par",
  "\\'b7\\tab use the software for commercial software hosting services.\\par",
  "\\pard\\fi-357\\li357\\sb120\\sa120\\tx360\\b\\fs20 3.\\tab SENSITIVE INFORMATION. \\b0  Please be aware that, similar to other debug tools that capture \\ldblquote process state\\rdblquote  information, files saved by Sysinternals tools may include personally identifiable or other sensitive information (such as usernames, passwords, paths to files accessed, and paths to registry accessed). By using this software, you acknowledge that you are aware of this and take sole responsibility for any personally identifiable or other sensitive information provided to Microsoft or any other party through your use of the software.\\b\\par",
  "5. \\tab\\fs19 DOCUMENTATION.\\b0   Any person that has valid access to your computer or internal network may copy and use the documentation for your internal, reference purposes.\\b\\par",
  "\\caps\\fs20 6.\\tab\\fs19 Export Restrictions\\caps0 .\\b0   The software is subject to United States export laws and regulations.  You must comply with all domestic and international export laws and regulations that apply to the software.  These laws include restrictions on destinations, end users and end use.  For additional information, see {\\cf1\\ul{\\field{\\*\\fldinst{HYPERLINK www.microsoft.com/exporting }}{\\fldrslt{www.microsoft.com/exporting}}}}\\cf1\\ul\\f0\\fs19  <{{\\field{\\*\\fldinst{HYPERLINK \"http://www.microsoft.com/exporting\"}}{\\fldrslt{http://www.microsoft.com/exporting}}}}\\f0\\fs19 >\\cf0\\ulnone .\\b\\par",
  "\\caps\\fs20 7.\\tab\\fs19 SUPPORT SERVICES.\\caps0  \\b0 Because this software is \"as is, \" we may not provide support services for it.\\b\\par",
  "\\caps\\fs20 8.\\tab\\fs19 Entire Agreement.\\b0\\caps0   This agreement, and the terms for supplements, updates, Internet-based services and support services that you use, are the entire agreement for the software and support services.\\par",
  "\\pard\\keepn\\fi-360\\li360\\sb120\\sa120\\tx360\\cf2\\b\\caps\\fs20 9.\\tab\\fs19 Applicable Law\\caps0 .\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\tx720\\cf0\\fs20 a.\\tab\\fs19 United States.\\b0   If you acquired the software in the United States, Washington state law governs the interpretation of this agreement and applies to claims for breach of it, regardless of conflict of laws principles.  The laws of the state where you live govern all other claims, including claims under state consumer protection laws, unfair competition laws, and in tort.\\b\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\fs20 b.\\tab\\fs19 Outside the United States.\\b0   If you acquired the software in any other country, the laws of that country apply.\\b\\par",
  "\\pard\\fi-357\\li357\\sb120\\sa120\\tx360\\caps\\fs20 10.\\tab\\fs19 Legal Effect.\\b0\\caps0   This agreement describes certain legal rights.  You may have other rights under the laws of your country.  You may also have rights with respect to the party from whom you acquired the software.  This agreement does not change your rights under the laws of your country if the laws of your country do not permit it to do so.\\b\\caps\\par",
  "\\fs20 11.\\tab\\fs19 Disclaimer of Warranty.\\caps0    \\caps The software is licensed \"as - is.\"  You bear the risk of using it.  SYSINTERNALS gives no express warranties, guarantees or conditions.  You may have additional consumer rights under your local laws which this agreement cannot change.  To the extent permitted under your local laws, SYSINTERNALS excludes the implied warranties of merchantability, fitness for a particular purpose and non-infringement.\\par",
  "\\pard\\fi-360\\li360\\sb120\\sa120\\tx360\\fs20 12.\\tab\\fs19 Limitation on and Exclusion of Remedies and Damages.  You can recover from SYSINTERNALS and its suppliers only direct damages up to U.S. $5.00.  You cannot recover any other damages, including consequential, lost profits, special, indirect or incidental damages.\\par",
  "\\pard\\li357\\sb120\\sa120\\b0\\caps0 This limitation applies to\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\tx720\\'b7\\tab anything related to the software, services, content (including code) on third party Internet sites, or third party programs; and\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\'b7\\tab claims for breach of contract, breach of warranty, guarantee or condition, strict liability, negligence, or other tort to the extent permitted by applicable law.\\par",
  "\\pard\\li360\\sb120\\sa120 It also applies even if Sysinternals knew or should have known about the possibility of the damages.  The above limitation or exclusion may not apply to you because your country may not allow the exclusion or limitation of incidental, consequential or other damages.\\par",
  "\\pard\\b Please note: As this software is distributed in Quebec, Canada, some of the clauses in this agreement are provided below in French.\\par",
  "\\pard\\sb240\\lang1036 Remarque : Ce logiciel \\'e9tant distribu\\'e9 au Qu\\'e9bec, Canada, certaines des clauses dans ce contrat sont fournies ci-dessous en fran\\'e7ais.\\par",
  "\\pard\\sb120\\sa120 EXON\\'c9RATION DE GARANTIE.\\b0  Le logiciel vis\\'e9 par une licence est offert \\'ab tel quel \\'bb. Toute utilisation de ce logiciel est \\'e0 votre seule risque et p\\'e9ril. Sysinternals n'accorde aucune autre garantie expresse. Vous pouvez b\\'e9n\\'e9ficier de droits additionnels en vertu du droit local sur la protection dues consommateurs, que ce contrat ne peut modifier. La ou elles sont permises par le droit locale, les garanties implicites de qualit\\'e9 marchande, d'ad\\'e9quation \\'e0 un usage particulier et d'absence de contrefa\\'e7on sont exclues.\\par",
  "\\pard\\keepn\\sb120\\sa120\\b LIMITATION DES DOMMAGES-INT\\'c9R\\'caTS ET EXCLUSION DE RESPONSABILIT\\'c9 POUR LES DOMMAGES.\\b0   Vous pouvez obtenir de Sysinternals et de ses fournisseurs une indemnisation en cas de dommages directs uniquement \\'e0 hauteur de 5,00 $ US. Vous ne pouvez pr\\'e9tendre \\'e0 aucune indemnisation pour les autres dommages, y compris les dommages sp\\'e9ciaux, indirects ou accessoires et pertes de b\\'e9n\\'e9fices.\\par",
  "\\lang1033 Cette limitation concerne :\\par",
  "\\pard\\keepn\\fi-360\\li720\\sb120\\sa120\\tx720\\lang1036\\'b7\\tab tout  ce qui est reli\\'e9 au logiciel, aux services ou au contenu (y compris le code) figurant sur des sites Internet tiers ou dans des programmes tiers ; et\\par",
  "\\pard\\fi-363\\li720\\sb120\\sa120\\tx720\\'b7\\tab les r\\'e9clamations au titre de violation de contrat ou de garantie, ou au titre de responsabilit\\'e9 stricte, de n\\'e9gligence ou d'une autre faute dans la limite autoris\\'e9e par la loi en vigueur.\\par",
  "\\pard\\sb120\\sa120 Elle s'applique \\'e9galement, m\\'eame si Sysinternals connaissait ou devrait conna\\'eetre l'\\'e9ventualit\\'e9 d'un tel dommage.  Si votre pays n'autorise pas l'exclusion ou la limitation de responsabilit\\'e9 pour les dommages indirects, accessoires ou de quelque nature que ce soit, il se peut que la limitation ou l'exclusion ci-dessus ne s'appliquera pas \\'e0 votre \\'e9gard.\\par",
  "\\b EFFET JURIDIQUE.\\b0   Le pr\\'e9sent contrat d\\'e9crit certains droits juridiques. Vous pourriez avoir d'autres droits pr\\'e9vus par les lois de votre pays.  Le pr\\'e9sent contrat ne modifie pas les droits que vous conf\\'e8rent les lois de votre pays si celles-ci ne le permettent pas.\\b\\par",
  "\\pard\\b0\\fs20\\lang1033\\par",
  "\\pard\\sa200\\sl276\\slmult1\\f1\\fs22\\lang9\\par",
  "}"
}; // weak
wchar_t *off_105C58C = L"SYSINTERNALS SOFTWARE LICENSE TERMS\nThese license terms are an agreement between Sysinternals(a wholly owned subsidiary of Microsoft Corporation) and you.Please read them.They apply to the software you are downloading from technet.microsoft.com / sysinternals, which includes the media on which you received it, if any.The terms also apply to any Sysinternals\n* updates,\n*supplements,\n*Internet - based services,\n*and support services\nfor this software, unless other terms accompany those items.If so, those terms apply.\nBY USING THE SOFTWARE, YOU ACCEPT THESE TERMS.IF YOU DO NOT ACCEPT THEM, DO NOT USE THE SOFTWARE.\n\nIf you comply with these license terms, you have the rights below.\nINSTALLATION AND USER RIGHTS\nYou may install and use any number of copies of the software on your devices.\n\nSCOPE OF LICENSE\nThe software is licensed, not sold.This agreement only gives you some rights to use the software.Sysinternals reserves all other rights.Unless applicable law gives you more rights despite this limitation, you may use the software only as expressly permitted in this agreement.In doing so, you must comply with any technical limitations in the software that only allow you to use it in certain ways.You may not\n* work around any technical limitations in the software;\n*reverse engineer, decompile or disassemble the software, except and only to the extent that applicable law expressly permits, despite this limitation;\n*make more copies of the software than specified in this agreement or allowed by applicable law, despite this limitation;\n*publish the software for others to copy;\n*rent, lease or lend the software;\n*transfer the software or this agreement to any third party; or\n* use the software for commercial software hosting services.\n\nSENSITIVE INFORMATION\nPlease be aware that, similar to other debug tools that capture "; // idb
tagMSGHANDLER CAboutDlg::gMsgHandler = { 2u, &dword_105C590, 0 }; // idb
struct tagMSGHANDLER CAboutDlg::gCmdHandler = { 2u, &dword_105C5AC, 0 }; // weak
int dword_105C5C8 = 131072; // weak
void *off_105CB88 = &dword_105C628; // weak
int dword_105CB8C[] = { 11 }; // weak
wchar_t *off_105CB90 = L"File"; // weak
GENERIC_MAPPING GenericMapping = { 1179785u, 1179926u, 1179808u, 2032127u }; // idb
GENERIC_MAPPING stru_105CC38 = { 136208u, 132075u, 1179648u, 2035711u }; // idb
GENERIC_MAPPING stru_105CC48 = { 133960u, 132274u, 1179648u, 2032639u }; // idb
GENERIC_MAPPING stru_105CC58 = { 131213u, 131074u, 131440u, 983551u }; // idb
GUID *off_105CC68 = &stru_1047BAC; // weak
GUID *off_105CCD8 = &stru_1047BAC; // weak
GUID *off_105CE08 = &stru_1047BAC; // weak
GUID *off_105CF18 = &stru_1047BAC; // weak
GUID *off_105D008 = &stru_1047BAC; // weak
GUID *off_105D098 = &stru_1047BAC; // weak
GUID *off_105D0E8 = &stru_1047BAC; // weak
_UNKNOWN unk_105D0F8; // weak
_UNKNOWN unk_105D110; // weak
int dword_105D130 = 1; // weak
_UNKNOWN unk_105D150; // weak
_UNKNOWN unk_105D178; // weak
tagCOLUMNKEYITEM gProcessColumns[] = ;
__int16 word_105D1F2[] = { 40 }; // idb
tagCOLUMNKEYITEM gHandleColumns[] = { { 21u, 100u }, { 22u, 450u } };
tagCOLUMNKEYITEM gDllColumns[] = { { 26u, 110u }, { 42u, 180u }, { 1033u, 140u }, { 1111u, 300u } };
WPARAM wParam = 1u; // idb
char byte_105D224 = '\x01'; // weak
char byte_105D225 = '\x01'; // weak
CHAR *gszProtocolNames[] = { "TCP" };
wchar_t *gszNetStatus[13] =
{
  L"???",
  L"CLOSED",
  L"LISTENING",
  L"SYN_SENT",
  L"SYN_RCVD",
  L"ESTABLISHED",
  L"FIN_WAIT1",
  L"FIN_WAIT2",
  L"CLOSE_WAIT",
  L"CLOSING",
  L"LAST_ACK",
  L"TIME_WAIT",
  L"DELETE_TCB"
}; // weak
wchar_t aPsprotectedsig[448] =
{
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  78u,
  111u,
  110u,
  101u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  65u,
  117u,
  116u,
  104u,
  101u,
  110u,
  116u,
  105u,
  99u,
  111u,
  100u,
  101u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  67u,
  111u,
  100u,
  101u,
  71u,
  101u,
  110u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  65u,
  110u,
  116u,
  105u,
  109u,
  97u,
  108u,
  119u,
  97u,
  114u,
  101u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  76u,
  115u,
  97u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  87u,
  105u,
  110u,
  100u,
  111u,
  119u,
  115u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  80u,
  115u,
  80u,
  114u,
  111u,
  116u,
  101u,
  99u,
  116u,
  101u,
  100u,
  83u,
  105u,
  103u,
  110u,
  101u,
  114u,
  87u,
  105u,
  110u,
  84u,
  99u,
  98u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // idb
int dword_105D5F0[] = { 3 }; // weak
int dword_105D798[] = { 1094 }; // weak
int dword_105D7DC[] = { 20 }; // weak
int dword_105D7F8[] = { 23 }; // weak
tagConfigItem gConfigItems[64] =
{
  { L"Windowplacement", KT_Structure, 44u, &gConfig, {  0.0 } },
  { L"FindWindowplacement", KT_Structure, 44u, (PVOID)0x10653E4, {  0.0 } },
  { L"SysinfoWindowplacement", KT_Structure, 44u, (PVOID)0x1065468, {  0.0 } },
  { L"PropWindowplacement", KT_Structure, 44u, (PVOID)0x1065410, {  0.0 } },
  { L"DllPropWindowplacement", KT_Structure, 44u, (PVOID)0x106543C, {  0.0 } },
  { L"UnicodeFont", KT_Structure, 92u, (PVOID)0x10654C0, {  0.0 } },
  { L"Divider", KT_Double, 0u, (PVOID)0x1065520, {  0.5 } },
  { L"SavedDivider", KT_Double, 0u, (PVOID)0x1065528, {  0.5 } },
  { L"ProcessColumns", KT_ShortArray, 192u, (PVOID)0x1065748, {  0.0 } },
  { L"ProcessImageColumnWidth", KT_Short, 2u, (PVOID)0x1065740, {  200.0 } },
  { L"HandleColumns", KT_ShortArray, 64u, (PVOID)0x1065998, {  0.0 } },
  { L"DllColumns", KT_ShortArray, 64u, (PVOID)0x1065A64, {  0.0 } },
  { L"ShowUnnamedHandles", KT_Bool, 0u, (PVOID)0x10696CA, {  0.0 } },
  { L"ShowDllView", KT_Bool, 0u, (PVOID)0x10696CC, {  0.0 } },
  { L"HandleSortColumn", KT_None, 0u, (PVOID)0x1065B24, {  0.0 } },
  { L"HandleSortDirection", KT_Bool, 0u, (PVOID)0x1065B28, {  1.0 } },
  { L"DllSortColumn", KT_None, 0u, (PVOID)0x1065A58, {  0.0 } },
  { L"DllSortDirection", KT_Bool, 0u, (PVOID)0x1065A5C, {  1.0 } },
  { L"ProcessSortColumn", KT_None, 0u, (PVOID)0x1065988, {  4.294967295e9 } },
  { L"ProcessSortDirection", KT_Bool, 0u, (PVOID)0x106598C, {  1.0 } },
  { L"HighlightServices", KT_Bool, 0u, (PVOID)0x10696B9, {  1.0 } },
  { L"HighlightOwnProcesses", KT_Bool, 0u, (PVOID)0x10696BA, {  1.0 } },
  { L"HighlightRelocatedDlls", KT_Bool, 0u, (PVOID)0x10696CE, {  0.0 } },
  { L"HighlightJobs", KT_Bool, 0u, (PVOID)0x10696B8, {  0.0 } },
  { L"HighlightNewProc", KT_Bool, 0u, (PVOID)0x10696BC, {  1.0 } },
  { L"HighlightDelProc", KT_Bool, 0u, (PVOID)0x10696BD, {  1.0 } },
  { L"HighlightImmersive", KT_Bool, 0u, (PVOID)0x10696BF, {  1.0 } },
  { L"HighlightProtected", KT_Bool, 0u, (PVOID)0x10696C1, {  0.0 } },
  { L"HighlightPacked", KT_Bool, 0u, (PVOID)0x10696BE, {  1.0 } },
  { L"HighlightNetProcess", KT_Bool, 0u, (PVOID)0x10696BB, {  0.0 } },
  { L"HighlightSuspend", KT_Bool, 0u, (PVOID)0x10696C0, {  1.0 } },
  { L"HighlightDuration", KT_None, 0u, (PVOID)0x1065534, {  1000.0 } },
  { L"ShowCpuFractions", KT_Bool, 0u, (PVOID)0x10696C9, {  1.0 } },
  { L"ShowLowerpane", KT_Bool, 0u, (PVOID)0x10696CD, {  0.0 } },
  { L"ShowAllUsers", KT_Bool, 0u, (PVOID)0x10696D0, {  1.0 } },
  { L"ShowProcessTree", KT_Bool, 0u, (PVOID)0x1065742, {  1.0 } },
  { L"SymbolWarningShown", KT_Bool, 0u, (PVOID)0x10698FC, {  0.0 } },
  { L"HideWhenMinimized", KT_Bool, 0u, (PVOID)0x10696D1, {  0.0 } },
  { L"AlwaysOntop", KT_Bool, 0u, (PVOID)0x10696D2, {  0.0 } },
  { L"OneInstance", KT_Bool, 0u, (PVOID)0x10696D3, {  0.0 } },
  { L"NumColumnSets", KT_None, 0u, (PVOID)0x1065B2C, {  0.0 } },
  { L"ConfirmKill", KT_Bool, 0u, (PVOID)0x10696D4, {  1.0 } },
  { L"RefreshRate", KT_None, 0u, (PVOID)0x1065530, {  1000.0 } },
  { L"PrcessColumnCount", KT_None, 0u, (PVOID)0x1065744, {  6.0 } },
  { L"ProcessColumnMap", KT_LongArray, 384u, (PVOID)0x1065808, {  0.0 } },
  { L"DllColumnCount", KT_None, 0u, (PVOID)0x1065A60, {  4.0 } },
  { L"DllColumnMap", KT_LongArray, 128u, (PVOID)0x10659D8, {  0.0 } },
  { L"HandleColumnCount", KT_None, 0u, (PVOID)0x1065994, {  2.0 } },
  { L"HandleColumnMap", KT_LongArray, 128u, (PVOID)0x1065AA4, {  0.0 } },
  { L"DefaultProcPropPage", KT_None, 0u, (PVOID)0x10696E8, {  0.0 } },
  { L"DefaultSysInfoPage", KT_None, 0u, (PVOID)0x10696F0, {  0.0 } },
  { L"DefaultDllPropPage", KT_None, 0u, (PVOID)0x10696EC, {  0.0 } },
  { L"DbgHelpPath", KT_String, 520u, (PVOID)0x10696F4, {  0.0 } },
  { L"SymbolPath", KT_String, 520u, (PVOID)0x10698FE, {  0.0 } },
  { L"ColorPacked", KT_None, 0u, (PVOID)0x1069B24, {  1.6711808e7 } },
  { L"ColorImmersive", KT_None, 0u, (PVOID)0x1069B2C, {  1.5395328e7 } },
  { L"ColorOwn", KT_None, 0u, (PVOID)0x1069B08, {  1.6765136e7 } },
  { L"ColorServices", KT_None, 0u, (PVOID)0x1069B0C, {  1.3684991e7 } },
  { L"ColorRelocatedDlls", KT_None, 0u, (PVOID)0x1069B10, {  1.0551295e7 } },
  { L"ColorGraphBk", KT_None, 0u, (PVOID)0x1069B28, {  0.0 } },
  { NULL, KT_None, 0u, NULL, {  0.0 } },
  { NULL, KT_None, 0u, NULL, {  0.0 } },
  { NULL, KT_None, 0u, NULL, {  0.0 } },
  { NULL, KT_None, 0u, NULL, {  0.0 } }
};
tagConfigItem stru_105DDD8 = { L"ColorGraphBk", KT_None, 0u, (PVOID)0x1069B28, {  0.0 } }; // weak
tagConfigItem stru_105DDF0 = { NULL, KT_None, 0u, NULL, {  0.0 } }; // weak
void *off_105DE08 = NULL; // weak
int dword_105DE0C = 0; // weak
int dword_105DE10 = 0; // weak
int dword_105DE14 = 0; // weak
double dbl_105DE18 =  0.0; // weak
void *off_105DE20 = NULL; // weak
int dword_105DE24 = 0; // weak
int dword_105DE28 = 0; // weak
int dword_105DE2C = 0; // weak
double dbl_105DE30 =  0.0; // weak
void *off_105DE38 = NULL; // weak
int dword_105DE3C = 0; // weak
int dword_105DE40 = 0; // weak
int dword_105DE44 = 0; // weak
__int64 qword_105DE48 = 0i64; // weak
int dword_105DE50 = 0; // weak
int dword_105DE54 = 0; // weak
int dword_105DE58 = 0; // weak
int dword_105DE5C = 0; // weak
__int64 qword_105DE60 = 0i64; // weak
int dword_105DE68 = 0; // weak
int dword_105DE6C = 0; // weak
int dword_105DE70 = 0; // weak
int dword_105DE74 = 0; // weak
__int64 qword_105DE78 = 0i64; // weak
int dword_105DE80 = 0; // weak
int dword_105DE84 = 0; // weak
int dword_105DE88 = 0; // weak
int dword_105DE8C = 0; // weak
__int64 qword_105DE90 = 0i64; // weak
int dword_105DE98 = 0; // weak
int dword_105DE9C = 0; // weak
int dword_105DEA0 = 0; // weak
int dword_105DEA4 = 0; // weak
__int64 qword_105DEA8 = 0i64; // weak
int dword_105DEB0 = 0; // weak
int dword_105DEB4 = 0; // weak
int dword_105DEB8 = 0; // weak
int dword_105DEBC = 0; // weak
__int64 qword_105DEC0 = 0i64; // weak
int dword_105DEC8 = 0; // weak
int dword_105DECC = 0; // weak
int dword_105DED0 = 0; // weak
int dword_105DED4 = 0; // weak
__int64 qword_105DED8 = 0i64; // weak
int dword_105DEE0 = 0; // weak
int dword_105DEE4 = 0; // weak
int dword_105DEE8 = 0; // weak
int dword_105DEEC = 0; // weak
__int64 qword_105DEF0 = 0i64; // weak
int dword_105DEF8 = 0; // weak
int dword_105DEFC = 0; // weak
int dword_105DF00 = 0; // weak
int dword_105DF04 = 0; // weak
__int64 qword_105DF08 = 0i64; // weak
int dword_105DF10 = 0; // weak
int dword_105DF14 = 0; // weak
int dword_105DF18 = 0; // weak
int dword_105DF1C = 0; // weak
__int64 qword_105DF20 = 0i64; // weak
int dword_105DF28 = 0; // weak
int dword_105DF2C = 0; // weak
int dword_105DF30 = 0; // weak
int dword_105DF34 = 0; // weak
__int64 qword_105DF38 = 0i64; // weak
int dword_105DF40 = 0; // weak
int dword_105DF44 = 0; // weak
int dword_105DF48 = 0; // weak
int dword_105DF4C = 0; // weak
__int64 qword_105DF50 = 0i64; // weak
int dword_105DF58 = 0; // weak
int dword_105DF5C = 0; // weak
int dword_105DF60 = 0; // weak
int dword_105DF64 = 0; // weak
__int64 qword_105DF68 = 0i64; // weak
int dword_105DF70 = 0; // weak
int dword_105DF74 = 0; // weak
int dword_105DF78 = 0; // weak
int dword_105DF7C = 0; // weak
__int64 qword_105DF80 = 0i64; // weak
int dword_105DF88 = 0; // weak
int dword_105DF8C = 0; // weak
int dword_105DF90 = 0; // weak
int dword_105DF94 = 0; // weak
__int64 qword_105DF98 = 0i64; // weak
int dword_105DFA0 = 0; // weak
int dword_105DFA4 = 0; // weak
int dword_105DFA8 = 0; // weak
int dword_105DFAC = 0; // weak
__int64 qword_105DFB0 = 0i64; // weak
int dword_105DFB8 = 0; // weak
int dword_105DFBC = 0; // weak
int dword_105DFC0 = 0; // weak
int dword_105DFC4 = 0; // weak
__int64 qword_105DFC8 = 0i64; // weak
int dword_105DFD0 = 0; // weak
int dword_105DFD4 = 0; // weak
int dword_105DFD8 = 0; // weak
int dword_105DFDC = 0; // weak
__int64 qword_105DFE0 = 0i64; // weak
int dword_105DFE8 = 0; // weak
int dword_105DFEC = 0; // weak
int dword_105DFF0 = 0; // weak
int dword_105DFF4 = 0; // weak
__int64 qword_105DFF8 = 0i64; // weak
int dword_105E000 = 0; // weak
int dword_105E004 = 0; // weak
int dword_105E008 = 0; // weak
int dword_105E00C = 0; // weak
__int64 qword_105E010 = 0i64; // weak
int dword_105E018 = 0; // weak
int dword_105E01C = 0; // weak
int dword_105E020 = 0; // weak
int dword_105E024 = 0; // weak
__int64 qword_105E028 = 0i64; // weak
int dword_105E030 = 0; // weak
int dword_105E034 = 0; // weak
int dword_105E038 = 0; // weak
int dword_105E03C = 0; // weak
__int64 qword_105E040 = 0i64; // weak
int dword_105E048 = 0; // weak
int dword_105E04C = 0; // weak
int dword_105E050 = 0; // weak
int dword_105E054 = 0; // weak
__int64 qword_105E058 = 0i64; // weak
int dword_105E060 = 0; // weak
int dword_105E064 = 0; // weak
int dword_105E068 = 0; // weak
int dword_105E06C = 0; // weak
__int64 qword_105E070 = 0i64; // weak
int dword_105E078 = 0; // weak
int dword_105E07C = 0; // weak
int dword_105E080 = 0; // weak
int dword_105E084 = 0; // weak
__int64 qword_105E088 = 0i64; // weak
int dword_105E090 = 0; // weak
int dword_105E094 = 0; // weak
int dword_105E098 = 0; // weak
int dword_105E09C = 0; // weak
__int64 qword_105E0A0 = 0i64; // weak
wchar_t *off_105E0BC[5] =
{
  L"SeShutdownPrivilege",
  L"SeChangeNotifyPrivilege",
  L"SeUndockPrivilege",
  L"SeIncreaseWorkingSetPrivilege",
  L"SeTimeZonePrivilege"
}; // weak
int dword_105E0D0 = 32; // weak
int dword_105E0D8 = 4294967295; // weak
int dword_105E0DC = 1; // weak
wchar_t gszLocaleInfo = 46u; // idb
int gdwProcessId_0 = 4294967295; // weak
char byte_105E104 = '\x01'; // weak
int gdwMenuItemPosLast = 14; // idb
int gdwRefreshMenuIDLast = 4294967295; // weak
tagMSGHANDLER CMainWnd::gMsgHandler = { 34u, &dword_105E3B0, 1 }; // idb
struct tagMSGHANDLER CMainWnd::gCmdHandler = { 126u, &dword_105E4C0, 1 }; // weak
int gdwMenuItemCountAppendedInRuntime = 5; // idb
wchar_t aActive[7] = L"Active"; // weak
char byte_105E8B0 = '\x01'; // weak
wchar_t aExecutive[10] = L"Executive"; // weak
wchar_t aObject_0[7] = L"Object"; // weak
wchar_t aSpecialAccess[18] = L"Special Access..."; // weak
struct _ACLHELPCONTROL HelpInfo = { L"procexp.hlp", 1u, 1u, 2u, 2147483648u, 0u, 17049280u, 2u }; // idb
int dword_105FED0 = 2; // weak
_ACLEDITENTRY stru_105FFB0[22] =
{
  { 2u, 2147483648u, 0u, L"&Read (R)" },
  { 2u, 1073741824u, 0u, L"&Write (W)" },
  { 2u, 536870912u, 0u, L"E&xecute (X)" },
  { 2u, 16777216u, 0u, L"&View/Change Audits (A)" },
  { 2u, 65536u, 0u, L"&Delete (D)" },
  { 2u, 262144u, 0u, L"Change &Permissions (P)" },
  { 2u, 524288u, 0u, L"Take &Ownership (O)" },
  { 2u, 1u, 0u, L"&List (L)" },
  { 2u, 2u, 0u, L"Add &Entry (N)" },
  { 2u, 131072u, 0u, L"Read &Control (T)" },
  { 3u, 0u, 0u, L"No Access" },
  { 3u, 131073u, 4294967295u, L"List" },
  { 3u, 2684354560u, 2684354560u, L"Read" },
  { 3u, 1610612736u, 4294967295u, L"Add" },
  { 3u, 3758096384u, 2684354560u, L"Add Read" },
  { 3u, 3758161920u, 3758161920u, L"Change" },
  { 3u, 268435456u, 268435456u, L"Full Control" },
  { 4u, 2147483648u, 0u, L"Read" },
  { 4u, 1073741824u, 0u, L"Write" },
  { 4u, 65536u, 0u, L"Delete (D)" },
  { 4u, 262144u, 0u, L"Change Permissions (P)" },
  { 4u, 524288u, 0u, L"Take Ownership (O)" }
}; // weak
_ACLEDITENTRY stru_1060110[11] =
{
  { 2u, 65536u, 0u, L"&Delete (D)" },
  { 2u, 262144u, 0u, L"Change &Permissions (P)" },
  { 2u, 524288u, 0u, L"Take &Ownership (O)" },
  { 2u, 16777216u, 0u, L"&View/Change Audits (A)" },
  { 2u, 131072u, 0u, L"&Read (R)" },
  { 2u, 2u, 0u, L"&Write (W)" },
  { 1u, 0u, 0u, L"No Access" },
  { 1u, 2147483648u, 0u, L"Read" },
  { 1u, 1073741824u, 0u, L"Write" },
  { 1u, 3758161920u, 0u, L"Change" },
  { 1u, 268435456u, 0u, L"Full Control" }
}; // weak
_ACLEDITENTRY stru_10601C0[12] =
{
  { 2u, 1u, 0u, L"&Query Value" },
  { 2u, 2u, 0u, L"&Set Value" },
  { 2u, 4u, 0u, L"&Create Subkeys" },
  { 2u, 8u, 0u, L"&Enumerate Subkeys" },
  { 2u, 16u, 0u, L"No&tify" },
  { 2u, 32u, 0u, L"Create &Link" },
  { 2u, 65536u, 0u, L"&Delete" },
  { 2u, 262144u, 0u, L"&Write DAC" },
  { 2u, 524288u, 0u, L"Write &Owner" },
  { 2u, 131072u, 0u, L"&Read Control" },
  { 1u, 8217u, 0u, L"Read" },
  { 1u, 268435456u, 0u, L"Full Control" }
}; // weak
_ACLEDITENTRY aclEditEntryFile[7] =
{
  { 5u, 131072u, 0u, L"&Read (R)" },
  { 5u, 1048576u, 0u, L"&Sychronize (S)" },
  { 5u, 65536u, 0u, L"&Delete (D)" },
  { 5u, 262144u, 0u, L"Change &Permissions (P)" },
  { 5u, 524288u, 0u, L"Change &Owner (O)" },
  { 5u, 1u, 0u, L"&Query State (Q)" },
  { 5u, 2u, 0u, L"&Modify State (M)" }
}; // weak
int AccessMasks[4] = { 1179785, 1179926, 1179808, 2032127 }; // weak
int RegistryAccessMasks[4] = { 1179673, 131078, 131097, 983103 }; // weak
HANDLE ghDriverHandle = (HANDLE)0xFFFFFFFF; // idb
HANDLE hSnapshot = (HANDLE)0xFFFFFFFF; // idb
DWORD gdwProcessIdSelected = 4294967294u; // idb
RegItem stru_1060320[4] =
{
  {
    5374044,
    {
      69,
      0,
      71,
      0,
      73,
      0,
      83,
      0,
      84,
      0,
      82,
      0,
      89,
      0,
      92,
      0,
      85,
      0,
      83,
      0,
      69,
      0,
      82,
      0,
      92,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      72,
      0,
      75,
      0,
      67,
      0,
      85,
      0
    },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    0,
    0,
    0
  },
  {
    4915272,
    {
      85,
      0,
      92,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      72,
      0,
      75,
      0,
      67,
      0,
      85,
      0
    },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    0,
    0,
    0
  },
  {
    5374044,
    {
      69,
      0,
      71,
      0,
      73,
      0,
      83,
      0,
      84,
      0,
      82,
      0,
      89,
      0,
      92,
      0,
      85,
      0,
      83,
      0,
      69,
      0,
      82,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      72,
      0,
      75,
      0,
      85,
      0,
      0,
      0
    },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    0,
    0,
    0
  },
  {
    5374044,
    {
      69,
      0,
      71,
      0,
      73,
      0,
      83,
      0,
      84,
      0,
      82,
      0,
      89,
      0,
      92,
      0,
      77,
      0,
      65,
      0,
      67,
      0,
      72,
      0,
      73,
      0,
      78,
      0,
      69,
      0,
      92,
      0,
      83,
      0,
      89,
      0,
      83,
      0,
      84,
      0,
      69,
      0,
      77,
      0,
      92,
      0,
      67,
      0,
      85,
      0,
      82,
      0,
      82,
      0,
      69,
      0,
      78,
      0,
      84,
      0,
      67,
      0,
      79,
      0,
      78,
      0,
      84,
      0,
      82,
      0,
      79,
      0,
      76,
      0,
      83,
      0,
      69,
      0,
      84,
      0,
      92,
      0,
      72,
      0,
      65,
      0,
      82,
      0,
      68,
      0,
      87,
      0,
      65,
      0,
      82,
      0,
      69,
      0,
      32,
      0,
      80,
      0,
      82,
      0,
      79,
      0,
      70,
      0,
      73,
      0,
      76,
      0,
      69,
      0,
      83,
      0,
      92,
      0,
      67,
      0,
      85,
      0,
      82,
      0,
      82,
      0,
      69,
      0,
      78,
      0,
      84,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      0,
      72,
      0,
      75,
      0,
      67,
      0,
      67,
      0
    },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    { 0, 0, 0, 0 },
    0,
    0,
    0
  }
}; // weak
int gdwValue_4F10B8[3] = { 4294967294, 4294967294, 4294967295 }; // weak
size_t gdwSystemHandleInfoLength = 65536u; // idb
int dword_10610C8 = 1; // weak
PSECURITY_DESCRIPTOR pSID = &dword_106B208; // idb
PSECURITY_DESCRIPTOR ObjectSecurity = &dword_106D208; // idb
int dword_10610D4 = 4294967295; // weak
char byte_10610D8 = '\x01'; // weak
int dword_10610DC = 1; // weak
int gdwFindReplaceFlags = 1; // weak
WPARAM gnColumnSortedInFindDlg = 1u; // idb
int dword_10610E8 = 4294967295; // weak
int dword_10610EC = 4294967295; // weak
int dword_10610F0 = 4294967295; // weak
int dword_10610F4 = 4294967295; // weak
int dword_10610F8 = 4294967295; // weak
int dword_10610FC = 4294967295; // weak
int dword_1061100 = 4294967295; // weak
int dword_1061104 = 4294967295; // weak
__int64 qword_1061108 = -4616189618054758400i64; // weak
__int64 qword_1061110 = -4616189618054758400i64; // weak
__int64 qword_1061118 = -4616189618054758400i64; // weak
__int64 qword_1061120 = -4616189618054758400i64; // weak
__int64 qword_1061128 = -4616189618054758400i64; // weak
__int64 qword_1061130 = -4616189618054758400i64; // weak
wchar_t aYouMustAgreeTo_2[298] = L"You must agree to VirusTotal's terms of service to use VirusTotal features.\n\nWhen you do, Process Explorer will submit hashes for files listed in the process and DLL view to VirusTotal.com. You can submit a file's contents by using the Submit button on the process and DLL properties dialog boxes."; // weak
int (__cdecl *ATL::_com_error::_com_error)(_DWORD, _DWORD) = &sub_1004240; // weak
VARIANTARG pvarg = { { { 10u, 0u, 0u, 0u, { ?flt } } } }; // idb
_UNKNOWN unk_10613A0; // weak
int __security_cookie = 3141592654; // weak
void *off_1061568 = &unk_1086A60; // weak
DWORD dwTlsIndex = 4294967295u; // idb
HANDLE hObject = (HANDLE)0xFFFFFFFE; // idb
int dword_1062430 = 28800; // weak
int dword_1062434 = 1; // weak
int dword_1062438 = 4294963696; // weak
void *off_10624C0 = &unk_1062440; // weak
int dword_1062568 = 1024; // weak
int dword_106256C = 4294966273; // weak
int dword_1062570 = 53; // weak
int dword_1062574 = 11; // weak
int dword_1062578 = 64; // weak
int dword_106257C = 1023; // weak
int dword_1062580 = 128; // weak
int dword_1062584 = 4294967169; // weak
int dword_1062588 = 24; // weak
int dword_106258C = 8; // weak
int dword_1062590 = 32; // weak
int dword_1062594 = 127; // weak
HANDLE hConsoleOutput = (HANDLE)0xFFFFFFFE; // idb
int gbFlagsInSub_40B220 = 0; // weak
tagAccountInfo *gpAccountInfo = NULL;
char byte_10631C9 = '\0'; // weak
char gbRestorePrivilegeFailed = '\0'; // weak
DWORD gdwTlsIndex = 0u; // idb
int dword_10631D8 = 0; // weak
int (__stdcall *NtDeleteKey)(HANDLE KeyHandle) = NULL;
int (__stdcall *NtOpenKey)(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes) = NULL;
int (__stdcall *RtlNtStatusToDosError)(LONG Status) = NULL;
int (__stdcall *NtCreateKey)(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, ULONG TitleIndex, PUNICODE_STRING Class, ULONG CreateOptions, PULONG Disposition) = NULL;
BOOLEAN (__stdcall *Wow64EnableWow64FsRedirection)(BOOLEAN) = NULL;
SystemDirInfo gSystemDirInfo = { { 0, 0, 0, 0,  } };
BOOL (__stdcall *Wow64DisableWow64FsRedirection)(PVOID *OldValue);
int (__stdcall *Wow64RevertWow64FsRedirection)(PVOID OldValue);
int dword_1063628[140]; // weak
int dword_1063858; // weak
char byte_1063860; // weak
HANDLE ghAppToken; // idb
WCHAR gszWindowsDirectory[260];
WCHAR gszProgramW6432EnvValue[260];
WCHAR gszProgameFilesX86EnvValueValue[260];
int dword_10648D4; // weak
int gdwFlags; // weak
wchar_t *gpszSystemPathInfo; // idb
void *dword_4F48E4; // idb
int ghWaitCursor; // weak
int ghHandCursor; // weak
void *dword_4F48F0; // idb
void *dword_10648F4; // idb
void *dword_10648F8; // idb
void *dword_4F48FC; // idb
__int16 word_1064900[400]; // weak
std__vector garrAccountInfo;
void *gpszTipText; // idb
std__tree gKeyNameMap; // idb
int (__stdcall *GetLongPathNameW_0)(_DWORD, _DWORD, _DWORD); // weak
int dword_1064C40; // weak
const WCHAR gpszText1; // idb
int dword_1064C48; // weak
int dword_1064C4C; // weak
WCHAR *dword_4F4C50; // idb
void *dword_4F4C54; // idb
char byte_1064C58; // weak
int (__stdcall *QueryServiceConfig2W_0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *IsWow64Process)(_DWORD, _DWORD); // weak
int dword_1064C68; // weak
int (__stdcall *GetSystemDefaultLocaleName)(_DWORD, _DWORD); // weak
int (__stdcall *GetUserDefaultLocaleName)(_DWORD, _DWORD); // weak
int (__stdcall *SHCreateItemFromParsingName)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
int dword_1064C78; // weak
struct _RTL_CRITICAL_SECTION CriticalSection; // idb
struct _RTL_CRITICAL_SECTION stru_1064C98; // idb
HANDLE dword_1064CB8; // idb
HANDLE hEvent; // idb
char byte_1064CCC; // weak
char byte_1064CCD; // weak
int dword_1064CD0; // weak
std__List gList5; // weak
std__List gList6; // weak
void *gMap5; // idb
void *gList2; // idb
void *gList1; // idb
void *gList3; // idb
tagStreamThreadInfo *gpStreamThreadInfo;
void *gMap6; // idb
struct CommandLineEventConsumer gCommandLineEventConsumer; // weak
struct ActiveScriptEventConsumer gActiveScriptEventConsumer; // weak
int dword_1064D34; // weak
char byte_1064D7C; // weak
HMODULE ghUxthemeModule; // idb
int (__stdcall *gpfnIsThemeActive)(); // weak
int (__stdcall *gpfnOpenThemeData)(_DWORD, _DWORD); // idb
int (__stdcall *gpfnDrawThemeBackground)(HTHEME hTheme, HDC hdc, int iPartId, int iStateId, LPCRECT pRect, LPCRECT pClipRect);
int (__stdcall *gpfnCloseThemeData)(_DWORD); // idb
tagLogPixelSize gLogPixelSize;
__int16 gAtomTreeList; // weak
__int16 gAtomTreeListProperty; // weak
HGDIOBJ ghDarkShadowPen; // idb
int dword_1064DA8; // weak
HGDIOBJ ghBlackPen; // idb
char byte_1064DB0; // weak
int dword_1064DB4; // weak
HWND ghWndAddressInAbout; // idb
int gbIndirectFontCreated; // weak
int ghDefaultGuiFont; // weak
HGDIOBJ ghIndirectFontCreated; // idb
HCURSOR ghHandArrow; // idb
HCURSOR ghCursorArrow; // idb
int dword_1064DD0; // weak
struct _RTL_CRITICAL_SECTION gBstrListLock; // idb
int *gBstrList;
char byte_1064DF4; // weak
CWin32Heap strHeap;
int ATL::CAtlStringMgr::sbInited; // weak
CAtlStringMgr strMgr;
int (__cdecl *EnableTraceEx)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // idb
int gdwVirtualScreenWidth; // weak
DWORD (__stdcall *gpfnRtlNtStatusToDosError)(LONG Status);
int (__stdcall *D3DKMTOpenAdapterFromDeviceName)(D3DKMT_OPENADAPTERFROMDEVICENAME *);
int D3DKMTCloseAdapter; // weak
int (__stdcall *D3DKMTQueryStatistics)(_D3DKMT_QUERYSTATISTICS *);
int gdwAdapterRuntingTime; // idb
std__List gAdapterLuidList;
HINSTANCE ghInstance; // idb
int gdwVersion; // weak
WCHAR gszMainClassName; // idb
WCHAR gszMainWindowName; // idb
EVENT_TRACE_PROPERTIES_EXT gProperties;
char gbFlagsInProcPropSheet; // weak
tagTREEVIEWLISTITEMPARAM *gpTreeViewListItemParam;
LPARAM dword_106539C; // idb
DLLLISTITEMPARAM *gpDllListItemParamHeader;
HFONT ghConfigFont;
HGDIOBJ ghConfigUnderlineFont; // idb
HGDIOBJ ghDefaultUnderlineFontHandle; // idb
WNDPROC gOldListWndProc; // idb
char byte_10653B4; // weak
char byte_10653B5; // weak
CRegSettings gConfig;
WPARAM dword_1069B98; // idb
WPARAM nItem; // idb
HMENU ghSelectColumnPopupMenuHandle; // idb
wchar_t pszBuffer; // idb
_bstr_t stru_1069E50; // idb
int dword_1069E54; // weak
_bstr_t a2; // idb
int dword_1069E5C; // weak
int dword_1069E60; // weak
int dword_1069E64; // weak
int dword_1069E68; // weak
int dword_1069E6C; // weak
char sbEditFlags; // weak
tagUserInfoWithSID *gpUserInfoWithSIDList;
int dword_1069E78; // weak
void *dword_1069E7C; // idb
int dword_1069E80; // idb
tagProcessComment *gpProcessComments;
int (__stdcall *gpfnEnableThemeDialogTexture)(_DWORD, _DWORD); // weak
int ghWhiteBrush; // weak
wchar_t Dst; // idb
int dword_106A090; // weak
char byte_106A094; // weak
char byte_106A095; // weak
char gNetClrMemoryPerfInfoLoaded; // weak
char byte_106A099; // weak
char byte_106A09A; // weak
struct _FILETIME gLoadNetClrMemoryPerfInfoTime; // idb
struct _FILETIME gLoadNetClrMemoryPerfInfoTimeLast; // weak
PerformanceInfoInMemory gPerformanceInfo;
PerformanceInfoInMemory gPerformanceInfoInMemory;
int dword_106A0CC; // idb
PE_TIME gTime; // idb
IWbemServices *gWbemServiceList;
_bstr_t gNullString; // idb
CSystemProcessInfoMap gThreadProcessMap; // idb
char byte_106A100; // weak
int (__stdcall *StartTraceW_0)(PTRACEHANDLE SessionHandle, LPCWSTR SessionName, PEVENT_TRACE_PROPERTIES Properties);
int (__stdcall *ControlTraceW_0)(TRACEHANDLE SessionHandle, LPCWSTR SessionName, PEVENT_TRACE_PROPERTIES Properties, ULONG ControlCode);
int (__stdcall *gpfnCreateRestrictedToken)(void *, unsigned int, unsigned int, struct _SID_AND_ATTRIBUTES *, unsigned int, struct _LUID_AND_ATTRIBUTES *, unsigned int, struct _SID_AND_ATTRIBUTES *, void **); // weak
int gdwRefreshCount; // weak
wchar_t gszMainTitle[260];
wchar_t *gpszCurAuthInfo; // idb
int gdwComdlg_FindReplaceMessageID; // weak
HWND ghMainWnd; // idb
HWND ghWndTreeListView; // idb
int dword_106A338; // weak
HWND ghWndHandlesListCtrl; // idb
HWND ghWndDllsListCtrl; // idb
HWND ghWndStatusBar; // idb
HWND ghWndToolbar; // idb
HWND ghWndSysinfoPropSheet; // idb
HWND ghWndCPUGraph; // idb
HWND ghWndMemoryGraph; // idb
HWND ghWndPhysicalMemoryGraph; // idb
HWND ghWndGPUGraph; // idb
HWND ghWndIOGraphCtrl; // idb
HWND ghWndNetworkGraph; // idb
HWND ghWndDiskGraph; // idb
HANDLE ghRefreshEventHandle; // idb
HANDLE ghEvent2; // idb
HANDLE ghTimerRefreshEvent; // idb
HANDLE ghTimerRefreshProcPageEventHandle; // idb
HANDLE ghEvent6; // idb
unsigned int gdwTickLast; // weak
HMENU ghPriorityPopMenuHandle; // idb
char gbHide; // weak
char gbMainWndMinimized; // weak
char gbProcessIdToSessionIdValid; // weak
char gbWindowFinding; // weak
int gszCmdLine; // weak
char gbIsProcessDEPEnabled; // weak
char gbWintrustInited; // weak
char gbLaunchDepends; // weak
char gbMainWndMinimized1; // weak
WCHAR **gpHiddenProcesses;
HCURSOR ghArrowCursor; // idb
struct tagRECT gRectWindow; // idb
RECT gRectPane; // idb
int dword_106A3BC; // weak
int dword_106A3C0; // idb
int dword_106A3C4; // idb
int dword_106A3C8; // idb
struct _SYSTEM_INFO gSystemInfo; // idb
int dword_106A3F0; // idb
int dword_106A3F4; // idb
const WCHAR gstrApplicationName; // idb
int dword_106A600; // idb
HINSTANCE ghWaitCursor; // idb
wchar_t gszAeDebuggerPath[260];
struct _RTL_CRITICAL_SECTION gSysInfoPropSheetLock; // idb
struct _RTL_CRITICAL_SECTION gLock2; // idb
struct _RTL_CRITICAL_SECTION gLock3; // idb
struct _RTL_CRITICAL_SECTION gProcThreadsLock; // idb
HANDLE ghSystemInfoSheetThreadEvent; // idb
HANDLE ghBackupRefreshThreadHandle; // idb
HANDLE ghEvent3; // idb
HCURSOR ghFindCursor; // idb
HWND ghWndHungWindow; // idb
int gShellIconMsg; // weak
UINT_PTR ghDllMenuPopup; // idb
UINT_PTR ghHandleMenuPopup; // idb
HMENU ghUserPopupMenuHandle; // idb
HWND ghWndFocusedLast; // idb
COLORREF gColorCustomized[16];
int dword_106A8D8; // weak
int (__stdcall *SetLayeredWindowAttributes)(HWND hWnd, RECT *lprc, DWORD dwOpacity, DWORD dwFlagsD);
int (__stdcall *gpfnSHAutoComplete)(struct HWND__ *, unsigned int); // weak
char gbBitmapOnRight; // weak
int gyMouseDown; // idb
int gnToolbarHeight; // idb
HCURSOR ghResizeCursor; // idb
int ghSplitterCursor; // weak
int gdwRefreshTickCountLast; // weak
DWORD SessionId; // idb
_DWORD dword_106A914; // idb
WCHAR CommandLine; // idb
HWND hWnd; // idb
COLORREF gColorOwnProcessStatic; // idb
COLORREF gColorServices; // idb
COLORREF gColorRelocatedDlls; // idb
COLORREF gColorJobs; // idb
COLORREF gColorDotNetProcesses; // idb
COLORREF gColorSuspendedProcess; // idb
HGDIOBJ gBrushOfOwnProcessStatic; // idb
HGDIOBJ gBrushServices; // idb
HGDIOBJ gBrushRelocatedDlls; // idb
HGDIOBJ gBrushJobs; // idb
HGDIOBJ gBrushDotNetProcesses; // idb
HGDIOBJ gBrushSuspendedProcess; // idb
COLORREF gColorNewObjectes; // idb
COLORREF gColorDeletedObjects; // idb
COLORREF gColorPackedImages; // idb
COLORREF gColorPagingListsStandby; // idb
COLORREF gColorWSShared; // idb
COLORREF gColorProtectedProcess; // idb
HGDIOBJ gBrushNewObjects; // idb
HGDIOBJ gBrushDeletedObjects; // idb
HGDIOBJ gBrushPackedImages; // idb
HGDIOBJ gBrushPagingListsStandby; // idb
HGDIOBJ gBrushImmsiveProcess; // idb
HGDIOBJ ho; // idb
int dword_106AB88; // weak
HANDLE ghBackendQueryObjectThreadHandle; // idb
HANDLE lpName; // idb
HANDLE hHandle; // idb
HANDLE Handle; // idb
OBJECT_NAME_INFORMATION *gObjectNameInformation;
int gulQueryObjectResult; // weak
char gbSupportExtendedSystemHandleInformation; // weak
WCHAR gszStringToFindLast[256];
const WCHAR gszStringToFind[256];
DWORD ppv; // idb
DWORD pdwValue4; // idb
DWORD pdwValue3; // idb
HINSTANCE ghMainInstance; // idb
int gdwProcessIdLast; // weak
FILETIME gCreateTimeLast;
int (__stdcall *NtSetInformationProcess)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int gdwTebAddressOffset; // weak
HWND ghFindDlg; // idb
HWND ghWndThreadStack; // idb
HWND ghWndListInFindDlg; // idb
int dword_106B1DC; // weak
struct _RTL_CRITICAL_SECTION gServiceLock; // idb
WCHAR **gpszServiceNames;
DWORD gdwServiceReturned; // idb
int (__stdcall *I_QueryTagInformation)(PVOID Unknown, _SC_SERVICE_TAG_QUERY_TYPE Type, _SC_SERVICE_TAG_QUERY *Query);
int (__stdcall *NtQuerySystemInformation)(_SYSTEM_INFORMATION_CLASS SystemInformationClass, PVOID SystemInformation, ULONG SystemInformationLength, PULONG ReturnLength);
int (__stdcall *gpfn_NtOpenSymbolicLinkObject)(PHANDLE LinkHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes);
int NtOpenDirectoryObject; // weak
int (__stdcall *NtQueryObject)(HANDLE Handle, OBJECT_INFORMATION_CLASS ObjectInformationClass, PVOID ObjectInformation, ULONG ObjectInformationLength, PULONG ReturnedLength);
int (__stdcall *gpfn_NtQuerySymbolicLinkObject)(HANDLE LinkHandle, PUNICODE_STRING LinkTarget, PULONG ReturnedLength);
int RtlTimeToTimeFields; // weak
int NtQueryDirectoryObject; // weak
int (__stdcall *NtSetInformationProcess_0)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *NtQuerySection)(HANDLE SectionHandle, SECTION_INFORMATION_CLASS InformationClass, PVOID InformationBuffer, ULONG InformationBufferSize, PULONG ResultLength);
int (__stdcall *NtQueryEvent)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *NtQueryMutant)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *NtQueryInformationProcess)(HANDLE ProcessHandle, PROCESSINFOCLASS ProcessInformationClass, PVOID ProcessInformation, ULONG ProcessInformationLength, PULONG ReturnLength);
int (__stdcall *NtQueryInformationThread)(HANDLE ThreadHandle, THREADINFOCLASS ThreadInformationClass, PVOID ThreadInformation, ULONG ThreadInformationLength, PULONG ReturnLength);
int (__stdcall *NtQueryVirtualMemory)(HANDLE ProcessHandle, PVOID Address, MEMORY_INFORMATION_CLASS VirtualMemoryInformationClass, PVOID VirtualMemoryInformation, SIZE_T Length, PSIZE_T ResultLength);
int (__thiscall *NtSuspendThread)(HANDLE ThreadHandle, PULONG PreviousSuspendCount);
int (__thiscall *NtResumeThread)(HANDLE ThreadHandle, PULONG SuspendCount);
int (__stdcall *NtSuspendProcess)(HANDLE ProcessHandle);
int (__stdcall *NtResumeProcess)(HANDLE ProcessHandle);
int (__stdcall *NtOpenThread)(PHANDLE ThreadHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PCLIENT_ID ClientId);
int (__stdcall *GetThreadIdealProcessorEx)(_DWORD, _DWORD); // weak
PRTL_DEBUG_BUFFER (__stdcall *RtlCreateQueryDebugBuffer)(ULONG Size, BOOLEAN EventPair);
int (__stdcall *RtlQueryProcessDebugInformation)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *RtlDestroyQueryDebugBuffer)(_DWORD); // weak
int (__stdcall *SedDiscretionaryAclEditor)(HWND Owner, HINSTANCE Instance, PWCHAR MachineName, PACLDLGCONTROL AclDlgControl, PACLEDITCONTROL AclEditControl, PWCHAR ObjectName, FARPROC pfnAclChangeCallback, PVOID ChangeCallbackContext, PSECURITY_DESCRIPTOR ObjectSecurity, BOOLEAN NoReadPermission, BOOLEAN ReadOnly, PDWORD ChangeContextStatus, PVOID MustBeZero);
int (__stdcall *SedTakeOwnership)(HWND Owner, HINSTANCE Instance, PWCHAR MachineName, PWCHAR ObjectType, PWCHAR ObjectName, DWORD ObjectCount, FARPROC ChangeCallback, PVOID ChangeCallbackContext, PSECURITY_DESCRIPTOR ObjectSecurity, BOOLEAN NoReadPermission, BOOLEAN NoOwnerChange, PDWORD ChangeContextStatus, PACLHELPCONTROL HelpInfo, PVOID MustBeZero);
int (__stdcall *SedSystemAclEditor)(HWND Owner, HINSTANCE Instance, PWCHAR MachineName, PACLDLGCONTROL AclDlgControl, PACLEDITCONTROL AclEditControl, PWCHAR ObjectName, FARPROC ChangeCallback, PVOID ChangeCallbackContext, PSECURITY_DESCRIPTOR ObjectSecurity, BOOLEAN NoReadPermission, PDWORD ChangeContextStatus, PVOID MustBeZero);
int (__stdcall *gpfnProcessIdToSessionId)(_DWORD, _DWORD); // weak
int (__stdcall *SymInitialize)(HANDLE hProcess, PCSTR UserSearchPath, BOOL fInvadeProcess);
int (__cdecl *SymGetSymFromName)(HANDLE hProcess, PCSTR Name, PIMAGEHLP_SYMBOL Symbol);
int (__stdcall *SymCleanup)(HANDLE ProcessHandle);
int (__stdcall *SymSetOptions)(DWORD);
int (__stdcall *SymLoadModuleExW_1)(HANDLE hProcess, HANDLE hFile, PCWSTR ImageName, PCWSTR ModuleName, DWORD64 BaseOfDll, DWORD DllSize, PMODLOAD_DATA Data, DWORD Flags);
int (__stdcall *FindExecutableImage)(PCSTR FileName, PCSTR SymbolPath, PSTR ImageFilePath);
int (__thiscall *QueryProcessCycleTime)(HANDLE ProcessHandle, PULONG64 CycleTime);
int (__stdcall *GlobalMemoryStatusEx)(_DWORD); // weak
int (__stdcall *WinStationGetProcessSid)(HANDLE hServer, DWORD ProcessId, FILETIME ProcessStartTime, LPBYTE pBuffer, PDWORD pdwSize);
int GetProcessorSystemCycleTime; // weak
int (__stdcall *AllocateAndGetTcpExTableFromStack)(PVOID *ppTcpTable, BOOL bOrder, HANDLE hHeap, DWORD dwFlags, DWORD dwFamily);
int (__stdcall *AllocateAndGetUdpExTableFromStack)(PVOID *ppUdpTable, BOOL bOrder, HANDLE hHeap, DWORD dwFlags, DWORD dwFamily);
int (__stdcall *AllocateAndGetUdpExTable2FromStack)(PVOID *ppUDPTable, BOOL bOrder, HANDLE hHeap, DWORD dwFlags, DWORD dwFamily, UDP_TABLE_CLASS UdpTableClass);
int (__stdcall *AllocateAndGetTcpExTable2FromStack)(PVOID *ppTcpTable, BOOL bOrder, HANDLE hHeap, DWORD dwFlags, DWORD dwFamily, TCP_TABLE_CLASS TcpTableClass);
int (__stdcall *QueryThreadCycleTime)(HANDLE ThreadHandle, PULONG64 CycleTime);
int (__stdcall *IsHungAppWindow)(HWND hWnd);
int IsHungThread; // weak
int (__stdcall *GetLogicalProcessorInformationEx)(_DWORD, _DWORD, _DWORD); // weak
int SetThreadGroupAffinity; // weak
int (__stdcall *WTSEnumerateSessionsW)(HANDLE hServer, DWORD Reserved, DWORD Version, PWTS_SESSION_INFOW *ppSessionInfo, DWORD *pCount);
int (__stdcall *WTSDisconnectSession)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *WinStationConnectW)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *WinStationShadow)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *WTSQuerySessionInformationW)(HANDLE hServer, DWORD SessionId, WTS_INFO_CLASS WTSInfoClass, LPWSTR *ppBuffer, DWORD *pBytesReturned);
int (__stdcall *WTSLogoffSessio)(_DWORD, _DWORD, _DWORD); // weak
int (__stdcall *WTSSendMessageW)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int (__stdcall *WTSFreeMemory)(PWTS_SESSION_INFOW SessionInfo);
int (__stdcall *QueryIdleProcessorCycleTime)(PULONG Buffer, PULONG64 ProcessorIdleCycleTime);
int (__stdcall *ChangeWindowMessageFilter)(_DWORD, _DWORD); // weak
int CpuGetContext; // weak
int (__stdcall *GetPackageFullName)(HANDLE hProcess, UINT32 *packageFullNameLength, PWSTR packageFullName);
int (__stdcall *GetProcessDpiAwareness)(_DWORD, _DWORD); // weak
SYSTEM_PROCESS_INFORMATION *gpSystemProcessInfoLast;
int gnSystemProcessInfoLengthLast; // weak
FILETIME gTimeQuerySystemInfoLast; // weak
int (__stdcall *HungWindowFromGhostWindow)(HWND hWnd);
SYSTEM_PROCESS_INFORMATION *gpSystemProcessInfo;
ULONG gnSystemProcessInfoLength; // idb
SYSTEM_PROCESSOR_PERFORMANCE_INFORMATION *gpSystemPerformanceInfo;
SYSTEM_INTERRUPT_INFORMATION *gpSystemInterruptInfo;
SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *gpSystemProcessorCycleTimeInfo;
CSystemProcessInfoMap gSystemProcessInfoMap; // idb
SYSTEM_HANDLE_INFORMATION *gpSystemHandleInfo;
SYSTEM_HANDLE_INFORMATION *gpSystemHandleInfo2;
SYSTEM_HANDLE_INFORMATION *gpSystemHandleInfo3;
DWORD gdwServiceNamesLength; // idb
int (__stdcall *MiniDumpWriteDump)(HANDLE hProcess, DWORD ProcessId, HANDLE hFile, MINIDUMP_TYPE DumpType, PMINIDUMP_EXCEPTION_INFORMATION ExceptionParam, PMINIDUMP_USER_STREAM_INFORMATION UserStreamParam, PMINIDUMP_CALLBACK_INFORMATION CallbackParam);
SC_HANDLE ghSCManagerHandle; // idb
wchar_t gpszObjectTypeNames[16384]; // idb
WCHAR gszDriverLinkName[];
WCHAR gszDriverName[256][25];
DWORD gdwLogicalProcessorInfoItemCount; // idb
SYSTEM_LOGICAL_PROCESSOR_INFORMATION *gpLogicalProcessorInfo;
volatile LONG gnRefCount; // idb
CGraphData **gppGraphInfo;
int dword_107BA1C; // weak
CGraphData *gpGraphInfoOfMemory;
CGraphData *gpGraphInfoOfCPU;
CGraphData *gpGraphInfoOfGPU;
CGraphData *gpGraphInfoOfSystemMemory;
CGraphData *gpGraphInfoOfDedicatedMemory;
CGraphData *gpGraphInfoOfPhysicalMemory;
FILETIME gTimeQuerySystemInfo; // idb
__int64 qword_107BA40; // weak
int (__stdcall *IsImmersiveProcess)(_DWORD); // weak
int (__stdcall *SHGetStockIconInfo)(_DWORD, _DWORD, _DWORD); // weak
LPWSTR gpszWindowText; // idb
rsize_t gdwWindowTextLength; // idb
char gbWindowTextFlags; // weak
HWND ghMainWndBackup;
CSystemProcessInfoMap gMap3; // idb
CSystemProcessInfoMap gMap2; // idb
TreeList_Item1 gTreeList_Item[3];
tagGraphInfo gIOGraphInfo;
tagGraphInfo gNetworkGraphInfo;
tagGraphInfo gDiskGraphInfo;
char byte_107BC00; // weak
int (__stdcall *GetProcessMitigationPolicy)(HANDLE hProcess, _PROCESS_MITIGATION_POLICY MitigationPolicy, PVOID lpBuffer, SIZE_T dwLength);
int (__stdcall *GetProcessDEPPolicy)(HANDLE hProcess, LPDWORD lpFlags, PBOOL lpPermanent);
int dword_107BC0C; // weak
int dword_107BC10; // weak
int dword_107BC14; // weak
int dword_107BC18; // weak
__int16 word_107BC1C; // weak
__int16 word_107BC1E; // weak
char byte_107BC20; // weak
int gbShowProcessTreeLast; // weak
__int64 qword_107BC30; // weak
int dword_107BC38[256]; // weak
int dword_107C038; // weak
int dword_107C03C; // weak
int dword_107C040; // weak
int dword_107C044; // weak
int dword_107C048; // weak
int dword_107C04C; // weak
int dword_107C050; // weak
struct _ACLDLGCONTROL gAclDlgControl; // idb
struct _ACLEDITCONTROL gAclEditControl; // idb
char byte_107C080; // weak
char byte_107C081; // weak
char byte_107C082; // weak
char byte_107C083; // weak
char byte_107C084; // weak
char byte_107C085; // weak
WCHAR gObjectName[1024]; // idb
wchar_t gObjectType; // idb
HANDLE ghSourceProcessHandle; // idb
int nWidth; // idb
int nHeight; // idb
struct tagRECT Rect; // idb
WORD pnWidths; // idb
__int16 word_107D0A6; // weak
__int16 word_107D0A8; // weak
__int16 word_107D0AA; // weak
__int16 word_107D0AC; // weak
int dword_107D0B0; // weak
wchar_t sstrFindWhat[];
tagFINDREPLACEW gFindReplaceItem; // idb
DWORD sbFound; // idb
wchar_t sstrFindResult[];
int gdwSymbolAddressOfMmMaximumNonPagedPoolInBytes; // weak
int gdwSymbolAddressOfMmSizeOfPagedPoolInBytes; // weak
HANDLE ghProcess; // idb
SYSTEM_PERFORMANCE_INFORMATION gSystenPerformanceInfoInProcSecurity;
int dword_108527C; // weak
int dword_1085294; // weak
int dword_10852A0; // weak
int dword_10852A8; // weak
__int64 qword_1085378; // weak
__int64 qword_1085380; // weak
_UNKNOWN unk_1085388; // weak
__int64 qword_1085390; // weak
__int64 qword_1085398; // weak
__int64 qword_10853A0; // weak
int dword_10853A8; // weak
int dword_10853AC; // weak
int dword_10853B0; // weak
__int16 gwWidthsOfListInFindDlg[4]; // weak
int dword_10854C8; // weak
HCURSOR hCursor; // idb
int dword_10854D0; // weak
int gdwRefreshRateLast; // weak
int gnWidthFindDlg; // idb
int gnHeightFindDlg; // idb
struct tagRECT gRectFindDlg; // idb
int ghMainIcon; // weak
char gbSearching; // weak
HANDLE ghThreadHandleInFindDlg; // idb
int dword_10854FC; // weak
wchar_t word_1085500; // idb
HINSTANCE hInstance; // idb
HINSTANCE shWaitCursor; // idb
char ATL::CAtlBaseModule::m_bInitFailed; // weak
HWND ghWndReBar; // idb
int gnStatusBarItemCount; // weak
HGDIOBJ dword_1085724; // idb
int dword_1085728; // weak
int dword_108572C; // weak
HDC hdc; // idb
int dword_1085734; // weak
int dword_1085738; // weak
char byte_108573C; // weak
int dword_1085740; // weak
struct _RTL_CRITICAL_SECTION stru_1085744; // idb
HANDLE ghEventHandle; // idb
int ghThreadHandle; // weak
HANDLE ghEventHandle2; // idb
int ghThreadHandle2; // weak
HANDLE ghEventHandle3; // idb
int ghThreadHandle3; // weak
char gbAgreenmentLicensed; // weak
char byte_1085775; // weak
tagHttpInfo gHttpInfo; // idb
void *dword_108579C; // idb
int dword_10857A0; // weak
EventList *off_10857A4; // idb
int dword_10857A8; // weak
EventList *off_10857AC; // idb
int dword_10857B0; // weak
char byte_10857B4; // weak
int dword_10857BC; // weak
int dword_10857C0; // weak
HMODULE hModule; // idb
_UNKNOWN unk_10857D8; // weak
struct _RTL_CRITICAL_SECTION stru_10857E0; // idb
int dword_1085840; // weak
bool dword_1085844; // idb
_UNKNOWN unk_108585A; // weak
int dword_1085864; // weak
int dword_1085868; // idb
_UNKNOWN unk_10858F0; // weak
_UNKNOWN unk_10858F3; // weak
CAtlBaseModule ATL::_AtlBaseModule;
PVOID dword_1085EBC; // idb
PVOID dword_1085EC4; // idb
int dword_1085EC8; // weak
PVOID dword_1086628; // idb
PVOID dword_108663C; // idb
int dword_1086648; // weak
PVOID dword_108694C; // idb
PVOID dword_1086950; // idb
PVOID dword_1086954; // idb
PVOID dword_1086958; // idb
PVOID dword_108695C; // idb
int dword_10869A4; // weak
int dword_10869AC; // weak


//----- (00F71000) --------------------------------------------------------
signed int __stdcall sub_F71000(_BYTE *a1, unsigned int a2, int a3)
{
  signed int result; // eax
  _BYTE *v4; // eax
  signed int v5; // ebx
  unsigned int v6; // esi
  char v7; // cl

  result = 0;
  if ( !a2 || a2 > 0x7FFFFFFF )
    result = -2147024809;
  if ( result >= 0 )
  {
    v4 = a1;
    v5 = 0;
    v6 = a2;
    if ( !a2 )
      goto LABEL_14;
    do
    {
      if ( !(2147483646 - a2 + v6) )
        break;
      v7 = v4[a3 - a1];
      if ( !v7 )
        break;
      *v4++ = v7;
      --v6;
    }
    while ( v6 );
    if ( !v6 )
    {
LABEL_14:
      --v4;
      v5 = -2147024774;
    }
    *v4 = 0;
    result = v5;
  }
  return result;
}

//----- (00F71063) --------------------------------------------------------
BOOL __stdcall sub_F71063(CHAR *a1)
{
  BOOL v1; // esi
  DWORD cbData; // [esp+4h] [ebp-118h]
  DWORD Type; // [esp+8h] [ebp-114h]
  LPSTR lpDst; // [esp+Ch] [ebp-110h]
  HKEY phkResult; // [esp+10h] [ebp-10Ch]
  BYTE Data; // [esp+14h] [ebp-108h]
  char v8; // [esp+117h] [ebp-5h]

  lpDst = a1;
  v1 = 0;
  if ( RegOpenKeyExA(
         HKEY_CLASSES_ROOT,
         "CLSID\\{ADB880A6-D8FF-11CF-9377-00AA003B7A11}\\InprocServer32",
         0,
         0x20019u,
         &phkResult) )
  {
    return 0;
  }
  cbData = 260;
  Type = 1;
  if ( !RegQueryValueExA(phkResult, 0, 0, &Type, &Data, &cbData) )
  {
    v8 = 0;
    if ( Type == 2 )
      v1 = ExpandEnvironmentStringsA(&Data, lpDst, 0x104u) - 1 <= 0x103;
    else
      v1 = sub_F71000(lpDst, 0x104u, &Data) >= 0;
  }
  RegCloseKey(phkResult);
  return v1;
}

//----- (00F71149) --------------------------------------------------------
int __stdcall sub_F71149(int a1, int a2, int a3, int a4)
{
  HMODULE v4; // ecx
  FARPROC v6; // eax
  CHAR LibFileName; // [esp+Ch] [ebp-108h]

  v4 = hModule;
  if ( hModule || dword_10857C0 != hModule )
    goto LABEL_13;
  if ( sub_F71063(&LibFileName) )
    hModule = LoadLibraryA(&LibFileName);
  v4 = hModule;
  if ( hModule || (v4 = LoadLibraryA("hhctrl.ocx"), (hModule = v4) != 0) )
  {
LABEL_13:
    v6 = dword_10857BC;
    if ( dword_10857BC )
      return (v6)(a1, a2, a3, a4);
    v6 = GetProcAddress(v4, 0xF);
    dword_10857BC = v6;
    if ( v6 )
      return (v6)(a1, a2, a3, a4);
  }
  dword_10857C0 = 1;
  return 0;
}
// 10857BC: using guessed type int dword_10857BC;
// 10857C0: using guessed type int dword_10857C0;

//----- (00F71200) --------------------------------------------------------
int sub_F71200()
{
  `eh vector constructor iterator'(word_1064900, 0x28u, 20, sub_F73750, sub_F73850);
  return atexit(sub_102A0D0);
}
// 1064900: using guessed type __int16 word_1064900[400];

//----- (00F71230) --------------------------------------------------------
int dynamic_initializer_for__garrAccountInfo__()
{
  return atexit(sub_102A0F0);
}

//----- (00F71240) --------------------------------------------------------
int dynamic_initializer_for__gpszTipText__()
{
  gpszTipText = _wcsdup(L"Autoruns - Sysinternals: www.sysinternals.com");
  return atexit(sub_102A150);
}

//----- (00F71260) --------------------------------------------------------
int sub_F71260()
{
  return atexit(sub_102A160);
}

//----- (00F71270) --------------------------------------------------------
int sub_F71270()
{
  return atexit(sub_102A1C0);
}

//----- (00F71280) --------------------------------------------------------
HCURSOR dynamic_initializer_for__ghHandCursor__()
{
  HCURSOR result; // eax

  result = LoadCursorW(0, IDC_HAND);
  ghHandCursor = result;
  return result;
}
// 10648EC: using guessed type int ghHandCursor;

//----- (00F712A0) --------------------------------------------------------
int dynamic_initializer_for__dword_4F48E4__()
{
  _WORD *v0; // eax

  v0 = malloc(2u);
  dword_4F48E4 = v0;
  *v0 = 0;
  return atexit(sub_102A220);
}

//----- (00F712C0) --------------------------------------------------------
int dynamic_initializer_for__gpszSystemPathInfo__()
{
  wchar_t *v0; // eax

  v0 = malloc(2u);
  gpszSystemPathInfo = v0;
  *v0 = 0;
  return atexit(sub_102A230);
}

//----- (00F712E0) --------------------------------------------------------
int dynamic_initializer_for__dword_4F48FC__()
{
  _WORD *v0; // eax

  v0 = malloc(2u);
  dword_4F48FC = v0;
  *v0 = 0;
  return atexit(sub_102A240);
}

//----- (00F71300) --------------------------------------------------------
int dynamic_initializer_for__gKeyNameMap__()
{
  gKeyNameMap._Mypair._Myval2._Myhead = std::_Tree_comp_alloc<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::_Buyheadnode();
  return atexit(dynamic_atexit_destructor_for__gKeyNameMap__);
}

//----- (00F71320) --------------------------------------------------------
int dynamic_initializer_for__dword_4F48F0__()
{
  _WORD *v0; // eax

  v0 = malloc(2u);
  dword_4F48F0 = v0;
  *v0 = 0;
  return atexit(sub_102A2D0);
}

//----- (00F71340) --------------------------------------------------------
HCURSOR dynamic_initializer_for__ghWaitCursor__()
{
  HCURSOR result; // eax

  result = LoadCursorW(0, IDC_WAIT);
  ghWaitCursor = result;
  return result;
}
// 10648E8: using guessed type int ghWaitCursor;

//----- (00F71360) --------------------------------------------------------
int dynamic_initializer_for__dword_4F4C54__()
{
  _WORD *v0; // eax

  v0 = malloc(2u);
  dword_4F4C54 = v0;
  *v0 = 0;
  return atexit(sub_102A2F0);
}

//----- (00F71380) --------------------------------------------------------
int dynamic_initializer_for__dword_4F4C50__()
{
  WCHAR *v0; // eax

  v0 = malloc(2u);
  dword_4F4C50 = v0;
  *v0 = 0;
  return atexit(sub_102A300);
}

//----- (00F713A0) --------------------------------------------------------
int dynamic_initializer_for__gList5_gList6__()
{
  gList5._Mypair._Myval2._Myhead = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(
                                     0,
                                     0);
  gList6._Mypair._Myval2._Myhead = 0;
  gList6._Mypair._Myval2._Mysize = 0;
  gList6._Mypair._Myval2._Myhead = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(
                                     0,
                                     0);
  return atexit(sub_102A310);
}
// 1064CD8: using guessed type std__List gList5;
// 1064CE0: using guessed type std__List gList6;

//----- (00F71420) --------------------------------------------------------
int dynamic_initializer_for__gList1__()
{
  gList1 = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(0, 0);
  return atexit(sub_102A320);
}

//----- (00F71440) --------------------------------------------------------
int dynamic_initializer_for__gList2__()
{
  gList2 = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(0, 0);
  return atexit(sub_102A3F0);
}

//----- (00F71460) --------------------------------------------------------
int dynamic_initializer_for__gList3__()
{
  gList3 = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(0, 0);
  return atexit(sub_102A4C0);
}

//----- (00F71480) --------------------------------------------------------
int dynamic_initializer_for__gMap5__()
{
  gMap5 = std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buyheadnode();
  return atexit(sub_102A590);
}

//----- (00F714A0) --------------------------------------------------------
int sub_F714A0()
{
  return atexit(sub_102A610);
}

//----- (00F714B0) --------------------------------------------------------
int sub_F714B0()
{
  return atexit(sub_102A620);
}

//----- (00F714C0) --------------------------------------------------------
int sub_F714C0()
{
  return atexit(sub_102A630);
}

//----- (00F714D0) --------------------------------------------------------
int dynamic_initializer_for__gActiveScriptEventConsumer__()
{
  ActiveScriptEventConsumer::ActiveScriptEventConsumer(&gActiveScriptEventConsumer);
  return atexit(sub_102A640);
}
// 1064D28: using guessed type struct ActiveScriptEventConsumer gActiveScriptEventConsumer;

//----- (00F714F0) --------------------------------------------------------
int dynamic_initializer_for__gCommandLineEventConsumer__()
{
  CommandLineEventConsumer::CommandLineEventConsumer(&gCommandLineEventConsumer);
  return atexit(sub_102A660);
}
// 1064D1C: using guessed type struct CommandLineEventConsumer gCommandLineEventConsumer;

//----- (00F71510) --------------------------------------------------------
int dynamic_initializer_for__gMap6__()
{
  gMap6 = std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buyheadnode();
  return atexit(sub_102A680);
}

//----- (00F71530) --------------------------------------------------------
ATOM dynamic_initializer_for__gAtomTreeListProperty__()
{
  ATOM result; // ax

  result = GlobalAddAtomW(L"TreeListProperty");
  gAtomTreeListProperty = result;
  return result;
}
// 1064DA0: using guessed type __int16 gAtomTreeListProperty;

//----- (00F71550) --------------------------------------------------------
ATOM dynamic_initializer_for__gAtomTreeList__()
{
  ATOM result; // ax

  result = CTreeList::Register();
  gAtomTreeList = result;
  return result;
}
// 1064D9C: using guessed type __int16 gAtomTreeList;

//----- (00F71560) --------------------------------------------------------
BOOL dynamic_initializer_for__gLogPixelSize__()
{
  HDC v0; // edi

  v0 = CreateCompatibleDC(0);
  gLogPixelSize.x = GetDeviceCaps(v0, 88);
  gLogPixelSize.y = GetDeviceCaps(v0, 90);
  return DeleteDC(v0);
}

//----- (00F71590) --------------------------------------------------------
int dynamic_initializer_for__ghUxthemeModule__()
{
  ghUxthemeModule = LoadLibraryW(L"uxtheme.dll");
  return atexit(sub_102A700);
}

//----- (00F715B0) --------------------------------------------------------
FARPROC dynamic_initializer_for__gpfnCloseThemeData__()
{
  FARPROC result; // eax

  result = ghUxthemeModule;
  if ( ghUxthemeModule )
  {
    result = GetProcAddress(ghUxthemeModule, "CloseThemeData");
    gpfnCloseThemeData = result;
  }
  else
  {
    gpfnCloseThemeData = 0;
  }
  return result;
}

//----- (00F715E0) --------------------------------------------------------
int (__stdcall *sub_F715E0())(HTHEME hTheme, HDC hdc, int iPartId, int iStateId, LPCRECT pRect, LPCRECT pClipRect)
{
  int (__stdcall *result)(HTHEME, HDC, int, int, LPCRECT, LPCRECT); // eax

  result = ghUxthemeModule;
  if ( ghUxthemeModule )
  {
    result = GetProcAddress(ghUxthemeModule, "DrawThemeBackground");
    gpfnDrawThemeBackground = result;
  }
  else
  {
    gpfnDrawThemeBackground = 0;
  }
  return result;
}

//----- (00F71610) --------------------------------------------------------
int (__stdcall *sub_F71610())()
{
  int (__stdcall *result)(); // eax

  result = ghUxthemeModule;
  if ( ghUxthemeModule )
  {
    result = GetProcAddress(ghUxthemeModule, "IsThemeActive");
    gpfnIsThemeActive = result;
  }
  else
  {
    gpfnIsThemeActive = 0;
  }
  return result;
}
// 1064D84: using guessed type int (__stdcall *gpfnIsThemeActive)();

//----- (00F71640) --------------------------------------------------------
FARPROC sub_F71640()
{
  FARPROC result; // eax

  result = ghUxthemeModule;
  if ( ghUxthemeModule )
  {
    result = GetProcAddress(ghUxthemeModule, "OpenThemeData");
    gpfnOpenThemeData = result;
  }
  else
  {
    gpfnOpenThemeData = 0;
  }
  return result;
}

//----- (00F71670) --------------------------------------------------------
IAtlStringMgr *sub_F71670()
{
  IAtlStringMgr *result; // eax

  result = ATL::StrTraitATL<wchar_t,ATL::ChTraitsCRT<wchar_t>>::GetDefaultManager();
  byte_1064DF4 = 1;
  return result;
}
// 1064DF4: using guessed type char byte_1064DF4;

//----- (00F71680) --------------------------------------------------------
int dynamic_initializer_for__gList4__()
{
  gBstrList = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(0, 0);
  return atexit(sub_102A720);
}

//----- (00F716A0) --------------------------------------------------------
FARPROC sub_F716A0()
{
  HMODULE v0; // eax
  FARPROC result; // eax

  v0 = LoadLibraryW(L"Advapi32.dll");
  result = GetProcAddress(v0, "EnableTraceEx");
  EnableTraceEx = result;
  return result;
}

//----- (00F716C0) --------------------------------------------------------
int dynamic_initializer_for__gList7__()
{
  gAdapterLuidList._Mypair._Myval2._Myhead = sub_FB4360(0, 0);
  return atexit(sub_102A840);
}

//----- (00F716E0) --------------------------------------------------------
HANDLE dynamic_initializer_for__gProperties__()
{
  HANDLE result; // eax

  result = CreateEventW(0, 1, 0, 0);
  gProperties.EventHandle = result;
  gProperties.ThreadHandle = 0;
  return result;
}

//----- (00F71700) --------------------------------------------------------
DWORD sub_F71700()
{
  DWORD v0; // eax
  double v1; // xmm0_8
  DWORD result; // eax
  double v3; // xmm0_8

  v0 = GetSysColor(15);
  stru_105DDF0.Name = L"ColorJobs";
  stru_105DDF0.KeyType = 0;
  v1 = v0;
  result = v0 >> 31;
  stru_105DDF0.StructSize = 0;
  stru_105DDF0.Address = &gConfig.ColorJobs;
  off_105DE08 = L"ColorDelProc";
  dword_105DE0C = 0;
  dword_105DE10 = 0;
  v3 = v1 + qword_103D110[result];
  dword_105DE14 = &gConfig.ColorDelProc;
  off_105DE20 = L"ColorNewProc";
  dword_105DE24 = 0;
  dword_105DE28 = 0;
  stru_105DDD8.dbValue = v3;
  stru_105DDF0.dbValue = dbl_103EA10;
  dbl_105DE18 = dbl_103EA18;
  dbl_105DE30 = dbl_103EA20;
  qword_105DE48 = qword_103EA38;
  qword_105DE60 = *&dbl_103EA28;
  qword_105DE90 = *&dbl_103EA30;
  qword_105DEA8 = *&dbl_103EA08;
  dword_105DE2C = &gConfig.ColorNewProc;
  off_105DE38 = L"ColorNet";
  dword_105DE3C = 0;
  dword_105DE40 = 0;
  dword_105DE44 = &gConfig.ColorNet;
  dword_105DE50 = L"ColorProtected";
  dword_105DE54 = 0;
  dword_105DE58 = 0;
  dword_105DE5C = &gConfig.ColorProtected;
  dword_105DE68 = L"ShowHeatmaps";
  dword_105DE6C = 1;
  dword_105DE70 = 0;
  dword_105DE74 = &gConfig.bShowColumnHeatmaps;
  qword_105DE78 = *&db_one;
  dword_105DE80 = L"ColorSuspend";
  dword_105DE84 = 0;
  dword_105DE88 = 0;
  dword_105DE8C = &gConfig.ColorSuspend;
  dword_105DE98 = L"StatusBarColumns";
  dword_105DE9C = 0;
  dword_105DEA0 = 0;
  dword_105DEA4 = &gConfig.dwStatusBarColumns;
  dword_105DEB0 = L"ShowAllCpus";
  dword_105DEB4 = 1;
  dword_105DEB8 = 0;
  dword_105DEBC = &gConfig.bShowAllCpus;
  qword_105DEC0 = 0i64;
  dword_105DEC8 = L"ShowAllGpus";
  dword_105DECC = 1;
  dword_105DED0 = 0;
  dword_105DED4 = &gConfig.bShowAllGpus;
  qword_105DED8 = 0i64;
  dword_105DEE0 = L"Opacity";
  dword_105DEE4 = 0;
  dword_105DEE8 = 0;
  dword_105DEEC = &gConfig.dwOpacity;
  qword_105DEF0 = *&db_onehundred;
  dword_105DEF8 = L"GpuNodeUsageMask";
  dword_105DEFC = 0;
  dword_105DF00 = 0;
  dword_105DF04 = &gConfig.dwGpuNodeUsageMask;
  qword_105DF08 = *&db_one;
  dword_105DF10 = L"VerifySignatures";
  dword_105DF14 = 1;
  dword_105DF18 = 0;
  dword_105DF1C = &gConfig.bVerifySignatures;
  qword_105DF20 = 0i64;
  dword_105DF28 = L"VirusTotalCheck";
  dword_105DF2C = 1;
  dword_105DF30 = 0;
  dword_105DF34 = &gConfig.bCheckVirusTotal;
  qword_105DF38 = 0i64;
  dword_105DF40 = L"VirusTotalSubmitUnknown";
  dword_105DF44 = 1;
  dword_105DF48 = 0;
  dword_105DF4C = &gConfig.bVirusTotalSubmitUnknown;
  qword_105DF50 = 0i64;
  dword_105DF58 = L"ToolbarBands";
  dword_105DF5C = 7;
  dword_105DF60 = 96;
  dword_105DF64 = gConfig.ToolBandInfo;
  qword_105DF68 = 0i64;
  dword_105DF70 = L"UseGoogle";
  dword_105DF74 = 1;
  dword_105DF78 = 0;
  dword_105DF7C = &gConfig.bUseGoogle;
  qword_105DF80 = 0i64;
  dword_105DF88 = L"ShowNewProcesses";
  dword_105DF8C = 1;
  dword_105DF90 = 0;
  dword_105DF94 = &gConfig.bShowNewProcesses;
  qword_105DF98 = 0i64;
  dword_105DFA0 = L"TrayCPUHistory";
  dword_105DFA4 = 1;
  dword_105DFA8 = 0;
  dword_105DFAC = &gConfig.bTrayCPUHistory;
  qword_105DFB0 = *&db_one;
  dword_105DFB8 = L"ShowIoTray";
  dword_105DFBC = 1;
  dword_105DFC0 = 0;
  dword_105DFC4 = &gConfig.bShowIoTray;
  qword_105DFC8 = 0i64;
  dword_105DFD0 = L"ShowNetTray";
  dword_105DFD4 = 1;
  dword_105DFD8 = 0;
  dword_105DFDC = &gConfig.bShowNetTray;
  qword_105DFE0 = 0i64;
  dword_105DFE8 = L"ShowDiskTray";
  dword_105DFEC = 1;
  dword_105DFF0 = 0;
  dword_105DFF4 = &gConfig.bShowDiskTray;
  qword_105DFF8 = 0i64;
  dword_105E000 = L"ShowPhysTray";
  dword_105E004 = 1;
  dword_105E008 = 0;
  dword_105E00C = &gConfig.bShowPhysTray;
  qword_105E010 = 0i64;
  dword_105E018 = L"ShowCommitTray";
  dword_105E01C = 1;
  dword_105E020 = 0;
  dword_105E024 = &gConfig.bShowCommitTray;
  qword_105E028 = 0i64;
  dword_105E030 = L"ShowGpuTray";
  dword_105E034 = 1;
  dword_105E038 = 0;
  dword_105E03C = &gConfig.bShowGpuHistory;
  qword_105E040 = 0i64;
  dword_105E048 = L"FormatIoBytes";
  dword_105E04C = 1;
  dword_105E050 = 0;
  dword_105E054 = &gConfig.bFormatIoBytes;
  qword_105E058 = *&db_one;
  dword_105E060 = L"StackWindowPlacement";
  dword_105E064 = 7;
  dword_105E068 = 44;
  dword_105E06C = &gConfig.WindowPlacement[5];
  qword_105E070 = 0i64;
  dword_105E078 = L"ETWstandardUserWarning";
  dword_105E07C = 1;
  dword_105E080 = 0;
  dword_105E084 = &gConfig.bETWStandardUserWarning;
  qword_105E088 = 0i64;
  dword_105E090 = 0;
  dword_105E094 = 0;
  dword_105E098 = 0;
  dword_105E09C = 0;
  qword_105E0A0 = 0i64;
  return result;
}
// 103CDC0: using guessed type double db_onehundred;
// 103DAD8: using guessed type wchar_t aColorjobs[10];
// 103DAEC: using guessed type wchar_t aColordelproc[13];
// 103DB08: using guessed type wchar_t aColornewproc[13];
// 103DB24: using guessed type wchar_t aColornet[9];
// 103DB38: using guessed type wchar_t aColorprotected[15];
// 103DB58: using guessed type wchar_t aShowheatmaps[13];
// 103DB74: using guessed type wchar_t aColorsuspend[13];
// 103DB90: using guessed type wchar_t aStatusbarcolum[17];
// 103DBB4: using guessed type wchar_t aShowallcpus[12];
// 103DBCC: using guessed type wchar_t aShowallgpus[12];
// 103DBF4: using guessed type wchar_t aGpunodeusagema[17];
// 103DC18: using guessed type wchar_t aVerifysignatur[17];
// 103DC3C: using guessed type wchar_t aVirustotalchec[16];
// 103DC5C: using guessed type wchar_t aVirustotalsubm[24];
// 103DC8C: using guessed type wchar_t aToolbarbands[13];
// 103DCA8: using guessed type wchar_t aUsegoogle[10];
// 103DCBC: using guessed type wchar_t aShownewprocess[17];
// 103DCE0: using guessed type wchar_t aTraycpuhistory[15];
// 103DD00: using guessed type wchar_t aShowiotray[11];
// 103DD18: using guessed type wchar_t aShownettray[12];
// 103DD30: using guessed type wchar_t aShowdisktray[13];
// 103DD4C: using guessed type wchar_t aShowphystray[13];
// 103DD68: using guessed type wchar_t aShowcommittray[15];
// 103DD88: using guessed type wchar_t aShowgputray[12];
// 103DDA0: using guessed type wchar_t aFormatiobytes[14];
// 103DDBC: using guessed type wchar_t aStackwindowpla[21];
// 103DDE8: using guessed type wchar_t aEtwstandarduse[23];
// 103EA08: using guessed type double dbl_103EA08;
// 103EA10: using guessed type double dbl_103EA10;
// 103EA18: using guessed type double dbl_103EA18;
// 103EA20: using guessed type double dbl_103EA20;
// 103EA28: using guessed type double dbl_103EA28;
// 103EA30: using guessed type double dbl_103EA30;
// 103EA38: using guessed type __int64 qword_103EA38;
// 105DDD8: using guessed type tagConfigItem;
// 105DDF0: using guessed type tagConfigItem stru_105DDF0;
// 105DE08: using guessed type void *off_105DE08;
// 105DE0C: using guessed type int dword_105DE0C;
// 105DE10: using guessed type int dword_105DE10;
// 105DE14: using guessed type int dword_105DE14;
// 105DE18: using guessed type double dbl_105DE18;
// 105DE20: using guessed type void *off_105DE20;
// 105DE24: using guessed type int dword_105DE24;
// 105DE28: using guessed type int dword_105DE28;
// 105DE2C: using guessed type int dword_105DE2C;
// 105DE30: using guessed type double dbl_105DE30;
// 105DE38: using guessed type void *off_105DE38;
// 105DE3C: using guessed type int dword_105DE3C;
// 105DE40: using guessed type int dword_105DE40;
// 105DE44: using guessed type int dword_105DE44;
// 105DE48: using guessed type __int64 qword_105DE48;
// 105DE50: using guessed type int dword_105DE50;
// 105DE54: using guessed type int dword_105DE54;
// 105DE58: using guessed type int dword_105DE58;
// 105DE5C: using guessed type int dword_105DE5C;
// 105DE60: using guessed type __int64 qword_105DE60;
// 105DE68: using guessed type int dword_105DE68;
// 105DE6C: using guessed type int dword_105DE6C;
// 105DE70: using guessed type int dword_105DE70;
// 105DE74: using guessed type int dword_105DE74;
// 105DE78: using guessed type __int64 qword_105DE78;
// 105DE80: using guessed type int dword_105DE80;
// 105DE84: using guessed type int dword_105DE84;
// 105DE88: using guessed type int dword_105DE88;
// 105DE8C: using guessed type int dword_105DE8C;
// 105DE90: using guessed type __int64 qword_105DE90;
// 105DE98: using guessed type int dword_105DE98;
// 105DE9C: using guessed type int dword_105DE9C;
// 105DEA0: using guessed type int dword_105DEA0;
// 105DEA4: using guessed type int dword_105DEA4;
// 105DEA8: using guessed type __int64 qword_105DEA8;
// 105DEB0: using guessed type int dword_105DEB0;
// 105DEB4: using guessed type int dword_105DEB4;
// 105DEB8: using guessed type int dword_105DEB8;
// 105DEBC: using guessed type int dword_105DEBC;
// 105DEC0: using guessed type __int64 qword_105DEC0;
// 105DEC8: using guessed type int dword_105DEC8;
// 105DECC: using guessed type int dword_105DECC;
// 105DED0: using guessed type int dword_105DED0;
// 105DED4: using guessed type int dword_105DED4;
// 105DED8: using guessed type __int64 qword_105DED8;
// 105DEE0: using guessed type int dword_105DEE0;
// 105DEE4: using guessed type int dword_105DEE4;
// 105DEE8: using guessed type int dword_105DEE8;
// 105DEEC: using guessed type int dword_105DEEC;
// 105DEF0: using guessed type __int64 qword_105DEF0;
// 105DEF8: using guessed type int dword_105DEF8;
// 105DEFC: using guessed type int dword_105DEFC;
// 105DF00: using guessed type int dword_105DF00;
// 105DF04: using guessed type int dword_105DF04;
// 105DF08: using guessed type __int64 qword_105DF08;
// 105DF10: using guessed type int dword_105DF10;
// 105DF14: using guessed type int dword_105DF14;
// 105DF18: using guessed type int dword_105DF18;
// 105DF1C: using guessed type int dword_105DF1C;
// 105DF20: using guessed type __int64 qword_105DF20;
// 105DF28: using guessed type int dword_105DF28;
// 105DF2C: using guessed type int dword_105DF2C;
// 105DF30: using guessed type int dword_105DF30;
// 105DF34: using guessed type int dword_105DF34;
// 105DF38: using guessed type __int64 qword_105DF38;
// 105DF40: using guessed type int dword_105DF40;
// 105DF44: using guessed type int dword_105DF44;
// 105DF48: using guessed type int dword_105DF48;
// 105DF4C: using guessed type int dword_105DF4C;
// 105DF50: using guessed type __int64 qword_105DF50;
// 105DF58: using guessed type int dword_105DF58;
// 105DF5C: using guessed type int dword_105DF5C;
// 105DF60: using guessed type int dword_105DF60;
// 105DF64: using guessed type int dword_105DF64;
// 105DF68: using guessed type __int64 qword_105DF68;
// 105DF70: using guessed type int dword_105DF70;
// 105DF74: using guessed type int dword_105DF74;
// 105DF78: using guessed type int dword_105DF78;
// 105DF7C: using guessed type int dword_105DF7C;
// 105DF80: using guessed type __int64 qword_105DF80;
// 105DF88: using guessed type int dword_105DF88;
// 105DF8C: using guessed type int dword_105DF8C;
// 105DF90: using guessed type int dword_105DF90;
// 105DF94: using guessed type int dword_105DF94;
// 105DF98: using guessed type __int64 qword_105DF98;
// 105DFA0: using guessed type int dword_105DFA0;
// 105DFA4: using guessed type int dword_105DFA4;
// 105DFA8: using guessed type int dword_105DFA8;
// 105DFAC: using guessed type int dword_105DFAC;
// 105DFB0: using guessed type __int64 qword_105DFB0;
// 105DFB8: using guessed type int dword_105DFB8;
// 105DFBC: using guessed type int dword_105DFBC;
// 105DFC0: using guessed type int dword_105DFC0;
// 105DFC4: using guessed type int dword_105DFC4;
// 105DFC8: using guessed type __int64 qword_105DFC8;
// 105DFD0: using guessed type int dword_105DFD0;
// 105DFD4: using guessed type int dword_105DFD4;
// 105DFD8: using guessed type int dword_105DFD8;
// 105DFDC: using guessed type int dword_105DFDC;
// 105DFE0: using guessed type __int64 qword_105DFE0;
// 105DFE8: using guessed type int dword_105DFE8;
// 105DFEC: using guessed type int dword_105DFEC;
// 105DFF0: using guessed type int dword_105DFF0;
// 105DFF4: using guessed type int dword_105DFF4;
// 105DFF8: using guessed type __int64 qword_105DFF8;
// 105E000: using guessed type int dword_105E000;
// 105E004: using guessed type int dword_105E004;
// 105E008: using guessed type int dword_105E008;
// 105E00C: using guessed type int dword_105E00C;
// 105E010: using guessed type __int64 qword_105E010;
// 105E018: using guessed type int dword_105E018;
// 105E01C: using guessed type int dword_105E01C;
// 105E020: using guessed type int dword_105E020;
// 105E024: using guessed type int dword_105E024;
// 105E028: using guessed type __int64 qword_105E028;
// 105E030: using guessed type int dword_105E030;
// 105E034: using guessed type int dword_105E034;
// 105E038: using guessed type int dword_105E038;
// 105E03C: using guessed type int dword_105E03C;
// 105E040: using guessed type __int64 qword_105E040;
// 105E048: using guessed type int dword_105E048;
// 105E04C: using guessed type int dword_105E04C;
// 105E050: using guessed type int dword_105E050;
// 105E054: using guessed type int dword_105E054;
// 105E058: using guessed type __int64 qword_105E058;
// 105E060: using guessed type int dword_105E060;
// 105E064: using guessed type int dword_105E064;
// 105E068: using guessed type int dword_105E068;
// 105E06C: using guessed type int dword_105E06C;
// 105E070: using guessed type __int64 qword_105E070;
// 105E078: using guessed type int dword_105E078;
// 105E07C: using guessed type int dword_105E07C;
// 105E080: using guessed type int dword_105E080;
// 105E084: using guessed type int dword_105E084;
// 105E088: using guessed type __int64 qword_105E088;
// 105E090: using guessed type int dword_105E090;
// 105E094: using guessed type int dword_105E094;
// 105E098: using guessed type int dword_105E098;
// 105E09C: using guessed type int dword_105E09C;
// 105E0A0: using guessed type __int64 qword_105E0A0;

//----- (00F71CE0) --------------------------------------------------------
FARPROC sub_F71CE0()
{
  FARPROC result; // eax

  result = ghUxthemeModule;
  if ( ghUxthemeModule )
  {
    result = GetProcAddress(ghUxthemeModule, "EnableThemeDialogTexture");
    gpfnEnableThemeDialogTexture = result;
  }
  else
  {
    gpfnEnableThemeDialogTexture = 0;
  }
  return result;
}
// 1069E88: using guessed type int (__stdcall *gpfnEnableThemeDialogTexture)(_DWORD, _DWORD);

//----- (00F71D10) --------------------------------------------------------
int dynamic_initializer_for__gPerformanceInfoInMemory__()
{
  PE_PerfInfo::PE_PerfInfo(&gPerformanceInfoInMemory, &gPerformanceInfo);
  return atexit(sub_102A9D0);
}

//----- (00F71D30) --------------------------------------------------------
int dynamic_initializer_for__gPerformanceInfo__()
{
  PerformanceInfo::PerformanceInfo(&gPerformanceInfo, 0);
  return atexit(sub_102A9E0);
}

//----- (00F71D50) --------------------------------------------------------
int dynamic_initializer_for__gNullString__()
{
  BSTR v0; // esi
  Data_t_bstr_t *v1; // eax

  v0 = SysAllocStringLen(&strIn, 1u);
  v1 = operator new(0xCu);
  if ( v1 )
  {
    v1->m_str = 0;
    v1->m_RefCount = 1;
    v1->m_wstr = v0;
  }
  else
  {
    v1 = 0;
  }
  gNullString.m_Data = v1;
  if ( !v1 )
    _com_issue_error(-2147024882);
  return atexit(sub_102A9F0);
}

//----- (00F71DE0) --------------------------------------------------------
int dynamic_initializer_for__gWbemServicesList__()
{
  *(&gWbemServiceList + 1) = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(
                               0,
                               0);
  return atexit(sub_102AA50);
}

//----- (00F71E00) --------------------------------------------------------
BOOL dynamic_initializer_for__gTime__()
{
  GetSystemTimeAsFileTime(&gTime);
  QueryPerformanceCounter(&gTime.Performance);
  return QueryPerformanceFrequency(&gTime.Frequency);
}

//----- (00F71E30) --------------------------------------------------------
int dynamic_initializer_for__gMap1__()
{
  gThreadProcessMap._Header = std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buyheadnode();
  return atexit(sub_102AB20);
}

//----- (00F71E50) --------------------------------------------------------
bool dynamic_initializer_for__gbBitmapOnRight__()
{
  bool result; // al

  result = IsXPDll();
  gbBitmapOnRight = result;
  return result;
}
// 106A8F8: using guessed type char gbBitmapOnRight;

//----- (00F71E60) --------------------------------------------------------
int dynamic_initializer_for__gDiskGraphInfo__()
{
  _bstr_t::_bstr_t(&gDiskGraphInfo.strName, "Disk");
  gDiskGraphInfo.pGraphData = 0;
  gDiskGraphInfo.dbMemorySize = 0i64;
  gDiskGraphInfo.nItemID = 8;
  return atexit(sub_102ABA0);
}

//----- (00F71EA0) --------------------------------------------------------
int dynamic_initializer_for__gIOGraphInfo__()
{
  _bstr_t::_bstr_t(&gIOGraphInfo.strName, "I/O");
  gIOGraphInfo.pGraphData = 0;
  gIOGraphInfo.dbMemorySize = 0i64;
  gIOGraphInfo.nItemID = 2;
  return atexit(sub_102AC00);
}

//----- (00F71EE0) --------------------------------------------------------
int dynamic_initializer_for__gNetworkGraphInfo__()
{
  _bstr_t::_bstr_t(&gNetworkGraphInfo.strName, "Network");
  gNetworkGraphInfo.pGraphData = 0;
  gNetworkGraphInfo.dbMemorySize = 0i64;
  gNetworkGraphInfo.nItemID = 9;
  return atexit(sub_102AC60);
}

//----- (00F71F20) --------------------------------------------------------
int sub_F71F20()
{
  gMap2._Header = sub_FF5440();
  return atexit(sub_102ACC0);
}

//----- (00F71F40) --------------------------------------------------------
int sub_F71F40()
{
  gMap3._Header = sub_FF5440();
  return atexit(sub_102AD40);
}

//----- (00F71F60) --------------------------------------------------------
int sub_F71F60()
{
  int result; // eax

  result = TreeList_Item1::Reset(&gTreeList_Item[2]);
  gTreeList_Item[2].field_14 = 0;
  gTreeList_Item[2].field_10 = 0;
  gTreeList_Item[2].field_C = 0;
  return result;
}

//----- (00F71F90) --------------------------------------------------------
int sub_F71F90()
{
  int result; // eax

  result = TreeList_Item1::Reset(gTreeList_Item);
  gTreeList_Item[0].field_14 = 0;
  gTreeList_Item[0].field_10 = 0;
  gTreeList_Item[0].field_C = 0;
  return result;
}

//----- (00F71FC0) --------------------------------------------------------
int sub_F71FC0()
{
  int result; // eax

  result = TreeList_Item1::Reset(&gTreeList_Item[1]);
  gTreeList_Item[1].field_14 = 0;
  gTreeList_Item[1].field_10 = 0;
  gTreeList_Item[1].field_C = 0;
  return result;
}

//----- (00F71FF0) --------------------------------------------------------
int dynamic_initializer_for__gHttpInfo__()
{
  gHttpInfo.m_List._Mypair._Myval2._Myhead = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(
                                               0,
                                               0);
  gHttpInfo.m_List2._Mypair._Myval2._Myhead = 0;
  gHttpInfo.m_List2._Mypair._Myval2._Mysize = 0;
  gHttpInfo.m_List2._Mypair._Myval2._Myhead = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(
                                                0,
                                                0);
  return atexit(HttpInfo_Release);
}

//----- (00F72070) --------------------------------------------------------
int sub_F72070()
{
  off_10857A4 = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(0, 0);
  return atexit(sub_102AE00);
}

//----- (00F72090) --------------------------------------------------------
int sub_F72090()
{
  dword_108579C = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(
                    0,
                    0);
  return atexit(sub_102AED0);
}

//----- (00F720B0) --------------------------------------------------------
int sub_F720B0()
{
  off_10857AC = std::_List_alloc<std::_List_base_types<tagEventItem *,std::allocator<tagEventItem *>>>::_Buynode0(0, 0);
  return atexit(sub_102AFA0);
}

//----- (00F720D0) --------------------------------------------------------
int sub_F720D0()
{
  gHttpInfo.field_1C = std::_Tree_comp_alloc<std::_Tmap_traits<unsigned long,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *,std::less<unsigned long>,std::allocator<std::pair<unsigned long const,_SYSTEM_PROCESSOR_IDLE_CYCLE_TIME_INFORMATION *>>,0>>::_Buyheadnode();
  return atexit(sub_102B070);
}

//----- (00F720F0) --------------------------------------------------------
int sub_F720F0()
{
  return atexit(sub_102B0F0);
}

//----- (00F720FC) --------------------------------------------------------
int sub_F720FC()
{
  std::_Init_locks::_Init_locks(&unk_10857D8);
  return atexit(sub_102B0FC);
}

//----- (00F72112) --------------------------------------------------------
int sub_F72112()
{
  return atexit(sub_102B106);
}

//----- (00F7211E) --------------------------------------------------------
int sub_F7211E()
{
  return atexit(sub_102B110);
}

//----- (00F7212A) --------------------------------------------------------
int sub_F7212A()
{
  return atexit(sub_102B11A);
}

//----- (00F72136) --------------------------------------------------------
int sub_F72136()
{
  std::_Init_locks::_Init_locks(&unk_10858F0);
  return atexit(sub_102B124);
}

//----- (00F7214C) --------------------------------------------------------
int dynamic_initializer_for__ATL::_AtlBaseModule___()
{
  ATL::CAtlWinModule::CAtlWinModule(&ATL::_AtlBaseModule);
  return atexit(ATL::_dynamic_atexit_destructor_for___AtlBaseModule__);
}

//----- (00F72170) --------------------------------------------------------
_DWORD *__thiscall sub_F72170(_DWORD *this)
{
  _DWORD *v1; // esi
  _WORD *v2; // eax
  _DWORD *result; // eax

  v1 = this;
  v2 = malloc(2u);
  *v1 = v2;
  *v2 = 0;
  result = v1;
  v1[1] = 0;
  v1[2] = 0;
  v1[3] = 0;
  return result;
}

//----- (00F721A0) --------------------------------------------------------
void __thiscall sub_F721A0(void ***this)
{
  void ***v1; // edi
  void **v2; // esi
  void **i; // ebx

  v1 = this;
  v2 = *this;
  if ( *this )
  {
    for ( i = this[1]; v2 != i; ++v2 )
      free(*v2);
    j__free(*v1);
    *v1 = 0;
    v1[1] = 0;
    v1[2] = 0;
  }
}

//----- (00F721F0) --------------------------------------------------------
void __thiscall sub_F721F0(void **this)
{
  void **v1; // edi
  void **v2; // esi
  void **i; // ebx

  v1 = this;
  v2 = this[1];
  if ( v2 )
  {
    for ( i = this[2]; v2 != i; ++v2 )
      free(*v2);
    j__free(v1[1]);
    v1[1] = 0;
    v1[2] = 0;
    v1[3] = 0;
  }
  free(*v1);
}

//----- (00F72250) --------------------------------------------------------
void **__thiscall sub_F72250(void **this, const wchar_t **a2)
{
  void **v2; // edi
  void *v3; // esi

  v2 = this;
  v3 = *this;
  *this = _wcsdup(*a2);
  free(v3);
  return v2;
}

//----- (00F72280) --------------------------------------------------------
void **__thiscall sub_F72280(void **this, wchar_t *a2)
{
  void **v2; // edi
  void *v3; // esi

  v2 = this;
  v3 = *this;
  *this = _wcsdup(a2);
  free(v3);
  return v2;
}

//----- (00F722B0) --------------------------------------------------------
int __cdecl PE_CopyString(WCHAR **ppv, WCHAR *lpszText1, LPCWSTR lpszText2)
{
  const wchar_t *v3; // ecx
  wchar_t *v4; // eax
  wchar_t *pszText2; // esi

  v3 = &gszNullString;
  if ( lpszText2 )
    v3 = lpszText2;
  v4 = _wcsdup(v3);
  pszText2 = v4;
  lpszText2 = v4;
  PE_CopyStringEx(ppv, lpszText1, &lpszText2);
  free(pszText2);
  return ppv;
}

//----- (00F72300) --------------------------------------------------------
void *__thiscall CopyStringToString(WCHAR **ppv, WCHAR *lpszText, DWORD dwPos, DWORD dwLength)
{
  WCHAR **ppv_1; // eax
  WCHAR *pstr; // ecx
  DWORD nTextLen1; // esi
  DWORD dwLength_1; // ebx
  DWORD dwPos_1; // edx
  unsigned int nTextLen2; // edi
  WCHAR *v10; // eax
  WCHAR **ppv_3; // ecx
  WCHAR **ppv_2; // [esp+Ch] [ebp-4h]
  DWORD dwPos_2; // [esp+1Ch] [ebp+Ch]

  ppv_1 = ppv;
  pstr = *ppv;
  ppv_2 = ppv_1;
  nTextLen1 = wcslen(pstr);
  dwLength_1 = dwLength;
  dwPos_1 = dwPos;
  if ( dwPos > nTextLen1 )
    dwPos_1 = nTextLen1;
  dwPos_2 = dwPos_1;
  if ( dwPos_1 + dwLength > nTextLen1 )
    dwLength_1 = nTextLen1 - dwPos_1;
  nTextLen2 = wcslen(lpszText);
  if ( (nTextLen2 - dwLength_1) <= 0 )
  {
    // 
    ppv_3 = ppv_2;
  }
  else
  {
    // 
    v10 = realloc(pstr, 2 * (nTextLen1 + nTextLen2 - dwLength_1 + 2));
    ppv_3 = ppv_2;
    dwPos_1 = dwPos_2;
    *ppv_2 = v10;
  }
  memmove(&(*ppv_3)[dwPos_1 + nTextLen2], &(*ppv_3)[dwPos_1 + dwLength_1], 2 * (nTextLen1 - dwPos_1 - dwLength_1) + 2);
  return memmove_0(&(*ppv_2)[dwPos_2], lpszText, 2 * nTextLen2);
}

//----- (00F723D0) --------------------------------------------------------
void __cdecl sub_F723D0(int a1, void *a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F72480(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F72480(a1, a2, v7, v5);
  free(v7);
}

//----- (00F72480) --------------------------------------------------------
void *__cdecl sub_F72480(int a1, void *a2, wchar_t *psz, void *a4)
{
  DWORD v4; // ebx
  HKEY v5; // esi
  const wchar_t *v6; // eax
  const wchar_t *v7; // eax
  unsigned __int16 **v8; // esi
  unsigned __int16 **v9; // eax
  unsigned int v10; // eax
  tagKeyName *v11; // esi
  unsigned int v12; // eax
  WCHAR *v13; // esi
  void *v14; // esi
  const wchar_t **v15; // eax
  void *v16; // esi
  const wchar_t *v17; // ecx
  const wchar_t *v18; // eax
  unsigned __int16 **v19; // esi
  unsigned __int16 **v20; // eax
  char v21; // bl
  const wchar_t *v22; // eax
  const wchar_t *v23; // eax
  HKEY v24; // ebx
  unsigned __int16 **v25; // esi
  unsigned __int16 **v26; // eax
  const wchar_t *v27; // eax
  unsigned __int16 **v28; // eax
  int a2a; // [esp+10h] [ebp-A4h]
  int v31; // [esp+14h] [ebp-A0h]
  int v32; // [esp+18h] [ebp-9Ch]
  int v33; // [esp+1Ch] [ebp-98h]
  WCHAR v34[2]; // [esp+20h] [ebp-94h]
  WCHAR v35[2]; // [esp+24h] [ebp-90h]
  WCHAR v36[2]; // [esp+28h] [ebp-8Ch]
  int v37; // [esp+2Ch] [ebp-88h]
  void *v38; // [esp+30h] [ebp-84h]
  int v39; // [esp+34h] [ebp-80h]
  WCHAR v40[2]; // [esp+38h] [ebp-7Ch]
  WCHAR v41[2]; // [esp+3Ch] [ebp-78h]
  DWORD v42; // [esp+40h] [ebp-74h]
  void *v43; // [esp+44h] [ebp-70h]
  void *v44; // [esp+48h] [ebp-6Ch]
  void *v45; // [esp+4Ch] [ebp-68h]
  void *v46; // [esp+50h] [ebp-64h]
  void *v47; // [esp+54h] [ebp-60h]
  HKEY hKey; // [esp+58h] [ebp-5Ch]
  void *v49; // [esp+5Ch] [ebp-58h]
  WCHAR szArg[2]; // [esp+60h] [ebp-54h]
  void *v51; // [esp+64h] [ebp-50h]
  void *a1a; // [esp+68h] [ebp-4Ch]
  HKEY KeyHandle; // [esp+6Ch] [ebp-48h]
  LPCWSTR v54; // [esp+70h] [ebp-44h]
  LPCWSTR v55; // [esp+74h] [ebp-40h]
  LPCWSTR v56; // [esp+78h] [ebp-3Ch]
  LPCWSTR szArg3; // [esp+7Ch] [ebp-38h]
  WCHAR *pszText; // [esp+80h] [ebp-34h]
  LPCWSTR v59; // [esp+84h] [ebp-30h]
  LPCWSTR v60; // [esp+88h] [ebp-2Ch]
  LPCWSTR szArg4; // [esp+8Ch] [ebp-28h]
  LPCWSTR v62; // [esp+90h] [ebp-24h]
  LPCWSTR v63; // [esp+94h] [ebp-20h]
  WCHAR *ppv3; // [esp+98h] [ebp-1Ch]
  void *v65; // [esp+9Ch] [ebp-18h]
  LPCWSTR lpSubKey; // [esp+A0h] [ebp-14h]
  std__List *v67; // [esp+A4h] [ebp-10h]
  int v68; // [esp+B0h] [ebp-4h]

  v4 = 0;
  v42 = 0;
  v67 = malloc(2u);
  LOWORD(v67->_Mypair._Myval2._Myhead) = 0;
  v68 = 0;
  ppv3 = malloc(2u);
  *ppv3 = 0;
  lpSubKey = malloc(2u);
  *lpSubKey = 0;
  v65 = malloc(2u);
  *v65 = 0;
  v49 = malloc(2u);
  *v49 = 0;
  v46 = malloc(2u);
  *v46 = 0;
  v47 = malloc(2u);
  *v47 = 0;
  v51 = malloc(2u);
  *v51 = 0;
  v5 = a2;
  LOBYTE(v68) = 7;
  if ( a4 == -1 )
  {
    v62 = _wcsdup(&gszNullString);
    v54 = _wcsdup(&gszNullString);
    v63 = _wcsdup(&gszNullString);
    v55 = _wcsdup(&gszNullString);
    v59 = _wcsdup(&gszNullString);
    v60 = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( psz )
      v6 = psz;
    pszText = _wcsdup(v6);
    v56 = _wcsdup(&gszNullString);
    v7 = &gszNullString;
    if ( psz )
      v7 = psz;
    szArg3 = _wcsdup(v7);
    LOBYTE(v68) = 17;
    v8 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v68) = 18;
    v9 = sub_F77BE0(szArg, a2, &szArg3, &v56);
    LOBYTE(v68) = 19;
    a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v9, v8, &v60);
    free(*szArg);
    free(a1a);
    free(szArg3);
    free(v56);
    free(pszText);
    free(szArg4);
    free(v60);
    free(v59);
    free(v55);
    free(v63);
    free(v54);
    LOBYTE(v68) = 7;
    free(v62);
    v5 = a2;
  }
  v10 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(v5, psz, 0, v10 | 0x20019, &KeyHandle) )
  {
    if ( !PE_LoadKey(KeyHandle, 0, &lpSubKey) )
    {
      do
      {
        v11 = lpSubKey;
        v12 = TlsGetValue(gdwTlsIndex);
        if ( !PE_OpenKey(KeyHandle, v11, 0, v12 | 0x20019, &hKey) )
        {
          if ( !sub_F815A0(KeyHandle, lpSubKey, &ppv3) )
          {
            if ( (LOWORD(v67->_Mypair._Myval2._Myhead) = 0, !sub_F81520(hKey, L"ShellComponent", 0, 0, &v67))
              && LOWORD(v67->_Mypair._Myval2._Myhead)
              || (sub_F81520(hKey, L"StubPath", 0, 0, &v67), LOWORD(v67->_Mypair._Myval2._Myhead)) )
            {
              v13 = ppv3;
              if ( !*ppv3 )
              {
                ppv3 = _wcsdup(L"n/a");
                free(v13);
              }
              a2a = malloc(2u);
              *a2a = 0;
              v31 = 0;
              v32 = 0;
              v33 = 0;
              LOBYTE(v68) = 20;
              sub_F76CC0(v67, &a2a);
              v14 = v51;
              v51 = _wcsdup(v67);
              free(v14);
              v15 = sub_F74EE0(&v38, a1, &a2a, 0);
              v16 = v65;
              v65 = _wcsdup(*v15);
              free(v16);
              free(v38);
              v37 = sub_F74ED0();
              v17 = &gszNullString;
              if ( psz )
                v17 = psz;
              v63 = _wcsdup(v17);
              v54 = _wcsdup(&gszNullString);
              v18 = &gszNullString;
              if ( psz )
                v18 = psz;
              v62 = _wcsdup(v18);
              LOBYTE(v68) = 23;
              v19 = sub_F77BE0(v41, a2, &v63, &lpSubKey);
              LOBYTE(v68) = 24;
              v20 = sub_F77BE0(v36, a2, &v62, &v54);
              LOBYTE(v68) = 25;
              v21 = sub_F73D40(a1, v20, v19, &ppv3, &v65, &v49, &v47, &v39);
              free(*v36);
              free(*v41);
              free(v62);
              free(v54);
              free(v63);
              if ( v21 )
              {
                if ( a4 == -1 )
                {
                  v44 = _wcsdup(&gszNullString);
                  v43 = _wcsdup(&gszNullString);
                  v45 = _wcsdup(&gszNullString);
                  szArg3 = _wcsdup(&gszNullString);
                  v56 = _wcsdup(&gszNullString);
                  pszText = _wcsdup(&gszNullString);
                  szArg4 = _wcsdup(&gszNullString);
                  v22 = &gszNullString;
                  if ( psz )
                    v22 = psz;
                  v60 = _wcsdup(v22);
                  v59 = _wcsdup(&gszNullString);
                  v23 = &gszNullString;
                  if ( psz )
                    v23 = psz;
                  v55 = _wcsdup(v23);
                  v24 = a2;
                  LOBYTE(v68) = 35;
                  v25 = sub_F77BE0(v40, a2, &v60, &szArg4);
                  LOBYTE(v68) = 36;
                  v26 = sub_F77BE0(v34, a2, &v55, &v59);
                  LOBYTE(v68) = 37;
                  a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v26, v25, &pszText);
                  free(*v34);
                  free(*v40);
                  free(v55);
                  free(v59);
                  free(v60);
                  free(szArg4);
                  free(pszText);
                  free(v56);
                  free(szArg3);
                  free(v45);
                  free(v43);
                  free(v44);
                }
                else
                {
                  v24 = a2;
                }
                *szArg = _wcsdup(&gszNullString);
                v27 = &gszNullString;
                if ( psz )
                  v27 = psz;
                a1a = _wcsdup(v27);
                LOBYTE(v68) = 39;
                v28 = sub_F77BE0(v35, v24, &a1a, &lpSubKey);
                LOBYTE(v68) = 40;
                sub_F73FF0(a1, v37, a4, 3, &ppv3, v28, &v65);
                free(*v35);
                free(a1a);
                free(*szArg);
              }
              LOBYTE(v68) = 7;
              sub_F721F0(&a2a);
              v4 = v42;
            }
          }
          RegCloseKey(hKey);
        }
        v42 = ++v4;
      }
      while ( !PE_LoadKey(KeyHandle, v4, &lpSubKey) );
    }
    RegCloseKey(KeyHandle);
  }
  free(v51);
  free(v47);
  free(v46);
  free(v49);
  free(v65);
  free(lpSubKey);
  free(ppv3);
  free(v67);
  return a4;
}

//----- (00F72BC0) --------------------------------------------------------
void __stdcall sub_F72BC0(void **a1, void **a2)
{
  void **i; // esi

  for ( i = a1; i != a2; ++i )
    free(*i);
}

//----- (00F72BF0) --------------------------------------------------------
char *__cdecl sub_F72BF0(int a1, int a2)
{
  int v2; // edi
  void **v3; // esi
  void **i; // ebx
  char *result; // eax

  if ( a1 != a2 )
  {
    v2 = a1 + 4;
    do
    {
      v3 = *v2;
      if ( *v2 )
      {
        for ( i = *(v2 + 4); v3 != i; ++v3 )
          free(*v3);
        j__free(*v2);
        *v2 = 0;
        *(v2 + 4) = 0;
        *(v2 + 8) = 0;
      }
      free(*(v2 - 4));
      v2 += 16;
      result = (v2 - 4);
    }
    while ( v2 - 4 != a2 );
  }
  return result;
}

//----- (00F72C60) --------------------------------------------------------
void __thiscall sub_F72C60(int *this)
{
  int *v1; // esi

  v1 = this;
  if ( *this )
  {
    sub_F72BF0(*this, this[1]);
    j__free(*v1);
    *v1 = 0;
    v1[1] = 0;
    v1[2] = 0;
  }
}

//----- (00F72CB0) --------------------------------------------------------
void __cdecl sub_F72CB0(int a1, void *a2, void *a3, LPCWSTR lpValueName)
{
  _WORD *v4; // ST58_4
  WCHAR *v5; // esi
  void *v6; // edi
  const wchar_t **v7; // eax
  wchar_t *v8; // ST5C_4

  v4 = malloc(2u);
  *v4 = 0;
  v5 = a3;
  v6 = sub_F72D60(a1, a2, *a3, lpValueName, 0xFFFFFFFF);
  v7 = PE_CopyString(&a3, v5, L"\\AutorunsDisabled");
  v8 = _wcsdup(*v7);
  free(v4);
  free(a3);
  sub_F72D60(a1, a2, v8, lpValueName, v6);
  free(v8);
}

//----- (00F72D60) --------------------------------------------------------
void *__cdecl sub_F72D60(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, void *a5)
{
  LPCWSTR v5; // ebx
  HKEY v6; // esi
  const wchar_t *v7; // eax
  const wchar_t *v8; // eax
  const wchar_t *v9; // eax
  const wchar_t *v10; // eax
  unsigned __int16 **v11; // esi
  unsigned __int16 **v12; // eax
  unsigned int v13; // eax
  int v14; // edx
  wchar_t *v15; // ecx
  unsigned int v16; // edi
  int v17; // esi
  const wchar_t **v18; // eax
  void *v19; // esi
  const WCHAR **v20; // ecx
  const wchar_t *v21; // eax
  const WCHAR **v22; // eax
  const wchar_t *v23; // eax
  unsigned __int16 **v24; // esi
  unsigned __int16 **v25; // eax
  char v26; // bl
  const wchar_t *v27; // eax
  const wchar_t *v28; // eax
  const wchar_t *v29; // eax
  const wchar_t *v30; // eax
  unsigned __int16 **v31; // esi
  unsigned __int16 **v32; // eax
  const WCHAR **v33; // eax
  const wchar_t *v34; // eax
  unsigned __int16 **v35; // eax
  WCHAR v37[2]; // [esp+10h] [ebp-A4h]
  WCHAR v38[2]; // [esp+14h] [ebp-A0h]
  WCHAR v39[2]; // [esp+18h] [ebp-9Ch]
  WCHAR v40[2]; // [esp+1Ch] [ebp-98h]
  int a2a; // [esp+20h] [ebp-94h]
  WCHAR v42[2]; // [esp+24h] [ebp-90h]
  int v43; // [esp+28h] [ebp-8Ch]
  void *v44; // [esp+2Ch] [ebp-88h]
  void *v45; // [esp+30h] [ebp-84h]
  LPCWSTR v46; // [esp+34h] [ebp-80h]
  HKEY hKey; // [esp+38h] [ebp-7Ch]
  WCHAR **ppv3; // [esp+3Ch] [ebp-78h]
  void *v49; // [esp+40h] [ebp-74h]
  LPCWSTR v50; // [esp+44h] [ebp-70h]
  void *v51; // [esp+48h] [ebp-6Ch]
  wchar_t *v52; // [esp+4Ch] [ebp-68h]
  int v53; // [esp+50h] [ebp-64h]
  int v54; // [esp+54h] [ebp-60h]
  void *v55; // [esp+58h] [ebp-5Ch]
  void *v56; // [esp+5Ch] [ebp-58h]
  void *v57; // [esp+60h] [ebp-54h]
  wchar_t *v58; // [esp+64h] [ebp-50h]
  void *v59; // [esp+6Ch] [ebp-48h]
  WCHAR szArg[2]; // [esp+70h] [ebp-44h]
  void *a1a; // [esp+74h] [ebp-40h]
  void *v62; // [esp+78h] [ebp-3Ch]
  LPCWSTR v63; // [esp+7Ch] [ebp-38h]
  LPCWSTR szArg3; // [esp+80h] [ebp-34h]
  LPCWSTR v65; // [esp+84h] [ebp-30h]
  LPCWSTR v66; // [esp+88h] [ebp-2Ch]
  LPCWSTR v67; // [esp+8Ch] [ebp-28h]
  LPCWSTR v68; // [esp+90h] [ebp-24h]
  LPCWSTR v69; // [esp+94h] [ebp-20h]
  LPCWSTR v70; // [esp+98h] [ebp-1Ch]
  LPCWSTR szArg4; // [esp+9Ch] [ebp-18h]
  WCHAR *pszText; // [esp+A0h] [ebp-14h]
  void *v73; // [esp+A4h] [ebp-10h]
  int v74; // [esp+B0h] [ebp-4h]

  v58 = malloc(2u);
  *v58 = 0;
  v74 = 0;
  v73 = malloc(2u);
  *v73 = 0;
  v62 = malloc(2u);
  *v62 = 0;
  v57 = malloc(2u);
  *v57 = 0;
  v59 = malloc(2u);
  *v59 = 0;
  v5 = lpValueName;
  v6 = a2;
  LOBYTE(v74) = 4;
  if ( a5 == -1 )
  {
    v68 = _wcsdup(&gszNullString);
    v63 = _wcsdup(&gszNullString);
    v65 = _wcsdup(&gszNullString);
    v67 = _wcsdup(&gszNullString);
    v69 = _wcsdup(&gszNullString);
    v70 = _wcsdup(&gszNullString);
    v7 = &gszNullString;
    if ( lpValueName )
      v7 = lpValueName;
    szArg4 = _wcsdup(v7);
    v8 = &gszNullString;
    if ( psz )
      v8 = psz;
    pszText = _wcsdup(v8);
    v9 = &gszNullString;
    if ( lpValueName )
      v9 = lpValueName;
    v66 = _wcsdup(v9);
    v10 = &gszNullString;
    if ( psz )
      v10 = psz;
    szArg3 = _wcsdup(v10);
    LOBYTE(v74) = 14;
    v11 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v74) = 15;
    v12 = sub_F77BE0(szArg, a2, &szArg3, &v66);
    LOBYTE(v74) = 16;
    a5 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v12, v11, &v70);
    free(*szArg);
    free(a1a);
    free(szArg3);
    free(v66);
    free(pszText);
    free(szArg4);
    free(v70);
    free(v69);
    free(v67);
    free(v65);
    free(v63);
    LOBYTE(v74) = 4;
    free(v68);
    v6 = a2;
  }
  v13 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(v6, psz, 0, v13 | 0x20019, &hKey) )
  {
    if ( !sub_F81520(hKey, lpValueName, 0, 0, &v58) )
    {
      v52 = 0;
      v53 = 0;
      v54 = 0;
      LOBYTE(v74) = 17;
      sub_F76DD0(v58, 44, &v52, 32);
      v14 = v53;
      v15 = v52;
      v16 = 0;
      if ( (v53 - v52) >> 4 )
      {
        v17 = 0;
        *szArg = 0;
        do
        {
          ppv3 = (v15 + v17);
          v18 = sub_F74EE0(&v44, a1, v15 + v17, 0);
          v19 = v73;
          v73 = _wcsdup(*v18);
          free(v19);
          free(v44);
          a2a = sub_F74ED0();
          v20 = &gszNullString;
          if ( v5 )
            v20 = v5;
          v67 = _wcsdup(v20);
          v21 = &gszNullString;
          if ( psz )
            v21 = psz;
          v65 = _wcsdup(v21);
          v22 = &gszNullString;
          if ( v5 )
            v22 = v5;
          v63 = _wcsdup(v22);
          v23 = &gszNullString;
          if ( psz )
            v23 = psz;
          v68 = _wcsdup(v23);
          LOBYTE(v74) = 21;
          v24 = sub_F77BE0(v42, a2, &v65, &v67);
          LOBYTE(v74) = 22;
          v25 = sub_F77BE0(v37, a2, &v68, &v63);
          LOBYTE(v74) = 23;
          v26 = sub_F73D40(a1, v25, v24, ppv3, &v73, &v62, &v59, &v43);
          free(*v37);
          free(*v42);
          free(v68);
          free(v63);
          free(v65);
          LOBYTE(v74) = 17;
          free(v67);
          if ( v26 )
          {
            if ( a5 == -1 )
            {
              v45 = _wcsdup(&gszNullString);
              v49 = _wcsdup(&gszNullString);
              v56 = _wcsdup(&gszNullString);
              v51 = _wcsdup(&gszNullString);
              szArg3 = _wcsdup(&gszNullString);
              v66 = _wcsdup(&gszNullString);
              v5 = lpValueName;
              v27 = &gszNullString;
              if ( lpValueName )
                v27 = lpValueName;
              pszText = _wcsdup(v27);
              v28 = &gszNullString;
              if ( psz )
                v28 = psz;
              szArg4 = _wcsdup(v28);
              v29 = &gszNullString;
              if ( lpValueName )
                v29 = lpValueName;
              v70 = _wcsdup(v29);
              v30 = &gszNullString;
              if ( psz )
                v30 = psz;
              v69 = _wcsdup(v30);
              LOBYTE(v74) = 33;
              v31 = sub_F77BE0(v40, a2, &szArg4, &pszText);
              LOBYTE(v74) = 34;
              v32 = sub_F77BE0(v38, a2, &v69, &v70);
              LOBYTE(v74) = 35;
              a5 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v32, v31, &v66);
              free(*v38);
              free(*v40);
              free(v69);
              free(v70);
              free(szArg4);
              free(pszText);
              free(v66);
              free(szArg3);
              free(v51);
              free(v56);
              free(v49);
              free(v45);
            }
            else
            {
              v5 = lpValueName;
            }
            a1a = _wcsdup(&gszNullString);
            v55 = _wcsdup(&gszNullString);
            v33 = &gszNullString;
            if ( v5 )
              v33 = v5;
            v46 = _wcsdup(v33);
            v34 = &gszNullString;
            if ( psz )
              v34 = psz;
            v50 = _wcsdup(v34);
            LOBYTE(v74) = 39;
            v35 = sub_F77BE0(v39, a2, &v50, &v46);
            LOBYTE(v74) = 40;
            sub_F73FF0(a1, a2a, a5, 5, ppv3, v35, &v73);
            free(*v39);
            free(v50);
            free(v46);
            free(v55);
            LOBYTE(v74) = 17;
            free(a1a);
          }
          else
          {
            v5 = lpValueName;
          }
          v14 = v53;
          ++v16;
          v15 = v52;
          v17 = *szArg + 16;
          *szArg += 16;
        }
        while ( v16 < (v53 - v52) >> 4 );
      }
      if ( v15 )
      {
        sub_F72BF0(v15, v14);
        j__free(v52);
      }
    }
    RegCloseKey(hKey);
  }
  free(v59);
  free(v57);
  free(v62);
  free(v73);
  free(v58);
  return a5;
}

//----- (00F73440) --------------------------------------------------------
int __cdecl sub_F73440(int a1, int a2, int a3)
{
  int v3; // esi
  int v4; // edi
  int v8; // [esp+0h] [ebp-24h]
  int v9; // [esp+10h] [ebp-14h]
  int *v10; // [esp+14h] [ebp-10h]
  int v11; // [esp+20h] [ebp-4h]

  v10 = &v8;
  v3 = a3;
  v4 = a1;
  v9 = a3;
  v11 = 0;
  while ( v4 != a2 )
  {
    if ( v3 )
    {
      *v3 = _wcsdup(*v4);
      LOBYTE(v11) = 2;
      sub_F735A0((v3 + 4), (v4 + 4));
    }
    v3 += 16;
    LOBYTE(v11) = 0;
    v4 += 16;
  }
  return v3;
}
// 10081AA: using guessed type void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD);

//----- (00F734F0) --------------------------------------------------------
wchar_t **__cdecl sub_F734F0(std__vector *a1, const wchar_t **a2, wchar_t **a3)
{
  const wchar_t **v3; // esi
  wchar_t **v4; // edi

  v3 = a1;
  if ( a1 == a2 )
    return a3;
  v4 = a3;
  do
  {
    if ( v4 )
      *v4 = _wcsdup(*v3);
    ++v3;
    ++v4;
  }
  while ( v3 != a2 );
  return v4;
}

//----- (00F73530) --------------------------------------------------------
_DWORD *__thiscall sub_F73530(void *this, void *a2)
{
  _DWORD *v2; // edi

  v2 = this;
  *(this + 5) = 7;
  *(this + 4) = 0;
  *this = 0;
  if ( *(a2 + 5) >= 8u )
  {
    *this = *a2;
    *a2 = 0;
  }
  else if ( *(a2 + 4) != -1 )
  {
    memmove(this, a2, 2 * (*(a2 + 4) + 1));
  }
  v2[4] = *(a2 + 4);
  v2[5] = *(a2 + 5);
  *(a2 + 5) = 7;
  *(a2 + 4) = 0;
  *a2 = 0;
  return v2;
}

//----- (00F735A0) --------------------------------------------------------
wchar_t ***__thiscall sub_F735A0(wchar_t ***this, const wchar_t ***a2)
{
  wchar_t ***v2; // esi
  const wchar_t ***v3; // edi
  int v5; // [esp+0h] [ebp-24h]
  wchar_t ***v6; // [esp+10h] [ebp-14h]
  int *v7; // [esp+14h] [ebp-10h]
  int v8; // [esp+20h] [ebp-4h]

  v7 = &v5;
  v2 = this;
  v6 = this;
  v3 = a2;
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  if ( sub_F7F930(this, v3[1] - *v3) )
  {
    v8 = 0;
    v2[1] = sub_F734F0(*v3, v3[1], *v2);
  }
  return v2;
}
// 10081AA: using guessed type void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD);

//----- (00F73650) --------------------------------------------------------
BSTR *__thiscall _bstr_t::Data_t::Data_t(Data_t_bstr_t *this, _bstr_t *a2, _bstr_t *a3)
{
  Data_t_bstr_t *v3; // ebx
  OLECHAR *v4; // eax
  UINT v5; // edi
  OLECHAR *v6; // eax
  UINT v7; // esi
  unsigned int v8; // ecx
  BSTR v9; // edx
  Data_t_bstr_t *v10; // eax
  Data_t_bstr_t *v11; // eax
  int v13; // [esp+Ch] [ebp-8h]

  v3 = this;
  this->m_str = 0;
  this->m_RefCount = 1;
  if ( a2->m_Data && (v4 = a2->m_Data->m_wstr) != 0 )
    v5 = SysStringLen(v4);
  else
    v5 = 0;
  if ( a3->m_Data && (v6 = a3->m_Data->m_wstr) != 0 )
    v7 = SysStringLen(v6);
  else
    v7 = 0;
  v8 = v7 + v5;
  if ( v7 + v5 < v7 || !is_mul_ok(2u, v8) || 2 * v8 > 0xFFFFFFFF )
LABEL_22:
    _com_issue_error(E_OUTOFMEMORY);
  v13 = 2 * v8;
  v9 = SysAllocStringByteLen(0, 2 * v8);
  v3->m_wstr = v9;
  if ( v9 )
  {
    v10 = a2->m_Data;
    if ( a2->m_Data && v10->m_wstr )
      memcpy_s(v9, v13 + 2, v10->m_wstr, 2 * v5 + 2);
    v11 = a3->m_Data;
    if ( a3->m_Data && v11->m_wstr )
      memcpy_s(&v3->m_wstr[v5], 2 * v7 + 2, v11->m_wstr, 2 * v7 + 2);
  }
  else if ( v7 + v5 )
  {
    goto LABEL_22;
  }
  return v3;
}

//----- (00F73750) --------------------------------------------------------
void __thiscall sub_F73750(void *this)
{
  _DWORD *v1; // esi
  _WORD *v2; // eax

  v1 = this;
  v2 = malloc(2u);
  v1[4] = v2;
  *v2 = 0;
  v1[5] = 0;
  v1[6] = 0;
  v1[7] = 0;
}

//----- (00F73780) --------------------------------------------------------
BSTR **__thiscall _bstr_t::_bstr_t(_bstr_t *this, OLECHAR *psz)
{
  _bstr_t *v2; // edi
  Data_t_bstr_t *v3; // eax
  Data_t_bstr_t *v4; // esi
  BSTR v5; // eax

  v2 = this;
  v3 = operator new(0xCu);
  v4 = v3;
  if ( v3 )
  {
    v3->m_str = 0;
    v3->m_RefCount = 1;
    v5 = SysAllocString(psz);
    v4->m_wstr = v5;
    if ( !v5 && psz )
      _com_issue_error(-2147024882);
  }
  else
  {
    v4 = 0;
  }
  v2->m_Data = v4;
  if ( !v4 )
    _com_issue_error(-2147024882);
  return v2;
}

//----- (00F73820) --------------------------------------------------------
int __thiscall sub_F73820(int this)
{
  int v1; // esi
  int result; // eax

  v1 = this;
  if ( *(this + 20) >= 8u )
    j__free(*this);
  *(v1 + 20) = 7;
  result = 0;
  *(v1 + 16) = 0;
  *v1 = 0;
  return result;
}

//----- (00F73850) --------------------------------------------------------
void __thiscall sub_F73850(void *this)
{
  void *v1; // esi

  v1 = this;
  if ( *(this + 5) )
  {
    j__free(*(this + 5));
    *(v1 + 5) = 0;
    *(v1 + 6) = 0;
    *(v1 + 7) = 0;
  }
  free(*(v1 + 4));
}

//----- (00F73890) --------------------------------------------------------
void __thiscall _bstr_t::_Free(_bstr_t *this)
{
  _bstr_t *v1; // edi
  Data_t_bstr_t *v2; // esi

  v1 = this;
  v2 = this->m_Data;
  if ( this->m_Data )
  {
    if ( !InterlockedDecrement(&v2->m_RefCount) && v2 )
    {
      if ( v2->m_wstr )
      {
        SysFreeString(v2->m_wstr);
        v2->m_wstr = 0;
      }
      if ( v2->m_str )
      {
        j_j__free(v2->m_str);
        v2->m_str = 0;
      }
      j__free(v2);
    }
    v1->m_Data = 0;
  }
}

//----- (00F738F0) --------------------------------------------------------
int *__thiscall sub_F738F0(int *this, const wchar_t ***a2)
{
  int *v2; // edi
  const wchar_t ***v3; // ebx
  const wchar_t **v4; // esi
  const wchar_t **v5; // eax
  void **v6; // ecx
  unsigned int v7; // edx
  void **v8; // esi
  void **v9; // ebx
  wchar_t **v10; // eax
  const wchar_t **v12; // esi
  int v13; // [esp+0h] [ebp-28h]
  int *v14; // [esp+10h] [ebp-18h]
  unsigned int v15; // [esp+14h] [ebp-14h]
  int *v16; // [esp+18h] [ebp-10h]
  int v17; // [esp+24h] [ebp-4h]

  v16 = &v13;
  v2 = this;
  v14 = this;
  v3 = a2;
  if ( this != a2 )
  {
    v4 = *a2;
    v5 = a2[1];
    if ( *a2 == v5 )
    {
      sub_F80010(this);
      return v2;
    }
    v6 = *this;
    v7 = v5 - v4;
    v15 = (v2[1] - *v2) >> 2;
    if ( v7 <= v15 )
    {
      v8 = sub_F94700(v4, a2[1], v6);
      if ( v8 != v2[1] )
      {
        v9 = v2[1];
        do
        {
          free(*v8);
          ++v8;
        }
        while ( v8 != v9 );
        v3 = a2;
      }
      v10 = (*v2 + 4 * (v3[1] - *v3));
      goto LABEL_10;
    }
    if ( v7 <= (v2[2] - v6) >> 2 )
    {
      v12 = &v4[v15];
      sub_F94700(*a2, v12, v6);
      v10 = sub_F734F0(v12, v3[1], v2[1]);
LABEL_10:
      v2[1] = v10;
      return v2;
    }
    if ( v6 )
    {
      sub_F72BC0(v6, v2[1]);
      j__free(*v2);
    }
    if ( sub_F7F930(v2, v3[1] - *v3) )
    {
      v17 = 0;
      v10 = sub_F734F0(*v3, v3[1], *v2);
      goto LABEL_10;
    }
  }
  return v2;
}
// 10081AA: using guessed type void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD);

//----- (00F73A50) --------------------------------------------------------
_bstr_t *__thiscall sub_F73A50(_bstr_t *this, _bstr_t *a2)
{
  _bstr_t *v2; // esi
  Data_t_bstr_t *v3; // eax

  v2 = this;
  if ( this != a2 )
  {
    _bstr_t::_Free(this);
    v3 = a2->m_Data;
    v2->m_Data = a2->m_Data;
    if ( v3 )
      InterlockedIncrement(&v3->m_RefCount);
  }
  return v2;
}

//----- (00F73A80) --------------------------------------------------------
EventItem *__thiscall _bstr_t::operator=(EventItem *this, OLECHAR *psz)
{
  EventItem *v2; // edi
  OLECHAR *v3; // eax
  Data_t_bstr_t *v4; // eax
  Data_t_bstr_t *v5; // esi
  BSTR v6; // eax

  v2 = this;
  // ??4_bstr_t@@QAEAAV0@PB_W@Z
  if ( !psz || (!this->strEventTrace.m_Data ? (v3 = 0) : (v3 = this->strEventTrace.m_Data->m_wstr), v3 != psz) )
  {
    _bstr_t::_Free(&this->strEventTrace);
    v4 = operator new(0xCu);
    v5 = v4;
    if ( v4 )
    {
      v4->m_str = 0;
      v4->m_RefCount = 1;
      v6 = SysAllocString(psz);
      v5->m_wstr = v6;
      if ( !v6 && psz )
        _com_issue_error(E_OUTOFMEMORY);
    }
    else
    {
      v5 = 0;
    }
    v2->strEventTrace.m_Data = v5;
    if ( !v5 )
      _com_issue_error(E_OUTOFMEMORY);
  }
  return v2;
}

//----- (00F73B40) --------------------------------------------------------
int __thiscall sub_F73B40(int **this)
{
  int result; // eax

  if ( *this )
    result = **this;
  else
    result = 0;
  return result;
}

//----- (00F73B50) --------------------------------------------------------
_bstr_t *__cdecl _bstr_t::operator+(_bstr_t *a1, OLECHAR *psz, _bstr_t *a2)
{
  _bstr_t::_bstr_t(a1, psz);
  _bstr_t::operator+=(a1, a2);
  return a1;
}

//----- (00F73BC0) --------------------------------------------------------
_bstr_t *__thiscall _bstr_t::operator+(Data_t_bstr_t **this, _bstr_t *a2, _bstr_t *a3)
{
  Data_t_bstr_t *v3; // eax

  v3 = *this;
  a2->m_Data = *this;
  if ( v3 )
    InterlockedIncrement(&v3->m_RefCount);
  _bstr_t::operator+=(a2, a3);
  return a2;
}

//----- (00F73C30) --------------------------------------------------------
BOOL __thiscall sub_F73C30(BSTR **this, BSTR **a2)
{
  Data_t_bstr_t *v2; // ecx
  BSTR *v3; // eax
  OLECHAR *v5; // eax

  v2 = *this;
  v3 = *a2;
  if ( v2 == *a2 )
    return 0;
  if ( !v2 )
  {
    if ( v3 )
    {
      v5 = *v3;
      if ( v5 )
      {
        if ( SysStringLen(v5) )
          return 1;
      }
    }
    return 0;
  }
  if ( v3 )
    return bstr_t::Data_t::Compare(v2, *a2) < 0;
  if ( !v2->m_wstr || !SysStringLen(v2->m_wstr) )
    return 0;
  return 0;
}

//----- (00F73CB0) --------------------------------------------------------
OLECHAR ***__thiscall _bstr_t::operator+=(_bstr_t *this, _bstr_t *a2)
{
  _bstr_t *v2; // esi
  Data_t_bstr_t *v3; // eax
  BSTR *v4; // edi

  v2 = this;
  v3 = operator new(0xCu);
  if ( v3 )
    v4 = _bstr_t::Data_t::Data_t(v3, v2, a2);
  else
    v4 = 0;
  if ( !v4 )
    _com_issue_error(E_OUTOFMEMORY);
  _bstr_t::_Free(v2);
  v2->m_Data = v4;
  return v2;
}

//----- (00F73D40) --------------------------------------------------------
char __cdecl sub_F73D40(int a1, const wchar_t **a2, OLECHAR **a3, OLECHAR **a4, OLECHAR **a5, const wchar_t **a6, void **a7, _DWORD *a8)
{
  OLECHAR **v8; // esi
  void *v10; // esi
  wchar_t *v11; // eax
  wchar_t *v12; // edi
  const wchar_t *v13; // eax
  wchar_t *v14; // eax
  int v15; // eax
  WCHAR **v16; // esi
  const wchar_t **v17; // eax
  const wchar_t *v18; // edi
  const wchar_t *v19; // ecx
  WCHAR **v20; // esi
  WCHAR **v21; // esi
  const wchar_t **v22; // eax
  wchar_t *v23; // ST14_4
  WCHAR *v24; // ST10_4
  wchar_t *v25; // eax
  WCHAR *v26; // eax
  WCHAR *v27; // esi
  unsigned __int16 **v28; // eax
  int v29; // [esp+10h] [ebp-84h]
  OLECHAR **v30; // [esp+14h] [ebp-80h]
  int v31; // [esp+18h] [ebp-7Ch]
  OLECHAR **v32; // [esp+1Ch] [ebp-78h]
  wchar_t *v33; // [esp+20h] [ebp-74h]
  OLECHAR **v34; // [esp+24h] [ebp-70h]
  WCHAR *ppv1; // [esp+28h] [ebp-6Ch]
  WCHAR *ppv2; // [esp+2Ch] [ebp-68h]
  WCHAR **ppszText2; // [esp+30h] [ebp-64h]
  wchar_t *v38; // [esp+34h] [ebp-60h]
  int v39; // [esp+90h] [ebp-4h]

  v8 = a5;
  v30 = a3;
  v32 = a4;
  v34 = a5;
  ppszText2 = a6;
  v31 = a8;
  *a8 = 0;
  v29 = 20;
  if ( byte_1063860 )
    ExitThread(0);
  if ( !_wcsicmp(*a2, L"desktop.ini") )
    return 0;
  if ( dword_1063858 )
  {
    v10 = *a7;
    *a7 = _wcsdup(*a6);
    free(v10);
    v11 = malloc(2u);
    v12 = v11;
    v33 = v11;
    *v11 = 0;
    v39 = 0;
    v13 = &gszNullString;
    if ( *v34 )
      v13 = *v34;
    v14 = _wcsdup(v13);
    v15 = sub_F91290(v14, a7);
    if ( v15 != 2 )
    {
      if ( v15 )
      {
        if ( !**a7 )
          goto LABEL_24;
        v26 = _wcsdup(L"(Not Verified) ");
      }
      else
      {
        v26 = _wcsdup(L"(Verified) ");
      }
      v27 = v26;
      ppv2 = v26;
      v28 = PE_CopyStringEx(&ppv1, &ppv2, a7);
      sub_F72250(a7, v28);
      free(ppv1);
      free(v27);
      goto LABEL_24;
    }
    ppv2 = sub_F76700(*v34, 0, 0, &v38, &v29, 0);
    if ( ppv2 )
    {
      v16 = ppszText2;
      if ( !**ppszText2 )
      {
LABEL_18:
        v23 = _wcsdup(v12);
        v24 = ppv2;
        v25 = _wcsdup(*v34);
        sub_F911B0(v25, v24, v23);
LABEL_24:
        v39 = -1;
        free(v12);
        v8 = v34;
        goto LABEL_25;
      }
      sub_F72250(&v33, ppszText2);
      v17 = PE_CopyString2(&ppszText2, L"(Not verified) ", v16);
      sub_F72250(a7, v17);
      free(ppszText2);
    }
    else
    {
      v18 = &gszNullString;
      v19 = &gszNullString;
      if ( v38 )
        v19 = v38;
      v20 = _wcsdup(v19);
      ppszText2 = v20;
      sub_F72250(&v33, &ppszText2);
      free(v20);
      if ( v38 )
        v18 = v38;
      v21 = _wcsdup(v18);
      ppszText2 = v21;
      v22 = PE_CopyString2(&ppv1, L"(Verified) ", &ppszText2);
      sub_F72250(a7, v22);
      free(ppv1);
      free(v21);
    }
    v12 = v33;
    goto LABEL_18;
  }
LABEL_25:
  if ( dword_10648D4 )
  {
    if ( wcsncmp(*v8, L"File not found: ", 0x10u) )
      sub_F91590(1, v31, *v30, *v32, *v8, 0);
  }
  return 1;
}
// 1063858: using guessed type int dword_1063858;
// 1063860: using guessed type char byte_1063860;
// 10648D4: using guessed type int dword_10648D4;

//----- (00F73FF0) --------------------------------------------------------
int __cdecl sub_F73FF0(int a1, int a2, void *ppv1, int a4, WCHAR **ppv3, int a6, int a7)
{
  WCHAR *v7; // edi
  unsigned __int16 **v8; // eax
  OLECHAR *v9; // esi
  OLECHAR *v10; // ecx
  int result; // eax
  void *v12; // esi

  if ( !(dword_1064C48 & 1) )
  {
    dword_1064C48 |= 1u;
    *&gpszText1 = malloc(2u);
    **&gpszText1 = 0;
    atexit(sub_102A2E0);
  }
  if ( ppv1 == -1 )
  {
    v12 = *&gpszText1;
    *&gpszText1 = _wcsdup(*ppv3);
    free(v12);
    result = 0;
  }
  else
  {
    v7 = malloc(2u);
    *v7 = 0;
    if ( a4 == 9 )
    {
      v8 = PE_CopyStringEx(&ppv1, &gpszText1, ppv3);
      v9 = _wcsdup(*v8);
      free(v7);
      free(ppv1);
    }
    else
    {
      v9 = _wcsdup(*a6);
      free(v7);
    }
    if ( gbFlagsInSub_40B220 == 1 )
    {
      v10 = L"System";
    }
    else if ( gpAccountInfo )
    {
      v10 = gpAccountInfo->szReferenceName;
    }
    else
    {
      v10 = L"Local System";
    }
    sub_FABF00(v10, *a7, v9);
    free(v9);
    result = 0;
  }
  return result;
}
// 102D5D8: using guessed type wchar_t aLocalSystem[13];
// 10631C0: using guessed type int gbFlagsInSub_40B220;
// 1064C48: using guessed type int dword_1064C48;

//----- (00F74130) --------------------------------------------------------
void __cdecl LoadSystemAccountInfo(HWND hWnd)
{
  HANDLE v1; // eax
  HMENU v2; // eax
  tagAccountInfo *pAccountInfo; // eax
  OLECHAR *pszUserName_1; // edx
  tagAccountInfo *v5; // ebx
  WCHAR *v6; // esi
  OLECHAR v7; // cx
  const wchar_t *v8; // ecx
  int v9; // edi
  wchar_t v10; // ax
  HWND v11; // edi
  UINT v12; // ST14_4
  HMENU v13; // eax
  HMENU v14; // eax
  unsigned int dwMode; // eax
  char *dwIndex; // ebx
  LSTATUS (__stdcall *RegQueryValueExW)(HKEY, LPCWSTR, LPDWORD, LPDWORD, LPBYTE, LPDWORD); // edi
  tagKeyName *pszDefaultUserName; // esi
  unsigned int dwMode_1; // eax
  PSID pSID; // ebx
  tagAccountInfo *pInfo; // eax
  tagAccountInfo *pInfo_1; // esi
  OLECHAR *szDefaultUserName_1; // ecx
  WCHAR *szUserName; // edx
  OLECHAR chText; // ax
  UINT_PTR v26; // ST14_4
  HMENU v27; // eax
  HMENU v28; // eax
  DWORD cchName; // [esp+10h] [ebp-1458h]
  DWORD ReturnLength; // [esp+14h] [ebp-1454h]
  BYTE Data; // [esp+18h] [ebp-1450h]
  enum _SID_NAME_USE nUse; // [esp+1Ch] [ebp-144Ch]
  DWORD cbSid; // [esp+20h] [ebp-1448h]
  HKEY hKey; // [esp+24h] [ebp-1444h]
  HANDLE TokenHandle; // [esp+28h] [ebp-1440h]
  DWORD cbDomainName; // [esp+2Ch] [ebp-143Ch]
  DWORD cbData; // [esp+30h] [ebp-1438h]
  unsigned int pInfo_2; // [esp+34h] [ebp-1434h]
  HWND hWnd1; // [esp+38h] [ebp-1430h]
  HKEY hSubKey; // [esp+3Ch] [ebp-142Ch]
  PSID pSid; // [esp+40h] [ebp-1428h]
  OLECHAR *szDefaultUserName; // [esp+44h] [ebp-1424h]
  int TokenInformation[1024]; // [esp+48h] [ebp-1420h]
  WCHAR szName[260]; // [esp+1048h] [ebp-420h]
  WCHAR szDomainName[260]; // [esp+1250h] [ebp-218h]
  int v46; // [esp+1464h] [ebp-4h]

  hWnd1 = hWnd;
  szDefaultUserName = malloc(2u);
  *szDefaultUserName = 0;
  v46 = 0;
  v1 = GetCurrentProcess();
  if ( !OpenProcessToken(v1, TOKEN_QUERY, &TokenHandle) )
  {
LABEL_4:
    if ( hWnd )
    {
      v2 = GetMenu(hWnd);
LABEL_42:
      DeleteMenu(v2, 3u, MF_BYPOSITION);
      goto __quit;
    }
    goto __quit;
  }
  ReturnLength = 4096;
  if ( !GetTokenInformation(TokenHandle, TokenUser, TokenInformation, 0x1000u, &ReturnLength) )
  {
    CloseHandle(TokenHandle);
    goto LABEL_4;
  }
  CloseHandle(TokenHandle);
  cbSid = 0;
  LookupAccountNameW(0, L"System", 0, &cbSid, szDomainName, &cbDomainName, &nUse);
  pSid = malloc(cbSid);
  LookupAccountNameW(0, L"System", pSid, &cbSid, szDomainName, &cbDomainName, &nUse);
  pAccountInfo = malloc(1568u);
  pszUserName_1 = szDefaultUserName;
  v5 = pAccountInfo;
  pInfo_2 = pAccountInfo;
  v6 = pAccountInfo->szUserName;
  do
  {
    v7 = *pszUserName_1;
    ++pszUserName_1;
    *v6 = v7;
    ++v6;
  }
  while ( v7 );
  v8 = L".Default";
  v9 = pAccountInfo->szUserName - L".Default";
  do
  {
    v10 = *v8;
    ++v8;
    *(v8 + v9 - 2) = v10;
  }
  while ( v10 );
  v5->nMenuID = (garrAccountInfo.baseclass_0._Mypair._Myval2._Mylast
               - garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst) >> 2;
  _swprintf(v5->szReferenceName, L"%s\\%s", L"NT AUTHORITY", L"SYSTEM");
  v11 = hWnd1;
  if ( hWnd1 )
  {
    v12 = v5->nMenuID;
    v13 = GetMenu(hWnd1);
    v14 = GetSubMenu(v13, 3);
    InsertMenuW(v14, 0xFFFFFFFF, MF_BYPOSITION, v12, v5->szReferenceName);
  }
  if ( EqualSid(pSid, TokenInformation[0]) )
  {
    LOBYTE(v5->bIsSystemUser) = 1;
    gpAccountInfo = v5;
  }
  else
  {
    LOBYTE(v5->bIsSystemUser) = 0;
  }
  _swprintf(v5->szProfileImgPath, L"%s\\%s", &gSystemDirInfo, L"Config");
  std::vector<tagAccountInfo *,std::allocator<tagAccountInfo *>>::push_back(&garrAccountInfo, &pInfo_2);
  dwMode = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(
          ghLocalMachineKey,
          L"Software\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList",
          0,
          dwMode | KEY_READ,
          &hSubKey) )
  {
    dwIndex = 0;
    pSid = 0;
    if ( !PE_LoadKey(hSubKey, 0, &szDefaultUserName) )
    {
      RegQueryValueExW = ::RegQueryValueExW;
      do
      {
        pszDefaultUserName = szDefaultUserName;
        dwMode_1 = TlsGetValue(gdwTlsIndex);
        if ( !PE_OpenKey(hSubKey, pszDefaultUserName, 0, dwMode_1 | KEY_READ, &hKey) )
        {
          cbData = 4;
          if ( !RegQueryValueExW(hKey, L"Flags", 0, 0, &Data, &cbData) && !(Data & 8) )
          {
            pSID = GetUserSID(szDefaultUserName);
            if ( pSID )
            {
              cchName = 260;
              cbDomainName = 260;
              if ( LookupAccountSidW(0, pSID, szName, &cchName, szDomainName, &cbDomainName, &nUse) )
              {
                pInfo = malloc(0x620u);
                cbData = 520;
                pInfo_1 = pInfo;
                pInfo_2 = pInfo;
                if ( RegQueryValueExW(hKey, L"ProfileImagePath", 0, 0, pInfo->szProfileImgPath, &cbData) )
                {
                  free(pInfo_1);
                }
                else
                {
                  szDefaultUserName_1 = szDefaultUserName;
                  szUserName = pInfo_1->szUserName;
                  do
                  {
                    chText = *szDefaultUserName_1;
                    ++szDefaultUserName_1;
                    *szUserName = chText;
                    ++szUserName;
                  }
                  while ( chText );
                  pInfo_1->nMenuID = (garrAccountInfo.baseclass_0._Mypair._Myval2._Mylast
                                    - garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst) >> 2;
                  _swprintf(pInfo_1->szReferenceName, L"%s\\%s", szDomainName, szName);
                  if ( hWnd1 )
                  {
                    v26 = pInfo_1->nMenuID;
                    v27 = GetMenu(hWnd1);
                    v28 = GetSubMenu(v27, 3);
                    InsertMenuW(v28, 0xFFFFFFFF, MF_BYPOSITION, v26, pInfo_1->szReferenceName);
                  }
                  if ( EqualSid(pSID, TokenInformation[0]) )
                  {
                    LOBYTE(pInfo_1->bIsSystemUser) = 1;
                    gpAccountInfo = pInfo_1;
                  }
                  else
                  {
                    LOBYTE(pInfo_1->bIsSystemUser) = 0;
                  }
                  std::vector<tagAccountInfo *,std::allocator<tagAccountInfo *>>::push_back(&garrAccountInfo, &pInfo_2);
                  RegQueryValueExW = ::RegQueryValueExW;
                }
              }
              FreeSid(pSID);
            }
            dwIndex = pSid;
          }
          RegCloseKey(hKey);
        }
        pSid = ++dwIndex;
      }
      while ( !PE_LoadKey(hSubKey, dwIndex, &szDefaultUserName) );
      v11 = hWnd1;
    }
    RegCloseKey(hSubKey);
  }
  if ( !TmAdjustPrivilege(L"SeRestorePrivilege") )
  {
    if ( v11 )
    {
      v2 = GetMenu(v11);
      goto LABEL_42;
    }
__quit:
    gbRestorePrivilegeFailed = 1;
  }
  free(szDefaultUserName);
}
// 102CA8C: using guessed type wchar_t aSystem_0[7];
// 1031FCC: using guessed type wchar_t aDefault[9];
// 1031FE0: using guessed type wchar_t aNtAuthority[13];
// 1032008: using guessed type wchar_t aConfig[7];
// 10631CA: using guessed type char gbRestorePrivilegeFailed;

//----- (00F74650) --------------------------------------------------------
char BackendThreadProc()
{
  const wchar_t **v0; // eax
  wchar_t *v1; // esi
  tagAccountInfo **pBuffer; // ecx
  unsigned int index; // esi
  unsigned int nCount; // eax
  WCHAR *ppstr; // [esp+4h] [ebp-4h]

  InitApis();
  gdwTlsIndex = TlsAlloc();
  TlsSetValue(gdwTlsIndex, 0);
  InitSystemPath();
  v0 = RequerySystemEnvironmentString(&ppstr, L"%PATH%");
  v1 = gpszSystemPathInfo;
  gpszSystemPathInfo = _wcsdup(*v0);
  free(v1);
  free(ppstr);
  InitializeCriticalSection(&gSystemDirInfo.Lock);
  AdjustRighToWinLogon();
  LoadSystemAccountInfo(0);
  sub_F7B220(0xFFFFFFFF, 1u);
  sub_F7B220(0xFFFFFFFF, 0);
  pBuffer = garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst;
  index = 0;
  nCount = (garrAccountInfo.baseclass_0._Mypair._Myval2._Mylast - garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst) >> 2;
  if ( nCount )
  {
    do
    {
      LOBYTE(nCount) = sub_F7F610(0, gpAccountInfo, pBuffer[index]->nMenuID);
      if ( !nCount )
        break;
      sub_F7B220(0xFFFFFFFF, 0);
      ++index;
      pBuffer = garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst;
      nCount = (garrAccountInfo.baseclass_0._Mypair._Myval2._Mylast
              - garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst) >> 2;
    }
    while ( index < nCount );
  }
  return nCount;
}

//----- (00F74730) --------------------------------------------------------
int __thiscall bstr_t::Data_t::Compare(Data_t_bstr_t *this, Data_t_bstr_t *str)
{
  Data_t_bstr_t *v2; // ebx
  UINT l2; // eax
  WCHAR *bstr1; // esi
  Data_t_bstr_t *v5; // edx
  UINT v6; // eax
  UINT len; // ecx
  WCHAR *bstr2; // edi
  WCHAR *v9; // edx
  int result; // eax
  UINT l1; // [esp+Ch] [ebp-4h]
  Data_t_bstr_t *stra; // [esp+18h] [ebp+8h]

  v2 = this;
  l1 = SysStringLen(this->m_wstr);
  l2 = SysStringLen(str->m_wstr);
  bstr1 = v2->m_wstr;
  v5 = l2;
  v6 = l1;
  len = l1;
  bstr2 = str->m_wstr;
  stra = v5;
  if ( l1 > v5 )
    len = v5;
  if ( len )
  {
    while ( 1 )
    {
      LOWORD(v9) = *bstr1;
      ++bstr2;
      ++bstr1;
      --len;
      if ( v9 != *(bstr2 - 1) )
        break;
      if ( !len )
      {
        v5 = stra;
        v6 = l1;
        goto LABEL_7;
      }
    }
    result = *(bstr1 - 1) - *(bstr2 - 1);
  }
  else
  {
LABEL_7:
    if ( v6 >= v5 )
      result = l1 != v5;
    else
      result = -1;
  }
  return result;
}

//----- (00F747C0) --------------------------------------------------------
errno_t __cdecl sub_F747C0(wchar_t *Src, wchar_t *Dst, rsize_t SizeInWords)
{
  return wcscpy_s(Dst, SizeInWords, Src);
}

//----- (00F747E0) --------------------------------------------------------
BOOL __cdecl TmAdjustPrivilege(LPCWSTR lpszName)
{
  HANDLE ProcessHandle; // eax
  BOOL Ret; // esi
  struct _LUID Luid; // [esp+4h] [ebp-20h]
  HANDLE TokenHandle; // [esp+Ch] [ebp-18h]
  struct _TOKEN_PRIVILEGES Privileges; // [esp+10h] [ebp-14h]

  ProcessHandle = GetCurrentProcess();
  if ( !OpenProcessToken(ProcessHandle, 0x28u, &TokenHandle) || !LookupPrivilegeValueW(0, lpszName, &Luid) )
    return 0;
  Privileges.Privileges[0].Luid = Luid;
  Privileges.PrivilegeCount = 1;
  Privileges.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
  Ret = AdjustTokenPrivileges(TokenHandle, FALSE, &Privileges, sizeof(_TOKEN_PRIVILEGES), 0, 0);
  if ( Ret )
  {
    if ( GetLastError() )
      Ret = 0;
  }
  CloseHandle(TokenHandle);
  return Ret;
}

//----- (00F74890) --------------------------------------------------------
int __cdecl sub_F74890(int a1, wchar_t *a2)
{
  _WORD *v2; // esi
  _WORD *v3; // edi
  wchar_t *v4; // ebx
  wchar_t *v5; // esi
  int v6; // ecx
  wchar_t *v7; // ecx
  wchar_t v8; // ax
  const wchar_t **v9; // eax
  wchar_t *v10; // esi
  wchar_t *v11; // edi
  wchar_t *v12; // eax
  wchar_t *v13; // ST14_4
  WCHAR *v14; // eax
  signed __int16 v15; // cx
  wchar_t *v16; // ST14_4
  wchar_t *v17; // ebx
  DWORD v18; // eax
  wchar_t *v19; // eax
  WCHAR *v21; // [esp+14h] [ebp-18h]
  WCHAR *ppstr; // [esp+1Ch] [ebp-10h]
  int v23; // [esp+28h] [ebp-4h]

  v2 = malloc(2u);
  *v2 = 0;
  v23 = 0;
  v3 = malloc(2u);
  *v3 = 0;
  LOBYTE(v23) = 1;
  v4 = _wcsdup(a2);
  free(v2);
  if ( TlsGetValue(gdwTlsIndex) == 256 )
  {
    v5 = _wcsdup(v4);
    _wcsupr(v5);
    if ( wcsstr(v5, L"%PROGRAMFILES%") )
    {
      v6 = wcsstr(v5, L"%PROGRAMFILES%") - v5;
      _mm_storeu_si128(&v4[v6], _mm_loadu_si128(L"%ProgramW6432%"));
      _mm_storel_epi64(&v4[v6 + 8], _mm_loadl_epi64(L"W6432%"));
      *&v4[v6 + 12] = *L"2%";
      v7 = &v4[v6 + 14];
      do
      {
        v8 = *v7;
        ++v7;
        *(v7 - 1) = v8;
      }
      while ( v8 );
    }
    free(v5);
  }
  v9 = RequerySystemEnvironmentString(&ppstr, v4);
  v10 = _wcsdup(*v9);
  free(v3);
  free(ppstr);
  v11 = _wcsdup(v10);
  free(v4);
  if ( *v10 != 34 )
  {
    if ( sub_F81040(v10) != -1 )
      goto LABEL_20;
    ppstr = 0;
    v17 = wcsrchr(v10, 0x20u);
    if ( !v17 )
      goto LABEL_20;
    do
    {
      if ( ppstr )
        *ppstr = 32;
      *v17 = 0;
      v18 = sub_F81040(v10);
      if ( v18 != -1 && !(v18 & 0x10) )
      {
        v19 = _wcsdup(v10);
        goto LABEL_21;
      }
      ppstr = v17;
      v17 = wcsrchr(v10, 0x20u);
    }
    while ( v17 );
    v14 = ppstr;
    if ( !ppstr )
      goto LABEL_20;
    v15 = 32;
    goto LABEL_19;
  }
  v12 = wcschr(v10 + 1, 0x22u);
  v21 = v12;
  if ( v12 )
  {
    *v12 = 0;
    v13 = v11;
    v11 = _wcsdup(v10 + 1);
    free(v13);
    v14 = v21;
    v15 = 34;
LABEL_19:
    *v14 = v15;
    goto LABEL_20;
  }
  v16 = v11;
  v11 = _wcsdup(v10 + 1);
  free(v16);
LABEL_20:
  v19 = _wcsdup(v11);
LABEL_21:
  *a1 = v19;
  free(v10);
  free(v11);
  return a1;
}

//----- (00F74AC0) --------------------------------------------------------
int __cdecl sub_F74AC0(int a1, wchar_t *psz)
{
  WCHAR *v2; // edi
  wchar_t *v3; // esi
  wchar_t *v4; // ebx
  unsigned int v5; // kr04_4
  const wchar_t *v6; // ecx
  WCHAR *v7; // esi
  const wchar_t **v8; // eax
  wchar_t *v9; // esi
  WCHAR *pszResult; // [esp+18h] [ebp-1Ch]
  void *v12; // [esp+1Ch] [ebp-18h]
  WCHAR *ppszText2; // [esp+20h] [ebp-14h]
  wchar_t *v14; // [esp+24h] [ebp-10h]
  int v15; // [esp+30h] [ebp-4h]

  v15 = 0;
  v2 = malloc(2u);
  ppszText2 = v2;
  *v2 = 0;
  v3 = _wcsdup(psz);
  v14 = v3;
  v4 = _wcsdup(gszProgameFilesX86EnvValueValue);
  LOBYTE(v15) = 3;
  _wcsupr(v4);
  _wcsupr(v3);
  if ( !wcsncmp(v3, v4, wcslen(v4)) && sub_F81040(psz) == -1 )
  {
    v5 = wcslen(gszProgameFilesX86EnvValueValue);
    v6 = &gszNullString;
    if ( &psz[v5] )
      v6 = &psz[v5];
    v7 = _wcsdup(v6);
    ppszText2 = v7;
    v8 = PE_CopyString2(&pszResult, gszProgramW6432EnvValue, &ppszText2);
    v12 = v2;
    v2 = _wcsdup(*v8);
    ppszText2 = v2;
    free(v12);
    free(pszResult);
    free(v7);
    if ( sub_F81040(v2) != -1 )
    {
      v9 = psz;
      psz = _wcsdup(v2);
      free(v9);
    }
    v3 = v14;
  }
  *a1 = _wcsdup(psz);
  free(v4);
  free(v3);
  free(v2);
  free(psz);
  return a1;
}

//----- (00F74C50) --------------------------------------------------------
PSID __cdecl GetUserSID(wchar_t *lpszUserName)
{
  wchar_t *pszUserName; // ecx
  int nCount; // ebx
  wchar_t chText; // ax
  wchar_t *pstr1; // eax
  wchar_t *pstr2; // eax
  wchar_t *v7; // edi
  wchar_t *v8; // esi
  const wchar_t *v9; // eax
  wchar_t *pstr4; // esi
  signed int v11; // edi
  wchar_t *pstr3; // eax
  DWORD *v13; // edi
  BOOL ret; // eax
  int dwValue; // [esp+4h] [ebp-838h]
  BYTE nSubAuthorityCount[4]; // [esp+8h] [ebp-834h]
  PSID pSid; // [esp+Ch] [ebp-830h]
  struct _SID_IDENTIFIER_AUTHORITY IdentifierAuthority; // [esp+10h] [ebp-82Ch]
  DWORD nSubAuthority[8]; // [esp+18h] [ebp-824h]
  WCHAR psz[1024]; // [esp+38h] [ebp-804h]

  pszUserName = lpszUserName;
  pSid = 0;
  LOBYTE(nCount) = 0;
  nSubAuthority[0] = 0;
  nSubAuthorityCount[0] = 0;
  nSubAuthority[1] = 0;
  nSubAuthority[2] = 0;
  nSubAuthority[3] = 0;
  nSubAuthority[4] = 0;
  nSubAuthority[5] = 0;
  nSubAuthority[6] = 0;
  nSubAuthority[7] = 0;
  *IdentifierAuthority.Value = 0;
  *&IdentifierAuthority.Value[4] = 0;
  do
  {
    chText = *pszUserName;
    ++pszUserName;
    *(pszUserName + psz - lpszUserName - 2) = chText;
  }
  while ( chText );
  pstr1 = wcschr(psz, '-');
  if ( !pstr1 )
    return pSid;
  pstr2 = wcschr(pstr1 + 1, '-');
  if ( !pstr2 )
    return pSid;
  v7 = pstr2 + 1;
  v8 = wcschr(pstr2 + 1, '-');
  if ( !v8 )
    return pSid;
  *v8 = 0;
  if ( *v7 != '0' || v7[1] != 'x' )
  {
    scan_fn(v7, L"%lu", &dwValue);
    IdentifierAuthority.Value[4] = BYTE1(dwValue);
    IdentifierAuthority.Value[5] = dwValue;
    IdentifierAuthority.Value[2] = HIBYTE(dwValue);
    IdentifierAuthority.Value[3] = BYTE2(dwValue);
  }
  else
  {
    scan_fn(v7, L"0x%02hx%02hx%02hx%02hx%02hx%02hx", &IdentifierAuthority);
  }
  *v8 = '-';
  v9 = v8;
  pstr4 = v8 + 1;
  v11 = 0;
  do
  {
    pstr3 = wcschr(v9, '-');
    if ( !pstr3 )
      break;
    ++v11;
    *pstr3 = 0;
    LOBYTE(nCount) = nCount + 1;
    v9 = pstr3 + 1;
  }
  while ( v11 < 8 );
  nSubAuthorityCount[0] = nCount;
  nCount = nCount;
  if ( nCount > 0 )
  {
    v13 = nSubAuthority;
    do
    {
      scan_fn(pstr4, L"%lu", v13);
      ++v13;
      pstr4 += lstrlenW(pstr4) + 1;
      --nCount;
    }
    while ( nCount );
  }
  ret = AllocateAndInitializeSid(
          &IdentifierAuthority,
          nSubAuthorityCount[0],
          nSubAuthority[0],
          nSubAuthority[1],
          nSubAuthority[2],
          nSubAuthority[3],
          nSubAuthority[4],
          nSubAuthority[5],
          nSubAuthority[6],
          nSubAuthority[7],
          &pSid);
  return (ret != 0 ? pSid : 0);
}

//----- (00F74ED0) --------------------------------------------------------
signed int sub_F74ED0()
{
  return -1;
}

//----- (00F74EE0) --------------------------------------------------------
int __cdecl sub_F74EE0(int a1, int a2, int a3, int a4)
{
  wchar_t *v4; // ecx
  wchar_t *v6; // [esp-4h] [ebp-Ch]
  int v7; // [esp+4h] [ebp-4h]

  v6 = v4;
  v7 = 0;
  sub_F770E0(&v6, a2, a3, a4);
  sub_F784A0(a1, v6);
  return a1;
}

//----- (00F74F20) --------------------------------------------------------
int __cdecl sub_F74F20(int a1, int a2, wchar_t *a3)
{
  _WORD *v3; // eax
  wchar_t *v5; // [esp-4h] [ebp-2Ch]
  int v6; // [esp+4h] [ebp-24h]
  int v7; // [esp+8h] [ebp-20h]
  int v8; // [esp+Ch] [ebp-1Ch]
  int v9; // [esp+10h] [ebp-18h]
  int v10; // [esp+18h] [ebp-10h]
  int v11; // [esp+24h] [ebp-4h]

  v10 = 0;
  v3 = malloc(2u);
  v6 = v3;
  v7 = 0;
  v8 = 0;
  *v3 = 0;
  v9 = 0;
  v11 = 0;
  sub_F77040(a3, &v6);
  sub_F770E0(&v5, a2, &v6, 0);
  sub_F784A0(a1, v5);
  sub_F721F0(&v6);
  return a1;
}

//----- (00F74FB0) --------------------------------------------------------
wchar_t **__cdecl sub_F74FB0(WCHAR **ppszArgs, HWND hWndIn, LPCWSTR lpszFileName)
{
  WCHAR **v3; // ebx
  wchar_t *v4; // esi
  wchar_t *pszArgs; // edi
  wchar_t *v6; // eax
  wchar_t *v7; // eax
  wchar_t *pszPath; // ebx
  wchar_t *v9; // eax
  const wchar_t **v10; // eax
  WCHAR *v11; // ebx
  wchar_t *v12; // eax
  wchar_t **v13; // eax
  WCHAR *ppv; // [esp+14h] [ebp-28Ch]
  std__vector theVector; // [esp+18h] [ebp-288h]
  IPersistFile *pPersistFile; // [esp+24h] [ebp-27Ch]
  HWND hWnd; // [esp+28h] [ebp-278h]
  WCHAR **v19; // [esp+2Ch] [ebp-274h]
  wchar_t *v20; // [esp+30h] [ebp-270h]
  IShellLinkW *pShellLink; // [esp+34h] [ebp-26Ch]
  void *pszFileName; // [esp+38h] [ebp-268h]
  wchar_t *a2; // [esp+3Ch] [ebp-264h]
  WIN32_FIND_DATAW FindData; // [esp+40h] [ebp-260h]
  int v25; // [esp+29Ch] [ebp-4h]

  v3 = ppszArgs;
  hWnd = hWndIn;
  v19 = ppszArgs;
  pszFileName = lpszFileName;
  v4 = malloc(2u);
  a2 = v4;
  *v4 = 0;
  v25 = 0;
  pszArgs = malloc(2u);
  v20 = pszArgs;
  *pszArgs = 0;
  LOBYTE(v25) = 1;
  CoInitializeEx(0, 0);
  if ( CoCreateInstance(&CLSID_ShellLink, 0, CLSCTX_INPROC_SERVER, &CLSID_IShellLinkW, &pShellLink) >= 0 )
  {
    if ( pShellLink->lpVtbl->QueryInterface(pShellLink, &CLSID_IPersistFile, &pPersistFile) >= 0 )
    {
      if ( pPersistFile->lpVtbl->Load(pPersistFile, pszFileName, STGM_DIRECT) >= 0
        && pShellLink->lpVtbl->Resolve(pShellLink, hWnd, 3) >= 0 )// SLR_ANY_MATCH | SLR_NO_UI
      {
        v7 = realloc(v4, 2002u);
        pszPath = v7;
        a2 = v7;
        if ( v7 )
          memset(v7, 0, 2002u);
        if ( pShellLink->lpVtbl->GetPath(pShellLink, pszPath, 1000, &FindData, SLGP_SHORTPATH) >= 0 )
        {
          sub_F72170(&ppv);
          LOBYTE(v25) = 2;
          v9 = _wcsdup(pszPath);
          v10 = sub_F74AC0(&pszFileName, v9);
          sub_F72250(&a2, v10);
          free(pszFileName);
          v4 = a2;
          v11 = ppv;
          ppv = _wcsdup(a2);
          free(v11);
          v12 = realloc(pszArgs, 2002u);
          pszArgs = v12;
          v20 = v12;
          if ( v12 )
            memset(v12, 0, 2002u);
          if ( pShellLink->lpVtbl->GetArguments(pShellLink, pszArgs, 1000) >= 0 )
          {
            CopyStringToString(&ppv, pszArgs, 0x7FFFFFFFu, 0);
            sub_F80530(&theVector, &a2);
            sub_F80530(&theVector, &v20);
            v13 = sub_F770E0(&pszFileName, hWnd, &ppv, 0);
            sub_F72250(&a2, v13);
            free(pszFileName);
            v4 = a2;
            pszArgs = v20;
          }
          LOBYTE(v25) = 1;
          sub_F721F0(&ppv);
        }
        else
        {
          v4 = _wcsdup(&gszNullString);
          a2 = v4;
          free(pszPath);
        }
        v3 = v19;
      }
      pPersistFile->lpVtbl->Release(pPersistFile);
    }
    pShellLink->lpVtbl->Release(pShellLink);
    v6 = _wcsdup(v4);
  }
  else
  {
    v6 = _wcsdup(&gszNullString);
  }
  *v3 = v6;
  free(pszArgs);
  free(v4);
  return v3;
}
// 1047B5C: using guessed type GUID CLSID_IPersistFile;

//----- (00F752B0) --------------------------------------------------------
int __cdecl sub_F752B0(int a1, wchar_t *psz)
{
  HMODULE v2; // eax
  FARPROC v3; // eax
  const wchar_t *v4; // ecx
  Data_t_bstr_t *v6; // edi
  BSTR v7; // eax
  _WORD *v8; // esi
  BSTR v9; // eax
  const unsigned __int16 *v10; // eax
  int v11; // eax
  const unsigned __int16 *v12; // eax
  int v13; // eax
  wchar_t **v14; // eax
  wchar_t *v15; // eax
  wchar_t *v16; // eax
  const wchar_t *v17; // eax
  const wchar_t *v18; // eax
  _WORD *v19; // [esp+14h] [ebp-18h]
  _bstr_t v20; // [esp+18h] [ebp-14h]
  _bstr_t bstrText; // [esp+1Ch] [ebp-10h]
  int v22; // [esp+28h] [ebp-4h]

  if ( dword_1064C40 & 1 )
  {
    v3 = GetLongPathNameW_0;
  }
  else
  {
    dword_1064C40 |= 1u;
    v2 = LoadLibraryW(L"kernel32.dll");
    v3 = GetProcAddress(v2, "GetLongPathNameW");
    GetLongPathNameW_0 = v3;
  }
  if ( !v3 )
  {
    v4 = &gszNullString;
    if ( psz )
      v4 = psz;
    *a1 = _wcsdup(v4);
    return a1;
  }
  sub_F77AB0(&gKeyNameMap, &bstrText, psz);
  v22 = 0;
  if ( !byte_1063860 )
  {
    v6 = bstrText.m_Data;
    if ( bstrText.m_Data )
      v7 = bstrText.m_Data->m_wstr;
    else
      v7 = 0;
    v20.m_Data = GetLongPathNameW_0(v7, 0, 0);
    v8 = malloc(2u);
    *v8 = 0;
    LOBYTE(v22) = 1;
    if ( !byte_1063860 )
    {
      v8 = realloc(v8, 2 * v20.m_Data + 2);
      v19 = v8;
      if ( v8 )
        memset(v8, 0, 2 * v20.m_Data + 2);
      v9 = v6 ? v6->m_wstr : 0;
      if ( GetLongPathNameW_0(v9, v8, v20.m_Data) )
      {
        if ( v6 )
          v10 = v6->m_wstr;
        else
          v10 = 0;
        v11 = wcscmp(v8, v10);
        if ( v11 )
          v11 = -(v11 < 0) | 1;
        if ( v11 )
        {
          if ( v6 )
            v12 = v6->m_wstr;
          else
            v12 = 0;
          v13 = wcscmp(psz, v12);
          if ( v13 )
            v13 = -(v13 < 0) | 1;
          if ( v13 )
          {
            v14 = *sub_F75DE0(&gKeyNameMap, &v20, v8);
            if ( v14 )
              v15 = *v14;
            else
              v15 = 0;
            sub_F72280(&v19, v15);
            _bstr_t::_Free(&v20);
            v8 = v19;
          }
          v16 = _wcsdup(v8);
        }
        else
        {
          v17 = &gszNullString;
          if ( psz )
            v17 = psz;
          v16 = _wcsdup(v17);
        }
        *a1 = v16;
        free(v8);
        _bstr_t::_Free(&bstrText);
        return a1;
      }
    }
    free(v8);
  }
  v18 = &gszNullString;
  if ( psz )
    v18 = psz;
  *a1 = _wcsdup(v18);
  _bstr_t::_Free(&bstrText);
  return a1;
}
// 1063860: using guessed type char byte_1063860;
// 1064C3C: using guessed type int (__stdcall *GetLongPathNameW_0)(_DWORD, _DWORD, _DWORD);
// 1064C40: using guessed type int dword_1064C40;

//----- (00F75520) --------------------------------------------------------
int __cdecl sub_F75520(int a1, wchar_t *psz, int a3)
{
  wchar_t *v3; // esi
  wchar_t *v4; // eax
  unsigned int v5; // ecx
  _WORD *v6; // eax
  wchar_t *v7; // ST0C_4
  wchar_t *v8; // eax
  wchar_t *v10; // eax
  wchar_t *v11; // edi
  wchar_t *v12; // eax
  int v13; // [esp+18h] [ebp-14h]
  signed int v14; // [esp+1Ch] [ebp-10h]

  v3 = _wcsdup(psz);
  _wcsupr(v3);
  v4 = _wcsdup(v3);
  if ( !sub_F76090(v4) || (v5 = 1, v14 = 1, ((*(a3 + 8) - *(a3 + 4)) >> 2) <= 1) )
  {
LABEL_9:
    *a1 = _wcsdup(&gszNullString);
    free(v3);
    free(psz);
    return a1;
  }
  while ( 1 )
  {
    v13 = 4 * v5;
    v6 = *(4 * v5 + *(a3 + 4));
    if ( *v6 == 47 || *v6 == 45 )
      goto LABEL_8;
    v7 = _wcsdup(L"CMD");
    v8 = _wcsdup(v3);
    if ( !sub_F75FD0(v8, v7) || _wcsicmp(*(v13 + *(a3 + 4)), L"start") )
      break;
    v5 = v14;
LABEL_8:
    v14 = ++v5;
    if ( v5 >= (*(a3 + 8) - *(a3 + 4)) >> 2 )
      goto LABEL_9;
  }
  v10 = _wcsdup(*(*(a3 + 4) + 4 * v14));
  v11 = v10;
  if ( *v10 != 34 )
  {
    v12 = wcschr(v10, 0x2Cu);
    if ( v12 )
      *v12 = 0;
  }
  *a1 = _wcsdup(v11);
  free(v11);
  free(v3);
  free(psz);
  return a1;
}

//----- (00F756C0) --------------------------------------------------------
wchar_t *InitSystemPath()
{
  HMODULE v0; // eax
  FARPROC v1; // eax
  int v2; // ecx
  WCHAR v3; // ax
  char *v4; // ecx
  __int16 v5; // ax
  HMODULE v6; // eax
  FARPROC GetSystemWow64DirectoryW; // eax
  int index; // ecx
  WCHAR chText; // ax
  int v10; // eax
  wchar_t *result; // eax

  v0 = LoadLibraryW(L"Kernel32.dll");
  v1 = GetProcAddress(v0, "GetSystemWindowsDirectoryW");
  if ( v1 )
    (v1)(gszWindowsDirectory, 260);
  else
    GetWindowsDirectoryW(gszWindowsDirectory, 0x104u);
  v2 = 0;
  do
  {
    v3 = gszWindowsDirectory[v2];
    ++v2;
    *(&Wow64EnableWow64FsRedirection + v2 * 2 + 2) = v3;
  }
  while ( v3 );
  v4 = &gSystemDirInfo - 2;
  do
  {
    v5 = *(v4 + 1);
    v4 += 2;
  }
  while ( v5 );
  *v4 = *L"\\System32";
  *(v4 + 1) = *L"ystem32";
  *(v4 + 2) = *L"tem32";
  *(v4 + 3) = *L"m32";
  *(v4 + 4) = *L"2";
  v6 = LoadLibraryW(L"Kernel32.dll");
  GetSystemWow64DirectoryW = GetProcAddress(v6, "GetSystemWow64DirectoryW");
  if ( GetSystemWow64DirectoryW && !(GetSystemWow64DirectoryW)(gSystemDirInfo.szSystemWow64Directory, 260) )
  {
    index = 0;
    do
    {
      chText = gSystemDirInfo.szBuffer[index];
      ++index;
      *(&gSystemDirInfo.Lock.SpinCount + index * 2 + 2) = chText;
    }
    while ( chText );
  }
  ExpandEnvironmentStringsW(L"%ProgramW6432%", gszProgramW6432EnvValue, 0x104u);
  v10 = wcscmp(L"%ProgramW6432%", gszProgramW6432EnvValue);
  if ( v10 )
    v10 = -(v10 < 0) | 1;
  if ( !v10 )
  {
    ExpandEnvironmentStringsW(L"%ProgramFiles%", gszProgramW6432EnvValue, 0x104u);
    SetEnvironmentVariableW(L"ProgramW6432", gszProgramW6432EnvValue);
  }
  ExpandEnvironmentStringsW(L"%PROGRAMFILES(X86)%", gszProgameFilesX86EnvValueValue, MAX_PATH);
  result = wcsstr(gszProgramW6432EnvValue, L" (x86)");
  if ( result )
  {
    *wcsstr(gszProgramW6432EnvValue, L" (x86)") = 0;
    result = SetEnvironmentVariableW(L"PROGRAMFILES(X86)", gszProgramW6432EnvValue);
  }
  return result;
}
// 102CEA8: using guessed type wchar_t aSystem32[10];

//----- (00F75860) --------------------------------------------------------
char __cdecl sub_F75860(wchar_t **a1, __int16 a2, const wchar_t **a3, char a4)
{
  wchar_t *v4; // esi
  wchar_t v5; // ax
  __int16 j; // bx
  char result; // al
  int v8; // eax
  wchar_t v9; // ax
  wchar_t *v10; // edi
  wchar_t *v11; // eax
  wchar_t *v12; // eax
  wchar_t i; // ax
  int v14; // eax
  wchar_t *v15; // ebx
  wchar_t *v16; // esi
  wchar_t *v17; // esi
  wchar_t *v18; // eax
  const wchar_t *v19; // ecx
  int v20; // edx
  const wchar_t *v21; // edx
  int v22; // ecx
  wchar_t v23; // ax
  const wchar_t **v24; // eax
  wchar_t *v25; // ebx
  DWORD v26; // eax
  const wchar_t **v27; // eax
  wchar_t *v28; // ebx
  DWORD v29; // eax
  wchar_t v30; // ax
  wchar_t *v31; // ebx
  wchar_t *v32; // esi
  WCHAR *ppv; // [esp+14h] [ebp-18h]
  WCHAR *ppstr; // [esp+18h] [ebp-14h]
  wchar_t *v35; // [esp+1Ch] [ebp-10h]
  int v36; // [esp+28h] [ebp-4h]

  v4 = *a1;
  v35 = v4;
  v5 = *v4;
  if ( !*v4 )
    goto LABEL_5;
  while ( 1 )
  {
    if ( !isspace(v5) )
    {
      j = a2;
      if ( *v4 != a2 )
        break;
    }
    v5 = v4[1];
    ++v4;
    v35 = v4;
    if ( !v5 )
      goto LABEL_5;
  }
  v8 = *v4;
  if ( v8 && v8 != a2 )
  {
    if ( v8 == 34 )
    {
      v9 = v4[1];
      v35 = v4 + 1;
      v10 = v4 + 1;
      if ( v9 )
      {
        while ( v9 != 34 )
        {
          v9 = v10[1];
          ++v10;
          if ( !v9 )
            goto LABEL_14;
        }
      }
      v11 = v10 + 1;
      if ( !*v10 )
LABEL_14:
        v11 = v10;
      *a1 = v11;
      if ( a2 && *v11 )
      {
        do
        {
          if ( **a1 == a2 )
            break;
          v12 = *a1 + 1;
          *a1 = v12;
        }
        while ( *v12 );
      }
LABEL_45:
      v31 = v35;
      v32 = *a3;
      *a3 = _wcsdup(v35);
      free(v32);
      (*a3)[v10 - v31] = 0;
      result = 1;
    }
    else
    {
      v10 = v4;
      while ( 1 )
      {
        for ( i = *v10; i; ++v10 )
        {
          if ( i == j )
            break;
          if ( i == 32 )
            break;
          i = v10[1];
        }
        if ( !a4 )
          goto LABEL_44;
        v14 = *v4;
        if ( v14 != 37 && v14 != 92 && v4[1] != 58 )
          goto LABEL_44;
        v15 = v35;
        v16 = *a3;
        *a3 = _wcsdup(v35);
        free(v16);
        (*a3)[v10 - v15] = 0;
        v17 = _wcsdup(*a3);
        v36 = 0;
        _wcsupr(v17);
        if ( TlsGetValue(gdwTlsIndex) == 256 && wcsstr(v17, L"%PROGRAMFILES%") )
        {
          v18 = wcsstr(v17, L"%PROGRAMFILES%");
          v19 = *a3;
          v20 = v18 - v17;
          _mm_storeu_si128(&(*a3)[v20], _mm_loadu_si128(L"%ProgramW6432%"));
          _mm_storel_epi64(&v19[v20 + 8], _mm_loadl_epi64(L"W6432%"));
          *&v19[v20 + 12] = *L"2%";
          v21 = &(*a3)[v20 + 14];
          v22 = *a3 - *a3;
          do
          {
            v23 = *v21;
            ++v21;
            *(v21 + v22 - 2) = v23;
          }
          while ( v23 );
        }
        v24 = RequerySystemEnvironmentString(&ppstr, *a3);
        v25 = *a3;
        *a3 = _wcsdup(*v24);
        free(v25);
        free(ppstr);
        v26 = sub_F81040(*a3);
        if ( v26 != -1 && !(v26 & 0x10)
          || (v27 = PE_CopyString(&ppv, a3, L".exe"),
              v28 = *a3,
              *a3 = _wcsdup(*v27),
              free(v28),
              free(ppv),
              v29 = sub_F81040(*a3),
              v29 != -1)
          && !(v29 & 0x10) )
        {
          free(v17);
LABEL_44:
          *a1 = v10;
          goto LABEL_45;
        }
        v30 = *v10;
        for ( j = a2; v30 != a2; ++v10 )
        {
          if ( !isspace(v30) )
            break;
          v30 = v10[1];
        }
        if ( !*v10 || *v10 == a2 )
          break;
        v36 = -1;
        free(v17);
        v4 = v35;
      }
      free(v17);
      result = 1;
    }
  }
  else
  {
LABEL_5:
    *a1 = v4;
    result = 0;
  }
  return result;
}

//----- (00F75BB0) --------------------------------------------------------
int (__stdcall *InitApis())(LONG Status)
{
  HMODULE v0; // eax
  HMODULE v1; // eax
  HMODULE v2; // eax
  HMODULE v3; // eax
  HMODULE v4; // eax
  HMODULE v5; // eax
  HMODULE v6; // eax
  HMODULE v7; // eax
  int (__stdcall *result)(LONG); // eax

  v0 = LoadLibraryW(L"Kernel32.dll");
  Wow64EnableWow64FsRedirection = GetProcAddress(v0, "Wow64EnableWow64FsRedirection");
  v1 = LoadLibraryW(L"Kernel32.dll");
  Wow64DisableWow64FsRedirection = GetProcAddress(v1, "Wow64DisableWow64FsRedirection");
  v2 = LoadLibraryW(L"Kernel32.dll");
  Wow64RevertWow64FsRedirection = GetProcAddress(v2, "Wow64RevertWow64FsRedirection");
  v3 = LoadLibraryW(L"advapi32.dll");
  *RegDeleteKeyExW = GetProcAddress(v3, "RegDeleteKeyExW");
  v4 = LoadLibraryW(L"ntdll.dll");
  NtDeleteKey = GetProcAddress(v4, "NtDeleteKey");
  v5 = LoadLibraryW(L"ntdll.dll");
  NtOpenKey = GetProcAddress(v5, "NtOpenKey");
  v6 = LoadLibraryW(L"ntdll.dll");
  NtCreateKey = GetProcAddress(v6, "NtCreateKey");
  v7 = LoadLibraryW(L"ntdll.dll");
  result = GetProcAddress(v7, "RtlNtStatusToDosError");
  RtlNtStatusToDosError = result;
  return result;
}

//----- (00F75C70) --------------------------------------------------------
int __cdecl sub_F75C70(int a1, wchar_t *a2)
{
  wchar_t *v2; // eax
  wchar_t *v3; // esi
  unsigned int v4; // kr04_4
  wchar_t *v5; // esi
  const wchar_t **v6; // eax
  void *v7; // edi
  WCHAR *pszResult; // [esp+10h] [ebp-20h]
  WCHAR *ppv; // [esp+14h] [ebp-1Ch]
  HKEY__ hKey; // [esp+18h] [ebp-18h]
  int v12; // [esp+1Ch] [ebp-14h]
  int ImageBase; // [esp+20h] [ebp-10h]
  int v14; // [esp+2Ch] [ebp-4h]

  v14 = 1;
  *a1 = _wcsdup(a2);
  v2 = a2;
  v12 = 1;
  if ( *a2 && Wow64DisableWow64FsRedirection )
  {
    v3 = _wcsdup(L"\\");
    hKey.unused = v3;
    PE_CopyString2(&pszResult, gszProgramW6432EnvValue, &hKey);
    LOBYTE(v14) = 2;
    free(v3);
    Wow64DisableWow64FsRedirection(&ImageBase);
    if ( !ImageBase && !_wcsnicmp(a2, &gSystemDirInfo, wcslen(&gSystemDirInfo)) )
    {
      v4 = wcslen(&gSystemDirInfo);
      v5 = _wcsdup(gSystemDirInfo.szSystemWow64Directory);
      hKey.unused = v5;
      v6 = PE_CopyString(&ppv, &hKey, &a2[v4]);
      v7 = *a1;
      *a1 = _wcsdup(*v6);
      free(v7);
      free(ppv);
      free(v5);
    }
    Wow64RevertWow64FsRedirection(ImageBase);
    free(pszResult);
    v2 = a2;
  }
  free(v2);
  return a1;
}

//----- (00F75DE0) --------------------------------------------------------
int __thiscall sub_F75DE0(int **this, int a2, OLECHAR *psz)
{
  OLECHAR *v3; // ebx
  int v4; // esi
  OLECHAR **v5; // eax
  OLECHAR *v6; // eax
  UINT v7; // edi
  _DWORD *v8; // eax
  const wchar_t *v9; // eax
  int v10; // eax
  int v11; // eax
  int j; // eax
  int i; // eax
  BSTR *v14; // eax
  BSTR *v15; // esi
  BSTR v16; // eax
  OLECHAR *v17; // eax
  OLECHAR *v18; // esi
  int result; // eax
  int **v20; // [esp+14h] [ebp-10h]

  v20 = this;
  v3 = psz;
  v4 = **this;
  if ( **this == *this )
  {
LABEL_23:
    v14 = operator new(0xCu);
    v15 = v14;
    psz = v14;
    if ( v14 )
    {
      v14[1] = 0;
      v14[2] = 1;
      v16 = SysAllocString(v3);
      *v15 = v16;
      if ( !v16 && v3 )
        _com_issue_error(-2147024882);
    }
    else
    {
      v15 = 0;
    }
    result = a2;
    *a2 = v15;
    if ( !v15 )
      _com_issue_error(-2147024882);
    return result;
  }
  while ( 1 )
  {
    if ( *(v4 + 24) )
      goto LABEL_13;
    v5 = *(v4 + 28);
    if ( !v5 )
      break;
    v6 = *v5;
    if ( !v6 )
      break;
    v7 = SysStringLen(v6);
    if ( !v7 )
      goto LABEL_28;
    v8 = *(v4 + 28);
    v9 = (v8 ? *v8 : 0);
    if ( !_wcsnicmp(v3, v9, v7) )
    {
      v10 = v3[v7];
      if ( !v10 || v10 == 92 )
        goto LABEL_28;
    }
    this = v20;
LABEL_13:
    if ( !*(v4 + 13) )
    {
      v11 = *(v4 + 8);
      if ( *(v11 + 13) )
      {
        for ( i = *(v4 + 4); !*(i + 13); i = *(i + 4) )
        {
          if ( v4 != *(i + 8) )
            break;
          v4 = i;
        }
        v4 = i;
      }
      else
      {
        v4 = *(v4 + 8);
        for ( j = *v11; !*(j + 13); j = *j )
          v4 = j;
      }
    }
    if ( v4 == *this )
      goto LABEL_23;
  }
  v7 = 0;
LABEL_28:
  sub_F785A0(&psz, v3, v7, (v4 + 20));
  v17 = psz;
  *a2 = psz;
  if ( v17 )
  {
    InterlockedIncrement(v17 + 2);
    v18 = psz;
    if ( psz )
    {
      if ( !InterlockedDecrement(psz + 2) && v18 )
      {
        if ( *v18 )
        {
          SysFreeString(*v18);
          *v18 = 0;
        }
        if ( *(v18 + 1) )
        {
          j_j__free(*(v18 + 1));
          *(v18 + 1) = 0;
        }
        j__free(v18);
      }
    }
  }
  return a2;
}

//----- (00F75FD0) --------------------------------------------------------
char __cdecl sub_F75FD0(wchar_t *a1, wchar_t *a2)
{
  wchar_t *v2; // esi
  wchar_t *v3; // edi
  wchar_t *v4; // eax
  wchar_t *v5; // eax
  int v6; // ecx
  int v7; // ecx
  char v8; // bl

  if ( !wcsstr(a1, a2) )
  {
    v5 = a1;
LABEL_16:
    v8 = 0;
    goto LABEL_17;
  }
  v2 = a1;
  v3 = a2;
  do
  {
    v4 = wcsstr(v2, a2);
    if ( !v4 )
      break;
    v3 = v4;
    v2 = v4 + 1;
    if ( v4 == -2 )
      break;
  }
  while ( wcsstr(v2, a2) );
  v5 = a1;
  if ( v3 != a1 )
  {
    v6 = *(v3 - 1);
    if ( v6 != 92 && v6 != 34 && v6 != 32 )
      goto LABEL_16;
  }
  v7 = v3[wcslen(a2)];
  if ( v7 )
  {
    if ( v7 != 34 && v7 != 32 && v7 != 46 )
      goto LABEL_16;
  }
  v8 = 1;
LABEL_17:
  free(v5);
  free(a2);
  return v8;
}

//----- (00F76090) --------------------------------------------------------
char __cdecl sub_F76090(wchar_t *psz)
{
  wchar_t *v1; // ST14_4
  wchar_t *v2; // eax
  wchar_t *v3; // ST14_4
  wchar_t *v4; // eax
  wchar_t *v5; // ST14_4
  wchar_t *v6; // eax
  wchar_t *v7; // ST14_4
  wchar_t *v8; // eax
  wchar_t *v9; // ST14_4
  wchar_t *v10; // eax
  wchar_t *v11; // ST14_4
  wchar_t *v12; // eax
  wchar_t *v13; // ST14_4
  wchar_t *v14; // eax
  _WORD *v15; // eax
  void *v16; // ebx
  wchar_t *v17; // eax
  wchar_t *v18; // eax
  wchar_t *v19; // edi
  const wchar_t *v20; // eax
  wchar_t *v21; // eax
  wchar_t *v22; // esi
  wchar_t *v23; // esi
  const wchar_t *v24; // ecx
  wchar_t *v25; // esi
  wchar_t *v26; // ST14_4
  int v27; // ST10_4
  wchar_t *v28; // eax
  char v29; // bl
  int v31; // [esp+18h] [ebp-70h]
  void *v32; // [esp+1Ch] [ebp-6Ch]
  wchar_t *v33; // [esp+20h] [ebp-68h]
  int v34; // [esp+24h] [ebp-64h]
  wchar_t *v35; // [esp+28h] [ebp-60h]
  int v36; // [esp+84h] [ebp-4h]

  v36 = 0;
  if ( wcsstr(psz, L"POWERSHELL") )
    OutputDebugStringW(L"here");
  v1 = _wcsdup(L"RUNDLL32");
  v2 = _wcsdup(psz);
  if ( !sub_F75FD0(v2, v1) )
  {
    v3 = _wcsdup(L"RUNDLL");
    v4 = _wcsdup(psz);
    if ( !sub_F75FD0(v4, v3) )
    {
      v5 = _wcsdup(L"CSCRIPT");
      v6 = _wcsdup(psz);
      if ( !sub_F75FD0(v6, v5) )
      {
        v7 = _wcsdup(L"WSCRIPT");
        v8 = _wcsdup(psz);
        if ( !sub_F75FD0(v8, v7) )
        {
          v9 = _wcsdup(L"REGSVR32");
          v10 = _wcsdup(psz);
          if ( !sub_F75FD0(v10, v9) )
          {
            v11 = _wcsdup(L"POWERSHELL");
            v12 = _wcsdup(psz);
            if ( !sub_F75FD0(v12, v11) )
            {
              v13 = _wcsdup(L"CMD");
              v14 = _wcsdup(psz);
              if ( !sub_F75FD0(v14, v13) )
                goto LABEL_24;
            }
          }
        }
      }
    }
  }
  v15 = malloc(2u);
  v16 = v15;
  *v15 = 0;
  v17 = malloc(2u);
  v33 = v17;
  *v17 = 0;
  v18 = malloc(2u);
  v19 = v18;
  *v18 = 0;
  LOBYTE(v36) = 3;
  v20 = &gszNullString;
  v31 = 20;
  if ( psz )
    v20 = psz;
  v21 = _wcsdup(v20);
  v22 = sub_F91290(v21, &v33);
  if ( v22 == 2 )
  {
    v34 = sub_F76700(psz, 0, 0, &v35, &v31, 0);
    if ( v34 )
    {
      if ( *v19 )
      {
        v23 = v33;
        v33 = _wcsdup(v19);
        free(v23);
      }
    }
    else
    {
      v24 = &gszNullString;
      if ( v35 )
        v24 = v35;
      v25 = _wcsdup(v24);
      v32 = v33;
      v33 = _wcsdup(v25);
      free(v32);
      free(v25);
    }
    v26 = _wcsdup(v33);
    v27 = v34;
    v28 = _wcsdup(psz);
    v22 = sub_F911B0(v28, v27, v26);
  }
  _wcsupr(v33);
  if ( v22 || !wcsstr(v33, L"WINDOWS") )
  {
    free(v19);
    free(v33);
    free(v16);
LABEL_24:
    v29 = 0;
    goto LABEL_25;
  }
  free(v19);
  free(v33);
  free(v16);
  v29 = 1;
LABEL_25:
  free(psz);
  return v29;
}

//----- (00F763B0) --------------------------------------------------------
char __cdecl sub_F763B0(wchar_t *a1)
{
  wchar_t *v1; // ecx
  wchar_t v2; // ax
  int v3; // eax
  char result; // al

  v1 = a1;
  v2 = *a1;
  if ( !*a1 )
    goto LABEL_14;
  do
  {
    if ( v2 != 32 && v2 != 44 )
      break;
    v2 = v1[1];
    ++v1;
  }
  while ( v2 );
  if ( !*v1 || !_wcsicmp(a1, L"desktop.ini") )
    goto LABEL_14;
  v3 = wcscmp(a1, L"%1");
  if ( v3 )
    v3 = -(v3 < 0) | 1;
  if ( v3 )
    result = 1;
  else
LABEL_14:
    result = 0;
  return result;
}

//----- (00F76440) --------------------------------------------------------
int __thiscall std::map<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>>::_Try_emplace<wchar_t const * const &,>(std__tree *this, tagKeyName **a2, tagKeyName *bstrValue, HKEY hRootKey, OLECHAR *lpszKey)
{
  OLECHAR *KeyId; // ebx
  std__Tree_node *pNode; // esi
  OLECHAR **v7; // eax
  OLECHAR *v8; // eax
  UINT v9; // edi
  std__Tree_node *v10; // eax
  const wchar_t *v11; // eax
  int v12; // eax
  std__Tree_node_For__bstr_t *v13; // eax
  std__Tree_node *j; // eax
  std__Tree_node *i; // eax
  tagKeyName *v16; // eax
  tagKeyName *v17; // esi
  Data_t_bstr_t *v18; // eax
  Data_t_bstr_t *v19; // eax
  tagKeyName *v20; // esi
  tagKeyName *result; // eax
  std__tree *pThis; // [esp+14h] [ebp-10h]

  pThis = this;
  KeyId = lpszKey;
  pNode = this->_Mypair._Myval2._Myhead->_Left;
  if ( this->_Mypair._Myval2._Myhead->_Left == this->_Mypair._Myval2._Myhead )
  {
LABEL_23:
    bstrValue->bstrText1.m_Data = hRootKey;
    v16 = operator new(0xCu);
    v17 = v16;
    bstrValue = v16;
    if ( v16 )
    {
      v16->bstrText2.m_Data = 0;
      v16->dwValue = 1;
      v18 = SysAllocString(KeyId);
      v17->bstrText1.m_Data = v18;
      if ( !v18 && KeyId )
        _com_issue_error(E_OUTOFMEMORY);
    }
    else
    {
      v17 = 0;
    }
    result = a2;
    *a2 = v17;
    if ( !v17 )
      _com_issue_error(E_OUTOFMEMORY);
    return result;
  }
  while ( 1 )
  {
    if ( pNode[1]._Left != hRootKey )
      goto LABEL_13;
    v7 = pNode[1]._Parent;
    if ( !v7 )
      break;
    v8 = *v7;
    if ( !v8 )
      break;
    v9 = SysStringLen(v8);
    if ( !v9 )
      goto LABEL_28;
    v10 = pNode[1]._Parent;
    v11 = (v10 ? v10->_Left : 0);
    if ( !_wcsnicmp(KeyId, v11, v9) )
    {
      v12 = KeyId[v9];
      if ( !v12 || v12 == '\\' )
        goto LABEL_28;
    }
    this = pThis;
LABEL_13:
    if ( !pNode->_IsNil )
    {
      v13 = pNode->_Right;
      if ( v13->_IsNil )
      {
        for ( i = pNode->_Parent; !i->_IsNil; i = i->_Parent )
        {
          if ( pNode != i->_Right )
            break;
          pNode = i;
        }
        pNode = i;
      }
      else
      {
        pNode = pNode->_Right;
        for ( j = v13->_Left; !j->_IsNil; j = j->_Left )
          pNode = j;
      }
    }
    if ( pNode == this->_Mypair._Myval2._Myhead )
      goto LABEL_23;
  }
  v9 = 0;
LABEL_28:
  bstrValue->bstrText1.m_Data = pNode[1]._Right;
  sub_F785A0(&bstrValue, KeyId, v9, &pNode[1]._Color);
  v19 = bstrValue;
  *a2 = bstrValue;
  if ( v19 )
  {
    InterlockedIncrement(&v19->m_RefCount);
    v20 = bstrValue;
    if ( bstrValue )
    {
      if ( !InterlockedDecrement(&bstrValue->dwValue) && v20 )
      {
        if ( v20->bstrText1.m_Data )
        {
          SysFreeString(v20->bstrText1.m_Data);
          v20->bstrText1.m_Data = 0;
        }
        if ( v20->bstrText2.m_Data )
        {
          j_j__free(v20->bstrText2.m_Data);
          v20->bstrText2.m_Data = 0;
        }
        j__free(v20);
      }
    }
  }
  return a2;
}

//----- (00F76640) --------------------------------------------------------
HANDLE __stdcall sub_F76640(OLECHAR *lpszKeyName, DWORD dwDesiredAccess, DWORD dwShareMode, LPSECURITY_ATTRIBUTES lpSecurityAttributes, DWORD dwCreationDisposition, DWORD dwFlagsAndAttributes, HANDLE hTemplateFile)
{
  tagKeyName *KeyName; // esi
  tagKeyName *v8; // ebx
  HANDLE v9; // edi

  sub_F77AB0(&gKeyNameMap, &lpszKeyName, lpszKeyName);
  KeyName = lpszKeyName;
  if ( lpszKeyName )
    v8 = *lpszKeyName;
  else
    v8 = 0;
  v9 = CreateFileW(
         v8,
         dwDesiredAccess,
         dwShareMode,
         lpSecurityAttributes,
         dwCreationDisposition,
         dwFlagsAndAttributes,
         hTemplateFile);
  if ( v9 == -1 )
  {
    ImpersonateLoggedOnUser(ghAppToken);
    v9 = CreateFileW(
           v8,
           dwDesiredAccess,
           dwShareMode,
           lpSecurityAttributes,
           dwCreationDisposition,
           dwFlagsAndAttributes,
           hTemplateFile);
    RevertToSelf();
  }
  if ( KeyName && !InterlockedDecrement(&KeyName->dwValue) )
  {
    if ( KeyName->bstrText1.m_Data )
    {
      SysFreeString(KeyName->bstrText1.m_Data);
      KeyName->bstrText1.m_Data = 0;
    }
    if ( KeyName->bstrText2.m_Data )
    {
      j_j__free(KeyName->bstrText2.m_Data);
      KeyName->bstrText2.m_Data = 0;
    }
    j__free(KeyName);
  }
  return v9;
}

//----- (00F76700) --------------------------------------------------------
LONG __cdecl sub_F76700(OLECHAR *psz, int a2, int a3, int a4, int a5, int a6)
{
  Data_t_bstr_t *v6; // esi
  const WCHAR *v7; // eax
  LONG v8; // edi
  _bstr_t bstrText; // [esp+8h] [ebp-4h]

  sub_F77AB0(&gKeyNameMap, &bstrText, psz);
  v6 = bstrText.m_Data;
  if ( bstrText.m_Data )
    v7 = bstrText.m_Data->m_wstr;
  else
    v7 = 0;
  v8 = sub_F99BB0(v7, a2, 0, 0, a3, a5, a4, 0, 0, 0, 0, a6, -1);
  if ( v6 && !InterlockedDecrement(&v6->m_RefCount) )
  {
    if ( v6->m_wstr )
    {
      SysFreeString(v6->m_wstr);
      v6->m_wstr = 0;
    }
    if ( v6->m_str )
    {
      j_j__free(v6->m_str);
      v6->m_str = 0;
    }
    j__free(v6);
  }
  return v8;
}

//----- (00F767A0) --------------------------------------------------------
int __cdecl PE_OpenKey(HKEY hRootKey, tagKeyName *lpszKeyName, LONG CreateOptions, DWORD DesiredAccess, PHKEY KeyHandle)
{
  Data_t_bstr_t *v5; // esi
  HKEY RootDirectory; // ebx
  Data_t_bstr_t *v7; // edi
  _bstr_t *v8; // ebx
  WORD *pszObjectName; // edx
  _bstr_t *v10; // eax
  _bstr_t *v11; // eax
  _bstr_t *v12; // eax
  _bstr_t *v13; // ebx
  _bstr_t *v14; // ebx
  _bstr_t *v15; // ebx
  char *v16; // ecx
  __int16 v17; // ax
  int nLength; // ecx
  int v19; // eax
  int dwError; // ebx
  int Status; // eax
  int v22; // eax
  LONG (__stdcall *v23)(volatile LONG *); // ecx
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [esp+10h] [ebp-44h]
  UNICODE_STRING strObjectName; // [esp+28h] [ebp-2Ch]
  ULONG Disposition; // [esp+30h] [ebp-24h]
  _bstr_t bstrUserName; // [esp+34h] [ebp-20h]
  _bstr_t bstrKeyName; // [esp+38h] [ebp-1Ch]
  _bstr_t v30; // [esp+3Ch] [ebp-18h]
  _bstr_t v31; // [esp+40h] [ebp-14h]
  _bstr_t v32; // [esp+44h] [ebp-10h]
  tagKeyName KeyName; // [esp+48h] [ebp-Ch]

  v5 = 0;
  v32.m_Data = 0;
  KeyName.dwValue = 0;
  std::map<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>>::_Try_emplace<wchar_t const * const &,>(
    &gKeyNameMap,
    &lpszKeyName,
    &hRootKey,
    hRootKey,
    lpszKeyName);
  RootDirectory = hRootKey;
  v7 = lpszKeyName;
  LOBYTE(KeyName.dwValue) = 1;
  if ( hRootKey != HKEY_LOCAL_MACHINE )
  {
    if ( hRootKey == HKEY_CURRENT_USER )
    {
      _bstr_t::_bstr_t(&hRootKey, L"\\");
      LOBYTE(KeyName.dwValue) = 2;
      v10 = _bstr_t::_bstr_t(&bstrUserName, gpAccountInfo->szUserName);
      LOBYTE(KeyName.dwValue) = 3;
      v11 = _bstr_t::operator+(&bstrKeyName, L"\\Registry\\User\\", v10);
      LOBYTE(KeyName.dwValue) = 4;
      v12 = _bstr_t::operator+(&v11->m_Data, &v30, &hRootKey);
      LOBYTE(KeyName.dwValue) = 5;
      v13 = _bstr_t::operator+(&v12->m_Data, &v31, &lpszKeyName);
      if ( &v32 != v13 )
      {
        _bstr_t::_Free(&v32);
        v5 = v13->m_Data;
        v32.m_Data = v5;
        if ( v5 )
          InterlockedIncrement(&v5->m_RefCount);
      }
      _bstr_t::_Free(&v31);
      _bstr_t::_Free(&v30);
      _bstr_t::_Free(&bstrKeyName);
      _bstr_t::_Free(&bstrUserName);
      LOBYTE(KeyName.dwValue) = 1;
      _bstr_t::_Free(&hRootKey);
      RootDirectory = 0;
      if ( v5 )
      {
        pszObjectName = v5->m_wstr;
        goto LABEL_28;
      }
    }
    else if ( hRootKey == HKEY_CLASSES_ROOT )
    {
      v14 = _bstr_t::operator+(&hRootKey, L"\\Registry\\Machine\\Software\\Classes\\", &lpszKeyName);
      if ( &v32 != v14 )
      {
        _bstr_t::_Free(&v32);
        v5 = v14->m_Data;
        v32.m_Data = v5;
        if ( v5 )
          InterlockedIncrement(&v5->m_RefCount);
      }
      _bstr_t::_Free(&hRootKey);
      RootDirectory = 0;
      if ( v5 )
      {
        pszObjectName = v5->m_wstr;
        goto LABEL_28;
      }
    }
    else if ( hRootKey == HKEY_USERS )
    {
      v15 = _bstr_t::operator+(&hRootKey, L"\\Registry\\User\\", &lpszKeyName);
      if ( &v32 != v15 )
      {
        _bstr_t::_Free(&v32);
        v5 = v15->m_Data;
        v32.m_Data = v5;
        if ( v5 )
          InterlockedIncrement(&v5->m_RefCount);
      }
      _bstr_t::_Free(&hRootKey);
      RootDirectory = 0;
      if ( v5 )
      {
        pszObjectName = v5->m_wstr;
        goto LABEL_28;
      }
    }
    else if ( lpszKeyName )
    {
      pszObjectName = lpszKeyName->bstrText1.m_Data;
      goto LABEL_28;
    }
LABEL_27:
    pszObjectName = 0;
    goto LABEL_28;
  }
  v8 = _bstr_t::operator+(&hRootKey, L"\\Registry\\Machine\\", &lpszKeyName);
  if ( &v32 != v8 )
  {
    _bstr_t::_Free(&v32);
    v5 = v8->m_Data;
    v32.m_Data = v5;
    if ( v5 )
      InterlockedIncrement(&v5->m_RefCount);
  }
  _bstr_t::_Free(&hRootKey);
  RootDirectory = 0;
  if ( !v5 )
    goto LABEL_27;
  pszObjectName = v5->m_wstr;
LABEL_28:
  v16 = pszObjectName;
  hRootKey = (pszObjectName + 1);
  do
  {
    v17 = *v16;
    v16 += 2;
  }
  while ( v17 );
  nLength = (v16 - hRootKey) >> 1;
  strObjectName.Buffer = pszObjectName;
  ObjectAttributes.Length = 24;
  ObjectAttributes.RootDirectory = RootDirectory;
  ObjectAttributes.Attributes = OBJ_CASE_INSENSITIVE;
  strObjectName.MaximumLength = 2 * nLength;
  strObjectName.Length = 2 * nLength;
  ObjectAttributes.ObjectName = &strObjectName;
  ObjectAttributes.SecurityDescriptor = 0;
  ObjectAttributes.SecurityQualityOfService = 0;
  v19 = NtOpenKey(KeyHandle, DesiredAccess, &ObjectAttributes);
  dwError = RtlNtStatusToDosError(v19);
  if ( dwError == ERROR_ACCESS_DENIED )
  {
    Status = NtCreateKey(
               KeyHandle,
               DesiredAccess,
               &ObjectAttributes,
               0,
               0,
               CreateOptions | REG_OPTION_BACKUP_RESTORE,
               &Disposition);
    dwError = RtlNtStatusToDosError(Status);
    if ( dwError == ERROR_ACCESS_DENIED )
    {
      if ( ghAppToken )
      {
        ImpersonateLoggedOnUser(ghAppToken);
        v22 = NtOpenKey(KeyHandle, DesiredAccess, &ObjectAttributes);
        dwError = RtlNtStatusToDosError(v22);
        RevertToSelf();
      }
    }
  }
  v23 = InterlockedDecrement;
  if ( v7 )
  {
    if ( !InterlockedDecrement(&v7->m_RefCount) )
    {
      if ( v7->m_wstr )
      {
        SysFreeString(v7->m_wstr);
        v7->m_wstr = 0;
      }
      if ( v7->m_str )
      {
        j_j__free(v7->m_str);
        v7->m_str = 0;
      }
      j__free(v7);
    }
    v23 = InterlockedDecrement;
  }
  if ( v5 && !v23(&v5->m_RefCount) )
  {
    if ( v5->m_wstr )
    {
      SysFreeString(v5->m_wstr);
      v5->m_wstr = 0;
    }
    if ( v5->m_str )
    {
      j_j__free(v5->m_str);
      v5->m_str = 0;
    }
    j__free(v5);
  }
  return dwError;
}

//----- (00F76B30) --------------------------------------------------------
HANDLE AdjustRighToWinLogon()
{
  HANDLE result; // eax
  HANDLE hFound; // edi
  const wchar_t *szExeFile; // esi
  wchar_t *pstr; // eax
  HANDLE ProcessHandle; // esi
  HANDLE phNewToken; // [esp+0h] [ebp-238h]
  HANDLE TokenHandle; // [esp+4h] [ebp-234h]
  PROCESSENTRY32W ProcessEntry; // [esp+8h] [ebp-230h]

  result = TmAdjustPrivilege(L"SeDebugPrivilege");
  if ( result )
  {
    result = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);
    hFound = result;
    if ( result )
    {
      ProcessEntry.dwSize = sizeof(PROCESSENTRY32W);
      if ( Process32FirstW(result, &ProcessEntry) )
      {
        while ( 1 )
        {
          szExeFile = ProcessEntry.szExeFile;
          if ( !wcsrchr(ProcessEntry.szExeFile, '\\')
            || (pstr = wcsrchr(ProcessEntry.szExeFile, '\\'), szExeFile = pstr + 1, pstr != 0xFFFFFFFE) )
          {
            if ( !_wcsicmp(szExeFile, L"winlogon.exe") )
              break;
          }
          if ( !Process32NextW(hFound, &ProcessEntry) )
            return CloseHandle(hFound);
        }
        ProcessHandle = OpenProcess(PROCESS_QUERY_INFORMATION, 0, ProcessEntry.th32ProcessID);
        if ( ProcessHandle )
        {
          TokenHandle = 0;
          if ( OpenProcessToken(ProcessHandle, TokenStatistics, &TokenHandle) )
          {
            if ( DuplicateTokenEx(
                   TokenHandle,
                   TOKEN_ALL_ACCESS,
                   0,
                   SecurityImpersonation,
                   TokenImpersonation,
                   &phNewToken) )
            {
              TmAdjustPrivilege(L"SeImpersonatePrivilege");
              if ( ImpersonateLoggedOnUser(phNewToken) )
              {
                TmAdjustPrivilege(L"SeSecurityPrivilege");
                TmAdjustPrivilege(L"SeDebugPrivilege");
                TmAdjustPrivilege(L"SeBackupPrivilege");
                RevertToSelf();
              }
              CloseHandle(phNewToken);
            }
            CloseHandle(TokenHandle);
          }
          CloseHandle(ProcessHandle);
        }
      }
      result = CloseHandle(hFound);
    }
  }
  return result;
}

//----- (00F76CC0) --------------------------------------------------------
char __cdecl sub_F76CC0(std__List *a1, int a2)
{
  const wchar_t ***v2; // ebx
  void *v3; // esi
  int v4; // ecx
  void **v5; // edi
  void **v6; // esi
  char result; // al
  void *v8; // [esp+10h] [ebp-20h]
  int a2a; // [esp+14h] [ebp-1Ch]
  int v10; // [esp+18h] [ebp-18h]
  char v11; // [esp+23h] [ebp-Dh]
  int v12; // [esp+2Ch] [ebp-4h]

  v8 = 0;
  a2a = 0;
  v10 = 0;
  v12 = 0;
  sub_F76DD0(a1, 0, &v8, 0);
  v2 = v8;
  v3 = *a2;
  if ( (a2a - v8) & 0xFFFFFFF0 )
  {
    *a2 = _wcsdup(*v8);
    free(v3);
    sub_F738F0((a2 + 4), v2 + 1);
    result = 1;
  }
  else
  {
    *a2 = _wcsdup(&gszNullString);
    free(v3);
    v4 = a2;
    v5 = *(a2 + 8);
    v6 = *(a2 + 4);
    if ( v6 != v5 )
    {
      do
      {
        free(*v6);
        ++v6;
      }
      while ( v6 != v5 );
      v4 = a2;
    }
    *(v4 + 8) = *(v4 + 4);
    result = 0;
  }
  v11 = result;
  if ( v2 )
  {
    sub_F72BF0(v2, a2a);
    j__free(v2);
    result = v11;
  }
  return result;
}

//----- (00F76DD0) --------------------------------------------------------
void __cdecl sub_F76DD0(wchar_t *a1, int a2, int a3, int a4)
{
  wchar_t **v4; // esi
  char *v5; // ebx
  __int16 v6; // di
  wchar_t *v7; // eax
  char v8; // al
  wchar_t *v9; // edi
  char v10; // al
  wchar_t *v11; // esi
  wchar_t *v12; // edi
  int v13; // edi
  wchar_t *v14; // eax
  wchar_t *v15; // esi
  void **v16; // ecx
  void *v17; // esi
  wchar_t *v18; // edi
  void **i; // esi
  void *v20; // [esp+10h] [ebp-34h]
  std__vector v21; // [esp+14h] [ebp-30h]
  wchar_t *v22; // [esp+20h] [ebp-24h]
  wchar_t *v23; // [esp+24h] [ebp-20h]
  int v24; // [esp+28h] [ebp-1Ch]
  wchar_t *v25; // [esp+2Ch] [ebp-18h]
  wchar_t *v26; // [esp+30h] [ebp-14h]
  char v27; // [esp+37h] [ebp-Dh]
  int v28; // [esp+40h] [ebp-4h]

  sub_F72BF0(*a3, *(a3 + 4));
  *(a3 + 4) = *a3;
  v25 = a1;
  v20 = malloc(2u);
  v4 = 0;
  v21.baseclass_0._Mypair._Myval2._Myend = 0;
  v21.baseclass_0._Mypair._Myval2._Myfirst = 0;
  v5 = 0;
  *v20 = 0;
  v21.baseclass_0._Mypair._Myval2._Mylast = 0;
  v6 = a4;
  v28 = 0;
  while ( 1 )
  {
    while ( 1 )
    {
      v7 = malloc(2u);
      v26 = v7;
      *v7 = 0;
      LOBYTE(v28) = 1;
      LOBYTE(v24) = ((v5 - v4) & 0xFFFFFFFC) == 0;
      v8 = sub_F75860(&v25, a2, &v26, v24);
      v27 = v8;
      if ( v6 )
      {
        v23 = malloc(2u);
        *v23 = 0;
        v9 = v25;
        LOBYTE(v28) = 2;
        v22 = v25;
        v10 = sub_F75860(&v22, a4, &v23, v24);
        v11 = v23;
        if ( v10 )
        {
          if ( v27 )
          {
            if ( v22 < v9 )
            {
              v25 = v22;
              v12 = v26;
              v26 = _wcsdup(v23);
              free(v12);
            }
          }
          else
          {
            v27 = 1;
          }
        }
        LOBYTE(v28) = 1;
        free(v11);
        v4 = v21.baseclass_0._Mypair._Myval2._Myfirst;
        v8 = v27;
      }
      if ( !v8 )
      {
        v15 = v25;
        break;
      }
      if ( &v26 >= v5 || v4 > &v26 )
      {
        if ( v5 == v21.baseclass_0._Mypair._Myval2._Myend )
        {
          std::vector<wchar_t const *,std::allocator<wchar_t const *>>::_Reserve(&v21, 1u);
          v5 = v21.baseclass_0._Mypair._Myval2._Mylast;
        }
        if ( v5 )
        {
          v14 = _wcsdup(v26);
          goto LABEL_20;
        }
      }
      else
      {
        v13 = &v26 - v4;
        if ( v5 == v21.baseclass_0._Mypair._Myval2._Myend )
        {
          std::vector<wchar_t const *,std::allocator<wchar_t const *>>::_Reserve(&v21, 1u);
          v5 = v21.baseclass_0._Mypair._Myval2._Mylast;
          v4 = v21.baseclass_0._Mypair._Myval2._Myfirst;
        }
        if ( v5 )
        {
          v14 = _wcsdup(v4[v13]);
LABEL_20:
          *v5 = v14;
          goto LABEL_21;
        }
      }
LABEL_21:
      v15 = v25;
      v5 += 4;
      v21.baseclass_0._Mypair._Myval2._Mylast = v5;
      if ( *v25 == a2 )
        break;
      v6 = a4;
      if ( *v25 == a4 )
        break;
      v4 = v21.baseclass_0._Mypair._Myval2._Myfirst;
      free(v26);
    }
    v16 = v21.baseclass_0._Mypair._Myval2._Myfirst;
    if ( (v5 - v21.baseclass_0._Mypair._Myval2._Myfirst) & 0xFFFFFFFC )
    {
      v17 = v20;
      v18 = _wcsdup(a1);
      v20 = v18;
      free(v17);
      v15 = v25;
      v18[v25 - a1] = 0;
      sub_F80460(a3, &v20);
      v5 = v21.baseclass_0._Mypair._Myval2._Mylast;
      v16 = v21.baseclass_0._Mypair._Myval2._Myfirst;
    }
    if ( !*v15 )
      break;
    v25 = v15 + 1;
    for ( i = v16; i != v5; ++i )
      free(*i);
    v4 = v21.baseclass_0._Mypair._Myval2._Myfirst;
    v5 = v21.baseclass_0._Mypair._Myval2._Myfirst;
    a1 = v25;
    v6 = a4;
    v21.baseclass_0._Mypair._Myval2._Mylast = v21.baseclass_0._Mypair._Myval2._Myfirst;
    free(v26);
  }
  free(v26);
  sub_F721F0(&v20);
}

//----- (00F77040) --------------------------------------------------------
void __cdecl sub_F77040(wchar_t *a1, int a2)
{
  void **v2; // edi
  void **i; // esi
  void *v4; // esi
  wchar_t *a2a; // [esp+10h] [ebp-10h]
  int v6; // [esp+1Ch] [ebp-4h]

  v2 = *(a2 + 8);
  for ( i = *(a2 + 4); i != v2; ++i )
    free(*i);
  *(a2 + 8) = *(a2 + 4);
  sub_F7F8D0(&a2a, a1);
  v6 = 0;
  v4 = *a2;
  *a2 = _wcsdup(a1);
  free(v4);
  sub_F80530((a2 + 4), &a2a);
  free(a2a);
}

//----- (00F770E0) --------------------------------------------------------
wchar_t **__cdecl sub_F770E0(wchar_t **a1, int a2, int a3, void *a4)
{
  int v4; // ecx
  WCHAR **v6; // edi
  _WORD *v7; // esi
  wchar_t *v8; // ebx
  WCHAR *v9; // edi
  wchar_t *v10; // eax
  wchar_t *v11; // ebx
  wchar_t *v12; // edi
  int v13; // ecx
  wchar_t *v14; // ecx
  wchar_t v15; // ax
  const wchar_t **v16; // eax
  wchar_t *v17; // edx
  unsigned int v18; // eax
  OLECHAR *v19; // esi
  LSTATUS v20; // eax
  wchar_t *v21; // eax
  wchar_t *v22; // ecx
  WCHAR *v23; // esi
  DWORD v24; // eax
  WCHAR *v25; // eax
  const wchar_t *v26; // eax
  const wchar_t **v27; // eax
  wchar_t *v28; // eax
  const wchar_t **v29; // eax
  const wchar_t **v30; // eax
  const wchar_t *v31; // eax
  LPCWSTR i; // ecx
  WCHAR *v33; // edi
  wchar_t *v34; // edi
  wchar_t *v35; // eax
  wchar_t *v36; // ecx
  wchar_t v37; // ax
  wchar_t *v38; // eax
  const wchar_t **v39; // eax
  wchar_t *v40; // esi
  wchar_t **v41; // eax
  void *v42; // esi
  wchar_t *v43; // eax
  void *v44; // ST24_4
  wchar_t *v45; // eax
  void *v46; // ST24_4
  WCHAR **v47; // [esp-8h] [ebp-8Ch]
  wchar_t *v48; // [esp-4h] [ebp-88h]
  int v49; // [esp+10h] [ebp-74h]
  _WORD *v50; // [esp+14h] [ebp-70h]
  std__vector v51; // [esp+18h] [ebp-6Ch]
  void *v52; // [esp+24h] [ebp-60h]
  wchar_t *v53; // [esp+28h] [ebp-5Ch]
  void *v54; // [esp+2Ch] [ebp-58h]
  wchar_t *a2a; // [esp+30h] [ebp-54h]
  HKEY hKey; // [esp+34h] [ebp-50h]
  int a1a; // [esp+38h] [ebp-4Ch]
  void *v58; // [esp+3Ch] [ebp-48h]
  void *v59; // [esp+40h] [ebp-44h]
  WCHAR *lpszText; // [esp+44h] [ebp-40h]
  WCHAR *pszResult; // [esp+48h] [ebp-3Ch]
  wchar_t *v62; // [esp+4Ch] [ebp-38h]
  int v63; // [esp+50h] [ebp-34h]
  WCHAR **v64; // [esp+54h] [ebp-30h]
  wchar_t **v65; // [esp+58h] [ebp-2Ch]
  OLECHAR *psz; // [esp+5Ch] [ebp-28h]
  wchar_t *ppv; // [esp+60h] [ebp-24h]
  DWORD nBufferLength; // [esp+64h] [ebp-20h]
  LPCWSTR lpFileName; // [esp+68h] [ebp-1Ch]
  size_t v70; // [esp+6Ch] [ebp-18h]
  int v71; // [esp+80h] [ebp-4h]

  a1a = a2;
  v4 = *(a3 + 8) - *(a3 + 4);
  v65 = a1;
  v63 = a3;
  pszResult = a4;
  LOBYTE(v54) = a4;
  v49 = 0;
  if ( !(v4 & 0xFFFFFFFC) )
  {
    *a1 = _wcsdup(L"<bad command>");
    return a1;
  }
  v58 = _wcsdup(**(a3 + 4));
  v71 = 0;
  lpFileName = malloc(2u);
  *lpFileName = 0;
  v6 = malloc(2u);
  v64 = v6;
  *v6 = 0;
  v7 = malloc(2u);
  v59 = v7;
  *v7 = 0;
  v8 = _wcsdup(**(a3 + 4));
  lpszText = v8;
  a2a = v8;
  ppv = _wcsdup(v8);
  _wcsupr(ppv);
  if ( !wcsncmp(ppv, L"\\??\\", 4u) )
  {
    v48 = v8 + 4;
LABEL_8:
    v10 = _wcsdup(v48);
    v47 = v6;
    goto LABEL_9;
  }
  if ( wcsncmp(ppv, L"\\SYSTEMROOT\\", 0xCu) )
  {
    v48 = v8;
    goto LABEL_8;
  }
  v9 = lpFileName;
  lpFileName = _wcsdup(gszWindowsDirectory);
  free(v9);
  CopyStringToString(&lpFileName, L"\\", 0x7FFFFFFFu, 0);
  CopyStringToString(&lpFileName, v8 + 12, 0x7FFFFFFFu, 0);
  v10 = _wcsdup(lpFileName);
  v47 = v64;
LABEL_9:
  v11 = v10;
  v53 = v10;
  free(v47);
  v12 = _wcsdup(v11);
  v52 = v12;
  LOBYTE(v71) = 6;
  _wcsupr(v12);
  if ( TlsGetValue(gdwTlsIndex) == 256 && wcsstr(v12, L"%PROGRAMFILES%") )
  {
    v13 = wcsstr(v12, L"%PROGRAMFILES%") - v12;
    _mm_storeu_si128(&v11[v13], _mm_loadu_si128(L"%ProgramW6432%"));
    _mm_storel_epi64(&v11[v13 + 8], _mm_loadl_epi64(L"W6432%"));
    *&v11[v13 + 12] = *L"2%";
    v14 = &v11[v13 + 14];
    do
    {
      v15 = *v14;
      ++v14;
      *(v14 - 1) = v15;
    }
    while ( v15 );
  }
  v16 = RequerySystemEnvironmentString(&psz, v11);
  v64 = lpFileName;
  lpFileName = _wcsdup(*v16);
  free(v64);
  free(psz);
  v17 = malloc(2u);
  v70 = v17;
  v62 = v17;
  *v17 = 0;
  LOBYTE(v71) = 7;
  if ( !*lpFileName )
    goto LABEL_64;
  psz = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\");
  LOBYTE(v71) = 8;
  CopyStringToString(&psz, lpszText, 0x7FFFFFFFu, 0);
  v18 = TlsGetValue(gdwTlsIndex);
  v19 = psz;
  if ( !PE_OpenKey(ghLocalMachineKey, psz, 0, v18 | 0x20019, &hKey) )
  {
    v20 = sub_F815A0(hKey, 0, &lpFileName);
    v48 = hKey;
    if ( !v20 )
    {
      RegCloseKey(v48);
      v21 = _wcsdup(lpFileName);
      *v65 = v21;
      free(v19);
      free(v70);
      free(v12);
      free(ppv);
      free(lpszText);
      free(v59);
      free(v11);
      free(lpFileName);
      free(v58);
      return v65;
    }
    RegCloseKey(v48);
  }
  v64 = _wcsdup(lpFileName);
  v62 = v64;
  free(v70);
  if ( pszResult || byte_1063860 )
  {
LABEL_36:
    v26 = lpFileName;
    if ( *lpFileName == 92 && lpFileName[1] != 92 )
    {
      wcsncpy_s(&v70, 3u, gszWindowsDirectory, 2u);
      v27 = PE_CopyString2(&pszResult, &v70, &lpFileName);
      nBufferLength = lpFileName;
      lpFileName = _wcsdup(*v27);
      free(nBufferLength);
      free(pszResult);
      v26 = lpFileName;
    }
    v48 = v22;
    nBufferLength = &v48;
    v28 = _wcsdup(v26);
    *nBufferLength = v28;
    v29 = sub_F75C70(&pszResult, v48);
    nBufferLength = lpFileName;
    lpFileName = _wcsdup(*v29);
    free(nBufferLength);
    free(pszResult);
    v48 = lpFileName;
    if ( byte_1063860 )
    {
      v70 = _wcsdup(v48);
      v62 = v70;
      free(v64);
    }
    else
    {
      v30 = sub_F752B0(&nBufferLength, v48);
      v70 = _wcsdup(*v30);
      v62 = v70;
      free(v64);
      free(nBufferLength);
    }
    _wcslwr(v70);
    LOBYTE(v71) = 7;
    free(v19);
    v7 = v59;
    v17 = v70;
LABEL_64:
    v36 = v17;
    nBufferLength = (v17 + 1);
    do
    {
      v37 = *v36;
      ++v36;
    }
    while ( v37 );
    if ( (v36 - nBufferLength) >> 1 )
    {
      v48 = v63;
      v38 = _wcsdup(v17);
      v39 = sub_F75520(&nBufferLength, v38, v48);
      v40 = _wcsdup(*v39);
      a2a = v40;
      free(lpszText);
      free(nBufferLength);
      if ( wcslen(v40) )
      {
        v50 = malloc(2u);
        *v50 = 0;
        v51.baseclass_0._Mypair._Myval2._Myfirst = 0;
        v51.baseclass_0._Mypair._Myval2._Mylast = 0;
        v51.baseclass_0._Mypair._Myval2._Myend = 0;
        LOBYTE(v71) = 10;
        sub_F80530(&v51, &a2a);
        v41 = sub_F770E0(&v54, a1a, &v50, v54);
        v42 = v70;
        v70 = _wcsdup(*v41);
        free(v42);
        free(v54);
        sub_F721F0(&v50);
        v40 = a2a;
      }
      v43 = _wcsdup(v70);
      v44 = v70;
      *v65 = v43;
      free(v44);
      free(v12);
      free(ppv);
      free(v40);
      free(v59);
    }
    else
    {
      v45 = _wcsdup(&gszNullString);
      v46 = v70;
      *v65 = v45;
      free(v46);
      free(v12);
      free(ppv);
      free(lpszText);
      free(v7);
    }
    free(v11);
    free(lpFileName);
    free(v58);
    return v65;
  }
  while ( 1 )
  {
    v23 = _wcsdup(lpFileName);
    pszResult = v23;
    LOBYTE(v71) = 9;
    if ( wcsstr(lpFileName, L"..") )
    {
      v24 = GetFullPathNameW(lpFileName, 0, 0, 0);
      nBufferLength = v24;
      if ( v24 )
      {
        v70 = 2 * v24 + 2;
        v25 = realloc(v23, v70);
        v23 = v25;
        pszResult = v25;
        if ( v25 )
          memset(v25, 0, v70);
        GetFullPathNameW(lpFileName, nBufferLength, v23, 0);
      }
    }
    if ( !byte_1063860 )
    {
      if ( sub_F81150(a1a, gpszSystemPathInfo, v23, &ppv) )
      {
        if ( !byte_1063860 && !(sub_F81040(ppv) & 0x10) )
        {
          nBufferLength = lpFileName;
          lpFileName = _wcsdup(ppv);
          free(nBufferLength);
          LOBYTE(v71) = 8;
          free(v23);
          goto LABEL_35;
        }
      }
      else if ( !wcschr(v23, 0x2Fu) && wcslen(v23) > 3 && v23[wcslen(v23) - 4] != 46 )
      {
        nBufferLength = ppv;
        ppv = _wcsdup(v23);
        free(nBufferLength);
        CopyStringToString(&ppv, L".exe", 0x7FFFFFFFu, 0);
        if ( byte_1063860
          || sub_F81150(a1a, gpszSystemPathInfo, ppv, &lpFileName)
          || (nBufferLength = ppv,
              ppv = _wcsdup(v23),
              free(nBufferLength),
              CopyStringToString(&ppv, L".dll", 0x7FFFFFFFu, 0),
              !byte_1063860)
          && sub_F81150(a1a, gpszSystemPathInfo, ppv, &lpFileName) )
        {
          LOBYTE(v71) = 8;
          free(v23);
LABEL_35:
          v19 = psz;
          goto LABEL_36;
        }
      }
    }
    v31 = lpFileName;
    for ( i = lpFileName; *i == 32; ++i )
      ;
    if ( !byte_1063860 )
      break;
LABEL_48:
    if ( wcsrchr(v31, 0x20u) )
      *wcsrchr(lpFileName, 0x20u) = 0;
    LOBYTE(v71) = 8;
    free(v23);
    if ( byte_1063860 )
      goto LABEL_35;
  }
  if ( wcschr(i, 0x20u) )
  {
    v31 = lpFileName;
    goto LABEL_48;
  }
  v33 = lpFileName;
  lpFileName = _wcsdup(L"File not found: ");
  free(v33);
  CopyStringToString(&lpFileName, v64, 0x7FFFFFFFu, 0);
  v34 = _wcsdup(lpFileName);
  v62 = v34;
  free(v64);
  if ( sub_F81040(**(v63 + 4)) != -1 && sub_F81040(**(v63 + 4)) & 0x10 )
  {
    sub_F72250(&v62, *(v63 + 4));
    v34 = v62;
  }
  else if ( !byte_1063860 && !wcsncmp(**(v63 + 4), L"||", 2u) )
  {
    if ( sub_F81040((**(v63 + 4) + 4)) == -1 )
    {
      nBufferLength = lpFileName;
      lpFileName = _wcsdup(L"File not found: ");
      free(nBufferLength);
      CopyStringToString(&lpFileName, (**(v63 + 4) + 4), 0x7FFFFFFFu, 0);
      nBufferLength = v34;
      v34 = _wcsdup(lpFileName);
      free(nBufferLength);
    }
    else
    {
      sub_F72280(&v62, (**(v63 + 4) + 4));
      v34 = v62;
    }
  }
  v35 = _wcsdup(v34);
  *v65 = v35;
  free(v23);
  free(psz);
  free(v34);
  free(v52);
  free(ppv);
  free(lpszText);
  free(v59);
  free(v11);
  free(lpFileName);
  free(v58);
  return v65;
}
// 1063860: using guessed type char byte_1063860;

//----- (00F77AB0) --------------------------------------------------------
int __thiscall sub_F77AB0(std__tree *this, tagKeyName *KeyName, LPCWSTR lpszKey)
{
  std::map<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>>::_Try_emplace<wchar_t const * const &,>(
    this,
    KeyName,
    &lpszKey,
    0,
    lpszKey);
  return KeyName;
}

//----- (00F77AE0) --------------------------------------------------------
int __cdecl sub_F77AE0(DWORD dwMessageId)
{
  int result; // eax
  DWORD v2; // ebx
  FILE *v3; // edi
  const wchar_t *v4; // esi
  wchar_t v5; // cx
  HLOCAL v6; // ST04_4
  HANDLE v7; // eax
  FILE *v8; // edi
  const wchar_t *v9; // esi
  wchar_t v10; // ax
  DWORD NumberOfBytesWritten; // [esp+4h] [ebp-8h]
  CHAR Buffer[4]; // [esp+8h] [ebp-4h]

  result = FormatMessageA(0x1300u, 0, dwMessageId, 0x400u, Buffer, 0, 0);
  v2 = result;
  if ( result )
  {
    if ( byte_10631C9 )
    {
      v3 = (sub_1007B15() + 8);
      _fputwc_nolock(0x3Cu, v3);
      v4 = L"error";
      v5 = 101;
      do
      {
        _fputwc_nolock(v5, v3);
        v5 = v4[1];
        ++v4;
      }
      while ( v5 );
      _fputwc_nolock(0x3Eu, v3);
    }
    v6 = *Buffer;
    v7 = GetStdHandle(0xFFFFFFF4);
    WriteFile(v7, v6, v2, &NumberOfBytesWritten, 0);
    if ( byte_10631C9 )
    {
      v8 = (sub_1007B15() + 8);
      _fputwc_nolock(0x3Cu, v8);
      _fputwc_nolock(0x2Fu, v8);
      v9 = L"error";
      v10 = 101;
      do
      {
        _fputwc_nolock(v10, v8);
        v10 = v9[1];
        ++v9;
      }
      while ( v10 );
      _fputwc_nolock(0x3Eu, v8);
    }
    result = LocalFree(*Buffer);
  }
  return result;
}
// 102D008: using guessed type wchar_t aError[6];
// 10631C9: using guessed type char byte_10631C9;

//----- (00F77BE0) --------------------------------------------------------
unsigned __int16 **__cdecl sub_F77BE0(std__vector *ppszArg, HKEY hKey, LPCWSTR *lpszArg3, LPCWSTR *lpszArg4)
{
  _WORD *v4; // eax
  WCHAR **v5; // ebx
  const wchar_t *lpszKeyRoot; // eax
  std__vector *v7; // esi
  LPCWSTR *v8; // eax
  unsigned __int16 **v9; // eax
  WCHAR *v10; // edi
  WCHAR **v11; // eax
  WCHAR *ppv; // [esp+8h] [ebp-4h]

  v4 = malloc(2u);
  v5 = ppszArg;
  ppszArg->baseclass_0._Mypair._Myval2._Myfirst = v4;
  *v4 = 0;
  if ( hKey == ghLocalMachineKey )
  {
    lpszKeyRoot = L"HKLM";
  }
  else
  {
    lpszKeyRoot = L"HKCU";
    if ( hKey != ghCurrentUserKey )
      lpszKeyRoot = L"?";
  }
  v7 = _wcsdup(lpszKeyRoot);
  ppszArg = v7;
  v8 = PE_CopyString(&ppv, &ppszArg, L"\\");
  v9 = PE_CopyStringEx(&hKey, v8, lpszArg3);
  v10 = *v5;
  *v5 = _wcsdup(*v9);
  free(v10);
  free(hKey);
  free(ppv);
  free(v7);
  if ( **lpszArg4 )
  {
    v11 = PE_CopyString2(&ppszArg, L"\\", lpszArg4);
    CopyStringToString(v5, *v11, 0x7FFFFFFFu, 0);
    free(ppszArg);
  }
  return v5;
}
// 102D5F4: using guessed type wchar_t asc_102D5F4[2];

//----- (00F77CC0) --------------------------------------------------------
void __cdecl sub_F77CC0(HWND a1, HWND a2)
{
  HWND v2; // edi
  WCHAR *v3; // ebx
  OLECHAR *v4; // esi
  wchar_t *v5; // eax
  wchar_t *v6; // esi
  const wchar_t **v7; // eax
  wchar_t *v8; // eax
  unsigned int v9; // eax
  int v10; // eax
  wchar_t *v11; // eax
  wchar_t *v12; // esi
  const wchar_t **v13; // eax
  wchar_t *v14; // eax
  wchar_t *v15; // eax
  wchar_t *v16; // esi
  const wchar_t **v17; // eax
  wchar_t *v18; // eax
  HWND v19; // edi
  wchar_t *v20; // eax
  wchar_t *v21; // esi
  const wchar_t **v22; // eax
  wchar_t *v23; // eax
  wchar_t *v24; // esi
  const wchar_t **v25; // eax
  HWND v26; // ecx
  WCHAR *v27; // esi
  wchar_t *v28; // eax
  const wchar_t **v29; // eax
  HWND v30; // eax
  HANDLE v31; // eax
  HWND v32; // esi
  HWND v33; // esi
  signed int v34; // ebx
  bool v35; // zf
  HWND v36; // eax
  HWND v37; // esi
  int v38; // eax
  int v39; // eax
  wchar_t v40; // ax
  wchar_t *v41; // esi
  HWND v42; // ebx
  int v43; // eax
  struct _STARTUPINFOW StartupInfo; // [esp+10h] [ebp-164h]
  struct _PROCESS_INFORMATION ProcessInformation; // [esp+54h] [ebp-120h]
  wchar_t *v46; // [esp+64h] [ebp-110h]
  WCHAR *v47; // [esp+68h] [ebp-10Ch]
  HWND hWnd; // [esp+6Ch] [ebp-108h]
  HKEY phkResult; // [esp+70h] [ebp-104h]
  DWORD v50; // [esp+74h] [ebp-100h]
  WCHAR *ppstr; // [esp+78h] [ebp-FCh]
  HWND hWndParent; // [esp+7Ch] [ebp-F8h]
  DWORD dwProcessId; // [esp+80h] [ebp-F4h]
  HWND v54; // [esp+84h] [ebp-F0h]
  DEVMODEW DevMode; // [esp+88h] [ebp-ECh]
  int v56; // [esp+170h] [ebp-4h]

  hWnd = a1;
  hWndParent = a2;
  v46 = 0;
  v2 = malloc(2u);
  v54 = v2;
  *v2 = 0;
  v56 = 0;
  v3 = malloc(2u);
  v47 = v3;
  *v3 = 0;
  v4 = malloc(2u);
  v50 = v4;
  *v4 = 0;
  LOBYTE(v56) = 2;
  DevMode.dmSize = 220;
  EnumDisplaySettingsW(0, 0xFFFFFFFF, &DevMode);
  if ( *hWndParent == 48 )
  {
    MessageBoxW(hWnd, L"The full name of the selected key or value is not available.", L"Process Explorer", 0x30u);
    goto LABEL_47;
  }
  if ( !wcsncmp(hWndParent, L"HKLM", 4u) )
  {
    v5 = _wcsdup(L"\\HKEY_LOCAL_MACHINE");
    v6 = v5;
    v54 = v5;
    v7 = PE_CopyString(&dwProcessId, &v54, hWndParent + 4);
    ppstr = v2;
    v8 = _wcsdup(*v7);
    v2 = v8;
    v54 = v8;
    free(ppstr);
    free(dwProcessId);
    free(v6);
    v9 = TlsGetValue(gdwTlsIndex);
    v10 = PE_OpenKey(ghLocalMachineKey, (hWndParent + 10), 0, v9 | 0x20019, &phkResult);
  }
  else if ( !wcsncmp(hWndParent, L"HKCU", 4u) )
  {
    v11 = _wcsdup(L"\\HKEY_CURRENT_USER");
    v12 = v11;
    dwProcessId = v11;
    v13 = PE_CopyString(&ppstr, &dwProcessId, hWndParent + 4);
    dwProcessId = v2;
    v14 = _wcsdup(*v13);
    v2 = v14;
    v54 = v14;
    free(dwProcessId);
    free(ppstr);
    free(v12);
    v10 = RegOpenKeyW(ghCurrentUserKey, hWndParent + 5, &phkResult);
  }
  else if ( !wcsncmp(hWndParent, L"HKCC", 4u) )
  {
    v15 = _wcsdup(L"\\HKEY_CURRENT_CONFIG");
    v16 = v15;
    dwProcessId = v15;
    v17 = PE_CopyString(&ppstr, &dwProcessId, hWndParent + 4);
    dwProcessId = v2;
    v18 = _wcsdup(*v17);
    v2 = v18;
    v54 = v18;
    free(dwProcessId);
    free(ppstr);
    free(v16);
    v10 = RegOpenKeyW(HKEY_CURRENT_CONFIG, hWndParent + 5, &phkResult);
  }
  else
  {
    v19 = hWndParent;
    if ( !wcsncmp(hWndParent, L"HKCR", 4u) )
    {
      v20 = _wcsdup(L"\\HKEY_CLASSES_ROOT");
      v21 = v20;
      dwProcessId = v20;
      v22 = PE_CopyString(&ppstr, &dwProcessId, hWndParent + 4);
      sub_F72250(&v54, v22);
      free(ppstr);
      free(v21);
      v10 = RegOpenKeyW(HKEY_CLASSES_ROOT, v19 + 5, &phkResult);
    }
    else
    {
      if ( wcsncmp(hWndParent, L"HKU", 3u) )
      {
        sub_F72280(&v54, hWndParent);
        goto LABEL_17;
      }
      v23 = _wcsdup(L"\\HKEY_USERS");
      v24 = v23;
      dwProcessId = v23;
      v25 = PE_CopyString(&ppstr, &dwProcessId, hWndParent + 3);
      sub_F72250(&v54, v25);
      free(ppstr);
      free(v24);
      v10 = RegOpenKeyW(HKEY_USERS, v19 + 4, &phkResult);
    }
    v2 = v54;
  }
  if ( !v10 )
  {
LABEL_17:
    RegCloseKey(phkResult);
    CopyStringToString(&v54, L"\\", 0x7FFFFFFFu, 0);
    v2 = v54;
    goto LABEL_18;
  }
  v46 = wcsrchr(v2, 0x5Cu) + 1;
  *wcsrchr(v2, 0x5Cu) = 0;
LABEL_18:
  v26 = FindWindowW(L"RegEdit_RegEdit", 0);
  hWndParent = v26;
  if ( v26 )
  {
    GetWindowThreadProcessId(v26, &dwProcessId);
    v31 = OpenProcess(0, 0, dwProcessId);
    v4 = v50;
    ProcessInformation.hProcess = v31;
    v30 = hWndParent;
  }
  else
  {
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    memset(&StartupInfo, 0, 0x44u);
    StartupInfo.cb = 68;
    StartupInfo.dwFlags = 1;
    StartupInfo.wShowWindow = 1;
    v27 = v3;
    if ( (GetVersion() & 0x80000000) == 0 )
      v28 = _wcsdup(L"%systemroot%\\regedit.exe");
    else
      v28 = _wcsdup(L"%windir%\\regedit.exe");
    v3 = v28;
    v47 = v28;
    free(v27);
    v29 = RequerySystemEnvironmentString(&ppstr, v3);
    dwProcessId = v50;
    v4 = _wcsdup(*v29);
    v50 = v4;
    free(dwProcessId);
    free(ppstr);
    sub_F81040(v4);
    if ( CreateProcessW(v4, v4, 0, 0, 0, 0, 0, 0, &StartupInfo, &ProcessInformation) )
    {
      WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
      CloseHandle(ProcessInformation.hThread);
    }
    GetLastError();
    v30 = FindWindowW(L"RegEdit_RegEdit", 0);
    hWndParent = v30;
  }
  if ( v30 )
  {
    ShowWindow(v30, 5);
    v32 = hWndParent;
    SetForegroundWindow(hWndParent);
    hWnd = FindWindowExW(v32, 0, L"SysTreeView32", 0);
    SetForegroundWindow(hWnd);
    v33 = hWnd;
    SetFocus(hWnd);
    WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
    SendMessageW(hWndParent, 0x111u, 0x10288u, 0);
    WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
    v34 = 30;
    do
    {
      SendMessageW(v33, 0x100u, 0x25u, 0);
      WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
      --v34;
    }
    while ( v34 );
    v35 = *v2 == 0;
    v36 = v2;
    v3 = v47;
    v4 = v50;
    v54 = v2;
    if ( !v35 )
    {
      v37 = hWnd;
      do
      {
        v38 = *v36;
        if ( v38 == 92 )
        {
          SendMessageW(v37, 0x100u, 0x27u, 0);
        }
        else
        {
          v39 = toupper(v38);
          SendMessageW(v37, 0x102u, v39, 0);
        }
        WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
        v36 = (v54 + 2);
        v54 = v36;
      }
      while ( *v36 );
      v4 = v50;
    }
    WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
    if ( v46 )
    {
      v54 = FindWindowExW(hWndParent, 0, L"SysListView32", 0);
      SetForegroundWindow(v54);
      SetFocus(v54);
      if ( DevMode.dmBitsPerPel > 8 )
        Sleep(0x2EEu);
      SendMessageW(v54, 0x100u, 0x24u, 0);
      v40 = *v46;
      if ( *v46 )
      {
        v41 = v46;
        v42 = v54;
        do
        {
          v43 = toupper(v40);
          SendMessageW(v42, 0x102u, v43, 0);
          WaitForInputIdle(ProcessInformation.hProcess, 0xFFFFFFFF);
          v40 = v41[1];
          ++v41;
        }
        while ( v40 );
        v3 = v47;
        v4 = v50;
      }
    }
    SetForegroundWindow(hWndParent);
    SetFocus(hWndParent);
    CloseHandle(ProcessInformation.hProcess);
  }
  else
  {
    MessageBoxW(
      hWnd,
      L"Error launching Regedit. Make sure you are running with Administrative rights.",
      L"Process Explorer",
      0x30u);
  }
LABEL_47:
  free(v4);
  free(v3);
  free(v2);
}
// 102D418: using guessed type wchar_t aWindirRegeditE[21];

//----- (00F784A0) --------------------------------------------------------
int __cdecl sub_F784A0(int a1, wchar_t *a2)
{
  _WORD *v2; // eax
  char v3; // bl
  unsigned int v4; // edi
  _WORD *v5; // esi
  _WORD *v6; // esi
  unsigned int i; // edx
  int v8; // eax

  v2 = malloc(2u);
  v3 = 0;
  *a1 = v2;
  v4 = 2;
  *v2 = 0;
  v5 = *a1;
  *a1 = _wcsdup(a2);
  free(v5);
  v6 = *a1;
  if ( !wcsncmp(a2, L"File not found: ", 0x10u) )
    v4 = 18;
  for ( i = v4; v4 < wcslen(a2); ++v4 )
  {
    v8 = a2[v4];
    if ( v8 == 92 )
    {
      if ( !v3 )
        v6[i++] = 92;
      v3 = 1;
    }
    else
    {
      v3 = 0;
      v6[i++] = v8;
    }
  }
  v6[i] = a2[v4];
  free(a2);
  return a1;
}

//----- (00F785A0) --------------------------------------------------------
_bstr_t *__cdecl sub_F785A0(_bstr_t *ret, OLECHAR *psz, int nPos, _bstr_t *str)
{
  _bstr_t *strIn; // edi
  UINT nLength; // ebx
  OLECHAR *v6; // edx
  BOOL fLengthIsZero; // eax
  int nFlags; // ecx
  _bstr_t *v10; // edi
  Data_t_bstr_t *v11; // eax
  Data_t_bstr_t *v12; // eax
  _bstr_t bstr1; // [esp+10h] [ebp-14h]
  int v14; // [esp+14h] [ebp-10h]
  int v15; // [esp+20h] [ebp-4h]

  ret->m_Data = 0;
  strIn = str;
  v15 = 0;
  v14 = 1;
  if ( str->m_Data && str->m_Data->m_wstr )
    nLength = SysStringLen(str->m_Data->m_wstr);
  else
    nLength = 0;
  v6 = psz;
  fLengthIsZero = nLength != 0;
  nFlags = (*psz != 0) - fLengthIsZero;
  if ( nFlags == -1 )
  {
    if ( ret != strIn )
    {
      _bstr_t::_Free(ret);
      v12 = strIn->m_Data;
      ret->m_Data = strIn->m_Data;
      if ( v12 )
        InterlockedIncrement(&v12->m_RefCount);
    }
    return ret;
  }
  if ( (*psz != 0) != fLengthIsZero )
  {
    if ( nFlags == 1 )
    {
      if ( nPos )
        v6 = &psz[nPos + 1];
      _bstr_t::operator=(ret, v6);
      return ret;
    }
    return ret;
  }
  _bstr_t::_bstr_t(&str, &psz[nPos]);
  v15 = 1;
  v10 = _bstr_t::operator+(&strIn->m_Data, &bstr1, &str);
  if ( ret != v10 )
  {
    _bstr_t::_Free(ret);
    v11 = v10->m_Data;
    ret->m_Data = v10->m_Data;
    if ( v11 )
      InterlockedIncrement(&v11->m_RefCount);
  }
  _bstr_t::_Free(&bstr1);
  _bstr_t::_Free(&str);
  return ret;
}

//----- (00F786F0) --------------------------------------------------------
void __cdecl sub_F786F0(int a1, void *a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F787A0(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F787A0(a1, a2, v7, v5);
  free(v7);
}

//----- (00F787A0) --------------------------------------------------------
void *__cdecl sub_F787A0(int a1, void *a2, wchar_t *psz, void *a4)
{
  _WORD *v4; // ebx
  tagKeyName *v5; // esi
  const wchar_t *v6; // eax
  wchar_t *v7; // eax
  wchar_t *v8; // ebx
  WCHAR *v9; // eax
  WCHAR *v10; // edi
  const wchar_t *v11; // eax
  wchar_t *v12; // esi
  unsigned __int16 **v13; // eax
  unsigned int v14; // eax
  _WORD *v15; // edi
  _WORD *v16; // esi
  WCHAR *v17; // eax
  const wchar_t **v18; // eax
  WCHAR *v19; // esi
  const wchar_t **v20; // eax
  void *v21; // esi
  tagKeyName *v22; // esi
  unsigned int v23; // eax
  const wchar_t **v24; // eax
  WCHAR *v25; // esi
  unsigned __int16 **v26; // eax
  WCHAR *v27; // edi
  WCHAR *v28; // edi
  tagKeyName *v29; // esi
  unsigned int v30; // eax
  const wchar_t *v31; // eax
  WCHAR *v32; // eax
  WCHAR *v33; // ebx
  wchar_t *v34; // eax
  wchar_t *v35; // edi
  const wchar_t *v36; // eax
  wchar_t *v37; // esi
  unsigned __int16 **v38; // eax
  const wchar_t *v39; // eax
  wchar_t *v40; // eax
  wchar_t *v41; // ebx
  wchar_t *v42; // eax
  wchar_t *v43; // edi
  const wchar_t *v44; // eax
  wchar_t *v45; // esi
  unsigned __int16 **v46; // eax
  wchar_t *v47; // eax
  wchar_t *v48; // edi
  const wchar_t *v49; // eax
  wchar_t *v50; // esi
  unsigned __int16 **v51; // eax
  WCHAR *ppv1; // [esp+10h] [ebp-A0h]
  WCHAR v54[2]; // [esp+14h] [ebp-9Ch]
  WCHAR v55[2]; // [esp+18h] [ebp-98h]
  int a4a; // [esp+1Ch] [ebp-94h]
  int v57; // [esp+20h] [ebp-90h]
  WCHAR *v58; // [esp+24h] [ebp-8Ch]
  WCHAR v59[2]; // [esp+28h] [ebp-88h]
  WCHAR v60[2]; // [esp+2Ch] [ebp-84h]
  WCHAR v61[2]; // [esp+30h] [ebp-80h]
  void *v62; // [esp+34h] [ebp-7Ch]
  WCHAR *pszResult; // [esp+38h] [ebp-78h]
  void *v64; // [esp+3Ch] [ebp-74h]
  int v65; // [esp+40h] [ebp-70h]
  int v66; // [esp+44h] [ebp-6Ch]
  int v67; // [esp+48h] [ebp-68h]
  int v68; // [esp+4Ch] [ebp-64h]
  void *v69; // [esp+50h] [ebp-60h]
  int a3; // [esp+54h] [ebp-5Ch]
  void *v71; // [esp+58h] [ebp-58h]
  void *a1a; // [esp+5Ch] [ebp-54h]
  HKEY KeyHandle; // [esp+60h] [ebp-50h]
  LPCWSTR v74; // [esp+64h] [ebp-4Ch]
  _WORD *v75; // [esp+68h] [ebp-48h]
  void *v76; // [esp+6Ch] [ebp-44h]
  WCHAR *v77; // [esp+70h] [ebp-40h]
  LPCWSTR szArg4; // [esp+74h] [ebp-3Ch]
  void *v79; // [esp+78h] [ebp-38h]
  DWORD dwIndex; // [esp+7Ch] [ebp-34h]
  LPCWSTR v81; // [esp+80h] [ebp-30h]
  WCHAR szArg[2]; // [esp+84h] [ebp-2Ch]
  LPCWSTR szArg3; // [esp+88h] [ebp-28h]
  char v84; // [esp+8Fh] [ebp-21h]
  WCHAR *ppv2; // [esp+90h] [ebp-20h]
  void *v86; // [esp+94h] [ebp-1Ch]
  HKEY hKey; // [esp+98h] [ebp-18h]
  wchar_t *ppv3; // [esp+9Ch] [ebp-14h]
  LPCWSTR lpszKeyName; // [esp+A0h] [ebp-10h]
  int v90; // [esp+ACh] [ebp-4h]

  v79 = malloc(2u);
  v77 = v79;
  *v79 = 0;
  v90 = 0;
  v69 = malloc(2u);
  *v69 = 0;
  v64 = malloc(2u);
  *v64 = 0;
  v71 = malloc(2u);
  *v71 = 0;
  v4 = malloc(2u);
  v75 = v4;
  *v4 = 0;
  v5 = psz;
  LOBYTE(v90) = 4;
  if ( a4 == -1 )
  {
    szArg4 = _wcsdup(&gszNullString);
    v76 = _wcsdup(&gszNullString);
    lpszKeyName = _wcsdup(&gszNullString);
    ppv3 = _wcsdup(&gszNullString);
    hKey = _wcsdup(&gszNullString);
    v86 = _wcsdup(&gszNullString);
    dwIndex = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( psz )
      v6 = psz;
    v7 = _wcsdup(v6);
    v8 = v7;
    a4 = v7;
    v9 = _wcsdup(&gszNullString);
    v10 = v9;
    ppv2 = v9;
    v11 = &gszNullString;
    if ( psz )
      v11 = psz;
    v12 = _wcsdup(v11);
    szArg3 = v12;
    v81 = sub_F77BE0(&a1a, a2, &a4, &dwIndex);
    v13 = sub_F77BE0(szArg, a2, &szArg3, &ppv2);
    LOBYTE(v90) = 16;
    a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v13, v81, &v86);
    free(*szArg);
    free(a1a);
    free(v12);
    free(v10);
    free(v8);
    free(dwIndex);
    free(v86);
    free(hKey);
    free(ppv3);
    free(lpszKeyName);
    free(v76);
    LOBYTE(v90) = 4;
    free(szArg4);
    v4 = v75;
    v5 = psz;
  }
  v14 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, v5, 0, v14 | 0x20019, &KeyHandle) )
  {
    dwIndex = 0;
    lpszKeyName = malloc(2u);
    *lpszKeyName = 0;
    ppv3 = malloc(2u);
    *ppv3 = 0;
    v15 = malloc(2u);
    v86 = v15;
    *v15 = 0;
    v16 = malloc(2u);
    v65 = v16;
    v66 = 0;
    v67 = 0;
    *v16 = 0;
    v68 = 0;
    LOBYTE(v90) = 20;
    if ( !PE_LoadKey(KeyHandle, 0, &ppv3) )
    {
      do
      {
        v17 = PE_CopyString2(&pszResult, L"CLSID\\", &ppv3);
        v18 = PE_CopyString(&a1a, v17, L"\\InprocServer32");
        v19 = lpszKeyName;
        lpszKeyName = _wcsdup(*v18);
        free(v19);
        free(a1a);
        free(pszResult);
        v20 = PE_CopyString2(&v58, L"HKCR\\CLSID\\", &ppv3);
        v21 = v4;
        v4 = _wcsdup(*v20);
        v75 = v4;
        free(v21);
        free(v58);
        v22 = lpszKeyName;
        v23 = TlsGetValue(gdwTlsIndex);
        if ( !PE_OpenKey(HKEY_CLASSES_ROOT, v22, 0, v23 | 0x20019, &hKey) )
        {
          if ( !sub_F81520(hKey, &gszNullString, 0, 0, &lpszKeyName) )
          {
            sub_F77040(lpszKeyName, &v65);
            v24 = sub_F74EE0(&v62, a1, &v65, 0);
            v86 = _wcsdup(*v24);
            free(v15);
            free(v62);
            RegCloseKey(hKey);
            v25 = _wcsdup(L"CLSID\\");
            ppv2 = v25;
            v26 = PE_CopyStringEx(&ppv1, &ppv2, &ppv3);
            v27 = lpszKeyName;
            lpszKeyName = _wcsdup(*v26);
            free(v27);
            free(ppv1);
            free(v25);
            v28 = _wcsdup(ppv3);
            v77 = v28;
            free(v79);
            v29 = lpszKeyName;
            v30 = TlsGetValue(gdwTlsIndex);
            if ( !PE_OpenKey(HKEY_CLASSES_ROOT, v29, 0, v30 | 0x20019, &hKey) )
            {
              if ( !sub_F81520(hKey, &gszNullString, 0, 0, &lpszKeyName) && wcslen(lpszKeyName) )
              {
                v77 = _wcsdup(lpszKeyName);
                free(v28);
              }
              RegCloseKey(hKey);
            }
            v31 = &gszNullString;
            if ( psz )
              v31 = psz;
            v32 = _wcsdup(v31);
            v33 = v32;
            ppv2 = v32;
            v34 = _wcsdup(&gszNullString);
            v35 = v34;
            szArg3 = v34;
            v36 = &gszNullString;
            if ( psz )
              v36 = psz;
            v37 = _wcsdup(v36);
            v81 = v37;
            *szArg = sub_F77BE0(v60, a2, &ppv2, &ppv3);
            v38 = sub_F77BE0(v54, a2, &v81, &szArg3);
            LOBYTE(v90) = 25;
            v84 = sub_F73D40(a1, &v77, v38, *szArg, &v86, &v69, &v71, &v57);
            free(*v54);
            free(*v60);
            free(v37);
            free(v35);
            free(v33);
            if ( v84 )
            {
              if ( a4 == -1 )
              {
                ppv2 = _wcsdup(&gszNullString);
                szArg3 = _wcsdup(&gszNullString);
                v81 = _wcsdup(&gszNullString);
                *szArg = _wcsdup(&gszNullString);
                v79 = _wcsdup(&gszNullString);
                v76 = _wcsdup(&gszNullString);
                szArg4 = _wcsdup(&gszNullString);
                v39 = &gszNullString;
                if ( psz )
                  v39 = psz;
                v40 = _wcsdup(v39);
                v41 = v40;
                a4 = v40;
                v42 = _wcsdup(&gszNullString);
                v43 = v42;
                a4a = v42;
                v44 = &gszNullString;
                if ( psz )
                  v44 = psz;
                v45 = _wcsdup(v44);
                a3 = v45;
                v74 = sub_F77BE0(v59, a2, &a4, &szArg4);
                v46 = sub_F77BE0(v61, a2, &a3, &a4a);
                LOBYTE(v90) = 37;
                a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v46, v74, &v76);
                free(*v61);
                free(*v59);
                free(v45);
                free(v43);
                free(v41);
                free(szArg4);
                free(v76);
                free(v79);
                free(*szArg);
                free(v81);
                free(szArg3);
                free(ppv2);
              }
              v47 = _wcsdup(&gszNullString);
              v48 = v47;
              a3 = v47;
              v49 = &gszNullString;
              if ( psz )
                v49 = psz;
              v50 = _wcsdup(v49);
              v74 = v50;
              v51 = sub_F77BE0(v55, a2, &v74, &ppv3);
              LOBYTE(v90) = 40;
              sub_F73FF0(a1, -1, a4, 3, &v77, v51, &v86);
              free(*v55);
              free(v50);
              free(v48);
            }
            sub_F721F0(&v65);
            free(v86);
            free(ppv3);
            free(lpszKeyName);
            v4 = v75;
            v79 = v77;
            goto LABEL_33;
          }
          RegCloseKey(hKey);
        }
        sub_F721F0(&v65);
        free(v15);
        free(ppv3);
        free(lpszKeyName);
LABEL_33:
        ++dwIndex;
        lpszKeyName = malloc(2u);
        *lpszKeyName = 0;
        ppv3 = malloc(2u);
        *ppv3 = 0;
        v15 = malloc(2u);
        v86 = v15;
        *v15 = 0;
        v16 = malloc(2u);
        v65 = v16;
        v66 = 0;
        v67 = 0;
        *v16 = 0;
        v68 = 0;
        LOBYTE(v90) = 20;
      }
      while ( !PE_LoadKey(KeyHandle, dwIndex, &ppv3) );
    }
    free(v16);
    free(v15);
    free(ppv3);
    free(lpszKeyName);
    RegCloseKey(KeyHandle);
  }
  free(v4);
  free(v71);
  free(v64);
  free(v69);
  free(v79);
  return a4;
}

//----- (00F79030) --------------------------------------------------------
void __cdecl sub_F79030(void *a1, int a2, void *a3, wchar_t *a4)
{
  _WORD *v4; // eax
  void *v5; // ebx
  const wchar_t *v6; // eax
  WCHAR *v7; // esi
  WCHAR *v8; // eax
  const wchar_t **v9; // eax
  WCHAR *v10; // edi
  const wchar_t *v11; // ecx
  wchar_t *v12; // esi
  WCHAR *v13; // eax
  const wchar_t **v14; // eax
  WCHAR *v15; // ebx
  WCHAR *pszResult; // [esp+10h] [ebp-18h]
  WCHAR *ppv; // [esp+14h] [ebp-14h]
  WCHAR *ppszText2; // [esp+18h] [ebp-10h]
  int v19; // [esp+24h] [ebp-4h]

  v4 = malloc(2u);
  v5 = v4;
  *v4 = 0;
  v19 = 0;
  v6 = &gszNullString;
  if ( a4 )
    v6 = a4;
  v7 = _wcsdup(v6);
  ppszText2 = v7;
  v8 = PE_CopyString2(&pszResult, L"Software\\Classes\\CLSID\\", &ppszText2);
  v9 = PE_CopyString(&ppv, v8, L"\\Instance");
  v10 = _wcsdup(*v9);
  ppszText2 = v10;
  free(v5);
  free(ppv);
  free(pszResult);
  free(v7);
  sub_F786F0(a2, a3, &ppszText2);
  if ( a1 )
  {
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    v11 = &gszNullString;
    if ( a4 )
      v11 = a4;
    v12 = _wcsdup(v11);
    a4 = v12;
    v13 = PE_CopyString2(&pszResult, L"Software\\Wow6432Node\\Classes\\CLSID\\", &a4);
    v14 = PE_CopyString(&a1, v13, L"\\Instance");
    v15 = v10;
    v10 = _wcsdup(*v14);
    ppszText2 = v10;
    free(v15);
    free(a1);
    free(pszResult);
    free(v12);
    sub_F786F0(a2, a3, &ppszText2);
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
  }
  free(v10);
}

//----- (00F791C0) --------------------------------------------------------
void __cdecl sub_F791C0(int a1, int a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F79270(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F79270(a1, a2, v7, v5);
  free(v7);
}

//----- (00F79270) --------------------------------------------------------
void *__cdecl sub_F79270(int a1, int a2, wchar_t *psz, void *a4)
{
  int v4; // edi
  tagKeyName *v5; // esi
  const wchar_t *v6; // eax
  wchar_t *v7; // eax
  wchar_t *v8; // ebx
  wchar_t *v9; // eax
  wchar_t *v10; // edi
  const wchar_t *v11; // eax
  wchar_t *v12; // esi
  unsigned __int16 **v13; // eax
  unsigned int v14; // eax
  int v15; // eax
  const wchar_t **v16; // eax
  const WCHAR **v17; // eax
  wchar_t *v18; // eax
  wchar_t *v19; // ebx
  wchar_t *v20; // eax
  wchar_t *v21; // edi
  const WCHAR **v22; // eax
  wchar_t *v23; // eax
  wchar_t *v24; // esi
  const wchar_t *v25; // eax
  unsigned __int16 **v26; // eax
  wchar_t *v27; // esi
  const wchar_t *v28; // eax
  wchar_t *v29; // eax
  wchar_t *v30; // ebx
  wchar_t *v31; // eax
  wchar_t *v32; // edi
  const WCHAR **v33; // eax
  wchar_t *v34; // esi
  unsigned __int16 **v35; // eax
  wchar_t *v36; // eax
  wchar_t *v37; // ebx
  const wchar_t *v38; // esi
  const wchar_t *v39; // eax
  wchar_t *v40; // edi
  wchar_t *v41; // esi
  unsigned __int16 **v42; // eax
  int a2a; // [esp+10h] [ebp-3A4h]
  wchar_t **v45; // [esp+14h] [ebp-3A0h]
  int v46; // [esp+18h] [ebp-39Ch]
  int v47; // [esp+1Ch] [ebp-398h]
  int v48; // [esp+20h] [ebp-394h]
  void *v49; // [esp+24h] [ebp-390h]
  HKEY hKey; // [esp+28h] [ebp-38Ch]
  DWORD cbData; // [esp+2Ch] [ebp-388h]
  WCHAR v52[2]; // [esp+30h] [ebp-384h]
  wchar_t *v53; // [esp+34h] [ebp-380h]
  void *v54; // [esp+38h] [ebp-37Ch]
  void *v55; // [esp+3Ch] [ebp-378h]
  void *v56; // [esp+40h] [ebp-374h]
  wchar_t *pszText; // [esp+44h] [ebp-370h]
  void *v58; // [esp+48h] [ebp-36Ch]
  void *v59; // [esp+4Ch] [ebp-368h]
  int a3; // [esp+50h] [ebp-364h]
  LPCWSTR szArg4; // [esp+54h] [ebp-360h]
  WCHAR v62[2]; // [esp+58h] [ebp-35Ch]
  void *v63; // [esp+5Ch] [ebp-358h]
  int v64; // [esp+60h] [ebp-354h]
  WCHAR v65[2]; // [esp+64h] [ebp-350h]
  LPCWSTR szArg; // [esp+68h] [ebp-34Ch]
  char v67; // [esp+6Fh] [ebp-345h]
  WCHAR v68[2]; // [esp+70h] [ebp-344h]
  HKEY hRootKey; // [esp+74h] [ebp-340h]
  void *a1a; // [esp+78h] [ebp-33Ch]
  LPCWSTR v71; // [esp+7Ch] [ebp-338h]
  LPCWSTR v72; // [esp+80h] [ebp-334h]
  wchar_t Data[400]; // [esp+84h] [ebp-330h]
  int v74; // [esp+3B0h] [ebp-4h]

  v4 = a1;
  v5 = psz;
  v64 = a1;
  hRootKey = a2;
  v53 = psz;
  v56 = malloc(2u);
  *v56 = 0;
  v74 = 0;
  v55 = malloc(2u);
  *v55 = 0;
  v49 = malloc(2u);
  *v49 = 0;
  v54 = malloc(2u);
  *v54 = 0;
  LOBYTE(v74) = 3;
  if ( a4 == -1 )
  {
    v72 = _wcsdup(&gszNullString);
    v71 = _wcsdup(&gszNullString);
    *v68 = _wcsdup(&gszNullString);
    v63 = _wcsdup(&gszNullString);
    v59 = _wcsdup(&gszNullString);
    v58 = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( psz )
      v6 = psz;
    v7 = _wcsdup(v6);
    v8 = v7;
    pszText = v7;
    v9 = _wcsdup(L"(Default)");
    v10 = v9;
    *v62 = v9;
    v11 = &gszNullString;
    if ( psz )
      v11 = psz;
    v12 = _wcsdup(v11);
    a3 = v12;
    *v65 = sub_F77BE0(&a1a, hRootKey, &pszText, &szArg4);
    v13 = sub_F77BE0(&szArg, hRootKey, &a3, v62);
    LOBYTE(v74) = 15;
    a4 = sub_F73FF0(v64, 0, 0xFFFFFFFF, 0, v13, *v65, &v58);
    free(szArg);
    free(a1a);
    free(v12);
    free(v10);
    free(v8);
    free(szArg4);
    free(v58);
    free(v59);
    free(v63);
    free(*v68);
    free(v71);
    LOBYTE(v74) = 3;
    free(v72);
    v5 = v53;
    v4 = v64;
  }
  v14 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(hRootKey, v5, 0, v14 | 0x20019, &hKey) )
  {
    cbData = 800;
    if ( !RegQueryValueExW(hKey, &gszNullString, 0, 0, Data, &cbData) && cbData )
    {
      a2a = malloc(2u);
      v45 = 0;
      v46 = 0;
      *a2a = 0;
      v47 = 0;
      LOBYTE(v74) = 16;
      if ( sub_F76CC0(Data, &a2a) )
      {
        pszText = *v45;
        v15 = wcscmp(pszText, L"%1");
        if ( v15 )
          v15 = -(v15 < 0) | 1;
        if ( v15 )
        {
          v16 = sub_F74EE0(&a1a, v4, &a2a, 0);
          sub_F72250(&v56, v16);
          free(a1a);
          v71 = _wcsdup(L"(Default)");
          v17 = &gszNullString;
          if ( v5 )
            v17 = v5;
          v18 = _wcsdup(v17);
          v19 = v18;
          a1a = v18;
          v20 = _wcsdup(&gszNullString);
          v21 = v20;
          szArg = v20;
          v22 = &gszNullString;
          if ( v5 )
            v22 = v5;
          v23 = _wcsdup(v22);
          v24 = v23;
          *v65 = v23;
          v25 = &gszNullString;
          if ( pszText )
            v25 = pszText;
          v72 = _wcsdup(v25);
          a3 = sub_F77BE0(v68, hRootKey, &a1a, &v71);
          v26 = sub_F77BE0(v62, hRootKey, v65, &szArg);
          LOBYTE(v74) = 23;
          v67 = sub_F73D40(v64, &v72, v26, a3, &v56, &v55, &v54, &v48);
          free(*v62);
          free(*v68);
          free(v72);
          free(v24);
          free(v21);
          free(v19);
          LOBYTE(v74) = 16;
          free(v71);
          if ( v67 )
          {
            if ( a4 == -1 )
            {
              szArg4 = _wcsdup(&gszNullString);
              v58 = _wcsdup(&gszNullString);
              v59 = _wcsdup(&gszNullString);
              v63 = _wcsdup(&gszNullString);
              *v68 = _wcsdup(&gszNullString);
              v71 = _wcsdup(&gszNullString);
              v72 = _wcsdup(&gszNullString);
              v27 = v53;
              v28 = &gszNullString;
              if ( v53 )
                v28 = v53;
              v29 = _wcsdup(v28);
              v30 = v29;
              a1a = v29;
              v31 = _wcsdup(L"(Default)");
              v32 = v31;
              szArg = v31;
              v33 = &gszNullString;
              if ( v27 )
                v33 = v27;
              v34 = _wcsdup(v33);
              *v65 = v34;
              a3 = sub_F77BE0(v52, hRootKey, &a1a, &v72);
              v35 = sub_F77BE0(v62, hRootKey, v65, &szArg);
              LOBYTE(v74) = 35;
              a4 = sub_F73FF0(v64, 0, 0xFFFFFFFF, 0, v35, a3, &v71);
              free(*v62);
              free(*v52);
              free(v34);
              free(v32);
              free(v30);
              free(v72);
              free(v71);
              free(*v68);
              free(v63);
              free(v59);
              free(v58);
              free(szArg4);
            }
            v71 = _wcsdup(&gszNullString);
            v72 = _wcsdup(&gszNullString);
            v36 = _wcsdup(L"(Default)");
            v37 = v36;
            *v52 = v36;
            v38 = &gszNullString;
            v39 = &gszNullString;
            if ( v53 )
              v39 = v53;
            v40 = _wcsdup(v39);
            a1a = v40;
            if ( pszText )
              v38 = pszText;
            v41 = _wcsdup(v38);
            szArg = v41;
            v42 = sub_F77BE0(v65, hRootKey, &a1a, v52);
            LOBYTE(v74) = 41;
            sub_F73FF0(v64, -1, a4, 12, &szArg, v42, &v56);
            free(*v65);
            free(v41);
            free(v40);
            free(v37);
            free(v72);
            free(v71);
          }
        }
      }
      sub_F721F0(&a2a);
    }
    RegCloseKey(hKey);
  }
  free(v54);
  free(v49);
  free(v55);
  free(v56);
  return a4;
}

//----- (00F79AB0) --------------------------------------------------------
void __cdecl sub_F79AB0(int a1, void *a2, void *a3, char a4, char a5)
{
  _WORD *v5; // ST68_4
  WCHAR *v6; // esi
  void *v7; // edi
  const wchar_t **v8; // eax
  wchar_t *v9; // ST6C_4

  v5 = malloc(2u);
  *v5 = 0;
  v6 = a3;
  v7 = sub_F79B70(a1, a2, *a3, a4, a5, 0xFFFFFFFF, 1, 1);
  v8 = PE_CopyString(&a3, v6, L"\\AutorunsDisabled");
  v9 = _wcsdup(*v8);
  free(v5);
  free(a3);
  sub_F79B70(a1, a2, v9, a4, a5, v7, 0, 1);
  free(v9);
}

//----- (00F79B70) --------------------------------------------------------
void *__cdecl sub_F79B70(int a1, void *a2, wchar_t *psz, char a4, char a5, void *a6, char a7, char a8)
{
  wchar_t *v8; // edi
  tagKeyName *v9; // esi
  const wchar_t *v10; // eax
  wchar_t *v11; // eax
  wchar_t *v12; // ebx
  wchar_t *v13; // eax
  wchar_t *v14; // edi
  const wchar_t *v15; // eax
  wchar_t *v16; // esi
  unsigned __int16 **v17; // eax
  unsigned int v18; // eax
  WCHAR *v19; // ebx
  _WORD *v20; // esi
  const wchar_t *v21; // edx
  __int16 *v22; // ecx
  __int16 v23; // ax
  wchar_t *v24; // esi
  WCHAR *v25; // eax
  const wchar_t **v26; // eax
  WCHAR *v27; // esi
  const wchar_t **v28; // eax
  wchar_t *v29; // esi
  tagKeyName *v30; // edi
  unsigned int v31; // eax
  WCHAR *v32; // esi
  void (__stdcall *v33)(HKEY); // edi
  WCHAR *v34; // eax
  const wchar_t **v35; // eax
  WCHAR *v36; // edi
  const wchar_t **v37; // eax
  tagKeyName *v38; // esi
  unsigned int v39; // eax
  int v40; // eax
  WCHAR *v41; // esi
  tagKeyName *v42; // esi
  unsigned int v43; // eax
  int v44; // eax
  void *v45; // esi
  WCHAR *v46; // ebx
  const wchar_t **v47; // eax
  WCHAR *v48; // esi
  const wchar_t **v49; // eax
  wchar_t *v50; // esi
  WCHAR *v51; // eax
  const wchar_t **v52; // eax
  WCHAR *v53; // esi
  const wchar_t **v54; // eax
  wchar_t *v55; // esi
  tagKeyName *v56; // esi
  unsigned int v57; // eax
  const wchar_t **v58; // eax
  LPCWSTR *v59; // eax
  unsigned __int16 **v60; // eax
  wchar_t *v61; // esi
  const wchar_t **v62; // eax
  const wchar_t **v63; // eax
  void *v64; // esi
  const wchar_t **v65; // eax
  wchar_t *v66; // eax
  const wchar_t *v67; // eax
  wchar_t *v68; // eax
  wchar_t *v69; // ebx
  wchar_t *v70; // eax
  wchar_t *v71; // edi
  const wchar_t *v72; // eax
  wchar_t *v73; // esi
  unsigned __int16 **v74; // eax
  const wchar_t *v75; // eax
  wchar_t *v76; // eax
  wchar_t *v77; // ebx
  wchar_t *v78; // eax
  wchar_t *v79; // edi
  const wchar_t *v80; // eax
  wchar_t *v81; // esi
  unsigned __int16 **v82; // eax
  const wchar_t *v83; // eax
  wchar_t *v84; // esi
  unsigned __int16 **v85; // eax
  int v87; // [esp+10h] [ebp-108h]
  int v88; // [esp+14h] [ebp-104h]
  int v89; // [esp+18h] [ebp-100h]
  int v90; // [esp+1Ch] [ebp-FCh]
  void *v91; // [esp+20h] [ebp-F8h]
  int a2a; // [esp+24h] [ebp-F4h]
  int v93; // [esp+28h] [ebp-F0h]
  int v94; // [esp+2Ch] [ebp-ECh]
  int v95; // [esp+30h] [ebp-E8h]
  WCHAR *v96; // [esp+34h] [ebp-E4h]
  WCHAR *ppv; // [esp+38h] [ebp-E0h]
  void *v98; // [esp+3Ch] [ebp-DCh]
  WCHAR v99[2]; // [esp+40h] [ebp-D8h]
  WCHAR *v100; // [esp+44h] [ebp-D4h]
  int v101; // [esp+48h] [ebp-D0h]
  WCHAR *v102; // [esp+4Ch] [ebp-CCh]
  WCHAR v103[2]; // [esp+50h] [ebp-C8h]
  WCHAR *v104; // [esp+54h] [ebp-C4h]
  WCHAR v105[2]; // [esp+58h] [ebp-C0h]
  void *v106; // [esp+5Ch] [ebp-BCh]
  WCHAR *pszResult; // [esp+60h] [ebp-B8h]
  WCHAR *ppv1; // [esp+64h] [ebp-B4h]
  int a3; // [esp+68h] [ebp-B0h]
  WCHAR *v110; // [esp+6Ch] [ebp-ACh]
  int a4a; // [esp+70h] [ebp-A8h]
  WCHAR *v112; // [esp+74h] [ebp-A4h]
  WCHAR v113[2]; // [esp+78h] [ebp-A0h]
  void *v114; // [esp+7Ch] [ebp-9Ch]
  WCHAR v115[2]; // [esp+80h] [ebp-98h]
  WCHAR *v116; // [esp+84h] [ebp-94h]
  void *v117; // [esp+88h] [ebp-90h]
  WCHAR *v118; // [esp+8Ch] [ebp-8Ch]
  void *v119; // [esp+90h] [ebp-88h]
  WCHAR *v120; // [esp+94h] [ebp-84h]
  int v121; // [esp+98h] [ebp-80h]
  int v122; // [esp+9Ch] [ebp-7Ch]
  int v123; // [esp+A0h] [ebp-78h]
  int v124; // [esp+A4h] [ebp-74h]
  void *v125; // [esp+A8h] [ebp-70h]
  void *v126; // [esp+ACh] [ebp-6Ch]
  void *v127; // [esp+B0h] [ebp-68h]
  void *v128; // [esp+B4h] [ebp-64h]
  HKEY KeyHandle; // [esp+B8h] [ebp-60h]
  DWORD Type; // [esp+BCh] [ebp-5Ch]
  unsigned int v131; // [esp+C0h] [ebp-58h]
  void *a1a; // [esp+C4h] [ebp-54h]
  DWORD dwIndex; // [esp+C8h] [ebp-50h]
  WCHAR szArg[2]; // [esp+CCh] [ebp-4Ch]
  LPCWSTR v135; // [esp+D0h] [ebp-48h]
  WCHAR *ppv3; // [esp+D4h] [ebp-44h]
  LPCWSTR szArg4; // [esp+D8h] [ebp-40h]
  wchar_t *v138; // [esp+DCh] [ebp-3Ch]
  LPCWSTR szArg3; // [esp+E0h] [ebp-38h]
  void *v140; // [esp+E4h] [ebp-34h]
  LPCWSTR v141; // [esp+E8h] [ebp-30h]
  HKEY hKey; // [esp+ECh] [ebp-2Ch]
  WCHAR *v143; // [esp+F0h] [ebp-28h]
  void *v144; // [esp+F4h] [ebp-24h]
  void *v145; // [esp+F8h] [ebp-20h]
  char v146; // [esp+FFh] [ebp-19h]
  wchar_t *ppszText2; // [esp+100h] [ebp-18h]
  HKEY__ v148; // [esp+104h] [ebp-14h]
  LPCWSTR lpszKeyName; // [esp+108h] [ebp-10h]
  int v150; // [esp+114h] [ebp-4h]

  v131 = 0;
  szArg3 = 0;
  v126 = malloc(2u);
  *v126 = 0;
  v150 = 0;
  v128 = malloc(2u);
  *v128 = 0;
  v125 = malloc(2u);
  *v125 = 0;
  v127 = malloc(2u);
  *v127 = 0;
  v8 = malloc(2u);
  v138 = v8;
  *v8 = 0;
  v9 = psz;
  LOBYTE(v150) = 4;
  if ( a6 == -1 )
  {
    v145 = _wcsdup(&gszNullString);
    v143 = _wcsdup(&gszNullString);
    v144 = _wcsdup(&gszNullString);
    v140 = _wcsdup(&gszNullString);
    v141 = _wcsdup(&gszNullString);
    ppv3 = _wcsdup(&gszNullString);
    dwIndex = _wcsdup(&gszNullString);
    v10 = &gszNullString;
    if ( psz )
      v10 = psz;
    v11 = _wcsdup(v10);
    v12 = v11;
    a6 = v11;
    v13 = _wcsdup(&gszNullString);
    v14 = v13;
    Type = v13;
    v15 = &gszNullString;
    if ( psz )
      v15 = psz;
    v16 = _wcsdup(v15);
    szArg3 = v16;
    szArg4 = sub_F77BE0(&a1a, a2, &a6, &dwIndex);
    v17 = sub_F77BE0(szArg, a2, &szArg3, &Type);
    LOBYTE(v150) = 16;
    a6 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v17, szArg4, &ppv3);
    free(*szArg);
    free(a1a);
    free(v16);
    free(v14);
    free(v12);
    free(dwIndex);
    free(ppv3);
    free(v141);
    free(v140);
    free(v144);
    free(v143);
    LOBYTE(v150) = 4;
    free(v145);
    v8 = v138;
    v9 = psz;
  }
  v18 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, v9, 0, v18 | 0x20019, &KeyHandle) )
  {
    dwIndex = 0;
    v148.unused = malloc(2u);
    *v148.unused = 0;
    v141 = malloc(2u);
    v143 = v141;
    *v141 = 0;
    ppszText2 = malloc(2u);
    *ppszText2 = 0;
    lpszKeyName = malloc(2u);
    *lpszKeyName = 0;
    v19 = malloc(2u);
    ppv3 = v19;
    *v19 = 0;
    v20 = malloc(2u);
    v145 = v20;
    v140 = v20;
    *v20 = 0;
    LOBYTE(v150) = 22;
    if ( !sub_F81450(KeyHandle, 0, &v148, 0, &Type, &ppszText2) )
    {
      while ( Type == 1 || Type == 2 || Type == 7 || Type == 3 )
      {
        v21 = v148.unused;
        v22 = v148.unused;
        szArg4 = v148.unused;
        szArg3 = (v148.unused + 2);
        do
        {
          v23 = *v22;
          ++v22;
        }
        while ( v23 );
        if ( !((v22 - szArg3) >> 1) )
        {
          if ( !a8 )
            break;
          v148.unused = _wcsdup(L"(Default)");
          free(szArg4);
          v21 = v148.unused;
        }
        v24 = _wcsdup(v21);
        v144 = v24;
        v143 = v24;
        free(v141);
        if ( a5 )
        {
          v25 = PE_CopyString2(&pszResult, L"CLSID\\", &v148);
          v26 = PE_CopyString(&ppv, v25, L"\\InprocServer32");
          v27 = lpszKeyName;
          lpszKeyName = _wcsdup(*v26);
          free(v27);
          free(ppv);
          free(pszResult);
          v28 = PE_CopyString2(&v120, L"HKCR\\CLSID\\", &v148);
          v29 = _wcsdup(*v28);
          v138 = v29;
          free(v8);
          free(v120);
          v30 = lpszKeyName;
          v31 = TlsGetValue(gdwTlsIndex);
          if ( PE_OpenKey(HKEY_CLASSES_ROOT, v30, 0, v31 | 0x20019, &hKey) )
          {
            v34 = PE_CopyString2(&v96, L"CLSID\\", &v148);
            v35 = PE_CopyString(&v118, v34, L"\\Shell\\Open\\Command");
            v36 = lpszKeyName;
            lpszKeyName = _wcsdup(*v35);
            free(v36);
            free(v118);
            free(v96);
            v37 = PE_CopyString2(&v116, L"HKCR\\CLSID\\", &v148);
            v138 = _wcsdup(*v37);
            free(v29);
            free(v116);
            v38 = lpszKeyName;
            v39 = TlsGetValue(gdwTlsIndex);
            v40 = PE_OpenKey(HKEY_CLASSES_ROOT, v38, 0, v39 | 0x20019, &hKey);
            v41 = lpszKeyName;
            if ( v40 )
            {
              lpszKeyName = _wcsdup(&gszNullString);
              free(v41);
              v33 = RegCloseKey;
            }
            else
            {
              lpszKeyName = _wcsdup(&gszNullString);
              free(v41);
              sub_F81520(hKey, &gszNullString, 0, 0, &lpszKeyName);
              v33 = RegCloseKey;
              RegCloseKey(hKey);
            }
          }
          else
          {
            v32 = lpszKeyName;
            lpszKeyName = _wcsdup(&gszNullString);
            free(v32);
            sub_F81520(hKey, &gszNullString, 0, 0, &lpszKeyName);
            v33 = RegCloseKey;
            RegCloseKey(hKey);
          }
          if ( wcslen(ppszText2)
            || (v42 = *PE_CopyString2(&v104, L"CLSID\\", &v148),
                LOBYTE(v150) = 23,
                v131 |= 1u,
                szArg3 = v131,
                v43 = TlsGetValue(gdwTlsIndex),
                v44 = PE_OpenKey(HKEY_CLASSES_ROOT, v42, 0, v43 | 0x20019, &hKey),
                v146 = 1,
                v44) )
          {
            v146 = 0;
          }
          v150 = 22;
          if ( v131 & 1 )
          {
            v131 &= 0xFFFFFFFE;
            free(v104);
          }
          if ( v146 )
          {
            sub_F81520(hKey, &gszNullString, 0, 0, &ppszText2);
            v33(hKey);
          }
          a2a = malloc(2u);
          v93 = 0;
          v94 = 0;
          *a2a = 0;
          v95 = 0;
          LOBYTE(v150) = 24;
          if ( sub_F76CC0(lpszKeyName, &a2a) )
          {
            v45 = v144;
            v46 = _wcsdup(ppszText2);
            v143 = v46;
            free(v45);
            v47 = sub_F74890(&v114, lpszKeyName);
            v48 = lpszKeyName;
            lpszKeyName = _wcsdup(*v47);
            free(v48);
            free(v114);
            v49 = sub_F74EE0(&v98, a1, &a2a, 0);
            v50 = _wcsdup(*v49);
            v140 = v50;
            free(v145);
            free(v98);
            sub_F721F0(&a2a);
            goto LABEL_46;
          }
          sub_F721F0(&a2a);
          free(v145);
          free(v19);
          free(lpszKeyName);
          free(ppszText2);
          free(v144);
LABEL_66:
          free(v148.unused);
          v8 = v138;
          goto LABEL_67;
        }
        if ( a4 )
        {
          v87 = malloc(2u);
          v88 = 0;
          v89 = 0;
          *v87 = 0;
          v90 = 0;
          LOBYTE(v150) = 26;
          if ( sub_F76CC0(ppszText2, &v87) )
          {
            v138 = _wcsdup(ppszText2);
            free(v8);
            v63 = sub_F74890(&v119, ppszText2);
            v64 = v126;
            v126 = _wcsdup(*v63);
            free(v64);
            free(v119);
            v65 = sub_F74EE0(&v117, a1, &v87, 0);
            v50 = _wcsdup(*v65);
            v140 = v50;
            free(v145);
            free(v117);
            sub_F721F0(&v87);
LABEL_45:
            v46 = v144;
LABEL_46:
            if ( !wcslen(v46) && wcslen(v50) )
            {
              if ( wcsrchr(v50, 0x5Cu) )
              {
                v66 = wcsrchr(v50, 0x5Cu);
                v143 = _wcsdup(v66 + 1);
                free(v46);
              }
              else
              {
                v143 = _wcsdup(v50);
                free(v46);
              }
            }
            v67 = &gszNullString;
            if ( psz )
              v67 = psz;
            v68 = _wcsdup(v67);
            v69 = v68;
            szArg3 = v68;
            v70 = _wcsdup(&gszNullString);
            v71 = v70;
            szArg4 = v70;
            v72 = &gszNullString;
            if ( psz )
              v72 = psz;
            v73 = _wcsdup(v72);
            *szArg = v73;
            a1a = sub_F77BE0(v113, a2, &szArg3, &v148);
            v74 = sub_F77BE0(v115, a2, szArg, &szArg4);
            LOBYTE(v150) = 31;
            v146 = sub_F73D40(a1, &v143, v74, a1a, &v140, &v128, &v127, &v101);
            free(*v115);
            free(*v113);
            free(v73);
            free(v71);
            free(v69);
            if ( v146 )
            {
              if ( a6 == -1 )
              {
                szArg3 = _wcsdup(&gszNullString);
                szArg4 = _wcsdup(&gszNullString);
                *szArg = _wcsdup(&gszNullString);
                a1a = _wcsdup(&gszNullString);
                v145 = _wcsdup(&gszNullString);
                v144 = _wcsdup(&gszNullString);
                v141 = _wcsdup(&gszNullString);
                v75 = &gszNullString;
                if ( psz )
                  v75 = psz;
                v76 = _wcsdup(v75);
                v77 = v76;
                a6 = v76;
                v78 = _wcsdup(&gszNullString);
                v79 = v78;
                a4a = v78;
                v80 = &gszNullString;
                if ( psz )
                  v80 = psz;
                v81 = _wcsdup(v80);
                a3 = v81;
                v135 = sub_F77BE0(v103, a2, &a6, &v141);
                v82 = sub_F77BE0(v105, a2, &a3, &a4a);
                LOBYTE(v150) = 43;
                a6 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v82, v135, &v144);
                free(*v105);
                free(*v103);
                free(v81);
                free(v79);
                free(v77);
                free(v141);
                free(v144);
                free(v145);
                free(a1a);
                free(*szArg);
                free(szArg4);
                free(szArg3);
              }
              v83 = &gszNullString;
              if ( psz )
                v83 = psz;
              v84 = _wcsdup(v83);
              v135 = v84;
              v85 = sub_F77BE0(v99, a2, &v135, &v148);
              LOBYTE(v150) = 45;
              sub_F73FF0(a1, -1, a6, 1, &v143, v85, &v140);
              free(*v99);
              free(v84);
            }
            free(v140);
            free(ppv3);
            free(lpszKeyName);
            free(ppszText2);
            free(v143);
            goto LABEL_66;
          }
          sub_F721F0(&v87);
          free(v145);
          free(v19);
          free(lpszKeyName);
          free(ppszText2);
          free(v24);
          free(v148.unused);
        }
        else
        {
          v51 = PE_CopyString2(&v102, L"CLSID\\", &ppszText2);
          v52 = PE_CopyString(&v112, v51, L"\\InprocServer32");
          v53 = lpszKeyName;
          lpszKeyName = _wcsdup(*v52);
          free(v53);
          free(v112);
          free(v102);
          v54 = PE_CopyString2(&v110, L"HKCR\\CLSID\\", &ppszText2);
          v55 = v8;
          v8 = _wcsdup(*v54);
          v138 = v8;
          free(v55);
          free(v110);
          v56 = lpszKeyName;
          v57 = TlsGetValue(gdwTlsIndex);
          if ( !PE_OpenKey(HKEY_CLASSES_ROOT, v56, 0, v57 | 0x20019, &hKey)
            && !sub_F81520(hKey, &gszNullString, 0, 0, &lpszKeyName) )
          {
            v121 = malloc(2u);
            v122 = 0;
            v123 = 0;
            *v121 = 0;
            v124 = 0;
            LOBYTE(v150) = 25;
            if ( sub_F76CC0(lpszKeyName, &v121) )
            {
              v58 = sub_F74EE0(&v91, a1, &v121, 0);
              ppv3 = _wcsdup(*v58);
              free(v19);
              free(v91);
              v59 = PE_CopyString(&v100, &v148, L" -> ");
              v60 = PE_CopyStringEx(&ppv1, v59, &ppv3);
              v61 = ppszText2;
              ppszText2 = _wcsdup(*v60);
              free(v61);
              free(ppv1);
              free(v100);
              v62 = sub_F74EE0(&v106, a1, &v121, 0);
              v50 = _wcsdup(*v62);
              v140 = v50;
              free(v145);
              free(v106);
              sub_F721F0(&v121);
              RegCloseKey(hKey);
              goto LABEL_45;
            }
            sub_F721F0(&v121);
          }
          free(v145);
          free(v19);
          free(lpszKeyName);
          free(ppszText2);
          free(v144);
          free(v148.unused);
        }
LABEL_67:
        ++dwIndex;
        v148.unused = malloc(2u);
        *v148.unused = 0;
        v141 = malloc(2u);
        v143 = v141;
        *v141 = 0;
        ppszText2 = malloc(2u);
        *ppszText2 = 0;
        lpszKeyName = malloc(2u);
        *lpszKeyName = 0;
        v19 = malloc(2u);
        ppv3 = v19;
        *v19 = 0;
        v20 = malloc(2u);
        v145 = v20;
        v140 = v20;
        *v20 = 0;
        LOBYTE(v150) = 22;
        if ( sub_F81450(KeyHandle, dwIndex, &v148, 0, &Type, &ppszText2) )
          goto LABEL_68;
      }
      free(v20);
      free(v19);
      free(lpszKeyName);
      free(ppszText2);
      free(v141);
      free(v148.unused);
      goto LABEL_67;
    }
LABEL_68:
    free(v20);
    free(v19);
    free(lpszKeyName);
    free(ppszText2);
    free(v141);
    free(v148.unused);
    RegCloseKey(KeyHandle);
  }
  free(v8);
  free(v127);
  free(v125);
  free(v128);
  free(v126);
  return a6;
}

//----- (00F7AA30) --------------------------------------------------------
void __cdecl sub_F7AA30(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, int a5)
{
  wchar_t *v5; // esi
  void *v6; // eax
  const WCHAR **v7; // ecx
  void *v8; // ebx
  wchar_t *v9; // edi
  const wchar_t **v10; // eax
  wchar_t *v11; // esi
  WCHAR *ppv; // [esp+10h] [ebp-18h]
  void *v13; // [esp+14h] [ebp-14h]
  void *v14; // [esp+18h] [ebp-10h]
  int v15; // [esp+24h] [ebp-4h]

  v13 = malloc(2u);
  v14 = v13;
  *v13 = 0;
  v5 = psz;
  v15 = 0;
  v6 = sub_F7AB10(a1, a2, psz, lpValueName, a5, 0xFFFFFFFF);
  v7 = &gszNullString;
  v8 = v6;
  if ( v5 )
    v7 = v5;
  v9 = _wcsdup(v7);
  psz = v9;
  v10 = PE_CopyString(&ppv, &psz, L"\\AutorunsDisabled");
  v11 = _wcsdup(*v10);
  v14 = v11;
  free(v13);
  free(ppv);
  free(v9);
  sub_F7AB10(a1, a2, v11, lpValueName, a5, v8);
  free(v11);
}

//----- (00F7AB10) --------------------------------------------------------
void *__cdecl sub_F7AB10(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, int a5, void *a6)
{
  _WORD *v6; // edi
  const WCHAR *v7; // esi
  tagKeyName *v8; // ebx
  const wchar_t *v9; // eax
  wchar_t *v10; // eax
  wchar_t *v11; // ebx
  const wchar_t *v12; // eax
  wchar_t *v13; // eax
  wchar_t *v14; // edi
  const wchar_t *v15; // eax
  wchar_t *v16; // esi
  unsigned __int16 **v17; // eax
  unsigned int v18; // eax
  LPCWSTR v19; // edx
  WCHAR v20; // cx
  int v21; // edx
  void *v22; // ecx
  const wchar_t ***v23; // edi
  _WORD *v24; // eax
  const wchar_t **v25; // eax
  const wchar_t **v26; // eax
  const WCHAR **v27; // eax
  const WCHAR **v28; // eax
  wchar_t *v29; // eax
  wchar_t *v30; // ebx
  const WCHAR **v31; // eax
  wchar_t *v32; // eax
  wchar_t *v33; // edi
  const wchar_t *v34; // eax
  wchar_t *v35; // esi
  unsigned __int16 **v36; // eax
  const wchar_t *v37; // eax
  wchar_t *v38; // eax
  wchar_t *v39; // ebx
  const wchar_t *v40; // eax
  wchar_t *v41; // eax
  wchar_t *v42; // edi
  const wchar_t *v43; // eax
  wchar_t *v44; // esi
  unsigned __int16 **v45; // eax
  const wchar_t *v46; // eax
  wchar_t *v47; // eax
  wchar_t *v48; // ebx
  const wchar_t *v49; // eax
  wchar_t *v50; // eax
  wchar_t *v51; // edi
  const wchar_t *v52; // eax
  wchar_t *v53; // esi
  unsigned __int16 **v54; // eax
  bool v55; // zf
  int a2a; // [esp+10h] [ebp-94h]
  int v58; // [esp+14h] [ebp-90h]
  int v59; // [esp+18h] [ebp-8Ch]
  int v60; // [esp+1Ch] [ebp-88h]
  int v61; // [esp+20h] [ebp-84h]
  WCHAR v62[2]; // [esp+24h] [ebp-80h]
  WCHAR v63[2]; // [esp+28h] [ebp-7Ch]
  WCHAR v64[2]; // [esp+2Ch] [ebp-78h]
  WCHAR v65[2]; // [esp+30h] [ebp-74h]
  WCHAR v66[2]; // [esp+34h] [ebp-70h]
  void *v67; // [esp+38h] [ebp-6Ch]
  int v68; // [esp+3Ch] [ebp-68h]
  int v69; // [esp+40h] [ebp-64h]
  HKEY hKey; // [esp+44h] [ebp-60h]
  void *v71; // [esp+48h] [ebp-5Ch]
  void *v72; // [esp+4Ch] [ebp-58h]
  void *v73; // [esp+50h] [ebp-54h]
  int a4; // [esp+54h] [ebp-50h]
  int a3; // [esp+58h] [ebp-4Ch]
  void *v76; // [esp+5Ch] [ebp-48h]
  void *a1a; // [esp+60h] [ebp-44h]
  int a7; // [esp+64h] [ebp-40h]
  void *v79; // [esp+68h] [ebp-3Ch]
  void *v80; // [esp+6Ch] [ebp-38h]
  void *v81; // [esp+70h] [ebp-34h]
  WCHAR *ppv3; // [esp+74h] [ebp-30h]
  void *v83; // [esp+78h] [ebp-2Ch]
  LPCWSTR szArg4; // [esp+7Ch] [ebp-28h]
  LPCWSTR v85; // [esp+80h] [ebp-24h]
  LPCWSTR szArg3; // [esp+84h] [ebp-20h]
  WCHAR szArg[2]; // [esp+88h] [ebp-1Ch]
  void *v88; // [esp+8Ch] [ebp-18h]
  LPCWSTR v89; // [esp+90h] [ebp-14h]
  char v90; // [esp+97h] [ebp-Dh]
  int v91; // [esp+A0h] [ebp-4h]

  v83 = malloc(2u);
  a7 = v83;
  *v83 = 0;
  v91 = 0;
  v6 = malloc(2u);
  v81 = v6;
  ppv3 = v6;
  *v6 = 0;
  v72 = malloc(2u);
  *v72 = 0;
  v71 = malloc(2u);
  *v71 = 0;
  v73 = malloc(2u);
  *v73 = 0;
  v7 = lpValueName;
  v8 = psz;
  LOBYTE(v91) = 4;
  if ( a6 == -1 )
  {
    v89 = _wcsdup(&gszNullString);
    szArg3 = _wcsdup(&gszNullString);
    v88 = _wcsdup(&gszNullString);
    v79 = _wcsdup(&gszNullString);
    v80 = _wcsdup(&gszNullString);
    v76 = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v9 = &gszNullString;
    if ( psz )
      v9 = psz;
    v10 = _wcsdup(v9);
    v11 = v10;
    a6 = v10;
    v12 = &gszNullString;
    if ( lpValueName )
      v12 = lpValueName;
    v13 = _wcsdup(v12);
    v14 = v13;
    a4 = v13;
    v15 = &gszNullString;
    if ( psz )
      v15 = psz;
    v16 = _wcsdup(v15);
    a3 = v16;
    v85 = sub_F77BE0(&a1a, a2, &a6, &szArg4);
    v17 = sub_F77BE0(szArg, a2, &a3, &a4);
    LOBYTE(v91) = 16;
    a6 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v17, v85, &v76);
    free(*szArg);
    free(a1a);
    free(v16);
    free(v14);
    free(v11);
    free(szArg4);
    free(v76);
    free(v80);
    free(v79);
    free(v88);
    free(szArg3);
    LOBYTE(v91) = 4;
    free(v89);
    v7 = lpValueName;
    v8 = psz;
    v6 = v81;
  }
  v18 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, v8, 0, v18 | 0x20019, &hKey) )
  {
    szArg4 = malloc(2u);
    *szArg4 = 0;
    LOBYTE(v91) = 17;
    if ( !sub_F81520(hKey, v7, 0, 0, &szArg4) )
    {
      v19 = szArg4;
      a1a = (szArg4 + 1);
      do
      {
        v20 = *v19;
        ++v19;
      }
      while ( v20 );
      if ( (v19 - a1a) >> 1 )
      {
        v67 = 0;
        v68 = 0;
        v69 = 0;
        LOBYTE(v91) = 18;
        sub_F76DD0(szArg4, a5, &v67, 0);
        v21 = v68;
        v22 = v67;
        a4 = (v68 - v67) >> 4;
        if ( a4 )
        {
          v23 = (v67 + 4);
          a3 = v67 + 4;
          while ( 1 )
          {
            ppv3 = _wcsdup(**v23);
            free(v81);
            v24 = malloc(2u);
            a2a = v24;
            v58 = 0;
            v59 = 0;
            *v24 = 0;
            v60 = 0;
            v25 = *v23;
            LOBYTE(v91) = 19;
            sub_F76CC0(*v25, &a2a);
            v26 = sub_F74EE0(&a1a, a1, &a2a, 0);
            a7 = _wcsdup(*v26);
            free(v83);
            free(a1a);
            v27 = &gszNullString;
            if ( v7 )
              v27 = v7;
            v89 = _wcsdup(v27);
            v28 = &gszNullString;
            if ( v8 )
              v28 = v8;
            v29 = _wcsdup(v28);
            v30 = v29;
            *szArg = v29;
            v31 = &gszNullString;
            if ( v7 )
              v31 = v7;
            v32 = _wcsdup(v31);
            v33 = v32;
            v85 = v32;
            v34 = &gszNullString;
            if ( psz )
              v34 = psz;
            v35 = _wcsdup(v34);
            szArg3 = v35;
            v88 = sub_F77BE0(v65, a2, szArg, &v89);
            v36 = sub_F77BE0(v64, a2, &szArg3, &v85);
            LOBYTE(v91) = 25;
            v90 = sub_F73D40(a1, v36, v88, &ppv3, &a7, &v72, &v73, &v61);
            free(*v64);
            free(*v65);
            free(v35);
            free(v33);
            free(v30);
            free(v89);
            if ( v90 )
            {
              if ( a6 == -1 )
              {
                v81 = _wcsdup(&gszNullString);
                v76 = _wcsdup(&gszNullString);
                v80 = _wcsdup(&gszNullString);
                v79 = _wcsdup(&gszNullString);
                v88 = _wcsdup(&gszNullString);
                szArg3 = _wcsdup(&gszNullString);
                v89 = _wcsdup(&gszNullString);
                v37 = &gszNullString;
                if ( psz )
                  v37 = psz;
                v38 = _wcsdup(v37);
                v39 = v38;
                a6 = v38;
                v40 = &gszNullString;
                if ( lpValueName )
                  v40 = lpValueName;
                v41 = _wcsdup(v40);
                v42 = v41;
                *szArg = v41;
                v43 = &gszNullString;
                if ( psz )
                  v43 = psz;
                v44 = _wcsdup(v43);
                v85 = v44;
                v83 = sub_F77BE0(v63, a2, &a6, &v89);
                v45 = sub_F77BE0(v62, a2, &v85, szArg);
                LOBYTE(v91) = 37;
                a6 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v45, v83, &szArg3);
                free(*v62);
                free(*v63);
                free(v44);
                free(v42);
                free(v39);
                free(v89);
                free(szArg3);
                free(v88);
                free(v79);
                free(v80);
                free(v76);
                free(v81);
              }
              v46 = &gszNullString;
              if ( lpValueName )
                v46 = lpValueName;
              v47 = _wcsdup(v46);
              v48 = v47;
              v89 = v47;
              v49 = &gszNullString;
              if ( lpValueName )
                v49 = lpValueName;
              v50 = _wcsdup(v49);
              v51 = v50;
              *szArg = v50;
              v52 = &gszNullString;
              if ( psz )
                v52 = psz;
              v53 = _wcsdup(v52);
              v85 = v53;
              v54 = sub_F77BE0(v66, a2, &v85, szArg);
              LOBYTE(v91) = 41;
              sub_F73FF0(a1, -1, a6, 1, &ppv3, v54, &a7);
              free(*v66);
              free(v53);
              free(v51);
              free(v48);
            }
            LOBYTE(v91) = 18;
            sub_F721F0(&a2a);
            v23 = (a3 + 16);
            v55 = a4-- == 1;
            a3 += 16;
            v83 = a7;
            if ( v55 )
              break;
            v7 = lpValueName;
            v8 = psz;
            v81 = ppv3;
          }
          v6 = ppv3;
          v22 = v67;
          v21 = v68;
        }
        if ( v22 )
        {
          sub_F72BF0(v22, v21);
          j__free(v67);
        }
      }
    }
    RegCloseKey(hKey);
    free(szArg4);
  }
  free(v73);
  free(v71);
  free(v72);
  free(v6);
  free(v83);
  return a6;
}

//----- (00F7B220) --------------------------------------------------------
void __cdecl sub_F7B220(DWORD dwType, DWORD dwFlags)
{
  DWORD v2; // edi
  unsigned __int8 (__stdcall *v3)(); // esi
  DWORD v4; // eax
  DWORD v5; // eax
  wchar_t *v6; // esi
  wchar_t *v7; // esi
  wchar_t *v8; // esi
  wchar_t *v9; // esi
  char v10; // al
  wchar_t *v11; // esi
  wchar_t *v12; // esi
  wchar_t *v13; // esi
  wchar_t *v14; // esi
  DWORD v15; // esi
  OLECHAR *v16; // eax
  OLECHAR *v17; // eax
  OLECHAR *v18; // eax
  OLECHAR *v19; // eax
  void *v20; // esi
  wchar_t *v21; // esi
  wchar_t *v22; // esi
  wchar_t *v23; // esi
  wchar_t *v24; // esi
  wchar_t *v25; // esi
  wchar_t *v26; // esi
  wchar_t *v27; // esi
  wchar_t *v28; // esi
  wchar_t *v29; // esi
  wchar_t *v30; // esi
  wchar_t *v31; // esi
  wchar_t *v32; // esi
  wchar_t *v33; // esi
  wchar_t *v34; // esi
  wchar_t *v35; // esi
  wchar_t *v36; // esi
  wchar_t *v37; // esi
  wchar_t *v38; // esi
  wchar_t *v39; // esi
  wchar_t *v40; // esi
  wchar_t *v41; // esi
  wchar_t *v42; // esi
  wchar_t *v43; // esi
  char v44; // al
  wchar_t *v45; // esi
  wchar_t *v46; // esi
  wchar_t *v47; // esi
  wchar_t *v48; // esi
  wchar_t *v49; // esi
  wchar_t *v50; // esi
  wchar_t *v51; // esi
  wchar_t *v52; // esi
  wchar_t *v53; // esi
  wchar_t *v54; // esi
  wchar_t *v55; // esi
  wchar_t *v56; // esi
  wchar_t *v57; // esi
  wchar_t *v58; // esi
  wchar_t *v59; // esi
  wchar_t *v60; // esi
  wchar_t *v61; // esi
  wchar_t *v62; // esi
  wchar_t *v63; // esi
  wchar_t *v64; // esi
  BYTE Data[4]; // [esp+10h] [ebp-1Ch]
  DWORD cbData; // [esp+14h] [ebp-18h]
  HKEY hKey; // [esp+18h] [ebp-14h]
  DWORD Type; // [esp+1Ch] [ebp-10h]
  int v69; // [esp+28h] [ebp-4h]

  v2 = dwFlags;
  gbFlagsInSub_40B220 = dwFlags;
  SetErrorMode(1u);
  if ( Wow64EnableWow64FsRedirection )
  {
    Wow64EnableWow64FsRedirection(0);
    TlsSetValue(gdwTlsIndex, 0x100);
  }
  v3 = GetVersion;
  if ( dwType & KEY_WOW64_64KEY )
  {
    gdwFlags = KEY_WOW64_64KEY;
    if ( v2 == 2 || v2 == 1 )
      sub_F805A0(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\Session Manager", L"BootExecute");
    if ( v2 == 2 || v2 == 1 )
      sub_F805A0(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\Session Manager", L"SetupExecute");
    if ( v2 == 2 || v2 == 1 )
      sub_F805A0(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\Session Manager", L"Execute");
    if ( v2 == 2 || v2 == 1 )
      sub_F805A0(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\Session Manager", L"S0InitialCommand");
    if ( GetVersion() >= 6u )
    {
      v4 = GetVersion();
      if ( BYTE1(v4) >= 1u && (v2 == 2 || v2 == 1) )
        sub_F7AA30(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control", L"ServiceControlManagerExtension", 32);
    }
  }
  v5 = dwType;
  if ( dwType & 0x40000 )
  {
    gdwFlags = 0x40000;
    sub_F8D790(0);
    v5 = dwType;
  }
  if ( v5 & 0x80000 )
  {
    gdwFlags = 0x80000;
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Outlook\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Outlook\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Outlook\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Outlook\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Excel\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Excel\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Excel\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Excel\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\PowerPoint\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\PowerPoint\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\PowerPoint\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\PowerPoint\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Word\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Word\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Word\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Word\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Access\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Microsoft\\Office\\Access\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Access\\Addins");
      sub_F87FE0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( v2 == 2 || !v2 )
    {
      dwFlags = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Office\\Access\\Addins");
      sub_F87FE0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    LOWORD(v5) = dwType;
  }
  if ( v5 & 0x200 )
  {
    gdwFlags = 512;
    if ( v2 == 2 || v2 == 1 )
      sub_F84E10(0, ghLocalMachineKey, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options");
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F84E10(
        0,
        ghLocalMachineKey,
        L"Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options");
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"Software\\Microsoft\\Command Processor", L"Autorun", 44);
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"Software\\Wow6432Node\\Microsoft\\Command Processor", L"Autorun", 44);
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
      sub_F7AA30(0, ghCurrentUserKey, L"Software\\Microsoft\\Command Processor", L"Autorun", 44);
    if ( v2 == 2 || !v2 )
    {
      v6 = _wcsdup(L"SOFTWARE\\Classes\\Exefile\\Shell\\Open\\Command");
      dwFlags = v6;
      sub_F791C0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(v6);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v7 = _wcsdup(L"SOFTWARE\\Classes\\Exefile\\Shell\\Open\\Command");
      dwFlags = v7;
      sub_F791C0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(v7);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F85E10(0, ghLocalMachineKey, L"Software\\Classes\\.exe");
    if ( v2 == 2 || !v2 )
      sub_F85E10(0, ghCurrentUserKey, L"Software\\Classes\\.exe");
    if ( v2 == 2 || v2 == 1 )
      sub_F85E10(0, ghLocalMachineKey, L"Software\\Classes\\.cmd");
    if ( v2 == 2 || !v2 )
      sub_F85E10(0, ghCurrentUserKey, L"Software\\Classes\\.cmd");
    if ( v2 == 2 || !v2 )
    {
      v8 = _wcsdup(L"SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command");
      dwFlags = v8;
      sub_F791C0(0, ghCurrentUserKey, &dwFlags);
      v69 = -1;
      free(v8);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v9 = _wcsdup(L"SOFTWARE\\Classes\\Htmlfile\\Shell\\Open\\Command");
      dwFlags = v9;
      sub_F791C0(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(v9);
    }
    LOWORD(v5) = dwType;
    v3 = GetVersion;
  }
  cbData = v5 & 0x1000;
  if ( v5 & 0x1000 )
  {
    gdwFlags = 4096;
    if ( v3() < 6u )
    {
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(
          0,
          ghLocalMachineKey,
          L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
          L"ServiceControllerStart",
          32);
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"LsaStart", 32);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SYSTEM\\Setup", L"CmdLine", 44);
  }
  v10 = dwType;
  if ( dwType & 0x20000 )
  {
    gdwFlags = 0x20000;
    if ( v2 == 2 || v2 == 1 )
    {
      sub_F95D10(0);
      v10 = dwType;
    }
  }
  if ( v10 & 0x20 )
  {
    gdwFlags = 32;
    if ( v2 == 2 || v2 == 1 )
    {
      sub_F89580(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Services");
      v10 = dwType;
    }
  }
  if ( v10 & 0x40 )
  {
    gdwFlags = 64;
    if ( v2 == 2 || v2 == 1 )
      sub_F81610(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Services");
    if ( v2 == 2 || v2 == 1 )
    {
      v11 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Font Drivers");
      dwFlags = v11;
      sub_F79AB0(0, ghLocalMachineKey, &dwFlags, 1, 0);
      v69 = -1;
      free(v11);
    }
  }
  if ( cbData )
  {
    gdwFlags = 4096;
    if ( GetVersion() < 6u )
    {
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"GinaDLL", 44);
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"UIHost", 44);
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"System", 44);
      if ( v2 == 2 || v2 == 1 )
      {
        dwFlags = _wcsdup(L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify");
        sub_F92060(0, ghLocalMachineKey, &dwFlags);
        v69 = -1;
        free(dwFlags);
      }
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(
          0,
          ghLocalMachineKey,
          L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon",
          L"SaveDumpStart",
          32);
    }
    else
    {
      if ( v2 == 2 || v2 == 1 )
      {
        v12 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Providers");
        dwFlags = v12;
        sub_F786F0(0, ghLocalMachineKey, &dwFlags);
        v69 = -1;
        free(v12);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v13 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\Credential Provider Filters");
        dwFlags = v13;
        sub_F786F0(0, ghLocalMachineKey, &dwFlags);
        v69 = -1;
        free(v13);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v14 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\PLAP Providers");
        dwFlags = v14;
        sub_F786F0(0, ghLocalMachineKey, &dwFlags);
        v69 = -1;
        free(v14);
      }
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"Taskman", 32);
    if ( v2 == 2 || !v2 )
      sub_F7AA30(
        0,
        ghCurrentUserKey,
        L"SOFTWARE\\Policies\\Microsoft\\Windows\\Control Panel\\Desktop",
        L"Scrnsave.exe",
        44);
    if ( v2 == 2 || !v2 )
      sub_F7AA30(0, ghCurrentUserKey, L"Control Panel\\Desktop", L"Scrnsave.exe", 44);
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\BootVerificationProgram", L"ImagePath", 44);
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GpExtensions");
      sub_F92060(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
  }
  v15 = dwType;
  if ( dwType & 0x4000 )
  {
    gdwFlags = 0x4000;
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"SYSTEM\\CurrentControlSet\\Control\\Print\\Monitors");
      sub_F88A90(0, ghLocalMachineKey, &dwFlags, 1);
      v69 = -1;
      free(dwFlags);
    }
  }
  if ( v15 & 0x8000 )
  {
    gdwFlags = 0x8000;
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(
        0,
        ghLocalMachineKey,
        L"SYSTEM\\CurrentControlSet\\Control\\SecurityProviders",
        L"SecurityProviders",
        44);
    if ( v2 == 2 || v2 == 1 )
      sub_F86E10(0, ghLocalMachineKey, L"SYSTEM\\CurrentControlSet\\Control\\Lsa", L"Authentication Packages");
    if ( v2 == 2 || v2 == 1 )
      sub_F86E10(0, ghLocalMachineKey, L"SYSTEM\\CurrentControlSet\\Control\\Lsa", L"Notification Packages");
    if ( v2 == 2 || v2 == 1 )
      sub_F86E10(0, ghLocalMachineKey, L"SYSTEM\\CurrentControlSet\\Control\\Lsa", L"Security Packages");
    if ( v2 == 2 || v2 == 1 )
      sub_F86E10(0, ghLocalMachineKey, L"SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig", L"Security Packages");
  }
  if ( v15 & 0x10000 )
  {
    gdwFlags = 0x10000;
    if ( v2 == 2 || v2 == 1 )
    {
      dwFlags = _wcsdup(L"SYSTEM\\CurrentControlSet\\Control\\NetworkProvider\\Order");
      sub_F87710(0, ghLocalMachineKey, &dwFlags);
      v69 = -1;
      free(dwFlags);
    }
  }
  if ( v15 & 0x2000 )
  {
    gdwFlags = 0x10000;
    if ( v2 == 2 || v2 == 1 )
    {
      v16 = _wcsdup(L"System\\CurrentControlSet\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries");
      sub_F93190(0, v16);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v17 = _wcsdup(L"System\\CurrentControlSet\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries");
      sub_F927D0(0, v17);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v18 = _wcsdup(L"System\\CurrentControlSet\\Services\\WinSock2\\Parameters\\Protocol_Catalog9\\Catalog_Entries64");
      sub_F93190(0, v18);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v19 = _wcsdup(L"System\\CurrentControlSet\\Services\\WinSock2\\Parameters\\NameSpace_Catalog5\\Catalog_Entries64");
      sub_F927D0(0, v19);
    }
    LOBYTE(v15) = dwType;
  }
  v20 = (v15 & 2);
  dwFlags = v20;
  if ( v20 && IsWinServer(TlsSetValue, v20) )
  {
    gdwFlags = 2;
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(
        0,
        ghLocalMachineKey,
        L"System\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd",
        L"StartupPrograms",
        44);
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"AppSetup", 44);
  }
  if ( v20 )
  {
    gdwFlags = 2;
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Startup");
      v69 = 32;
      sub_F82060(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || !v2 )
    {
      Type = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Logon");
      v69 = 33;
      sub_F82060(0, ghCurrentUserKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Logon");
      v69 = 34;
      sub_F82060(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"Userinit", 44);
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"VmApplet", 0);
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Shutdown");
      v69 = 35;
      sub_F82060(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || !v2 )
    {
      Type = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Logoff");
      v69 = 36;
      sub_F82060(0, ghCurrentUserKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Logoff");
      v69 = 37;
      sub_F82060(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Group Policy\\Scripts\\Startup");
      v69 = 38;
      sub_F82060(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Group Policy\\Scripts\\Shutdown");
      v69 = 39;
      sub_F82060(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
  }
  if ( dwType & 0x400 )
  {
    gdwFlags = 1024;
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows");
      v69 = 40;
      sub_F72CB0(0, ghLocalMachineKey, &Type, L"Appinit_Dlls");
      v69 = -1;
      free(Type);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Windows");
      v69 = 41;
      sub_F72CB0(0, ghLocalMachineKey, &Type, L"Appinit_Dlls");
      v69 = -1;
      free(Type);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v21 = _wcsdup(L"System\\CurrentControlSet\\Control\\Session Manager\\AppCertDlls");
      cbData = v21;
      v69 = 42;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v21);
      v20 = dwFlags;
    }
  }
  if ( v20 )
  {
    gdwFlags = 2;
    if ( (GetVersion() & 0x80000000) != 0 )
    {
      if ( v2 == 2 || v2 == 1 )
      {
        v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServices");
        cbData = v20;
        v69 = 43;
        sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
        v69 = -1;
        free(v20);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce");
        cbData = v20;
        v69 = 44;
        sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
        v69 = -1;
        free(v20);
      }
      if ( v2 == 2 || !v2 )
      {
        v20 = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\RunServices");
        cbData = v20;
        v69 = 45;
        sub_F79AB0(0, ghCurrentUserKey, &cbData, 1, 0);
        v69 = -1;
        free(v20);
      }
      if ( v2 == 2 || !v2 )
      {
        v20 = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\RunServicesOnce");
        cbData = v20;
        v69 = 46;
        sub_F79AB0(0, ghCurrentUserKey, &cbData, 1, 0);
        v69 = -1;
        free(v20);
      }
    }
    if ( v2 == 2 || !v2 )
      sub_F7AA30(0, ghCurrentUserKey, L"Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", L"Shell", 44);
    if ( v2 == 2 || !v2 )
      sub_F7AA30(0, ghCurrentUserKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"Shell", 44);
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", L"Shell", 44);
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"Shell", 44);
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(0, ghLocalMachineKey, L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon", L"Taskman", 32);
    if ( !PE_OpenKey(ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\SafeBoot\\Option", 0, 0x20019u, &hKey) )
    {
      cbData = 4;
      Type = 4;
      if ( !RegQueryValueExW(hKey, L"UseAlternateShell", 0, &Type, Data, &cbData) && (v2 == 2 || v2 == 1) )
        sub_F7AA30(0, ghLocalMachineKey, L"System\\CurrentControlSet\\Control\\SafeBoot", L"AlternateShell", 44);
      RegCloseKey(hKey);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AlternateShells\\AvailableShells");
      cbData = v20;
      v69 = 47;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v20);
    }
    if ( IsWinServer(TlsSetValue, v20) )
    {
      if ( v2 == 2 || v2 == 1 )
      {
        v22 = _wcsdup(
                L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install\\Software\\Microsoft\\Windows\\"
                 "CurrentVersion\\Runonce");
        cbData = v22;
        v69 = 48;
        sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
        v69 = -1;
        free(v22);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v23 = _wcsdup(
                L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install\\Software\\Microsoft\\Windows\\"
                 "CurrentVersion\\RunonceEx");
        cbData = v23;
        v69 = 49;
        sub_F7F2D0(0, ghLocalMachineKey, &cbData, 1, 0);
        v69 = -1;
        free(v23);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v24 = _wcsdup(
                L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install\\Software\\Microsoft\\Windows\\"
                 "CurrentVersion\\Run");
        cbData = v24;
        v69 = 50;
        sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
        v69 = -1;
        free(v24);
      }
      if ( v2 == 2 || v2 == 1 )
        sub_F7AA30(
          0,
          ghLocalMachineKey,
          L"SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp",
          L"InitialProgram",
          44);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v25 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
      cbData = v25;
      v69 = 51;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v25);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v26 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run");
      cbData = v26;
      v69 = 52;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v26);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      v27 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run");
      cbData = v27;
      v69 = 53;
      sub_F79AB0(0, ghCurrentUserKey, &cbData, 1, 0);
      v69 = -1;
      free(v27);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || !v2 )
    {
      v28 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run");
      cbData = v28;
      v69 = 54;
      sub_F79AB0(0, ghCurrentUserKey, &cbData, 1, 0);
      v69 = -1;
      free(v28);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v29 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx");
      cbData = v29;
      v69 = 55;
      sub_F7F2D0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v29);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v30 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx");
      cbData = v30;
      v69 = 56;
      sub_F7F2D0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v30);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      v31 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx");
      cbData = v31;
      v69 = 57;
      sub_F7F2D0(0, ghCurrentUserKey, &cbData, 1, 0);
      v69 = -1;
      free(v31);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || !v2 )
    {
      v32 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnceEx");
      cbData = v32;
      v69 = 58;
      sub_F7F2D0(0, ghCurrentUserKey, &cbData, 1, 0);
      v69 = -1;
      free(v32);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v33 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce");
      cbData = v33;
      v69 = 59;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v33);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v34 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce");
      cbData = v34;
      v69 = 60;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 1, 0);
      v69 = -1;
      free(v34);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      v35 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce");
      cbData = v35;
      v69 = 61;
      sub_F79AB0(0, ghCurrentUserKey, &cbData, 1, 0);
      v69 = -1;
      free(v35);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || !v2 )
    {
      v36 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\RunOnce");
      cbData = v36;
      v69 = 62;
      sub_F79AB0(0, ghCurrentUserKey, &cbData, 1, 0);
      v69 = -1;
      free(v36);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    v20 = dwFlags;
  }
  cbData = dwType & 4;
  if ( dwType & 4 )
  {
    gdwFlags = 4;
    if ( v2 == 2 || !v2 )
    {
      Type = _wcsdup(L"SOFTWARE\\Classes\\Protocols\\Filter");
      v69 = 63;
      sub_F830B0(0, ghCurrentUserKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"SOFTWARE\\Classes\\Protocols\\Filter");
      v69 = 64;
      sub_F830B0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || !v2 )
    {
      Type = _wcsdup(L"SOFTWARE\\Classes\\Protocols\\Handler");
      v69 = 65;
      sub_F830B0(0, ghCurrentUserKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"SOFTWARE\\Classes\\Protocols\\Handler");
      v69 = 66;
      sub_F830B0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( v2 == 2 || !v2 )
    {
      Type = _wcsdup(L"SOFTWARE\\Microsoft\\Internet Explorer\\Desktop\\Components");
      v69 = 67;
      sub_F839D0(0, ghCurrentUserKey, &Type);
      v69 = -1;
      free(Type);
    }
  }
  if ( v20 )
  {
    gdwFlags = 2;
    if ( v2 == 2 || !v2 )
      sub_F8EFA0(
        0,
        ghCurrentUserKey,
        L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
        L"AltStartup");
    if ( v2 == 2 || v2 == 1 )
      sub_F8EFA0(
        0,
        ghLocalMachineKey,
        L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
        L"Common AltStartup");
    if ( v2 == 2 || v2 == 1 )
      sub_F8EFA0(
        0,
        ghLocalMachineKey,
        L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
        L"Common Startup");
    if ( v2 == 2 || !v2 )
      sub_F8EFA0(
        0,
        ghCurrentUserKey,
        L"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders",
        L"Startup");
    if ( v2 == 2 || !v2 )
      sub_F7AA30(0, ghCurrentUserKey, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", L"Load", 32);
    if ( v2 == 2 || !v2 )
      sub_F7AA30(0, ghCurrentUserKey, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows", L"Run", 32);
    if ( (GetVersion() & 0x80000000) != 0 )
      sub_F91840(0);
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run");
      Type = v20;
      v69 = 68;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 1, 0);
      v69 = -1;
      free(v20);
    }
    if ( v2 == 2 || !v2 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run");
      Type = v20;
      v69 = 69;
      sub_F79AB0(0, ghCurrentUserKey, &Type, 1, 0);
      v69 = -1;
      free(v20);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"SOFTWARE\\Microsoft\\Active Setup\\Installed Components");
      v69 = 70;
      sub_F723D0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      Type = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Active Setup\\Installed Components");
      v69 = 71;
      sub_F723D0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(Type);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
      sub_F7AA30(
        0,
        ghLocalMachineKey,
        L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows",
        L"IconServiceLib",
        44);
  }
  if ( cbData )
  {
    gdwFlags = 4;
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SharedTaskScheduler");
      Type = v20;
      v69 = 72;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 0, 1);
      v69 = -1;
      free(v20);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\SharedTaskScheduler");
      Type = v20;
      v69 = 73;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 0, 1);
      v69 = -1;
      free(v20);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellServiceObjects");
      Type = v20;
      v69 = 74;
      sub_F786F0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(v20);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellServiceObjects");
      Type = v20;
      v69 = 75;
      sub_F786F0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(v20);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellServiceObjects");
      Type = v20;
      v69 = 76;
      sub_F786F0(0, ghCurrentUserKey, &Type);
      v69 = -1;
      free(v20);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad");
      Type = v20;
      v69 = 77;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 0, 0);
      v69 = -1;
      free(v20);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad");
      Type = v20;
      v69 = 78;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 0, 0);
      v69 = -1;
      free(v20);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      v20 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad");
      Type = v20;
      v69 = 79;
      sub_F79AB0(0, ghCurrentUserKey, &Type, 0, 0);
      v69 = -1;
      free(v20);
    }
  }
  if ( dwFlags )
  {
    gdwFlags = 2;
    if ( v2 == 2 || !v2 )
    {
      v20 = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run");
      Type = v20;
      v69 = 80;
      sub_F79AB0(0, ghCurrentUserKey, &Type, 1, 0);
      v69 = -1;
      free(v20);
    }
    if ( IsWinServer(TlsSetValue, v20) )
    {
      if ( v2 == 2 || !v2 )
      {
        v37 = _wcsdup(
                L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install\\Software\\Microsoft\\Windows\\"
                 "CurrentVersion\\Runonce");
        Type = v37;
        v69 = 81;
        sub_F79AB0(0, ghCurrentUserKey, &Type, 1, 0);
        v69 = -1;
        free(v37);
      }
      if ( v2 == 2 || !v2 )
      {
        v38 = _wcsdup(
                L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install\\Software\\Microsoft\\Windows\\"
                 "CurrentVersion\\RunonceEx");
        Type = v38;
        v69 = 82;
        sub_F7F2D0(0, ghCurrentUserKey, &Type, 1, 0);
        v69 = -1;
        free(v38);
      }
      if ( v2 == 2 || !v2 )
      {
        v39 = _wcsdup(
                L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Terminal Server\\Install\\Software\\Microsoft\\Windows\\"
                 "CurrentVersion\\Run");
        Type = v39;
        v69 = 83;
        sub_F79AB0(0, ghCurrentUserKey, &Type, 1, 0);
        v69 = -1;
        free(v39);
      }
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v40 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnConnect");
      Type = v40;
      v69 = 84;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 1, 0);
      v69 = -1;
      free(v40);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v41 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows CE Services\\AutoStartOnConnect");
      Type = v41;
      v69 = 85;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 1, 0);
      v69 = -1;
      free(v41);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v42 = _wcsdup(L"SOFTWARE\\Microsoft\\Windows CE Services\\AutoStartOnDisconnect");
      Type = v42;
      v69 = 86;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 1, 0);
      v69 = -1;
      free(v42);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v43 = _wcsdup(L"SOFTWARE\\Wow6432Node\\Microsoft\\Windows CE Services\\AutoStartOnDisconnect");
      Type = v43;
      v69 = 87;
      sub_F79AB0(0, ghLocalMachineKey, &Type, 1, 0);
      v69 = -1;
      free(v43);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
  }
  v44 = dwType;
  if ( dwType & 0x10 )
  {
    gdwFlags = 16;
    if ( v2 == 2 || v2 == 1 )
    {
      sub_F90760(0);
      v44 = dwType;
    }
  }
  *Data = v44 & 8;
  if ( v44 & 8 )
  {
    gdwFlags = 8;
    if ( v2 == 2 || v2 == 1 )
    {
      v45 = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects");
      Type = v45;
      v69 = 88;
      sub_F786F0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(v45);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v46 = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects");
      Type = v46;
      v69 = 89;
      sub_F786F0(0, ghLocalMachineKey, &Type);
      v69 = -1;
      free(v46);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
  }
  if ( cbData )
  {
    gdwFlags = 4;
    if ( v2 == 2 || v2 == 1 )
    {
      v47 = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellExecuteHooks");
      cbData = v47;
      v69 = 90;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 0, 1);
      v69 = -1;
      free(v47);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v48 = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellExecuteHooks");
      cbData = v48;
      v69 = 91;
      sub_F79AB0(0, ghLocalMachineKey, &cbData, 0, 1);
      v69 = -1;
      free(v48);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\*\\ShellEx\\ContextMenuHandlers");
      v69 = 92;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\*\\ShellEx\\ContextMenuHandlers");
      v69 = 93;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\*\\ShellEx\\ContextMenuHandlers");
      v69 = 94;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Drive\\ShellEx\\ContextMenuHandlers");
      v69 = 95;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Drive\\ShellEx\\ContextMenuHandlers");
      v69 = 96;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Drive\\ShellEx\\ContextMenuHandlers");
      v69 = 97;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\*\\ShellEx\\PropertySheetHandlers");
      v69 = 98;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\*\\ShellEx\\PropertySheetHandlers");
      v69 = 99;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\*\\ShellEx\\PropertySheetHandlers");
      v69 = 100;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\AllFileSystemObjects\\ShellEx\\ContextMenuHandlers");
      v69 = 101;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\AllFileSystemObjects\\ShellEx\\ContextMenuHandlers");
      v69 = 102;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\AllFileSystemObjects\\ShellEx\\ContextMenuHandlers");
      v69 = 103;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers");
      v69 = 104;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers");
      v69 = 105;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\AllFileSystemObjects\\ShellEx\\DragDropHandlers");
      v69 = 106;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\AllFileSystemObjects\\ShellEx\\PropertySheetHandlers");
      v69 = 107;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\AllFileSystemObjects\\ShellEx\\PropertySheetHandlers");
      v69 = 108;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\AllFileSystemObjects\\ShellEx\\PropertySheetHandlers");
      v69 = 109;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\ShellEx\\ContextMenuHandlers");
      v69 = 110;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\ShellEx\\ContextMenuHandlers");
      v69 = 111;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Directory\\ShellEx\\ContextMenuHandlers");
      v69 = 112;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Shellex\\DragDropHandlers");
      v69 = 113;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Shellex\\DragDropHandlers");
      v69 = 114;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Directory\\Shellex\\DragDropHandlers");
      v69 = 115;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Shellex\\PropertySheetHandlers");
      v69 = 116;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Shellex\\PropertySheetHandlers");
      v69 = 117;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Directory\\Shellex\\PropertySheetHandlers");
      v69 = 118;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Shellex\\CopyHookHandlers");
      v69 = 119;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Shellex\\CopyHookHandlers");
      v69 = 120;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Directory\\Shellex\\CopyHookHandlers");
      v69 = 121;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Background\\ShellEx\\ContextMenuHandlers");
      v69 = 122;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Directory\\Background\\ShellEx\\ContextMenuHandlers");
      v69 = 123;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Directory\\Background\\ShellEx\\ContextMenuHandlers");
      v69 = 124;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      v49 = _wcsdup(L"Software\\Classes\\Folder\\Shellex\\ColumnHandlers");
      cbData = v49;
      v69 = 125;
      sub_F786F0(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(v49);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v50 = _wcsdup(L"Software\\Classes\\Folder\\Shellex\\ColumnHandlers");
      cbData = v50;
      v69 = 126;
      sub_F786F0(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(v50);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v51 = _wcsdup(L"Software\\Wow6432Node\\Classes\\Folder\\Shellex\\ColumnHandlers");
      cbData = v51;
      v69 = 127;
      sub_F786F0(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(v51);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\ContextMenuHandlers");
      v69 = 128;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\ContextMenuHandlers");
      v69 = 129;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Folder\\ShellEx\\ContextMenuHandlers");
      v69 = 130;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\DragDropHandlers");
      v69 = 131;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\DragDropHandlers");
      v69 = 132;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Folder\\ShellEx\\DragDropHandlers");
      v69 = 133;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\ExtShellFolderViews");
      v69 = 134;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\ExtShellFolderViews");
      v69 = 135;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Folder\\ShellEx\\ExtShellFolderViews");
      v69 = 136;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\PropertySheetHandlers");
      v69 = 137;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Classes\\Folder\\ShellEx\\PropertySheetHandlers");
      v69 = 138;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Classes\\Folder\\ShellEx\\PropertySheetHandlers");
      v69 = 139;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers");
      v69 = 140;
      sub_F8A070(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers");
      v69 = 141;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ShellIconOverlayIdentifiers");
      v69 = 142;
      sub_F8A070(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
      sub_F7AA30(
        0,
        ghCurrentUserKey,
        L"Software\\Classes\\Clsid\\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}",
        L"Inprocserver32",
        32);
    if ( v2 == 2 || !v2 )
    {
      v52 = _wcsdup(L"Software\\Microsoft\\Ctf\\LangBarAddin");
      cbData = v52;
      v69 = 143;
      sub_F786F0(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(v52);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v53 = _wcsdup(L"Software\\Microsoft\\Ctf\\LangBarAddin");
      cbData = v53;
      v69 = 144;
      sub_F786F0(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(v53);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v54 = _wcsdup(L"Software\\Microsoft\\Ctf\\LangBarAddin");
      cbData = v54;
      v69 = 145;
      sub_F786F0(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(v54);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
  }
  if ( *Data )
  {
    gdwFlags = 8;
    if ( v2 == 2 || !v2 )
    {
      v55 = _wcsdup(L"Software\\Microsoft\\Internet Explorer\\UrlSearchHooks");
      *Data = v55;
      v69 = 146;
      sub_F79AB0(0, ghCurrentUserKey, Data, 0, 1);
      v69 = -1;
      free(v55);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v56 = _wcsdup(L"Software\\Microsoft\\Internet Explorer\\Toolbar");
      *Data = v56;
      v69 = 147;
      sub_F79AB0(0, ghLocalMachineKey, Data, 0, 1);
      v69 = -1;
      free(v56);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      v57 = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Internet Explorer\\Toolbar");
      *Data = v57;
      v69 = 148;
      sub_F79AB0(0, ghLocalMachineKey, Data, 0, 1);
      v69 = -1;
      free(v57);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Microsoft\\Internet Explorer\\Explorer Bars");
      v69 = 149;
      sub_F84150(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Microsoft\\Internet Explorer\\Explorer Bars");
      v69 = 150;
      sub_F84150(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Internet Explorer\\Explorer Bars");
      v69 = 151;
      sub_F84150(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Internet Explorer\\Explorer Bars");
      v69 = 152;
      sub_F84150(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Microsoft\\Internet Explorer\\Extensions");
      v69 = 153;
      sub_F84150(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Microsoft\\Internet Explorer\\Extensions");
      v69 = 154;
      sub_F84150(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(1u);
      TlsSetValue(gdwTlsIndex, 0x200);
    }
    if ( v2 == 2 || !v2 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Internet Explorer\\Extensions");
      v69 = 155;
      sub_F84150(0, ghCurrentUserKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      cbData = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Internet Explorer\\Extensions");
      v69 = 156;
      sub_F84150(0, ghLocalMachineKey, &cbData);
      v69 = -1;
      free(cbData);
    }
    if ( Wow64EnableWow64FsRedirection )
    {
      Wow64EnableWow64FsRedirection(0);
      TlsSetValue(gdwTlsIndex, 0x100);
    }
  }
  if ( (dwType & 0x80u) != 0 )
  {
    gdwFlags = 128;
    if ( PE_OpenKey(ghLocalMachineKey, L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32", 0, 0x20019u, Data) )
    {
      if ( dword_1063628[0] && (v2 == 2 || v2 == 1) )
        wprintf(L"\nNo entry to display for codecs. Codecs are not supported on Nano Server.\n");
    }
    else
    {
      if ( v2 == 2 || !v2 )
      {
        v58 = _wcsdup(L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32");
        dwType = v58;
        v69 = 157;
        sub_F79AB0(0, ghCurrentUserKey, &dwType, 1, 0);
        v69 = -1;
        free(v58);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v59 = _wcsdup(L"Software\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32");
        dwType = v59;
        v69 = 158;
        sub_F79AB0(0, ghLocalMachineKey, &dwType, 1, 0);
        v69 = -1;
        free(v59);
      }
      if ( Wow64EnableWow64FsRedirection )
      {
        Wow64EnableWow64FsRedirection(1u);
        TlsSetValue(gdwTlsIndex, 0x200);
      }
      if ( v2 == 2 || !v2 )
      {
        v60 = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32");
        dwType = v60;
        v69 = 159;
        sub_F79AB0(0, ghCurrentUserKey, &dwType, 1, 0);
        v69 = -1;
        free(v60);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v61 = _wcsdup(L"Software\\Wow6432Node\\Microsoft\\Windows NT\\CurrentVersion\\Drivers32");
        dwType = v61;
        v69 = 160;
        sub_F79AB0(0, ghLocalMachineKey, &dwType, 1, 0);
        v69 = -1;
        free(v61);
      }
      if ( Wow64EnableWow64FsRedirection )
      {
        Wow64EnableWow64FsRedirection(0);
        TlsSetValue(gdwTlsIndex, 0x100);
      }
      if ( v2 == 2 || !v2 )
      {
        v62 = _wcsdup(L"Software\\Classes\\Filter");
        dwType = v62;
        v69 = 161;
        sub_F786F0(0, ghCurrentUserKey, &dwType);
        v69 = -1;
        free(v62);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v63 = _wcsdup(L"Software\\Classes\\Filter");
        dwType = v63;
        v69 = 162;
        sub_F786F0(0, ghLocalMachineKey, &dwType);
        v69 = -1;
        free(v63);
      }
      if ( Wow64EnableWow64FsRedirection )
      {
        Wow64EnableWow64FsRedirection(1u);
        TlsSetValue(gdwTlsIndex, 0x200);
      }
      if ( v2 == 2 || v2 == 1 )
      {
        v64 = _wcsdup(L"Software\\Classes\\Filter");
        dwType = v64;
        v69 = 163;
        sub_F786F0(0, ghLocalMachineKey, &dwType);
        v69 = -1;
        free(v64);
      }
      if ( Wow64EnableWow64FsRedirection )
      {
        Wow64EnableWow64FsRedirection(0);
        TlsSetValue(gdwTlsIndex, 0x100);
      }
      if ( v2 == 2 || !v2 )
        sub_F79030(1, 0, ghCurrentUserKey, L"{083863F1-70DE-11d0-BD40-00A0C911CE86}");
      if ( v2 == 2 || !v2 )
        sub_F79030(1, 0, ghCurrentUserKey, L"{AC757296-3522-4E11-9862-C17BE5A1767E}");
      if ( v2 == 2 || !v2 )
        sub_F79030(1, 0, ghCurrentUserKey, L"{7ED96837-96F0-4812-B211-F13C24117ED3}");
      if ( v2 == 2 || !v2 )
        sub_F79030(1, 0, ghCurrentUserKey, L"{ABE3B9A4-257D-4B97-BD1A-294AF496222E}");
      if ( v2 == 2 || v2 == 1 )
        sub_F79030(1, 0, ghLocalMachineKey, L"{083863F1-70DE-11d0-BD40-00A0C911CE86}");
      if ( v2 == 2 || v2 == 1 )
        sub_F79030(1, 0, ghLocalMachineKey, L"{AC757296-3522-4E11-9862-C17BE5A1767E}");
      if ( v2 == 2 || v2 == 1 )
        sub_F79030(1, 0, ghLocalMachineKey, L"{7ED96837-96F0-4812-B211-F13C24117ED3}");
      if ( v2 == 2 || v2 == 1 )
        sub_F79030(1, 0, ghLocalMachineKey, L"{ABE3B9A4-257D-4B97-BD1A-294AF496222E}");
    }
  }
  if ( dwFlags )
  {
    gdwFlags = 2;
    if ( v2 == 2 || !v2 )
    {
      dwType = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Logoff");
      v69 = 164;
      sub_F82060(0, ghCurrentUserKey, &dwType);
      v69 = -1;
      free(dwType);
    }
    if ( v2 == 2 || v2 == 1 )
    {
      dwType = _wcsdup(L"Software\\Policies\\Microsoft\\Windows\\System\\Scripts\\Shutdown");
      v69 = 165;
      sub_F82060(0, ghLocalMachineKey, &dwType);
      free(dwType);
    }
  }
}
// 10631C0: using guessed type int gbFlagsInSub_40B220;
// 1063628: using guessed type int dword_1063628[140];
// 10648D8: using guessed type int gdwFlags;

//----- (00F7F2D0) --------------------------------------------------------
void __cdecl sub_F7F2D0(int a1, void *a2, int a3, char a4, char a5)
{
  WCHAR *v5; // edi
  tagKeyName *v6; // esi
  unsigned int v7; // eax
  _WORD *v8; // esi
  _WORD *v9; // ebx
  LPCWSTR *v10; // eax
  unsigned __int16 **v11; // eax
  wchar_t *v12; // edi
  void *v13; // ebx
  const wchar_t **v14; // eax
  wchar_t *v15; // esi
  void *v16; // edi
  LSTATUS v17; // eax
  WCHAR *v18; // ebx
  wchar_t *v19; // edi
  WCHAR *v20; // esi
  unsigned __int16 **v21; // eax
  _WORD *v22; // [esp+10h] [ebp-40h]
  void *a1a; // [esp+14h] [ebp-3Ch]
  WCHAR szArg[2]; // [esp+18h] [ebp-38h]
  int a6; // [esp+1Ch] [ebp-34h]
  LPCWSTR szArg4; // [esp+20h] [ebp-30h]
  WCHAR *ppv; // [esp+24h] [ebp-2Ch]
  WCHAR *ppv1; // [esp+28h] [ebp-28h]
  void *v29; // [esp+2Ch] [ebp-24h]
  void *v30; // [esp+30h] [ebp-20h]
  void *v31; // [esp+34h] [ebp-1Ch]
  HKEY hKey; // [esp+38h] [ebp-18h]
  HKEY__ v33; // [esp+3Ch] [ebp-14h]
  WCHAR *ppv3; // [esp+40h] [ebp-10h]
  int v35; // [esp+4Ch] [ebp-4h]

  v22 = malloc(2u);
  *v22 = 0;
  v5 = a3;
  v35 = 0;
  v6 = *a3;
  v7 = TlsGetValue(gdwTlsIndex);
  if ( PE_OpenKey(a2, v6, 0, v7 | 0x20019, &hKey) )
  {
    ppv3 = _wcsdup(&gszNullString);
    v33.unused = _wcsdup(&gszNullString);
    v31 = _wcsdup(&gszNullString);
    v30 = _wcsdup(&gszNullString);
    v29 = _wcsdup(&gszNullString);
    v18 = _wcsdup(&gszNullString);
    ppv1 = v18;
    v19 = _wcsdup(&gszNullString);
    szArg4 = v19;
    v20 = _wcsdup(&gszNullString);
    ppv = v20;
    a6 = sub_F77BE0(&a1a, a2, a3, &szArg4);
    v21 = sub_F77BE0(szArg, a2, a3, &ppv);
    LOBYTE(v35) = 13;
    sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v21, a6, &ppv1);
    free(*szArg);
    free(a1a);
    free(v20);
    free(v19);
    free(v18);
    free(v29);
    free(v30);
    free(v31);
    free(v33.unused);
    free(ppv3);
  }
  else
  {
    v31 = 0;
    v8 = malloc(2u);
    v33.unused = v8;
    *v8 = 0;
    v9 = malloc(2u);
    v30 = v9;
    v29 = v9;
    *v9 = 0;
    ppv3 = malloc(2u);
    *ppv3 = 0;
    LOBYTE(v35) = 3;
    if ( !PE_LoadKey(hKey, 0, &ppv3) )
    {
      do
      {
        v10 = PE_CopyString(&ppv, v5, L"\\");
        v11 = PE_CopyStringEx(&ppv1, v10, &ppv3);
        v12 = _wcsdup(*v11);
        v33.unused = v12;
        free(v8);
        free(ppv1);
        free(ppv);
        v13 = sub_F79B70(a1, a2, v12, a4, a5, 0xFFFFFFFF, 1, 0);
        v14 = PE_CopyString(&szArg4, &v33, L"\\AutorunsDisabled");
        v15 = _wcsdup(*v14);
        v29 = v15;
        free(v30);
        free(szArg4);
        sub_F79B70(a1, a2, v15, a4, a5, v13, 0, 0);
        free(ppv3);
        free(v15);
        free(v12);
        v31 = v31 + 1;
        v16 = v31;
        v8 = malloc(2u);
        v33.unused = v8;
        *v8 = 0;
        v9 = malloc(2u);
        v30 = v9;
        v29 = v9;
        *v9 = 0;
        ppv3 = malloc(2u);
        *ppv3 = 0;
        LOBYTE(v35) = 3;
        v17 = PE_LoadKey(hKey, v16, &ppv3);
        v5 = a3;
      }
      while ( !v17 );
    }
    free(ppv3);
    free(v9);
    free(v8);
    RegCloseKey(hKey);
  }
  free(v22);
}

//----- (00F7F610) --------------------------------------------------------
char __cdecl sub_F7F610(HWND hWnd, tagAccountInfo *pInfo, DWORD dwMenuId)
{
  WCHAR *v3; // edi
  WCHAR *lpszFile; // ebx
  _WORD *v5; // eax
  int index; // ecx
  tagAccountInfo **v7; // esi
  unsigned int nCount; // edx
  tagAccountInfo *v9; // eax
  tagAccountInfo *pInfoTemp; // esi
  bool bNotSystemUser; // zf
  int v12; // eax
  const WCHAR **v13; // ecx
  wchar_t *v14; // esi
  const wchar_t **v15; // eax
  const wchar_t **v16; // eax
  WCHAR *v17; // esi
  tagKeyName *v18; // esi
  int v19; // eax
  wchar_t *v20; // esi
  const wchar_t **v21; // eax
  WCHAR *v22; // ST48_4
  FILE *v23; // eax
  UINT v24; // ST2C_4
  HMENU v25; // eax
  UINT v26; // ST2C_4
  HMENU v27; // eax
  void *v29; // [esp+10h] [ebp-30h]
  const WCHAR *lpszKeyName; // [esp+14h] [ebp-2Ch]
  HKEY__ v31; // [esp+18h] [ebp-28h]
  WCHAR *ppstr; // [esp+1Ch] [ebp-24h]
  DWORD dwMessageId; // [esp+20h] [ebp-20h]
  HKEY__ hKey; // [esp+24h] [ebp-1Ch]
  HKEY KeyHandle; // [esp+28h] [ebp-18h]
  tagAccountInfo *pInfoTemp_1; // [esp+2Ch] [ebp-14h]
  char ret; // [esp+33h] [ebp-Dh]
  int v38; // [esp+3Ch] [ebp-4h]

  v3 = malloc(2u);
  hKey.unused = v3;
  *v3 = 0;
  v38 = 0;
  lpszFile = malloc(2u);
  v31.unused = lpszFile;
  *lpszFile = 0;
  ret = 0;
  v5 = malloc(2u);
  index = 0;
  v29 = v5;
  *v5 = 0;
  v7 = garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst;
  nCount = (garrAccountInfo.baseclass_0._Mypair._Myval2._Mylast - garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst) >> 2;
  LOBYTE(v38) = 2;
  if ( nCount )
  {
    while ( 1 )
    {
      v9 = v7[index];
      v7 = garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst;
      if ( v9->nMenuID == dwMenuId )
        break;
      if ( ++index >= nCount )
        goto LABEL_4;
    }
    pInfoTemp = *(garrAccountInfo.baseclass_0._Mypair._Myval2._Myfirst + index);
  }
  else
  {
LABEL_4:
    pInfoTemp = KeyHandle;
  }
  bNotSystemUser = LOBYTE(pInfoTemp->bIsSystemUser) == 0;
  pInfoTemp_1 = pInfoTemp;
  if ( !bNotSystemUser )
  {
    KeyHandle = HKEY_CURRENT_USER;
LABEL_20:
    ret = 1;
    if ( hWnd )
    {
      v24 = pInfo->nMenuID;
      v25 = GetMenu(hWnd);
      CheckMenuItem(v25, v24, 0);
      v26 = pInfoTemp_1->nMenuID;
      v27 = GetMenu(hWnd);
      CheckMenuItem(v27, v26, MF_CHECKED);
    }
    if ( pInfo && !LOBYTE(pInfo->bIsSystemUser) )
    {
      RegCloseKey(ghCurrentUserKey);
      RegUnLoadKeyW(HKEY_USERS, pInfo->szUserName);
    }
    gpAccountInfo = pInfoTemp_1;
    ghCurrentUserKey = KeyHandle;
    goto LABEL_26;
  }
  lpszKeyName = pInfoTemp->szReferenceName;
  v12 = wcscmp(pInfoTemp->szReferenceName, L"NT AUTHORITY\\SYSTEM");
  if ( v12 )
    v12 = -(v12 < 0) | 1;
  if ( v12 )
  {
    v13 = &gszNullString;
    if ( pInfoTemp != -1048 )
      v13 = pInfoTemp->szProfileImgPath;
    v14 = _wcsdup(v13);
    hKey.unused = v14;
    v15 = PE_CopyString(&ppstr, &hKey, L"\\ntuser.dat");
    dwMessageId = v3;
    v3 = _wcsdup(*v15);
    hKey.unused = v3;
    free(dwMessageId);
    free(ppstr);
    free(v14);
    v16 = RequerySystemEnvironmentString(&ppstr, v3);
    v17 = lpszFile;
    lpszFile = _wcsdup(*v16);
    v31.unused = lpszFile;
    free(v17);
    free(ppstr);
    v18 = pInfoTemp_1->szUserName;
    dwMessageId = RegLoadKeyW(HKEY_USERS, pInfoTemp_1->szUserName, lpszFile);
    if ( dwMessageId )
    {
      v20 = _wcsdup(L"Error loading profile for ");
      v31.unused = v20;
      v21 = PE_CopyString(&ppstr, &v31, lpszKeyName);
      v22 = v3;
      v3 = _wcsdup(*v21);
      free(v22);
      free(ppstr);
      free(v20);
      v23 = sub_1007B15();
      fputws(v3, v23 + 2);
      sub_F77AE0(dwMessageId);
      goto LABEL_26;
    }
    v19 = PE_OpenKey(HKEY_USERS, v18, 0, 0x2001Fu, &KeyHandle);
  }
  else
  {
    v19 = PE_OpenKey(HKEY_USERS, pInfoTemp->szUserName, 0, 0x2001Fu, &KeyHandle);
  }
  if ( !v19 )
    goto LABEL_20;
LABEL_26:
  free(v29);
  free(lpszFile);
  free(v3);
  return ret;
}
// 102D238: using guessed type wchar_t aNtAuthoritySys[20];

//----- (00F7F8D0) --------------------------------------------------------
int __cdecl sub_F7F8D0(int a1, wchar_t *a2)
{
  const wchar_t *v2; // ecx
  wchar_t *v3; // eax
  wchar_t *v4; // ecx
  wchar_t *v5; // edx
  wchar_t i; // ax

  v2 = &gszNullString;
  if ( a2 )
    v2 = a2;
  v3 = _wcsdup(v2);
  v4 = v3;
  v5 = v3;
  *a1 = v3;
  for ( i = *v3; i; ++v4 )
  {
    if ( i != '"' )
    {
      *v5 = i;
      ++v5;
    }
    i = v4[1];
  }
  *v5 = 0;
  return a1;
}

//----- (00F7F930) --------------------------------------------------------
char __thiscall sub_F7F930(_DWORD *this, unsigned int a2)
{
  _DWORD *v2; // esi
  char *v4; // eax

  v2 = this;
  *this = 0;
  this[1] = 0;
  this[2] = 0;
  if ( !a2 )
    return 0;
  if ( a2 > 0x3FFFFFFF )
    std::_Xlength_error("vector<T> too long");
  v4 = operator new(4 * a2);
  if ( !v4 )
    std::_Xbad_alloc();
  *v2 = v4;
  v2[1] = v4;
  v2[2] = &v4[4 * a2];
  return 1;
}

//----- (00F7F9A0) --------------------------------------------------------
_DWORD *std::_Tree_comp_alloc<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::_Buyheadnode()
{
  _DWORD *result; // eax

  result = operator new(0x20u);
  JUMPOUT(result, 0, std::_Xbad_alloc);
  *result = result;
  if ( result != -4 )
    result[1] = result;
  if ( result != -8 )
    result[2] = result;
  *(result + 6) = 257;
  return result;
}

//----- (00F7F9D0) --------------------------------------------------------
int __thiscall sub_F7F9D0(int *this, unsigned int a2, int a3)
{
  int *v3; // esi
  unsigned int v4; // edi
  unsigned int v5; // ebx
  unsigned int v6; // ecx
  unsigned int v7; // eax
  void *v8; // ecx
  int *v9; // edx
  int v10; // eax
  int result; // eax
  int v12; // [esp+0h] [ebp-28h]
  int *v13; // [esp+10h] [ebp-18h]
  int v14; // [esp+14h] [ebp-14h]
  int *v15; // [esp+18h] [ebp-10h]
  int v16; // [esp+24h] [ebp-4h]

  v15 = &v12;
  v3 = this;
  v13 = this;
  v4 = a2 | 7;
  if ( (a2 | 7) <= 0x7FFFFFFE )
  {
    v5 = this[5];
    v6 = this[5] >> 1;
    if ( v6 > v4 / 3 )
    {
      v4 = v6 + v5;
      if ( v5 > 2147483646 - v6 )
        v4 = 2147483646;
    }
  }
  else
  {
    v4 = a2;
  }
  v7 = v4 + 1;
  v16 = 0;
  v8 = 0;
  v14 = 0;
  if ( v4 != -1 )
  {
    if ( v7 > 0x7FFFFFFF || (v8 = operator new(2 * v7), (v14 = v8) == 0) )
      std::_Xbad_alloc();
  }
  if ( a3 )
  {
    v9 = v3[5] < 8 ? v3 : *v3;
    if ( a3 )
      memmove_0(v8, v9, 2 * a3);
  }
  if ( v3[5] >= 8 )
    j__free(*v3);
  v10 = v14;
  *v3 = v14;
  v3[5] = v4;
  v3[4] = a3;
  if ( v4 >= 8 )
    v3 = v10;
  result = 0;
  *(v3 + a3) = 0;
  return result;
}
// 10081AA: using guessed type void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD);

//----- (00F7FB40) --------------------------------------------------------
void __stdcall std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::clear(std__Tree_node *a1)
{
  std__Tree_node_For__bstr_t *v1; // edi
  std__Tree_node_For__bstr_t *v2; // ebx
  Data_t_bstr_t *v3; // esi
  Data_t_bstr_t *v4; // esi

  v1 = a1;
  v2 = a1;
  if ( !a1->_IsNil )
  {
    do
    {
      std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::clear(v2->_Right);
      v3 = v1->_bstrText2.m_Data;
      v2 = v2->_Left;
      if ( v3 )
      {
        if ( !InterlockedDecrement(&v3->m_RefCount) && v3 )
        {
          if ( v3->m_wstr )
          {
            SysFreeString(v3->m_wstr);
            v3->m_wstr = 0;
          }
          if ( v3->m_str )
          {
            j_j__free(v3->m_str);
            v3->m_str = 0;
          }
          j__free(v3);
        }
        v1->_bstrText2.m_Data = 0;
      }
      v4 = v1->_bstrText1.m_Data;
      if ( v4 )
      {
        if ( !InterlockedDecrement(&v4->m_RefCount) && v4 )
        {
          if ( v4->m_wstr )
          {
            SysFreeString(v4->m_wstr);
            v4->m_wstr = 0;
          }
          if ( v4->m_str )
          {
            j_j__free(v4->m_str);
            v4->m_str = 0;
          }
          j__free(v4);
        }
        v1->_bstrText1.m_Data = 0;
      }
      j__free(v1);
      v1 = v2;
    }
    while ( !v2->_IsNil );
  }
}

//----- (00F7FC40) --------------------------------------------------------
BOOL __thiscall sub_F7FC40(void *this, int a2, int a3)
{
  int *v3; // esi
  unsigned int v4; // eax
  BOOL result; // eax
  unsigned int v6; // ebx
  int *v7; // ecx
  int v8; // [esp+14h] [ebp+Ch]

  v3 = this;
  if ( a2 > 0x7FFFFFFE )
    std::_Xlength_error("string too long");
  v4 = *(this + 5);
  if ( v4 >= a2 )
  {
    if ( a3 && a2 < 8 )
    {
      v6 = *(this + 4);
      if ( a2 < v6 )
        v6 = a2;
      if ( v4 >= 8 )
      {
        v7 = *this;
        v8 = *v3;
        if ( v6 )
        {
          memmove_0(v3, v7, 2 * v6);
          v7 = v8;
        }
        j__free(v7);
      }
      v3[4] = v6;
      v3[5] = 7;
      *(v3 + v6) = 0;
      result = a2 > 0;
    }
    else
    {
      if ( !a2 )
      {
        *(this + 4) = 0;
        if ( v4 >= 8 )
          v3 = *this;
        *v3 = 0;
      }
      result = a2 > 0;
    }
  }
  else
  {
    sub_F7F9D0(this, a2, *(this + 4));
    result = a2 > 0;
  }
  return result;
}

//----- (00F7FD00) --------------------------------------------------------
int *__thiscall sub_F7FD00(int *this, unsigned int a2)
{
  int *v2; // ebx
  unsigned int v3; // esi
  char *v4; // edi
  int v5; // eax
  int v6; // ecx
  int v7; // ebx
  int *result; // eax
  int v9; // [esp+0h] [ebp-28h]
  void *v10; // [esp+10h] [ebp-18h]
  int *v11; // [esp+14h] [ebp-14h]
  int *v12; // [esp+18h] [ebp-10h]
  int v13; // [esp+24h] [ebp-4h]

  v12 = &v9;
  v2 = this;
  v11 = this;
  v3 = a2;
  v4 = 0;
  v10 = 0;
  if ( a2 )
  {
    if ( a2 > 0xFFFFFFF || (v4 = operator new(16 * a2), (v10 = v4) == 0) )
      std::_Xbad_alloc();
  }
  v13 = 0;
  sub_F73440(*v2, v2[1], v4);
  v5 = *v2;
  v6 = v2[1];
  v7 = v2[1] - *v2;
  if ( v5 )
  {
    sub_F72BF0(v5, v6);
    j__free(*v11);
  }
  result = v11;
  v11[2] = &v4[16 * v3];
  result[1] = &v4[v7 & 0xFFFFFFF0];
  *result = v4;
  return result;
}
// 10081AA: using guessed type void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD);

//----- (00F7FDF0) --------------------------------------------------------
const wchar_t **__thiscall sub_F7FDF0(std__vector *this, unsigned int a2)
{
  std__vector *v2; // ebx
  char *v3; // edi
  std__vector *v4; // eax
  std__vector *v5; // esi
  int v6; // ecx
  int v7; // ecx
  const wchar_t **result; // eax
  int v9; // [esp+0h] [ebp-2Ch]
  int v10; // [esp+10h] [ebp-1Ch]
  void *v11; // [esp+14h] [ebp-18h]
  int *v12; // [esp+1Ch] [ebp-10h]
  int v13; // [esp+28h] [ebp-4h]

  v12 = &v9;
  v2 = this;
  v3 = 0;
  v11 = 0;
  if ( a2 )
  {
    if ( a2 > 0x3FFFFFFF || (v3 = operator new(4 * a2), (v11 = v3) == 0) )
      std::_Xbad_alloc();
  }
  v13 = 0;
  sub_F734F0(v2->baseclass_0._Mypair._Myval2._Myfirst, v2->baseclass_0._Mypair._Myval2._Mylast, v3);
  v4 = v2->baseclass_0._Mypair._Myval2._Mylast;
  v5 = v2->baseclass_0._Mypair._Myval2._Myfirst;
  v6 = v2->baseclass_0._Mypair._Myval2._Mylast - v2->baseclass_0._Mypair._Myval2._Myfirst;
  v11 = v2->baseclass_0._Mypair._Myval2._Mylast;
  v7 = v6 >> 2;
  v10 = v7;
  if ( v5 )
  {
    if ( v5 != v4 )
    {
      do
      {
        free(v5->baseclass_0._Mypair._Myval2._Myfirst);
        v5 = (v5 + 4);
      }
      while ( v5 != v11 );
    }
    j__free(v2->baseclass_0._Mypair._Myval2._Myfirst);
    v7 = v10;
  }
  v2->baseclass_0._Mypair._Myval2._Myfirst = v3;
  v2->baseclass_0._Mypair._Myval2._Myend = &v3[4 * a2];
  result = &v3[4 * v7];
  v2->baseclass_0._Mypair._Myval2._Mylast = result;
  return result;
}
// 10081AA: using guessed type void __stdcall __noreturn _CxxThrowException(_DWORD, _DWORD);

//----- (00F7FEE0) --------------------------------------------------------
int *__thiscall sub_F7FEE0(int *this, unsigned int a2)
{
  int v2; // esi
  int *result; // eax
  int v4; // esi
  unsigned int v5; // esi
  unsigned int v6; // edx
  unsigned int v7; // edx
  unsigned int v8; // edx

  v2 = this[1];
  result = ((this[2] - v2) >> 4);
  if ( result < a2 )
  {
    v4 = (v2 - *this) >> 4;
    if ( 0xFFFFFFF - v4 < a2 )
      std::_Xlength_error("vector<T> too long");
    v5 = a2 + v4;
    v6 = (this[2] - *this) >> 4;
    if ( 0xFFFFFFF - (v6 >> 1) >= v6 )
    {
      v8 = (v6 >> 1) + v6;
      if ( v8 < v5 )
        v8 = v5;
      result = sub_F7FD00(this, v8);
    }
    else
    {
      v7 = 0;
      if ( v5 > 0 )
        v7 = v5;
      result = sub_F7FD00(this, v7);
    }
  }
  return result;
}

//----- (00F7FF60) --------------------------------------------------------
unsigned int __thiscall std::vector<wchar_t const *,std::allocator<wchar_t const *>>::_Reserve(std__vector *this, unsigned int a2)
{
  void *v2; // esi
  unsigned int result; // eax
  signed int v4; // esi
  unsigned int v5; // esi
  unsigned int v6; // edx
  unsigned int v7; // edx
  unsigned int v8; // edx

  v2 = this->baseclass_0._Mypair._Myval2._Mylast;
  result = (this->baseclass_0._Mypair._Myval2._Myend - v2) >> 2;
  if ( result < a2 )
  {
    v4 = (v2 - this->baseclass_0._Mypair._Myval2._Myfirst) >> 2;
    if ( 0x3FFFFFFF - v4 < a2 )
      std::_Xlength_error("vector<T> too long");
    v5 = a2 + v4;
    v6 = (this->baseclass_0._Mypair._Myval2._Myend - this->baseclass_0._Mypair._Myval2._Myfirst) >> 2;
    if ( 0x3FFFFFFF - (v6 >> 1) >= v6 )
    {
      v8 = (v6 >> 1) + v6;
      if ( v8 < v5 )
        v8 = v5;
      result = sub_F7FDF0(this, v8);
    }
    else
    {
      v7 = 0;
      if ( v5 > 0 )
        v7 = v5;
      result = sub_F7FDF0(this, v7);
    }
  }
  return result;
}

//----- (00F7FFE0) --------------------------------------------------------
void *__stdcall sub_F7FFE0(unsigned int a1)
{
  void *v1; // ecx

  v1 = 0;
  if ( a1 )
  {
    if ( a1 > 0x7FFFFFFF || (v1 = operator new(2 * a1)) == 0 )
      std::_Xbad_alloc();
  }
  return v1;
}

//----- (00F80010) --------------------------------------------------------
int __thiscall sub_F80010(int *this)
{
  int *v1; // edi
  int v2; // ebx
  void **v3; // esi
  int result; // eax

  v1 = this;
  v2 = this[1];
  v3 = *this;
  if ( *this == v2 )
  {
    result = *this;
    this[1] = v3;
  }
  else
  {
    do
    {
      free(*v3);
      ++v3;
    }
    while ( v3 != v2 );
    result = *v1;
    v1[1] = *v1;
  }
  return result;
}

//----- (00F80050) --------------------------------------------------------
int __thiscall std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::erase(std__tree *this, std__Tree_node **a2, std__Tree_node *a3, std__Tree_node *Node)
{
  std__Tree_node *v4; // eax
  std__tree *v5; // esi
  std__Tree_node *_Myhead; // ecx
  std__Tree_node **v7; // eax
  std__Tree_node *v8; // ecx
  int result; // eax
  std__Tree_node *v10; // ecx
  std__Tree_node *i; // edx
  std__Tree_node *v12; // eax
  int v13; // [esp+4h] [ebp-4h]

  v4 = a3;
  v5 = this;
  _Myhead = this->_Mypair._Myval2._Myhead;
  if ( a3 != _Myhead->_Left || Node != _Myhead )
  {
    for ( ; a3 != Node; v4 = a3 )
    {
      v10 = v4;
      if ( !v4->_IsNil )
      {
        i = v4->_Right;
        if ( i->_IsNil )
        {
          for ( i = v4->_Parent; !i->_IsNil; i = i->_Parent )
          {
            if ( v4 != i->_Right )
              break;
            v4 = i;
          }
        }
        else
        {
          v12 = i->_Left;
          if ( !i->_Left->_IsNil )
          {
            do
            {
              i = v12;
              v12 = v12->_Left;
            }
            while ( !v12->_IsNil );
          }
        }
        a3 = i;
      }
      std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::erase(
        v5,
        &v13,
        v10);
    }
    *a2 = v4;
    result = a2;
  }
  else
  {
    std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::clear(_Myhead->_Parent);
    v5->_Mypair._Myval2._Myhead->_Parent = v5->_Mypair._Myval2._Myhead;
    v5->_Mypair._Myval2._Myhead->_Left = v5->_Mypair._Myval2._Myhead;
    v5->_Mypair._Myval2._Myhead->_Right = v5->_Mypair._Myval2._Myhead;
    v7 = &v5->_Mypair._Myval2._Myhead->_Left;
    v5->_Mypair._Myval2._Mysize = 0;
    v8 = *v7;
    result = a2;
    *a2 = v8;
  }
  return result;
}

//----- (00F80110) --------------------------------------------------------
int __thiscall std::_Tree<std::_Tmap_traits<wchar_t const *,tagKeyName,std::less<wchar_t const *>,std::allocator<std::pair<wchar_t const * const,tagKeyName>>,0>>::erase(std__tree *this, int a2, std__Tree_node *a3)
{
  std__Tree_node_For__bstr_t *v3; // ebx
  std__Tree_node *v4; // edi
  std__Tree_node *v5; // ecx
  std__Tree_node *v6; // esi
  std__tree *pThis; // edx
  std__Tree_node *v8; // eax
  std__Tree_node *v9; // ecx
  std__Tree_node *v10; // eax
  std__Tree_node *v11; // eax
  std__Tree_node *i; // ecx
  std__Tree_node *v13; // eax
  bool v14; // cl
  std__Tree_node *v15; // ecx
  std__Tree_node *v16; // ST00_4
  std__Tree_node *v17; // esi
  std__Tree_node *v18; // ST00_4
  Data_t_bstr_t *v19; // edi
  LONG (__stdcall *v20)(volatile LONG *); // ecx
  Data_t_bstr_t *v21; // edi
  std__Tree_node *v22; // eax
  std__Tree_node *v23; // ecx
  int result; // eax
  std__Tree_node *v25; // [esp+Ch] [ebp-8h]
  std__tree *This; // [esp+10h] [ebp-4h]

  v3 = a3;
  This = this;
  sub_F94CE0(&a3);
  if ( v3->_Left->_IsNil )
  {
    v4 = v3->_Right;
LABEL_6:
    v6 = v3->_Parent;
    if ( !v4->_IsNil )
      v4->_Parent = v6;
    pThis = This;
    if ( This->_Mypair._Myval2._Myhead->_Parent == v3 )
    {
      This->_Mypair._Myval2._Myhead->_Parent = v4;
    }
    else if ( v6->_Left == v3 )
    {
      v6->_Left = v4;
    }
    else
    {
      v6->_Right = v4;
    }
    v8 = This->_Mypair._Myval2._Myhead;
    if ( This->_Mypair._Myval2._Myhead->_Left == v3 )
    {
      if ( v4->_IsNil )
      {
        v9 = v6;
      }
      else
      {
        v10 = v4->_Left;
        v9 = v4;
        if ( !v4->_Left->_IsNil )
        {
          do
          {
            v9 = v10;
            v10 = v10->_Left;
          }
          while ( !v10->_IsNil );
        }
        v8 = This->_Mypair._Myval2._Myhead;
      }
      v8->_Left = v9;
    }
    if ( This->_Mypair._Myval2._Myhead->_Right == v3 )
    {
      if ( v4->_IsNil )
      {
        This->_Mypair._Myval2._Myhead->_Right = v6;
      }
      else
      {
        v11 = v4->_Right;
        for ( i = v4; !v11->_IsNil; v11 = v11->_Right )
          i = v11;
        This->_Mypair._Myval2._Myhead->_Right = i;
      }
    }
    goto LABEL_37;
  }
  if ( v3->_Right->_IsNil )
  {
    v4 = v3->_Left;
    goto LABEL_6;
  }
  v5 = a3;
  v25 = a3;
  v4 = a3->_Right;
  if ( a3 == v3 )
    goto LABEL_6;
  v3->_Left->_Parent = a3;
  v5->_Left = v3->_Left;
  if ( v5 == v3->_Right )
  {
    v6 = v5;
  }
  else
  {
    v6 = v5->_Parent;
    if ( !v4->_IsNil )
      v4->_Parent = v6;
    v6->_Left = v4;
    v5->_Right = v3->_Right;
    v3->_Right->_Parent = v5;
  }
  if ( This->_Mypair._Myval2._Myhead->_Parent == v3 )
  {
    This->_Mypair._Myval2._Myhead->_Parent = v5;
  }
  else
  {
    v13 = v3->_Parent;
    if ( v13->_Left == v3 )
      v13->_Left = v5;
    else
      v13->_Right = v5;
  }
  v5->_Parent = v3->_Parent;
  v14 = v5->_Color;
  v25->_Color = v3->_Color;
  pThis = This;
  v3->_Color = v14;
LABEL_37:
  if ( v3->_Color == 1 )
  {
    for ( ; v4 != pThis->_Mypair._Myval2._Myhead->_Parent; v6 = v6->_Parent )
    {
      if ( v4->_Color != 1 )
        break;
      v15 = v6->_Left;
      if ( v4 == v6->_Left )
      {
        v15 = v6->_Right;
        if ( !v15->_Color )
        {
          v15->_Color = 1;
          v6->_Color = 0;
          sub_FF54B0(pThis, v6);
          v15 = v6->_Right;
          pThis = This;
        }
        if ( v15->_IsNil )
          goto LABEL_55;
        if ( v15->_Left->_Color != 1 || v15->_Right->_Color != 1 )
        {
          if ( v15->_Right->_Color == 1 )
          {
            v15->_Left->_Color = 1;
            v15->_Color = 0;
            sub_1002BB0(pThis, v15);
            v15 = v6->_Right;
          }
          v15->_Color = v6->_Color;
          v6->_Color = 1;
          v16 = v6;
          v17 = This;
          v15->_Right->_Color = 1;
          sub_FF54B0(This, v16);
          v4->_Color = 1;
          goto LABEL_61;
        }
      }
      else
      {
        if ( !v15->_Color )
        {
          v15->_Color = 1;
          v6->_Color = 0;
          sub_1002BB0(pThis, v6);
          v15 = v6->_Left;
          pThis = This;
        }
        if ( v15->_IsNil )
          goto LABEL_55;
        if ( v15->_Right->_Color != 1 || v15->_Left->_Color != 1 )
        {
          if ( v15->_Left->_Color == 1 )
          {
            v15->_Right->_Color = 1;
            v15->_Color = 0;
            sub_FF54B0(pThis, v15);
            v15 = v6->_Left;
          }
          v15->_Color = v6->_Color;
          v6->_Color = 1;
          v18 = v6;
          v17 = This;
          v15->_Left->_Color = 1;
          sub_1002BB0(This, v18);
          v4->_Color = 1;
          goto LABEL_61;
        }
      }
      v15->_Color = 0;
LABEL_55:
      v4 = v6;
    }
    v17 = This;
    v4->_Color = 1;
  }
  else
  {
    v17 = This;
  }
LABEL_61:
  v19 = v3->_bstrText2.m_Data;
  // void __thiscall tagKeyName___tagKeyName(tagKeyName *this)
  v20 = InterlockedDecrement;
  if ( v19 )
  {
    if ( !InterlockedDecrement(&v19->m_RefCount) && v19 )
    {
      if ( v19->m_wstr )
      {
        SysFreeString(v19->m_wstr);
        v19->m_wstr = 0;
      }
      if ( v19->m_str )
      {
        j_j__free(v19->m_str);
        v19->m_str = 0;
      }
      j__free(v19);
    }
    v20 = InterlockedDecrement;
    v3->_bstrText2.m_Data = 0;
  }
  v21 = v3->_bstrText1.m_Data;
  if ( v21 )
  {
    if ( !v20(&v21->m_RefCount) && v21 )
    {
      if ( v21->m_wstr )
      {
        SysFreeString(v21->m_wstr);
        v21->m_wstr = 0;
      }
      if ( v21->m_str )
      {
        j_j__free(v21->m_str);
        v21->m_str = 0;
      }
      j__free(v21);
    }
    v3->_bstrText1.m_Data = 0;
  }
  j__free(v3);
  v22 = v17->_Parent;
  v23 = a3;
  if ( v22 )
    v17->_Parent = (v22 - 1);
  result = a2;
  *a2 = v23;
  return result;
}

//----- (00F80440) --------------------------------------------------------
UINT __thiscall sub_F80440(BSTR **this)
{
  UINT result; // eax

  if ( *this && **this )
    result = SysStringLen(**this);
  else
    result = 0;
  return result;
}

//----- (00F80460) --------------------------------------------------------
const wchar_t **__thiscall sub_F80460(int *this, const wchar_t **a2)
{
  int *v2; // esi
  const wchar_t **result; // eax
  const wchar_t **v4; // edi
  int v5; // ecx
  unsigned int v6; // edi
  int v7; // ebx

  v2 = this;
  result = this[1];
  v4 = a2;
  if ( a2 >= result || (v5 = *this, *v2 > a2) )
  {
    if ( result == v2[2] )
      result = sub_F7FEE0(v2, 1u);
    v7 = v2[1];
    if ( v7 )
    {
      *v7 = _wcsdup(*a2);
      goto LABEL_11;
    }
  }
  else
  {
    v6 = a2 - v5;
    if ( result == v2[2] )
      result = sub_F7FEE0(v2, 1u);
    v7 = v2[1];
    v4 = (*v2 + (v6 & 0xFFFFFFF0));
    if ( v7 )
    {
      *v7 = _wcsdup(*v4);
LABEL_11:
      result = sub_F735A0((v7 + 4), v4 + 1);
      goto LABEL_12;
    }
  }
LABEL_12:
  v2[1] += 16;
  return result;
}

//----- (00F80530) --------------------------------------------------------
const wchar_t **__thiscall sub_F80530(std__vector *this, const wchar_t **a2)
{
  std__vector *v2; // esi
  const wchar_t **result; // eax
  _BYTE *v4; // ecx
  int v5; // edi
  _DWORD *v6; // ebx

  v2 = this;
  result = this->baseclass_0._Mypair._Myval2._Mylast;
  if ( a2 >= result || (v4 = this->baseclass_0._Mypair._Myval2._Myfirst, v2->baseclass_0._Mypair._Myval2._Myfirst > a2) )
  {
    if ( result == v2->baseclass_0._Mypair._Myval2._Myend )
      result = std::vector<wchar_t const *,std::allocator<wchar_t const *>>::_Reserve(v2, 1u);
    v6 = v2->baseclass_0._Mypair._Myval2._Mylast;
    if ( v6 )
    {
      result = _wcsdup(*a2);
      goto LABEL_11;
    }
  }
  else
  {
    v5 = (a2 - v4) >> 2;
    if ( result == v2->baseclass_0._Mypair._Myval2._Myend )
      result = std::vector<wchar_t const *,std::allocator<wchar_t const *>>::_Reserve(v2, 1u);
    v6 = v2->baseclass_0._Mypair._Myval2._Mylast;
    if ( v6 )
    {
      result = _wcsdup(*(v2->baseclass_0._Mypair._Myval2._Myfirst + v5));
LABEL_11:
      *v6 = result;
      goto LABEL_12;
    }
  }
LABEL_12:
  v2->baseclass_0._Mypair._Myval2._Mylast = v2->baseclass_0._Mypair._Myval2._Mylast + 4;
  return result;
}

//----- (00F805A0) --------------------------------------------------------
void *__cdecl sub_F805A0(int a1, HKEY hKey, LPCWSTR lpszKeyName, LPCWSTR lpValueName)
{
  _bstr_t *v4; // eax
  _bstr_t *v5; // eax
  Data_t_bstr_t *v6; // esi
  Data_t_bstr_t *v7; // esi
  Data_t_bstr_t *v8; // esi
  void *v9; // eax
  const WCHAR *v10; // ecx
  void *v11; // eax
  Data_t_bstr_t *v12; // esi
  void *v13; // edi
  _bstr_t v15; // [esp+10h] [ebp-1Ch]
  _bstr_t v16; // [esp+14h] [ebp-18h]
  _bstr_t v17; // [esp+18h] [ebp-14h]
  _bstr_t v18; // [esp+1Ch] [ebp-10h]
  int v19; // [esp+28h] [ebp-4h]

  _bstr_t::_bstr_t(&v16, L"AutorunsDisabled");
  v19 = 0;
  v4 = _bstr_t::_bstr_t(&v17, L"\\");
  LOBYTE(v19) = 1;
  v5 = _bstr_t::operator+(&v18, lpszKeyName, v4);
  LOBYTE(v19) = 2;
  _bstr_t::operator+(&v5->m_Data, &v15, &v16);
  v6 = v18.m_Data;
  if ( v18.m_Data )
  {
    if ( !InterlockedDecrement(&v18.m_Data->m_RefCount) && v6 )
    {
      if ( v6->m_wstr )
      {
        SysFreeString(v6->m_wstr);
        v6->m_wstr = 0;
      }
      if ( v6->m_str )
      {
        j_j__free(v6->m_str);
        v6->m_str = 0;
      }
      j__free(v6);
    }
    v18.m_Data = 0;
  }
  v7 = v17.m_Data;
  if ( v17.m_Data )
  {
    if ( !InterlockedDecrement(&v17.m_Data->m_RefCount) && v7 )
    {
      if ( v7->m_wstr )
      {
        SysFreeString(v7->m_wstr);
        v7->m_wstr = 0;
      }
      if ( v7->m_str )
      {
        j_j__free(v7->m_str);
        v7->m_str = 0;
      }
      j__free(v7);
    }
    v17.m_Data = 0;
  }
  v8 = v16.m_Data;
  LOBYTE(v19) = 6;
  if ( v16.m_Data && !InterlockedDecrement(&v16.m_Data->m_RefCount) )
  {
    if ( v8->m_wstr )
    {
      SysFreeString(v8->m_wstr);
      v8->m_wstr = 0;
    }
    if ( v8->m_str )
    {
      j_j__free(v8->m_str);
      v8->m_str = 0;
    }
    j__free(v8);
  }
  v9 = sub_F80790(a1, hKey, lpszKeyName, lpValueName, 0xFFFFFFFF);
  if ( v15.m_Data )
    v10 = v15.m_Data->m_wstr;
  else
    v10 = 0;
  v11 = sub_F80790(a1, hKey, v10, lpValueName, v9);
  v12 = v15.m_Data;
  v13 = v11;
  if ( v15.m_Data && !InterlockedDecrement(&v15.m_Data->m_RefCount) && v12 )
  {
    if ( v12->m_wstr )
    {
      SysFreeString(v12->m_wstr);
      v12->m_wstr = 0;
    }
    if ( v12->m_str )
    {
      j_j__free(v12->m_str);
      v12->m_str = 0;
    }
    j__free(v12);
  }
  return v13;
}

//----- (00F80790) --------------------------------------------------------
void *__cdecl sub_F80790(int a1, HKEY hKey, LPCWSTR lpszKeyName, LPCWSTR lpszValueName, HANDLE Handle)
{
  HANDLE v5; // edi
  const WCHAR *v6; // esi
  int v7; // ebx
  const wchar_t *v8; // eax
  const wchar_t *v9; // eax
  const wchar_t *v10; // eax
  const wchar_t *v11; // eax
  unsigned __int16 **v12; // esi
  unsigned __int16 **v13; // eax
  WCHAR *v15; // eax
  wchar_t *v16; // edi
  DWORD v17; // eax
  _WORD *v18; // eax
  WCHAR *v19; // esi
  wchar_t *v20; // eax
  wchar_t *v21; // esi
  const wchar_t **v22; // eax
  wchar_t *v23; // ebx
  const wchar_t *v24; // ecx
  const wchar_t *v25; // eax
  const wchar_t *v26; // eax
  const wchar_t *v27; // eax
  unsigned __int16 **v28; // esi
  unsigned __int16 **v29; // eax
  char v30; // bl
  LPCWSTR v31; // ebx
  const wchar_t *v32; // eax
  const wchar_t *v33; // eax
  const wchar_t *v34; // eax
  const wchar_t *v35; // eax
  unsigned __int16 **v36; // esi
  unsigned __int16 **v37; // eax
  int v38; // ST34_4
  int v39; // esi
  const WCHAR **v40; // eax
  const wchar_t *v41; // eax
  unsigned __int16 **v42; // eax
  WCHAR v43[2]; // [esp+10h] [ebp-A4h]
  WCHAR v44[2]; // [esp+14h] [ebp-A0h]
  WCHAR v45[2]; // [esp+18h] [ebp-9Ch]
  WCHAR v46[2]; // [esp+1Ch] [ebp-98h]
  WCHAR v47[2]; // [esp+20h] [ebp-94h]
  int v48; // [esp+24h] [ebp-90h]
  void *v49; // [esp+28h] [ebp-8Ch]
  int a2; // [esp+2Ch] [ebp-88h]
  int v51; // [esp+30h] [ebp-84h]
  int v52; // [esp+34h] [ebp-80h]
  int v53; // [esp+38h] [ebp-7Ch]
  int v54; // [esp+3Ch] [ebp-78h]
  void *v55; // [esp+40h] [ebp-74h]
  void *v56; // [esp+44h] [ebp-70h]
  LPCWSTR v57; // [esp+48h] [ebp-6Ch]
  void *v58; // [esp+4Ch] [ebp-68h]
  LPCWSTR v59; // [esp+50h] [ebp-64h]
  void *v60; // [esp+54h] [ebp-60h]
  LPCWSTR v61; // [esp+58h] [ebp-5Ch]
  WCHAR *ppv3; // [esp+5Ch] [ebp-58h]
  void *v63; // [esp+60h] [ebp-54h]
  LPCWSTR v64; // [esp+64h] [ebp-50h]
  LPCWSTR v65; // [esp+68h] [ebp-4Ch]
  void *v66; // [esp+6Ch] [ebp-48h]
  void *a1a; // [esp+70h] [ebp-44h]
  HKEY hKeya; // [esp+74h] [ebp-40h]
  WCHAR szArg[2]; // [esp+78h] [ebp-3Ch]
  LPCWSTR v70; // [esp+7Ch] [ebp-38h]
  LPCWSTR v71; // [esp+80h] [ebp-34h]
  void *v72; // [esp+84h] [ebp-30h]
  LPCWSTR v73; // [esp+88h] [ebp-2Ch]
  LPCWSTR v74; // [esp+8Ch] [ebp-28h]
  LPCWSTR v75; // [esp+90h] [ebp-24h]
  DWORD cbData; // [esp+94h] [ebp-20h]
  LPCWSTR szArg3; // [esp+98h] [ebp-1Ch]
  WCHAR *pszText; // [esp+9Ch] [ebp-18h]
  LPCWSTR szArg4; // [esp+A0h] [ebp-14h]
  wchar_t *v80; // [esp+A4h] [ebp-10h]
  int v81; // [esp+B0h] [ebp-4h]

  v5 = Handle;
  v6 = lpszValueName;
  v7 = a1;
  if ( Handle == -1 )
  {
    v71 = _wcsdup(&gszNullString);
    v81 = 0;
    v73 = _wcsdup(&gszNullString);
    v70 = _wcsdup(&gszNullString);
    v74 = _wcsdup(&gszNullString);
    v72 = _wcsdup(&gszNullString);
    v80 = _wcsdup(&gszNullString);
    v8 = &gszNullString;
    if ( lpszValueName )
      v8 = lpszValueName;
    szArg4 = _wcsdup(v8);
    v9 = &gszNullString;
    if ( lpszKeyName )
      v9 = lpszKeyName;
    pszText = _wcsdup(v9);
    v10 = &gszNullString;
    if ( lpszValueName )
      v10 = lpszValueName;
    v75 = _wcsdup(v10);
    v11 = &gszNullString;
    if ( lpszKeyName )
      v11 = lpszKeyName;
    szArg3 = _wcsdup(v11);
    LOBYTE(v81) = 9;
    v12 = sub_F77BE0(&a1a, hKey, &pszText, &szArg4);
    LOBYTE(v81) = 10;
    v13 = sub_F77BE0(szArg, hKey, &szArg3, &v75);
    LOBYTE(v81) = 11;
    v5 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v13, v12, &v80);
    Handle = v5;
    free(*szArg);
    free(a1a);
    free(szArg3);
    free(v75);
    free(pszText);
    free(szArg4);
    free(v80);
    free(v72);
    free(v74);
    free(v70);
    free(v73);
    v81 = -1;
    free(v71);
    v6 = lpszValueName;
  }
  hKeya = 0;
  PE_OpenKey(hKey, lpszKeyName, 0, KEY_READ, &hKeya);
  if ( !hKeya )
    return v5;
  cbData = 0;
  if ( !RegQueryValueExW(hKeya, v6, 0, 0, 0, &cbData) )
  {
    v15 = malloc(2u);
    pszText = v15;
    *v15 = 0;
    v81 = 12;
    v16 = operator new[](2 * ((cbData >> 1) + 2));
    RegQueryValueExW(hKeya, v6, 0, 0, v16, &cbData);
    v17 = cbData >> 1;
    cbData = v17;
    if ( v17 > 2 )
    {
      v16[v17 - 1] = 0;
      for ( v16[cbData] = 0; *v16; v16 = wcschr(v16 + 1, 0) + 1 )
      {
        v18 = malloc(2u);
        a2 = v18;
        *v18 = 0;
        v51 = 0;
        v52 = 0;
        v53 = 0;
        LOBYTE(v81) = 13;
        sub_F76CC0(v16, &a2);
        v19 = pszText;
        pszText = _wcsdup(v16);
        free(v19);
        sub_F74EE0(&v80, v7, &a2, 0);
        v20 = v80;
        if ( v80 )
        {
          if ( !_wcsnicmp(v80, L"File not found: ", 0x10u) && !_wcsnicmp(v16, L"autocheck ", 0xAu) )
          {
            v21 = _wcsdup(v16);
            v54 = v21;
            LOBYTE(v81) = 15;
            sub_F76CC0((v16 + 10), &a2);
            v22 = sub_F74EE0(&v49, v7, &a2, 0);
            v23 = v80;
            v80 = _wcsdup(*v22);
            free(v23);
            free(v49);
            free(v21);
            v7 = a1;
          }
          v20 = v80;
        }
        if ( *v20 )
        {
          szArg4 = malloc(2u);
          *szArg4 = 0;
          szArg3 = malloc(2u);
          *szArg3 = 0;
          v75 = malloc(2u);
          *v75 = 0;
          LOBYTE(v81) = 18;
          v54 = sub_F74ED0();
          v72 = _wcsdup(v16);
          v24 = &gszNullString;
          if ( lpszValueName )
            v24 = lpszValueName;
          v74 = _wcsdup(v24);
          v25 = &gszNullString;
          if ( lpszKeyName )
            v25 = lpszKeyName;
          v70 = _wcsdup(v25);
          v26 = &gszNullString;
          if ( lpszValueName )
            v26 = lpszValueName;
          v73 = _wcsdup(v26);
          v27 = &gszNullString;
          if ( lpszKeyName )
            v27 = lpszKeyName;
          v71 = _wcsdup(v27);
          LOBYTE(v81) = 23;
          v28 = sub_F77BE0(v43, hKey, &v70, &v74);
          LOBYTE(v81) = 24;
          v29 = sub_F77BE0(v47, hKey, &v71, &v73);
          LOBYTE(v81) = 25;
          v30 = sub_F73D40(v7, v29, v28, &v72, &v80, &szArg4, &v75, &v48);
          free(*v47);
          free(*v43);
          free(v71);
          free(v73);
          free(v70);
          free(v74);
          free(v72);
          if ( v30 )
          {
            if ( Handle == -1 )
            {
              v58 = _wcsdup(&gszNullString);
              v56 = _wcsdup(&gszNullString);
              v60 = _wcsdup(&gszNullString);
              v55 = _wcsdup(&gszNullString);
              v66 = _wcsdup(&gszNullString);
              v63 = _wcsdup(&gszNullString);
              v31 = lpszValueName;
              v32 = &gszNullString;
              if ( lpszValueName )
                v32 = lpszValueName;
              v59 = _wcsdup(v32);
              v33 = &gszNullString;
              if ( lpszKeyName )
                v33 = lpszKeyName;
              v64 = _wcsdup(v33);
              v34 = &gszNullString;
              if ( lpszValueName )
                v34 = lpszValueName;
              v65 = _wcsdup(v34);
              v35 = &gszNullString;
              if ( lpszKeyName )
                v35 = lpszKeyName;
              v57 = _wcsdup(v35);
              LOBYTE(v81) = 35;
              v36 = sub_F77BE0(v46, hKey, &v64, &v59);
              LOBYTE(v81) = 36;
              v37 = sub_F77BE0(v44, hKey, &v57, &v65);
              LOBYTE(v81) = 37;
              v38 = v36;
              v39 = a1;
              Handle = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v37, v38, &v63);
              free(*v44);
              free(*v46);
              free(v57);
              free(v65);
              free(v64);
              free(v59);
              free(v63);
              free(v66);
              free(v55);
              free(v60);
              free(v56);
              free(v58);
            }
            else
            {
              v39 = a1;
              v31 = lpszValueName;
            }
            *szArg = _wcsdup(&gszNullString);
            v40 = &gszNullString;
            if ( v31 )
              v40 = v31;
            a1a = _wcsdup(v40);
            v41 = &gszNullString;
            if ( lpszKeyName )
              v41 = lpszKeyName;
            v61 = _wcsdup(v41);
            ppv3 = _wcsdup(v16);
            LOBYTE(v81) = 41;
            v42 = sub_F77BE0(v45, hKey, &v61, &a1a);
            LOBYTE(v81) = 42;
            sub_F73FF0(v39, v54, Handle, 5, &ppv3, v42, &v80);
            free(*v45);
            free(ppv3);
            free(v61);
            free(a1a);
            free(*szArg);
          }
          free(v75);
          free(szArg3);
          free(szArg4);
          v20 = v80;
        }
        free(v20);
        LOBYTE(v81) = 12;
        sub_F721F0(&a2);
        v7 = a1;
      }
    }
    free(pszText);
  }
  RegCloseKey(hKeya);
  return Handle;
}

//----- (00F80F50) --------------------------------------------------------
int __cdecl RequerySystemEnvironmentString(WCHAR **ppstr, LPCWSTR lpszName)
{
  DWORD nLength; // eax
  DWORD v3; // edi
  WCHAR *pBuffer; // eax
  size_t v5; // edi
  WCHAR *v6; // eax
  DWORD nSize; // [esp+Ch] [ebp-4h]

  nLength = ExpandEnvironmentStringsW(lpszName, 0, 0);
  v3 = nLength;
  nSize = nLength;
  pBuffer = malloc(2u);
  v5 = 2 * v3 + 2;
  *ppstr = pBuffer;
  *pBuffer = 0;
  v6 = realloc(*ppstr, v5);
  *ppstr = v6;
  if ( v6 )
    memset(v6, 0, v5);
  ExpandEnvironmentStringsW(lpszName, *ppstr, nSize);
  return ppstr;
}

//----- (00F80FC0) --------------------------------------------------------
HANDLE __cdecl sub_F80FC0(OLECHAR *psz, LPWIN32_FIND_DATAW lpFindFileData)
{
  Data_t_bstr_t *v2; // esi
  const WCHAR *v3; // eax
  HANDLE v4; // edi
  _bstr_t bstrText; // [esp+8h] [ebp-4h]

  sub_F77AB0(&gKeyNameMap, &bstrText, psz);
  v2 = bstrText.m_Data;
  if ( bstrText.m_Data )
    v3 = bstrText.m_Data->m_wstr;
  else
    v3 = 0;
  v4 = FindFirstFileW(v3, lpFindFileData);
  if ( v2 && !InterlockedDecrement(&v2->m_RefCount) )
  {
    if ( v2->m_wstr )
    {
      SysFreeString(v2->m_wstr);
      v2->m_wstr = 0;
    }
    if ( v2->m_str )
    {
      j_j__free(v2->m_str);
      v2->m_str = 0;
    }
    j__free(v2);
  }
  return v4;
}

//----- (00F81040) --------------------------------------------------------
DWORD __cdecl sub_F81040(OLECHAR *psz)
{
  Data_t_bstr_t *v1; // esi
  const WCHAR *v2; // eax
  DWORD v3; // edi
  _bstr_t bstrText; // [esp+8h] [ebp-4h]

  sub_F77AB0(&gKeyNameMap, &bstrText, psz);
  v1 = bstrText.m_Data;
  if ( bstrText.m_Data )
    v2 = bstrText.m_Data->m_wstr;
  else
    v2 = 0;
  v3 = GetFileAttributesW(v2);
  if ( v1 && !InterlockedDecrement(&v1->m_RefCount) )
  {
    if ( v1->m_wstr )
    {
      SysFreeString(v1->m_wstr);
      v1->m_wstr = 0;
    }
    if ( v1->m_str )
    {
      j_j__free(v1->m_str);
      v1->m_str = 0;
    }
    j__free(v1);
  }
  return v3;
}

//----- (00F810C0) --------------------------------------------------------
DWORD_PTR __cdecl sub_F810C0(OLECHAR *psz, DWORD dwFileAttributes, SHFILEINFOW *psfi, UINT cbFileInfo, UINT uFlags)
{
  Data_t_bstr_t *v5; // esi
  const WCHAR *v6; // eax
  DWORD_PTR v7; // edi
  _bstr_t bstrText; // [esp+8h] [ebp-4h]

  sub_F77AB0(&gKeyNameMap, &bstrText, psz);
  v5 = bstrText.m_Data;
  if ( bstrText.m_Data )
    v6 = bstrText.m_Data->m_wstr;
  else
    v6 = 0;
  v7 = SHGetFileInfoW(v6, dwFileAttributes, psfi, cbFileInfo, uFlags);
  if ( v5 && !InterlockedDecrement(&v5->m_RefCount) )
  {
    if ( v5->m_wstr )
    {
      SysFreeString(v5->m_wstr);
      v5->m_wstr = 0;
    }
    if ( v5->m_str )
    {
      j_j__free(v5->m_str);
      v5->m_str = 0;
    }
    j__free(v5);
  }
  return v7;
}

//----- (00F81150) --------------------------------------------------------
bool __cdecl sub_F81150(int a1, wchar_t *a2, WCHAR *psz, int a4)
{
  int v4; // eax
  Data_t_bstr_t *bstrFileName; // esi
  const WCHAR *v6; // eax
  void *v7; // ebx
  bool v8; // bl
  const wchar_t *v9; // ecx
  wchar_t *v10; // edi
  bool v11; // zf
  const wchar_t *v12; // esi
  wchar_t *v13; // ebx
  unsigned int v14; // ecx
  WCHAR *v15; // edx
  WCHAR v16; // ax
  size_t v17; // esi
  const WCHAR **v18; // ecx
  WCHAR *v19; // ebx
  Data_t_bstr_t *v20; // esi
  const WCHAR *v21; // eax
  DWORD v22; // eax
  void *v24; // ebx
  int dwFileAttributes; // [esp+14h] [ebp-18h]
  LPCWSTR lpszKey; // [esp+18h] [ebp-14h]
  const wchar_t *v27; // [esp+1Ch] [ebp-10h]
  int v28; // [esp+28h] [ebp-4h]

  v4 = *psz;
  if ( v4 && psz[1] == ':' || v4 == '\\' )
  {
    sub_F77AB0(&gKeyNameMap, &dwFileAttributes, psz);
    bstrFileName = dwFileAttributes;
    if ( dwFileAttributes )
      v6 = *dwFileAttributes;
    else
      v6 = 0;
    dwFileAttributes = GetFileAttributesW(v6);
    v7 = *a4;
    *a4 = _wcsdup(psz);
    free(v7);
    v8 = dwFileAttributes != -1 && !(dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY);
    if ( bstrFileName && !InterlockedDecrement(&bstrFileName->m_RefCount) )
    {
      if ( bstrFileName->m_wstr )
      {
        SysFreeString(bstrFileName->m_wstr);
        bstrFileName->m_wstr = 0;
      }
      if ( bstrFileName->m_str )
      {
        j_j__free(bstrFileName->m_str);
        bstrFileName->m_str = 0;
      }
      j__free(bstrFileName);
    }
  }
  else
  {
    v9 = &gszNullString;
    if ( a2 )
      v9 = a2;
    v10 = _wcsdup(v9);
    v11 = *v10 == 0;
    v12 = v10;
    v28 = 0;
    v27 = v10;
    if ( v11 )
    {
LABEL_42:
      v8 = 0;
    }
    else
    {
      while ( 1 )
      {
        v13 = wcschr(v12, ';');
        if ( v13 )
          *v13 = 0;
        v14 = wcslen(v12);
        v15 = psz;
        do
        {
          v16 = *v15;
          ++v15;
        }
        while ( v16 );
        v17 = v15 - (psz + 1) + v14 + 2;
        lpszKey = malloc(2 * v17);
        swprintf_s(lpszKey, v17, L"%s\\%s", v27, psz);
        if ( v13 )
        {
          v18 = (v13 + 1);
          *v13 = 59;
        }
        else
        {
          v18 = &gszNullString;
        }
        v19 = lpszKey;
        v27 = v18;
        sub_F77AB0(&gKeyNameMap, &dwFileAttributes, lpszKey);
        v20 = dwFileAttributes;
        v21 = (dwFileAttributes ? *dwFileAttributes : 0);
        v22 = GetFileAttributesW(v21);
        if ( v22 != -1 && !(v22 & 0x10) )
          break;
        free(v19);
        if ( v20 )
        {
          if ( !InterlockedDecrement(&v20->m_RefCount) )
          {
            if ( v20->m_wstr )
            {
              SysFreeString(v20->m_wstr);
              v20->m_wstr = 0;
            }
            if ( v20->m_str )
            {
              j_j__free(v20->m_str);
              v20->m_str = 0;
            }
            j__free(v20);
          }
          dwFileAttributes = 0;
        }
        v12 = v27;
        if ( !*v27 )
          goto LABEL_42;
      }
      v24 = *a4;
      *a4 = _wcsdup(lpszKey);
      free(v24);
      free(lpszKey);
      _bstr_t::_Free(&dwFileAttributes);
      v8 = 1;
    }
    free(v10);
  }
  return v8;
}

//----- (00F813D0) --------------------------------------------------------
LSTATUS __cdecl PE_LoadKey(HKEY hKey, DWORD dwIndex, WCHAR **ppszKey)
{
  LSTATUS result; // eax
  DWORD v4; // eax
  size_t v5; // ebx
  WCHAR *v6; // eax
  DWORD cbMaxSubKeyLen; // [esp+0h] [ebp-4h]

  cbMaxSubKeyLen = 0;
  result = RegQueryInfoKeyW(hKey, 0, 0, 0, 0, &cbMaxSubKeyLen, 0, 0, 0, 0, 0, 0);
  if ( !result )
  {
    v4 = cbMaxSubKeyLen + 1;
    cbMaxSubKeyLen = v4;
    v5 = 2 * v4 + 2;
    v6 = realloc(*ppszKey, v5);
    *ppszKey = v6;
    if ( v6 )
      memset(v6, 0, v5);
    result = RegEnumKeyW(hKey, dwIndex, *ppszKey, cbMaxSubKeyLen);
  }
  return result;
}

//----- (00F81450) --------------------------------------------------------
LSTATUS __cdecl sub_F81450(HKEY hKey, DWORD dwIndex, int a3, LPDWORD lpReserved, LPDWORD lpType, int a6)
{
  LSTATUS result; // eax
  size_t v7; // esi
  void *v8; // eax
  size_t v9; // esi
  void *v10; // eax
  DWORD cbMaxValueLen; // [esp+0h] [ebp-8h]
  DWORD cbMaxValueNameLen; // [esp+4h] [ebp-4h]

  cbMaxValueNameLen = 0;
  cbMaxValueLen = 0;
  result = RegQueryInfoKeyW(hKey, 0, 0, 0, 0, 0, 0, 0, &cbMaxValueNameLen, &cbMaxValueLen, 0, 0);
  if ( !result )
  {
    v7 = 2 * (cbMaxValueNameLen++ + 1) + 2;
    v8 = realloc(*a3, v7);
    *a3 = v8;
    if ( v8 )
      memset(v8, 0, v7);
    v9 = 2 * (((cbMaxValueLen + 1) >> 1) + 1);
    v10 = realloc(*a6, 2 * (((cbMaxValueLen + 1) >> 1) + 1));
    *a6 = v10;
    if ( v10 )
      memset(v10, 0, v9);
    result = RegEnumValueW(hKey, dwIndex, *a3, &cbMaxValueNameLen, lpReserved, lpType, *a6, &cbMaxValueLen);
  }
  return result;
}

//----- (00F81520) --------------------------------------------------------
LSTATUS __cdecl sub_F81520(HKEY hKey, LPCWSTR lpValueName, LPDWORD lpReserved, LPDWORD lpType, int a5)
{
  LSTATUS result; // eax
  void *v6; // eax
  DWORD v7; // [esp+0h] [ebp-8h]
  DWORD cbData; // [esp+4h] [ebp-4h]

  cbData = 0;
  result = RegQueryValueExW(hKey, lpValueName, lpReserved, 0, 0, &cbData);
  if ( !result )
  {
    v7 = 2 * (((cbData + 1) >> 1) + 1);
    v6 = realloc(*a5, 2 * (((cbData + 1) >> 1) + 1));
    *a5 = v6;
    if ( v6 )
      memset(v6, 0, v7);
    result = RegQueryValueExW(hKey, lpValueName, lpReserved, lpType, *a5, &cbData);
  }
  return result;
}

//----- (00F815A0) --------------------------------------------------------
LSTATUS __cdecl sub_F815A0(HKEY hKey, LPCWSTR lpSubKey, int a3)
{
  LSTATUS result; // eax
  void *v4; // eax
  unsigned int v5; // [esp+0h] [ebp-8h]
  LONG cbData; // [esp+4h] [ebp-4h]

  cbData = 0;
  result = RegQueryValueW(hKey, lpSubKey, 0, &cbData);
  if ( !result )
  {
    v5 = 2 * (((cbData + 1) >> 1) + 1);
    v4 = realloc(*a3, 2 * (((cbData + 1) >> 1) + 1));
    *a3 = v4;
    if ( v4 )
      memset(v4, 0, v5);
    result = RegQueryValueW(hKey, lpSubKey, *a3, &cbData);
  }
  return result;
}

//----- (00F81610) --------------------------------------------------------
void *__cdecl sub_F81610(int a1, void *a2, wchar_t *psz)
{
  DWORD v3; // ebx
  wchar_t *v4; // eax
  wchar_t *v5; // eax
  WCHAR *v6; // eax
  _WORD *v7; // eax
  _WORD *v8; // eax
  _WORD *v9; // eax
  _WORD *v10; // eax
  _WORD *v11; // eax
  const wchar_t *v12; // eax
  const wchar_t *v13; // eax
  unsigned __int16 **v14; // esi
  unsigned __int16 **v15; // eax
  void *v16; // esi
  LSTATUS (__stdcall *v17)(HKEY, LPCWSTR, LPDWORD, LPDWORD, LPBYTE, LPDWORD); // esi
  LSTATUS v18; // eax
  void *v19; // esi
  WCHAR *v20; // eax
  const wchar_t **v21; // eax
  wchar_t *v22; // esi
  const wchar_t **v23; // eax
  void *v24; // esi
  HMODULE v25; // eax
  FARPROC v26; // eax
  size_t v27; // esi
  void *v28; // eax
  WCHAR *v29; // esi
  const wchar_t *v30; // eax
  const wchar_t *v31; // eax
  unsigned __int16 **v32; // esi
  unsigned __int16 **v33; // eax
  char v34; // bl
  const wchar_t *v35; // eax
  const wchar_t *v36; // eax
  unsigned __int16 **v37; // esi
  unsigned __int16 **v38; // eax
  const wchar_t *v39; // eax
  unsigned __int16 **v40; // eax
  BYTE v42; // [esp+10h] [ebp-2C4h]
  void *v43; // [esp+14h] [ebp-2C0h]
  BYTE v44[4]; // [esp+18h] [ebp-2BCh]
  BYTE Data[4]; // [esp+1Ch] [ebp-2B8h]
  WCHAR v46[2]; // [esp+20h] [ebp-2B4h]
  WCHAR *ppv; // [esp+24h] [ebp-2B0h]
  int a2a; // [esp+28h] [ebp-2ACh]
  WCHAR v49[2]; // [esp+2Ch] [ebp-2A8h]
  int v50; // [esp+30h] [ebp-2A4h]
  WCHAR *pszResult; // [esp+34h] [ebp-2A0h]
  WCHAR v52[2]; // [esp+38h] [ebp-29Ch]
  WCHAR v53[2]; // [esp+3Ch] [ebp-298h]
  WCHAR v54[2]; // [esp+40h] [ebp-294h]
  void *v55; // [esp+44h] [ebp-290h]
  void *v56; // [esp+48h] [ebp-28Ch]
  void *v57; // [esp+4Ch] [ebp-288h]
  void *v58; // [esp+50h] [ebp-284h]
  void *a1a; // [esp+54h] [ebp-280h]
  void *v60; // [esp+58h] [ebp-27Ch]
  void *ppv1; // [esp+5Ch] [ebp-278h]
  WCHAR szArg[2]; // [esp+60h] [ebp-274h]
  HKEY hRootKey; // [esp+64h] [ebp-270h]
  DWORD v64; // [esp+68h] [ebp-26Ch]
  LPCWSTR v65; // [esp+6Ch] [ebp-268h]
  WCHAR *pszText; // [esp+70h] [ebp-264h]
  LPCWSTR v67; // [esp+74h] [ebp-260h]
  LPCWSTR szArg3; // [esp+78h] [ebp-25Ch]
  WCHAR *ppv3; // [esp+7Ch] [ebp-258h]
  LPCWSTR v70; // [esp+80h] [ebp-254h]
  LPCWSTR v71; // [esp+84h] [ebp-250h]
  LPCWSTR v72; // [esp+88h] [ebp-24Ch]
  LPCWSTR szArg4; // [esp+8Ch] [ebp-248h]
  LPCWSTR v74; // [esp+90h] [ebp-244h]
  LPCWSTR v75; // [esp+94h] [ebp-240h]
  int v76; // [esp+98h] [ebp-23Ch]
  void *v77; // [esp+9Ch] [ebp-238h]
  wchar_t *v78; // [esp+A0h] [ebp-234h]
  void *v79; // [esp+A4h] [ebp-230h]
  HKEY v80; // [esp+A8h] [ebp-22Ch]
  DWORD cbData; // [esp+ACh] [ebp-228h]
  void *v82; // [esp+B0h] [ebp-224h]
  HKEY hKey; // [esp+B4h] [ebp-220h]
  wchar_t *ppszText2; // [esp+B8h] [ebp-21Ch]
  wchar_t Src; // [esp+BCh] [ebp-218h]
  int v86; // [esp+2D0h] [ebp-4h]

  v3 = 0;
  v76 = a1;
  v80 = a2;
  v64 = 0;
  v4 = malloc(2u);
  v78 = v4;
  *v4 = 0;
  v86 = 0;
  v5 = malloc(2u);
  ppszText2 = v5;
  *v5 = 0;
  v6 = malloc(2u);
  ppv3 = v6;
  *v6 = 0;
  v7 = malloc(2u);
  v79 = v7;
  *v7 = 0;
  v8 = malloc(2u);
  v60 = v8;
  *v8 = 0;
  v9 = malloc(2u);
  v82 = v9;
  *v9 = 0;
  v10 = malloc(2u);
  v58 = v10;
  *v10 = 0;
  v11 = malloc(2u);
  v77 = v11;
  *v11 = 0;
  v72 = _wcsdup(&gszNullString);
  v65 = _wcsdup(&gszNullString);
  v67 = _wcsdup(&gszNullString);
  v75 = _wcsdup(&gszNullString);
  v71 = _wcsdup(&gszNullString);
  v74 = _wcsdup(&gszNullString);
  szArg4 = _wcsdup(&gszNullString);
  v12 = &gszNullString;
  if ( psz )
    v12 = psz;
  pszText = _wcsdup(v12);
  v70 = _wcsdup(&gszNullString);
  v13 = &gszNullString;
  if ( psz )
    v13 = psz;
  szArg3 = _wcsdup(v13);
  LOBYTE(v86) = 17;
  v14 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
  LOBYTE(v86) = 18;
  v15 = sub_F77BE0(szArg, v80, &szArg3, &v70);
  LOBYTE(v86) = 19;
  v16 = sub_F73FF0(v76, 0, 0xFFFFFFFF, 0, v15, v14, &v74);
  ppv1 = v16;
  free(*szArg);
  free(a1a);
  free(szArg3);
  free(v70);
  free(pszText);
  free(szArg4);
  free(v74);
  free(v71);
  free(v75);
  free(v67);
  free(v65);
  LOBYTE(v86) = 7;
  free(v72);
  if ( !PE_OpenKey(ghLocalMachineKey, psz, 0, 0x20019u, &hRootKey) )
  {
    if ( !PE_LoadKey(hRootKey, 0, &ppszText2) )
    {
      v17 = RegQueryValueExW;
      do
      {
        if ( !PE_OpenKey(hRootKey, ppszText2, 0, 0x20019u, &hKey) )
        {
          cbData = 4;
          if ( !v17(hKey, L"Type", 0, 0, Data, &cbData) && *Data <= 2u )
          {
            cbData = 4;
            if ( !v17(hKey, L"Start", 0, 0, v44, &cbData) )
            {
              cbData = 4;
              if ( *v44 != 4 || !v17(hKey, L"AutorunsDisabled", 0, 0, &v42, &cbData) )
              {
                v18 = sub_F81520(hKey, L"ImagePath", 0, 0, &v78);
                v19 = v77;
                if ( v18 )
                {
                  v77 = _wcsdup(ppszText2);
                  free(v19);
                  v20 = PE_CopyString2(&pszResult, L"\\SystemRoot\\System32\\Drivers\\", &ppszText2);
                  v21 = PE_CopyString(&ppv, v20, L".sys");
                  v22 = v78;
                  v78 = _wcsdup(*v21);
                  free(v22);
                  free(ppv);
                  free(pszResult);
                }
                else
                {
                  v77 = _wcsdup(v78);
                  free(v19);
                }
                v23 = sub_F74F20(&v43, v76, v78);
                v24 = v79;
                v79 = _wcsdup(*v23);
                free(v24);
                free(v43);
                a2a = sub_F74ED0();
                sub_F81520(hKey, L"Description", 0, 0, &v82);
                if ( *v82 == 64 )
                {
                  v25 = LoadLibraryW(L"Advapi32.dll");
                  v26 = GetProcAddress(v25, "RegLoadMUIStringW");
                  dword_1064C4C = v26;
                  if ( v26 )
                  {
                    if ( !(v26)(hKey, L"Description", &Src, 260, &cbData, 0, 0) )
                    {
                      v27 = 2 * cbData + 4;
                      v28 = realloc(v82, v27);
                      v82 = v28;
                      if ( v28 )
                      {
                        memset(v28, 0, v27);
                        v28 = v82;
                      }
                      sub_F747C0(&Src, v28, cbData + 1);
                    }
                  }
                }
                v29 = ppv3;
                ppv3 = _wcsdup(ppszText2);
                free(v29);
                v30 = &gszNullString;
                if ( psz )
                  v30 = psz;
                v67 = _wcsdup(v30);
                v65 = _wcsdup(&gszNullString);
                v31 = &gszNullString;
                if ( psz )
                  v31 = psz;
                v72 = _wcsdup(v31);
                LOBYTE(v86) = 22;
                v32 = sub_F77BE0(v54, v80, &v67, &ppszText2);
                LOBYTE(v86) = 23;
                v33 = sub_F77BE0(v49, v80, &v72, &v65);
                LOBYTE(v86) = 24;
                v34 = sub_F73D40(v76, v33, v32, &ppv3, &v79, &v60, &v58, &v50);
                free(*v49);
                free(*v54);
                free(v72);
                free(v65);
                LOBYTE(v86) = 7;
                free(v67);
                if ( v34 )
                {
                  if ( ppv1 == -1 )
                  {
                    v57 = _wcsdup(&gszNullString);
                    v56 = _wcsdup(&gszNullString);
                    v55 = _wcsdup(&gszNullString);
                    szArg3 = _wcsdup(&gszNullString);
                    v70 = _wcsdup(&gszNullString);
                    pszText = _wcsdup(&gszNullString);
                    szArg4 = _wcsdup(&gszNullString);
                    v35 = &gszNullString;
                    if ( psz )
                      v35 = psz;
                    v74 = _wcsdup(v35);
                    v71 = _wcsdup(&gszNullString);
                    v36 = &gszNullString;
                    if ( psz )
                      v36 = psz;
                    v75 = _wcsdup(v36);
                    LOBYTE(v86) = 34;
                    v37 = sub_F77BE0(v52, v80, &v74, &szArg4);
                    LOBYTE(v86) = 35;
                    v38 = sub_F77BE0(v53, v80, &v75, &v71);
                    LOBYTE(v86) = 36;
                    ppv1 = sub_F73FF0(v76, 0, 0xFFFFFFFF, 0, v38, v37, &pszText);
                    free(*v53);
                    free(*v52);
                    free(v75);
                    free(v71);
                    free(v74);
                    free(szArg4);
                    free(pszText);
                    free(v70);
                    free(szArg3);
                    free(v55);
                    free(v56);
                    free(v57);
                  }
                  *szArg = _wcsdup(&gszNullString);
                  v39 = &gszNullString;
                  if ( psz )
                    v39 = psz;
                  a1a = _wcsdup(v39);
                  LOBYTE(v86) = 38;
                  v40 = sub_F77BE0(v46, v80, &a1a, &ppszText2);
                  LOBYTE(v86) = 39;
                  sub_F73FF0(v76, a2a, ppv1, 13, &ppv3, v40, &v79);
                  free(*v46);
                  free(a1a);
                  LOBYTE(v86) = 7;
                  free(*szArg);
                }
                v17 = RegQueryValueExW;
                v3 = v64;
              }
            }
          }
          RegCloseKey(hKey);
        }
        v64 = ++v3;
      }
      while ( !PE_LoadKey(hRootKey, v3, &ppszText2) );
      v16 = ppv1;
    }
    RegCloseKey(hRootKey);
  }
  free(v77);
  free(v58);
  free(v82);
  free(v60);
  free(v79);
  free(ppv3);
  free(ppszText2);
  free(v78);
  return v16;
}
// 1064C4C: using guessed type int dword_1064C4C;

//----- (00F82060) --------------------------------------------------------
void *__cdecl sub_F82060(int a1, int a2, int *a3)
{
  void *v3; // eax

  v3 = sub_F82090(a1, a2, *a3, 0xFFFFFFFF, 1);
  return sub_F82090(a1, a2, *a3, v3, 0);
}

//----- (00F82090) --------------------------------------------------------
void *__cdecl sub_F82090(int a1, int a2, int a3, void *a4, char a5)
{
  wchar_t *v5; // edi
  const wchar_t *v6; // ecx
  const WCHAR **v7; // eax
  wchar_t *v8; // esi
  WCHAR *v9; // eax
  const wchar_t **v10; // eax
  void *v11; // ebx
  WCHAR *v12; // ebx
  unsigned int v13; // eax
  void (__stdcall *v14)(HKEY); // esi
  WCHAR *v15; // ebx
  _WORD *v16; // eax
  WCHAR *v17; // eax
  WCHAR *v18; // esi
  _WORD *v19; // eax
  WCHAR *v20; // eax
  WCHAR *v21; // edi
  WCHAR *v22; // ebx
  LPCWSTR *v23; // eax
  unsigned __int16 **v24; // eax
  LPCWSTR *v25; // eax
  unsigned __int16 **v26; // eax
  WCHAR *v27; // ebx
  int v28; // ebx
  LPCWSTR *v29; // eax
  int v30; // ebx
  void **v31; // ebx
  void **v32; // esi
  unsigned int v33; // eax
  LSTATUS v34; // eax
  tagKeyName *v35; // esi
  unsigned int v36; // eax
  void *v37; // esi
  wchar_t *v38; // eax
  void *v39; // esi
  WCHAR *v40; // esi
  unsigned int v41; // eax
  LSTATUS v42; // eax
  int v43; // ebx
  tagKeyName *v44; // esi
  unsigned int v45; // eax
  WCHAR *v46; // eax
  LPCWSTR *v47; // eax
  unsigned __int16 **v48; // eax
  LPCWSTR *v49; // eax
  unsigned __int16 **v50; // eax
  wchar_t *v51; // esi
  const wchar_t **v52; // eax
  WCHAR *v53; // esi
  void **v54; // ecx
  const wchar_t **v55; // eax
  WCHAR *v56; // esi
  LPCWSTR *v57; // eax
  unsigned __int16 **v58; // eax
  LPCWSTR *v59; // eax
  unsigned __int16 **v60; // eax
  void *v61; // esi
  int v63; // [esp+10h] [ebp-118h]
  int a2a; // [esp+20h] [ebp-108h]
  HKEY v65; // [esp+24h] [ebp-104h]
  wchar_t *v66; // [esp+28h] [ebp-100h]
  WCHAR *v67; // [esp+2Ch] [ebp-FCh]
  int v68; // [esp+30h] [ebp-F8h]
  WCHAR *v69; // [esp+34h] [ebp-F4h]
  WCHAR *ppv1; // [esp+38h] [ebp-F0h]
  HKEY KeyHandle; // [esp+3Ch] [ebp-ECh]
  WCHAR *v72; // [esp+40h] [ebp-E8h]
  WCHAR *v73; // [esp+44h] [ebp-E4h]
  wchar_t *psz; // [esp+48h] [ebp-E0h]
  void *v75; // [esp+4Ch] [ebp-DCh]
  void *v76; // [esp+50h] [ebp-D8h]
  void **v77; // [esp+54h] [ebp-D4h]
  int v78; // [esp+58h] [ebp-D0h]
  WCHAR szText2[2]; // [esp+5Ch] [ebp-CCh]
  HKEY v80; // [esp+60h] [ebp-C8h]
  WCHAR *v81; // [esp+64h] [ebp-C4h]
  WCHAR *ppv3; // [esp+68h] [ebp-C0h]
  void *v83; // [esp+6Ch] [ebp-BCh]
  void *v84; // [esp+70h] [ebp-B8h]
  void *v85; // [esp+74h] [ebp-B4h]
  WCHAR v86[2]; // [esp+78h] [ebp-B0h]
  void *v87; // [esp+7Ch] [ebp-ACh]
  void *v88; // [esp+80h] [ebp-A8h]
  int a1a; // [esp+84h] [ebp-A4h]
  void *v90; // [esp+88h] [ebp-A0h]
  HKEY hRootKey; // [esp+8Ch] [ebp-9Ch]
  void *v92; // [esp+90h] [ebp-98h]
  HKEY__ v93; // [esp+94h] [ebp-94h]
  WCHAR *ppv; // [esp+98h] [ebp-90h]
  WCHAR *v95; // [esp+9Ch] [ebp-8Ch]
  WCHAR *v96; // [esp+A0h] [ebp-88h]
  WCHAR *v97; // [esp+A4h] [ebp-84h]
  void *v98; // [esp+A8h] [ebp-80h]
  WCHAR *v99; // [esp+ACh] [ebp-7Ch]
  HKEY__ v100; // [esp+B0h] [ebp-78h]
  WCHAR *v101; // [esp+B4h] [ebp-74h]
  WCHAR *v102; // [esp+B8h] [ebp-70h]
  WCHAR *v103; // [esp+BCh] [ebp-6Ch]
  HKEY__ v104; // [esp+C0h] [ebp-68h]
  HKEY hKey; // [esp+C4h] [ebp-64h]
  LPCWSTR lpAppName; // [esp+C8h] [ebp-60h]
  HKEY__ v107; // [esp+CCh] [ebp-5Ch]
  LPCWSTR v108; // [esp+D0h] [ebp-58h]
  WCHAR *v109; // [esp+D4h] [ebp-54h]
  LPCWSTR lpFileName; // [esp+D8h] [ebp-50h]
  WCHAR KeyName; // [esp+DCh] [ebp-4Ch]
  int v112; // [esp+124h] [ebp-4h]

  a1a = a1;
  hRootKey = a2;
  psz = a3;
  hKey = 0;
  v108 = malloc(2u);
  *v108 = 0;
  v112 = 0;
  v5 = malloc(2u);
  v66 = v5;
  *v5 = 0;
  v107.unused = malloc(2u);
  *v107.unused = 0;
  lpAppName = malloc(2u);
  *lpAppName = 0;
  *v86 = malloc(2u);
  **v86 = 0;
  *szText2 = malloc(2u);
  **szText2 = 0;
  v104.unused = malloc(2u);
  *v104.unused = 0;
  v93.unused = malloc(2u);
  *v93.unused = 0;
  v98 = malloc(2u);
  *v98 = 0;
  v88 = malloc(2u);
  *v88 = 0;
  v96 = malloc(2u);
  v103 = v96;
  *v96 = 0;
  v90 = malloc(2u);
  *v90 = 0;
  v6 = L"HKCU";
  LOBYTE(v112) = 11;
  if ( a2 != ghCurrentUserKey )
    v6 = L"HKLM";
  v7 = &gszNullString;
  if ( v6 )
    v7 = v6;
  v8 = _wcsdup(v7);
  v100.unused = v8;
  v9 = PE_CopyString(&ppv, &v100, L"\\");
  v10 = PE_CopyString(&v97, v9, psz);
  v11 = v107.unused;
  v107.unused = _wcsdup(*v10);
  free(v11);
  free(v97);
  free(ppv);
  free(v8);
  if ( a4 == -1 )
  {
    v102 = _wcsdup(&gszNullString);
    v101 = _wcsdup(&gszNullString);
    v95 = _wcsdup(&gszNullString);
    v99 = _wcsdup(&gszNullString);
    lpFileName = _wcsdup(&gszNullString);
    v109 = _wcsdup(&gszNullString);
    LOBYTE(v112) = 17;
    a4 = sub_F73FF0(a1a, 0, 0xFFFFFFFF, 0, &v107, &v107, &v109);
    free(v109);
    free(lpFileName);
    free(v99);
    free(v95);
    free(v101);
    LOBYTE(v112) = 11;
    free(v102);
  }
  v12 = _wcsdup(psz);
  v103 = v12;
  free(v96);
  if ( !a5 )
  {
    CopyStringToString(&v103, L"\\AutorunsDisabled", 0x7FFFFFFFu, 0);
    v12 = v103;
  }
  v13 = TlsGetValue(gdwTlsIndex);
  v14 = RegCloseKey;
  if ( !PE_OpenKey(hRootKey, v12, 0, v13 | 0x20019, &hKey) )
  {
    v100.unused = 0;
    if ( !sub_F81450(hKey, 0, &lpAppName, 0, 0, &v104) )
    {
      do
      {
        PE_CopyString(&lpFileName, &v104, L"\\Scripts.Ini");
        if ( GetFileAttributesW(lpFileName) == -1 )
        {
          LOBYTE(v112) = 11;
          free(lpFileName);
        }
        else
        {
          v15 = 0;
          while ( 1 )
          {
            v97 = v15;
            _swprintf(&KeyName, L"%dCmdLine", v15);
            v16 = malloc(2u);
            *v16 = 0;
            v17 = realloc(v16, 0x412u);
            v18 = v17;
            ppv = v17;
            if ( v17 )
              memset(v17, 0, 0x412u);
            v84 = GetPrivateProfileStringW(lpAppName, &KeyName, &gszNullString, v18, 0x208u, lpFileName);
            if ( !v84 )
              break;
            _swprintf(&KeyName, L"%dParameters", v15);
            v19 = malloc(2u);
            *v19 = 0;
            v20 = realloc(v19, 0x412u);
            v21 = v20;
            ppv3 = v20;
            if ( v20 )
              memset(v20, 0, 0x412u);
            GetPrivateProfileStringW(lpAppName, &KeyName, &gszNullString, v21, 0x208u, lpFileName);
            if ( v84 > 2 && (!wcsncmp(v18, L"\\\\", 2u) || v18[1] == 58) )
            {
              v22 = v108;
              v108 = _wcsdup(v18);
              free(v22);
            }
            else
            {
              v23 = PE_CopyString(&v72, &v104, L"\\");
              v24 = PE_CopyStringEx(&ppv1, v23, &lpAppName);
              v25 = PE_CopyString(&v73, v24, L"\\");
              v26 = PE_CopyStringEx(&v67, v25, &ppv);
              v27 = v108;
              v108 = _wcsdup(*v26);
              free(v27);
              free(v67);
              free(v73);
              free(ppv1);
              free(v72);
            }
            if ( GetFileAttributesW(v108) == -1 )
            {
              free(v21);
              free(v18);
              v15 = (v97 + 1);
            }
            else
            {
              v75 = malloc(2u);
              *v75 = 0;
              v76 = 0;
              v77 = 0;
              v78 = 0;
              LOBYTE(v112) = 21;
              sub_F77040(v108, &v75);
              v28 = a1a;
              sub_F74EE0(&v109, a1a, &v75, 0);
              LOBYTE(v112) = 22;
              v84 = sub_F74ED0();
              v29 = PE_CopyString(&v69, &v108, L" ");
              PE_CopyStringEx(&v96, v29, &ppv3);
              free(v69);
              v102 = _wcsdup(&KeyName);
              LOBYTE(v112) = 24;
              LOBYTE(v28) = sub_F73D40(v28, &v107, &v102, &v96, &v109, &v98, &v90, &v68);
              free(v102);
              if ( v28 )
              {
                if ( a4 == -1 )
                {
                  v85 = _wcsdup(&gszNullString);
                  v83 = _wcsdup(&gszNullString);
                  v87 = _wcsdup(&gszNullString);
                  v99 = _wcsdup(&gszNullString);
                  v95 = _wcsdup(&gszNullString);
                  v101 = _wcsdup(&gszNullString);
                  v30 = a1a;
                  LOBYTE(v112) = 30;
                  a4 = sub_F73FF0(a1a, 0, 0xFFFFFFFF, 0, &v107, &v107, &v101);
                  free(v101);
                  free(v95);
                  free(v99);
                  free(v87);
                  free(v83);
                  free(v85);
                }
                else
                {
                  v30 = a1a;
                }
                v92 = _wcsdup(&gszNullString);
                v81 = _wcsdup(&KeyName);
                LOBYTE(v112) = 32;
                sub_F73FF0(v30, v84, a4, 10, &v81, &v108, &v109);
                free(v81);
                free(v92);
              }
              free(v96);
              free(v109);
              v31 = v76;
              if ( v76 )
              {
                if ( v76 != v77 )
                {
                  v32 = v77;
                  do
                  {
                    free(*v31);
                    ++v31;
                  }
                  while ( v31 != v32 );
                  v31 = v76;
                  v18 = ppv;
                }
                j__free(v31);
                v76 = 0;
                v77 = 0;
                v78 = 0;
              }
              free(v75);
              free(v21);
              free(v18);
              v15 = (v97 + 1);
            }
          }
          free(v18);
          LOBYTE(v112) = 11;
          free(lpFileName);
        }
        ++v100.unused;
      }
      while ( !sub_F81450(hKey, v100.unused, &lpAppName, 0, 0, &v104) );
      v12 = v103;
      v5 = v66;
      v14 = RegCloseKey;
    }
    v14(hKey);
  }
  v33 = TlsGetValue(gdwTlsIndex);
  if ( PE_OpenKey(hRootKey, psz, 0, v33 | 0x20019, &hKey) )
    goto LABEL_74;
  v87 = 0;
  v34 = PE_LoadKey(hKey, 0, &lpAppName);
  if ( v34 == 259 )
    goto LABEL_73;
  while ( !v34 )
  {
    v35 = lpAppName;
    v36 = TlsGetValue(gdwTlsIndex);
    if ( !PE_OpenKey(hKey, v35, 0, v36 | 0x20019, &KeyHandle) )
    {
      v109 = malloc(2u);
      *v109 = 0;
      LOBYTE(v112) = 33;
      if ( sub_F81520(KeyHandle, L"DisplayName", 0, 0, &v109) )
        goto LABEL_69;
      v37 = v93.unused;
      v93.unused = _wcsdup(&gszNullString);
      free(v37);
      sub_F81520(KeyHandle, L"FileSysPath", 0, 0, &v93);
      v38 = wcsrchr(psz, 0x5Cu);
      v39 = *szText2;
      *szText2 = _wcsdup(v38);
      free(v39);
      v40 = v12;
      v12 = _wcsdup(lpAppName);
      v103 = v12;
      free(v40);
      if ( !a5 )
      {
        CopyStringToString(&v103, L"\\AutorunsDisabled", 0x7FFFFFFFu, 0);
        v12 = v103;
      }
      v41 = TlsGetValue(gdwTlsIndex);
      if ( !PE_OpenKey(hKey, v12, 0, v41 | 0x20019, &v80) )
      {
        v83 = 0;
        v42 = PE_LoadKey(v80, 0, v86);
        if ( v42 != 259 )
        {
          v43 = a1a;
          do
          {
            if ( v42 )
              break;
            v44 = *v86;
            v45 = TlsGetValue(gdwTlsIndex);
            if ( !PE_OpenKey(v80, v44, 0, v45 | 0x20019, &v65) )
            {
              if ( !sub_F81520(v65, L"Script", 0, 0, &v108) )
              {
                lpFileName = malloc(2u);
                *lpFileName = 0;
                if ( *v93.unused && *v108 != 92 && v108[1] != 58 )
                {
                  v46 = PE_CopyString(&v73, &v93, L"\\");
                  v47 = PE_CopyString(&ppv1, v46, L"Scripts");
                  v48 = PE_CopyStringEx(&v72, v47, szText2);
                  v49 = PE_CopyString(&ppv3, v48, L"\\");
                  v50 = PE_CopyStringEx(&v69, v49, &v108);
                  v51 = v5;
                  v5 = _wcsdup(*v50);
                  v66 = v5;
                  free(v51);
                  free(v69);
                  free(ppv3);
                  free(v72);
                  free(ppv1);
                  free(v73);
                  sub_F72170(&v63);
                  LOBYTE(v112) = 35;
                  sub_F77040(v5, &v63);
                  v52 = sub_F74EE0(&v67, v43, &v63, 0);
                  v53 = lpFileName;
                  lpFileName = _wcsdup(*v52);
                  free(v53);
                  free(v67);
                  v54 = &v63;
                }
                else
                {
                  v75 = malloc(2u);
                  *v75 = 0;
                  v76 = 0;
                  v77 = 0;
                  v78 = 0;
                  LOBYTE(v112) = 36;
                  sub_F77040(v108, &v75);
                  v55 = sub_F74EE0(&v84, v43, &v75, 0);
                  v56 = lpFileName;
                  lpFileName = _wcsdup(*v55);
                  free(v56);
                  free(v84);
                  v54 = &v75;
                }
                LOBYTE(v112) = 34;
                sub_F721F0(v54);
                a2a = sub_F74ED0();
                v57 = PE_CopyString(&v99, &v107, L"\\");
                v58 = PE_CopyStringEx(&v95, v57, &lpAppName);
                v59 = PE_CopyString(&v101, v58, L"\\");
                v60 = PE_CopyStringEx(&v102, v59, v86);
                v61 = v104.unused;
                v104.unused = _wcsdup(*v60);
                free(v61);
                free(v102);
                free(v101);
                free(v95);
                free(v99);
                if ( sub_F73D40(v43, &v107, &v104, &v109, &lpFileName, &v98, &v90, &v68) )
                {
                  if ( a4 == -1 )
                  {
                    v92 = _wcsdup(&gszNullString);
                    v96 = _wcsdup(&gszNullString);
                    ppv = _wcsdup(&gszNullString);
                    v97 = _wcsdup(&gszNullString);
                    v100.unused = _wcsdup(&gszNullString);
                    hRootKey = _wcsdup(&gszNullString);
                    LOBYTE(v112) = 42;
                    a4 = sub_F73FF0(v43, 0, 0xFFFFFFFF, 0, &v107, &v107, &hRootKey);
                    free(hRootKey);
                    free(v100.unused);
                    free(v97);
                    free(ppv);
                    free(v96);
                    free(v92);
                  }
                  v85 = _wcsdup(&gszNullString);
                  v81 = _wcsdup(&gszNullString);
                  LOBYTE(v112) = 44;
                  sub_F73FF0(v43, a2a, a4, 3, &v109, &v104, &lpFileName);
                  free(v81);
                  free(v85);
                }
                LOBYTE(v112) = 33;
                free(lpFileName);
              }
              RegCloseKey(v65);
            }
            v83 = v83 + 1;
            v42 = PE_LoadKey(v80, v83, v86);
          }
          while ( v42 != 259 );
          v12 = v103;
        }
        RegCloseKey(v80);
LABEL_69:
        RegCloseKey(KeyHandle);
      }
      LOBYTE(v112) = 11;
      free(v109);
    }
    v87 = v87 + 1;
    v34 = PE_LoadKey(hKey, v87, &lpAppName);
    if ( v34 == 259 )
      break;
  }
  v14 = RegCloseKey;
LABEL_73:
  v14(hKey);
LABEL_74:
  free(v90);
  free(v12);
  free(v88);
  free(v98);
  free(v93.unused);
  free(v104.unused);
  free(*szText2);
  free(*v86);
  free(lpAppName);
  free(v107.unused);
  free(v5);
  free(v108);
  return a4;
}

//----- (00F83070) --------------------------------------------------------
unsigned __int16 **__cdecl PE_CopyStringEx(WCHAR **ppv, LPCWSTR *lpszText1, LPCWSTR *lpszText2)
{
  *ppv = _wcsdup(*lpszText1);
  CopyStringToString(ppv, *lpszText2, -0x80000001, 0);
  return ppv;
}

//----- (00F830B0) --------------------------------------------------------
void __cdecl sub_F830B0(int a1, void *a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F83160(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F83160(a1, a2, v7, v5);
  free(v7);
}

//----- (00F83160) --------------------------------------------------------
void *__cdecl sub_F83160(int a1, void *a2, wchar_t *psz, void *a4)
{
  const wchar_t *v4; // eax
  const wchar_t *v5; // eax
  unsigned __int16 **v6; // esi
  unsigned __int16 **v7; // eax
  unsigned int v8; // eax
  void (__stdcall *v9)(HKEY); // ebx
  tagKeyName *v10; // esi
  unsigned int v11; // eax
  WCHAR *v12; // eax
  const wchar_t **v13; // eax
  WCHAR *v14; // esi
  const wchar_t **v15; // eax
  WCHAR *v16; // esi
  tagKeyName *v17; // esi
  unsigned int v18; // eax
  WCHAR *v19; // esi
  const wchar_t **v20; // eax
  WCHAR *v21; // esi
  const wchar_t *v22; // ecx
  const wchar_t *v23; // eax
  unsigned __int16 **v24; // esi
  unsigned __int16 **v25; // eax
  char v26; // bl
  const wchar_t *v27; // eax
  const wchar_t *v28; // eax
  HKEY v29; // ebx
  unsigned __int16 **v30; // esi
  unsigned __int16 **v31; // eax
  const wchar_t *v32; // eax
  unsigned __int16 **v33; // eax
  DWORD v34; // esi
  int v36; // [esp+10h] [ebp-B0h]
  int v37; // [esp+14h] [ebp-ACh]
  int v38; // [esp+18h] [ebp-A8h]
  int v39; // [esp+1Ch] [ebp-A4h]
  WCHAR *v40; // [esp+20h] [ebp-A0h]
  WCHAR v41[2]; // [esp+24h] [ebp-9Ch]
  WCHAR v42[2]; // [esp+28h] [ebp-98h]
  WCHAR *ppv; // [esp+2Ch] [ebp-94h]
  WCHAR v44[2]; // [esp+30h] [ebp-90h]
  int v45; // [esp+34h] [ebp-8Ch]
  void *v46; // [esp+38h] [ebp-88h]
  WCHAR v47[2]; // [esp+3Ch] [ebp-84h]
  WCHAR v48[2]; // [esp+40h] [ebp-80h]
  WCHAR *pszResult; // [esp+44h] [ebp-7Ch]
  void *v50; // [esp+48h] [ebp-78h]
  int a2a; // [esp+4Ch] [ebp-74h]
  LPCWSTR v52; // [esp+50h] [ebp-70h]
  void *v53; // [esp+54h] [ebp-6Ch]
  LPCWSTR v54; // [esp+58h] [ebp-68h]
  void *v55; // [esp+5Ch] [ebp-64h]
  LPCWSTR v56; // [esp+60h] [ebp-60h]
  LPCWSTR v57; // [esp+64h] [ebp-5Ch]
  void *v58; // [esp+68h] [ebp-58h]
  void *v59; // [esp+6Ch] [ebp-54h]
  void *v60; // [esp+70h] [ebp-50h]
  void *v61; // [esp+74h] [ebp-4Ch]
  void *v62; // [esp+78h] [ebp-48h]
  HKEY KeyHandle; // [esp+7Ch] [ebp-44h]
  void *a1a; // [esp+80h] [ebp-40h]
  WCHAR szArg[2]; // [esp+84h] [ebp-3Ch]
  void *v66; // [esp+88h] [ebp-38h]
  LPCWSTR v67; // [esp+8Ch] [ebp-34h]
  LPCWSTR szArg3; // [esp+90h] [ebp-30h]
  LPCWSTR v69; // [esp+94h] [ebp-2Ch]
  LPCWSTR v70; // [esp+98h] [ebp-28h]
  HKEY hKey; // [esp+9Ch] [ebp-24h]
  WCHAR *pszText; // [esp+A0h] [ebp-20h]
  WCHAR *ppszText2; // [esp+A4h] [ebp-1Ch]
  LPCWSTR szArg4; // [esp+A8h] [ebp-18h]
  LPCWSTR lpszKeyName; // [esp+ACh] [ebp-14h]
  LPCWSTR v76; // [esp+B0h] [ebp-10h]
  int v77; // [esp+BCh] [ebp-4h]

  v66 = malloc(2u);
  *v66 = 0;
  v77 = 0;
  v62 = malloc(2u);
  *v62 = 0;
  v61 = malloc(2u);
  *v61 = 0;
  LOBYTE(v77) = 2;
  if ( a4 == -1 )
  {
    v67 = _wcsdup(&gszNullString);
    v69 = _wcsdup(&gszNullString);
    szArg3 = _wcsdup(&gszNullString);
    v70 = _wcsdup(&gszNullString);
    v76 = _wcsdup(&gszNullString);
    lpszKeyName = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v4 = &gszNullString;
    if ( psz )
      v4 = psz;
    pszText = _wcsdup(v4);
    ppszText2 = _wcsdup(&gszNullString);
    v5 = &gszNullString;
    if ( psz )
      v5 = psz;
    hKey = _wcsdup(v5);
    LOBYTE(v77) = 12;
    v6 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v77) = 13;
    v7 = sub_F77BE0(szArg, a2, &hKey, &ppszText2);
    LOBYTE(v77) = 14;
    a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v7, v6, &lpszKeyName);
    free(*szArg);
    free(a1a);
    free(hKey);
    free(ppszText2);
    free(pszText);
    free(szArg4);
    free(lpszKeyName);
    free(v76);
    free(v70);
    free(szArg3);
    free(v69);
    LOBYTE(v77) = 2;
    free(v67);
  }
  v8 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, psz, 0, v8 | 0x20019, &KeyHandle) )
  {
    *szArg = 0;
    lpszKeyName = malloc(2u);
    *lpszKeyName = 0;
    ppszText2 = malloc(2u);
    *ppszText2 = 0;
    v76 = malloc(2u);
    *v76 = 0;
    szArg4 = malloc(2u);
    *szArg4 = 0;
    pszText = malloc(2u);
    *pszText = 0;
    LOBYTE(v77) = 19;
    v9 = RegCloseKey;
    if ( !PE_LoadKey(KeyHandle, 0, &lpszKeyName) )
    {
      do
      {
        v10 = lpszKeyName;
        v11 = TlsGetValue(gdwTlsIndex);
        if ( !PE_OpenKey(KeyHandle, v10, 0, v11 | 0x20019, &hKey) )
        {
          if ( sub_F81520(hKey, L"CLSID", 0, 0, &ppszText2) )
          {
            v9(hKey);
          }
          else
          {
            v9(hKey);
            v12 = PE_CopyString2(&pszResult, L"CLSID\\", &ppszText2);
            v13 = PE_CopyString(&ppv, v12, L"\\InprocServer32");
            v14 = v76;
            v76 = _wcsdup(*v13);
            free(v14);
            free(ppv);
            free(pszResult);
            v15 = PE_CopyString2(&v40, L"HKCR\\CLSID\\", &ppszText2);
            v16 = pszText;
            pszText = _wcsdup(*v15);
            free(v16);
            free(v40);
            v17 = v76;
            v18 = TlsGetValue(gdwTlsIndex);
            if ( !PE_OpenKey(HKEY_CLASSES_ROOT, v17, 0, v18 | KEY_READ, &hKey) )
            {
              v19 = v76;
              v76 = _wcsdup(&gszNullString);
              free(v19);
              sub_F81520(hKey, &gszNullString, 0, 0, &v76);
              v9(hKey);
              if ( wcslen(v76) )
              {
                v36 = malloc(2u);
                *v36 = 0;
                v37 = 0;
                v38 = 0;
                v39 = 0;
                LOBYTE(v77) = 20;
                sub_F77040(v76, &v36);
                v20 = sub_F74EE0(&v46, a1, &v36, 0);
                v21 = szArg4;
                szArg4 = _wcsdup(*v20);
                free(v21);
                free(v46);
                a2a = sub_F74ED0();
                v22 = &gszNullString;
                if ( psz )
                  v22 = psz;
                szArg3 = _wcsdup(v22);
                v69 = _wcsdup(&gszNullString);
                v23 = &gszNullString;
                if ( psz )
                  v23 = psz;
                v67 = _wcsdup(v23);
                LOBYTE(v77) = 23;
                v24 = sub_F77BE0(v44, a2, &szArg3, &lpszKeyName);
                LOBYTE(v77) = 24;
                v25 = sub_F77BE0(v42, a2, &v67, &v69);
                LOBYTE(v77) = 25;
                v26 = sub_F73D40(a1, &lpszKeyName, v25, v24, &szArg4, &v66, &v61, &v45);
                free(*v42);
                free(*v44);
                free(v67);
                free(v69);
                free(szArg3);
                if ( v26 )
                {
                  if ( a4 == -1 )
                  {
                    v58 = _wcsdup(&gszNullString);
                    v59 = _wcsdup(&gszNullString);
                    v55 = _wcsdup(&gszNullString);
                    v53 = _wcsdup(&gszNullString);
                    v60 = _wcsdup(&gszNullString);
                    v50 = _wcsdup(&gszNullString);
                    v52 = _wcsdup(&gszNullString);
                    v27 = &gszNullString;
                    if ( psz )
                      v27 = psz;
                    v54 = _wcsdup(v27);
                    v57 = _wcsdup(&gszNullString);
                    v28 = &gszNullString;
                    if ( psz )
                      v28 = psz;
                    v70 = _wcsdup(v28);
                    v29 = a2;
                    LOBYTE(v77) = 35;
                    v30 = sub_F77BE0(v47, a2, &v54, &v52);
                    LOBYTE(v77) = 36;
                    v31 = sub_F77BE0(v48, a2, &v70, &v57);
                    LOBYTE(v77) = 37;
                    a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v31, v30, &v50);
                    free(*v48);
                    free(*v47);
                    free(v70);
                    free(v57);
                    free(v54);
                    free(v52);
                    free(v50);
                    free(v60);
                    free(v53);
                    free(v55);
                    free(v59);
                    free(v58);
                  }
                  else
                  {
                    v29 = a2;
                  }
                  a1a = _wcsdup(&gszNullString);
                  v32 = &gszNullString;
                  if ( psz )
                    v32 = psz;
                  v56 = _wcsdup(v32);
                  LOBYTE(v77) = 39;
                  v33 = sub_F77BE0(v41, v29, &v56, &lpszKeyName);
                  LOBYTE(v77) = 40;
                  sub_F73FF0(a1, a2a, a4, 3, &lpszKeyName, v33, &szArg4);
                  free(*v41);
                  free(v56);
                  free(a1a);
                }
                sub_F721F0(&v36);
                free(pszText);
                free(szArg4);
                free(v76);
                free(ppszText2);
                free(lpszKeyName);
                v9 = RegCloseKey;
                goto LABEL_31;
              }
            }
          }
        }
        free(pszText);
        free(szArg4);
        free(v76);
        free(ppszText2);
        free(lpszKeyName);
LABEL_31:
        v34 = ++*szArg;
        lpszKeyName = malloc(2u);
        *lpszKeyName = 0;
        ppszText2 = malloc(2u);
        *ppszText2 = 0;
        v76 = malloc(2u);
        *v76 = 0;
        szArg4 = malloc(2u);
        *szArg4 = 0;
        pszText = malloc(2u);
        *pszText = 0;
        LOBYTE(v77) = 19;
      }
      while ( !PE_LoadKey(KeyHandle, v34, &lpszKeyName) );
    }
    free(pszText);
    free(szArg4);
    free(v76);
    free(ppszText2);
    free(lpszKeyName);
    v9(KeyHandle);
  }
  free(v61);
  free(v62);
  free(v66);
  return a4;
}

//----- (00F839D0) --------------------------------------------------------
void __cdecl sub_F839D0(int a1, void *a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F83A80(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F83A80(a1, a2, v7, v5);
  free(v7);
}

//----- (00F83A80) --------------------------------------------------------
void *__cdecl sub_F83A80(int a1, void *a2, wchar_t *psz, void *a4)
{
  DWORD v4; // ebx
  _WORD *v5; // esi
  tagKeyName *v6; // edi
  const wchar_t *v7; // eax
  const wchar_t *v8; // eax
  unsigned __int16 **v9; // edi
  unsigned __int16 **v10; // eax
  unsigned int v11; // eax
  void *v12; // esi
  tagKeyName *v13; // edi
  unsigned int v14; // eax
  const wchar_t **v15; // eax
  void *v16; // edi
  int v17; // eax
  const wchar_t *v18; // ecx
  const wchar_t *v19; // eax
  unsigned __int16 **v20; // edi
  unsigned __int16 **v21; // eax
  char v22; // bl
  wchar_t *v23; // ebx
  const wchar_t *v24; // eax
  const wchar_t *v25; // eax
  unsigned __int16 **v26; // edi
  unsigned __int16 **v27; // eax
  const WCHAR **v28; // eax
  unsigned __int16 **v29; // eax
  int a2a; // [esp+10h] [ebp-A0h]
  int v32; // [esp+14h] [ebp-9Ch]
  int v33; // [esp+18h] [ebp-98h]
  int v34; // [esp+1Ch] [ebp-94h]
  WCHAR v35[2]; // [esp+20h] [ebp-90h]
  _WORD *v36; // [esp+24h] [ebp-8Ch]
  WCHAR v37[2]; // [esp+28h] [ebp-88h]
  WCHAR v38[2]; // [esp+2Ch] [ebp-84h]
  void *v39; // [esp+30h] [ebp-80h]
  int v40; // [esp+34h] [ebp-7Ch]
  WCHAR v41[2]; // [esp+38h] [ebp-78h]
  int v42; // [esp+3Ch] [ebp-74h]
  WCHAR v43[2]; // [esp+40h] [ebp-70h]
  HKEY hKey; // [esp+44h] [ebp-6Ch]
  void *v45; // [esp+48h] [ebp-68h]
  LPCWSTR v46; // [esp+4Ch] [ebp-64h]
  void *v47; // [esp+50h] [ebp-60h]
  std__List *v48; // [esp+54h] [ebp-5Ch]
  void *v49; // [esp+58h] [ebp-58h]
  DWORD v50; // [esp+5Ch] [ebp-54h]
  void *v51; // [esp+60h] [ebp-50h]
  void *v52; // [esp+64h] [ebp-4Ch]
  void *a1a; // [esp+68h] [ebp-48h]
  HKEY KeyHandle; // [esp+6Ch] [ebp-44h]
  WCHAR szArg[2]; // [esp+70h] [ebp-40h]
  LPCWSTR v56; // [esp+74h] [ebp-3Ch]
  LPCWSTR v57; // [esp+78h] [ebp-38h]
  LPCWSTR v58; // [esp+7Ch] [ebp-34h]
  LPCWSTR v59; // [esp+80h] [ebp-30h]
  LPCWSTR v60; // [esp+84h] [ebp-2Ch]
  LPCWSTR szArg3; // [esp+88h] [ebp-28h]
  LPCWSTR v62; // [esp+8Ch] [ebp-24h]
  WCHAR *pszText; // [esp+90h] [ebp-20h]
  LPCWSTR szArg4; // [esp+94h] [ebp-1Ch]
  LPCWSTR v65; // [esp+98h] [ebp-18h]
  void *v66; // [esp+9Ch] [ebp-14h]
  LPCWSTR lpszKeyName; // [esp+A0h] [ebp-10h]
  int v68; // [esp+ACh] [ebp-4h]

  v4 = 0;
  v50 = 0;
  v48 = malloc(2u);
  LOWORD(v48->_Mypair._Myval2._Myhead) = 0;
  v68 = 0;
  lpszKeyName = malloc(2u);
  *lpszKeyName = 0;
  v5 = malloc(2u);
  v36 = v5;
  *v5 = 0;
  v66 = malloc(2u);
  *v66 = 0;
  v52 = malloc(2u);
  *v52 = 0;
  v51 = malloc(2u);
  *v51 = 0;
  v49 = malloc(2u);
  *v49 = 0;
  v6 = psz;
  LOBYTE(v68) = 6;
  if ( a4 == -1 )
  {
    v59 = _wcsdup(&gszNullString);
    v65 = _wcsdup(&gszNullString);
    v56 = _wcsdup(&gszNullString);
    v58 = _wcsdup(&gszNullString);
    v60 = _wcsdup(&gszNullString);
    v62 = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v7 = &gszNullString;
    if ( psz )
      v7 = psz;
    pszText = _wcsdup(v7);
    v57 = _wcsdup(&gszNullString);
    v8 = &gszNullString;
    if ( psz )
      v8 = psz;
    szArg3 = _wcsdup(v8);
    LOBYTE(v68) = 16;
    v9 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v68) = 17;
    v10 = sub_F77BE0(szArg, a2, &szArg3, &v57);
    LOBYTE(v68) = 18;
    a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v10, v9, &v62);
    free(*szArg);
    free(a1a);
    free(szArg3);
    free(v57);
    free(pszText);
    free(szArg4);
    free(v62);
    free(v60);
    free(v58);
    free(v56);
    free(v65);
    LOBYTE(v68) = 6;
    free(v59);
    v6 = psz;
  }
  v11 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, v6, 0, v11 | 0x20019, &KeyHandle) )
  {
    if ( !PE_LoadKey(KeyHandle, 0, &lpszKeyName) )
    {
      v12 = a4;
      do
      {
        v13 = lpszKeyName;
        v14 = TlsGetValue(gdwTlsIndex);
        if ( !PE_OpenKey(KeyHandle, v13, 0, v14 | 0x20019, &hKey) )
        {
          if ( !sub_F81520(hKey, L"Source", 0, 0, &v48) )
          {
            a2a = malloc(2u);
            *a2a = 0;
            v32 = 0;
            v33 = 0;
            v34 = 0;
            LOBYTE(v68) = 19;
            if ( sub_F76CC0(v48, &a2a) )
            {
              v15 = sub_F74EE0(&v39, a1, &a2a, 0);
              v16 = v66;
              v66 = _wcsdup(*v15);
              free(v16);
              free(v39);
              v17 = sub_F74ED0();
              v18 = &gszNullString;
              v40 = v17;
              if ( psz )
                v18 = psz;
              v65 = _wcsdup(v18);
              v59 = _wcsdup(&gszNullString);
              v19 = &gszNullString;
              if ( psz )
                v19 = psz;
              a4 = _wcsdup(v19);
              LOBYTE(v68) = 22;
              v20 = sub_F77BE0(v37, a2, &v65, &lpszKeyName);
              LOBYTE(v68) = 23;
              v21 = sub_F77BE0(v41, a2, &a4, &v59);
              LOBYTE(v68) = 24;
              v22 = sub_F73D40(a1, &lpszKeyName, v21, v20, &v66, &v52, &v49, &v42);
              free(*v41);
              free(*v37);
              free(a4);
              free(v59);
              free(v65);
              if ( v22 )
              {
                if ( v12 == -1 )
                {
                  v45 = _wcsdup(&gszNullString);
                  v47 = _wcsdup(&gszNullString);
                  szArg3 = _wcsdup(&gszNullString);
                  v57 = _wcsdup(&gszNullString);
                  pszText = _wcsdup(&gszNullString);
                  szArg4 = _wcsdup(&gszNullString);
                  v62 = _wcsdup(&gszNullString);
                  v23 = psz;
                  v24 = &gszNullString;
                  if ( psz )
                    v24 = psz;
                  v60 = _wcsdup(v24);
                  v58 = _wcsdup(&gszNullString);
                  v25 = &gszNullString;
                  if ( psz )
                    v25 = psz;
                  v56 = _wcsdup(v25);
                  LOBYTE(v68) = 34;
                  v26 = sub_F77BE0(v35, a2, &v60, &v62);
                  LOBYTE(v68) = 35;
                  v27 = sub_F77BE0(v43, a2, &v56, &v58);
                  LOBYTE(v68) = 36;
                  v12 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v27, v26, &szArg4);
                  free(*v43);
                  free(*v35);
                  free(v56);
                  free(v58);
                  free(v60);
                  free(v62);
                  free(szArg4);
                  free(pszText);
                  free(v57);
                  free(szArg3);
                  free(v47);
                  free(v45);
                }
                else
                {
                  v23 = psz;
                }
                *szArg = _wcsdup(&gszNullString);
                a1a = _wcsdup(&gszNullString);
                v28 = &gszNullString;
                if ( v23 )
                  v28 = v23;
                v46 = _wcsdup(v28);
                LOBYTE(v68) = 39;
                v29 = sub_F77BE0(v38, a2, &v46, &lpszKeyName);
                LOBYTE(v68) = 40;
                sub_F73FF0(a1, v40, v12, 3, &lpszKeyName, v29, &v66);
                free(*v38);
                free(v46);
                free(a1a);
                free(*szArg);
              }
              v4 = v50;
            }
            LOBYTE(v68) = 6;
            sub_F721F0(&a2a);
          }
          RegCloseKey(hKey);
        }
        v50 = ++v4;
      }
      while ( !PE_LoadKey(KeyHandle, v4, &lpszKeyName) );
      a4 = v12;
      v5 = v36;
    }
    RegCloseKey(KeyHandle);
  }
  free(v49);
  free(v51);
  free(v52);
  free(v66);
  free(v5);
  free(lpszKeyName);
  free(v48);
  return a4;
}

//----- (00F84150) --------------------------------------------------------
void __cdecl sub_F84150(int a1, void *a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F84200(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F84200(a1, a2, v7, v5);
  free(v7);
}

//----- (00F84200) --------------------------------------------------------
void *__cdecl sub_F84200(int a1, void *a2, wchar_t *psz, void *a4)
{
  wchar_t *v4; // edi
  const wchar_t *v5; // eax
  const wchar_t *v6; // eax
  unsigned __int16 **v7; // esi
  unsigned __int16 **v8; // eax
  unsigned int v9; // eax
  void (__stdcall *v10)(HKEY); // ebx
  tagKeyName *v11; // esi
  unsigned int v12; // eax
  wchar_t *v13; // ebx
  UINT v14; // edi
  wchar_t *v15; // eax
  const wchar_t **v16; // eax
  wchar_t *v17; // esi
  HMODULE v18; // ebx
  wchar_t *v19; // edi
  LSTATUS v20; // eax
  WCHAR *v21; // eax
  const wchar_t **v22; // eax
  WCHAR *v23; // esi
  tagKeyName *v24; // esi
  unsigned int v25; // eax
  DWORD v26; // esi
  WCHAR *v28; // esi
  const wchar_t *v29; // eax
  void *v30; // esi
  const wchar_t **v31; // eax
  WCHAR *v32; // esi
  const WCHAR **v33; // ecx
  const WCHAR **v34; // eax
  HKEY v35; // ebx
  unsigned __int16 **v36; // esi
  unsigned __int16 **v37; // eax
  const WCHAR **v38; // eax
  const WCHAR **v39; // eax
  HKEY v40; // ebx
  unsigned __int16 **v41; // esi
  unsigned __int16 **v42; // eax
  const WCHAR **v43; // eax
  unsigned __int16 **v44; // eax
  HKEY v45; // [esp-4h] [ebp-2E0h]
  int v46; // [esp+10h] [ebp-2CCh]
  int v47; // [esp+14h] [ebp-2C8h]
  int v48; // [esp+18h] [ebp-2C4h]
  int v49; // [esp+1Ch] [ebp-2C0h]
  void *v50; // [esp+20h] [ebp-2BCh]
  WCHAR *ppv; // [esp+24h] [ebp-2B8h]
  WCHAR v52[2]; // [esp+28h] [ebp-2B4h]
  WCHAR v53[2]; // [esp+2Ch] [ebp-2B0h]
  WCHAR v54[2]; // [esp+30h] [ebp-2ACh]
  wchar_t *v55; // [esp+34h] [ebp-2A8h]
  WCHAR v56[2]; // [esp+38h] [ebp-2A4h]
  int v57; // [esp+3Ch] [ebp-2A0h]
  WCHAR *ppstr; // [esp+40h] [ebp-29Ch]
  WCHAR v59[2]; // [esp+44h] [ebp-298h]
  WCHAR *pszResult; // [esp+48h] [ebp-294h]
  int a2a; // [esp+4Ch] [ebp-290h]
  void *v62; // [esp+50h] [ebp-28Ch]
  void *v63; // [esp+54h] [ebp-288h]
  void *v64; // [esp+58h] [ebp-284h]
  void *v65; // [esp+5Ch] [ebp-280h]
  void *v66; // [esp+60h] [ebp-27Ch]
  LPCWSTR v67; // [esp+64h] [ebp-278h]
  LPCWSTR v68; // [esp+68h] [ebp-274h]
  LPCWSTR v69; // [esp+6Ch] [ebp-270h]
  void *v70; // [esp+70h] [ebp-26Ch]
  void *v71; // [esp+74h] [ebp-268h]
  void *v72; // [esp+78h] [ebp-264h]
  HKEY v73; // [esp+7Ch] [ebp-260h]
  void *a1a; // [esp+80h] [ebp-25Ch]
  WCHAR szArg[2]; // [esp+84h] [ebp-258h]
  HKEY KeyHandle; // [esp+88h] [ebp-254h]
  void *v77; // [esp+8Ch] [ebp-250h]
  void *v78; // [esp+90h] [ebp-24Ch]
  LPCWSTR v79; // [esp+94h] [ebp-248h]
  LPCWSTR v80; // [esp+98h] [ebp-244h]
  LPCWSTR v81; // [esp+9Ch] [ebp-240h]
  LPCWSTR v82; // [esp+A0h] [ebp-23Ch]
  LPCWSTR szArg3; // [esp+A4h] [ebp-238h]
  int v84; // [esp+A8h] [ebp-234h]
  wchar_t *ppv3; // [esp+ACh] [ebp-230h]
  WCHAR *ppszText2; // [esp+B0h] [ebp-22Ch]
  HKEY hKey; // [esp+B4h] [ebp-228h]
  OLECHAR *pszText; // [esp+B8h] [ebp-224h]
  LPCWSTR szArg4; // [esp+BCh] [ebp-220h]
  LPCWSTR lpszKeyName; // [esp+C0h] [ebp-21Ch]
  WCHAR Buffer; // [esp+C4h] [ebp-218h]
  int v92; // [esp+2D8h] [ebp-4h]

  v4 = psz;
  v84 = a1;
  v73 = a2;
  v55 = psz;
  ppv3 = malloc(2u);
  *ppv3 = 0;
  v92 = 0;
  v77 = malloc(2u);
  *v77 = 0;
  v71 = malloc(2u);
  *v71 = 0;
  v72 = malloc(2u);
  *v72 = 0;
  v78 = malloc(2u);
  *v78 = 0;
  LOBYTE(v92) = 4;
  if ( a4 == -1 )
  {
    v79 = _wcsdup(&gszNullString);
    v81 = _wcsdup(&gszNullString);
    szArg3 = _wcsdup(&gszNullString);
    v80 = _wcsdup(&gszNullString);
    v82 = _wcsdup(&gszNullString);
    lpszKeyName = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v5 = &gszNullString;
    if ( psz )
      v5 = psz;
    pszText = _wcsdup(v5);
    hKey = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( psz )
      v6 = psz;
    ppszText2 = _wcsdup(v6);
    LOBYTE(v92) = 14;
    v7 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v92) = 15;
    v8 = sub_F77BE0(szArg, a2, &ppszText2, &hKey);
    LOBYTE(v92) = 16;
    a4 = sub_F73FF0(v84, 0, 0xFFFFFFFF, 0, v8, v7, &lpszKeyName);
    free(*szArg);
    free(a1a);
    free(ppszText2);
    free(hKey);
    free(pszText);
    free(szArg4);
    free(lpszKeyName);
    free(v82);
    free(v80);
    free(szArg3);
    free(v81);
    LOBYTE(v92) = 4;
    free(v79);
  }
  v9 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, psz, 0, v9 | 0x20019, &KeyHandle) )
  {
    *szArg = 0;
    pszText = malloc(2u);
    *pszText = 0;
    ppszText2 = malloc(2u);
    *ppszText2 = 0;
    lpszKeyName = malloc(2u);
    *lpszKeyName = 0;
    szArg4 = malloc(2u);
    *szArg4 = 0;
    LOBYTE(v92) = 20;
    v10 = RegCloseKey;
    if ( !PE_LoadKey(KeyHandle, 0, &pszText) )
    {
      while ( 1 )
      {
        v11 = pszText;
        v12 = TlsGetValue(gdwTlsIndex);
        if ( !PE_OpenKey(KeyHandle, v11, 0, v12 | 0x20019, &hKey) )
        {
          if ( sub_F81520(hKey, L"MenuText", 0, 0, &ppv3) && sub_F81520(hKey, L"ButtonText", 0, 0, &ppv3) )
            goto LABEL_25;
          if ( *ppv3 == 64 )
          {
            v13 = _wcsdup(ppv3);
            a2a = v13;
            LOBYTE(v92) = 21;
            v14 = 0;
            if ( wcschr(v13, 0x2Cu) )
            {
              v15 = wcschr(v13, 0x2Cu);
              *v15 = 0;
              v14 = abs(_wtoi(v15 + 1));
            }
            v16 = RequerySystemEnvironmentString(&ppstr, v13 + 1);
            v17 = _wcsdup(*v16);
            free(v13);
            free(ppstr);
            v18 = LoadLibraryExW(v17, 0, 2u);
            if ( v18 )
            {
              if ( LoadStringW(v18, v14, &Buffer, 260) )
              {
                v19 = ppv3;
                ppv3 = _wcsdup(&Buffer);
                free(v19);
              }
              FreeLibrary(v18);
            }
            LOBYTE(v92) = 20;
            free(v17);
            v10 = RegCloseKey;
            v4 = v55;
          }
          if ( !sub_F81520(hKey, L"Exec", 0, 0, &lpszKeyName) )
            goto LABEL_36;
          if ( !sub_F81520(hKey, L"Script", 0, 0, &lpszKeyName) )
          {
            if ( !_wcsnicmp(lpszKeyName, L"res://", 6u) )
            {
              v28 = lpszKeyName;
              v29 = lpszKeyName + 6;
              goto LABEL_35;
            }
            if ( !_wcsnicmp(lpszKeyName, L"file://", 7u) )
            {
              v28 = lpszKeyName;
              v29 = lpszKeyName + 7;
LABEL_35:
              lpszKeyName = _wcsdup(v29);
              free(v28);
            }
LABEL_36:
            v10(hKey);
            v46 = malloc(2u);
            *v46 = 0;
            v47 = 0;
            v48 = 0;
            v49 = 0;
            LOBYTE(v92) = 22;
            sub_F77040(lpszKeyName, &v46);
            v30 = v78;
            v78 = _wcsdup(lpszKeyName);
            free(v30);
            v31 = sub_F74EE0(&v50, v84, &v46, 0);
            v32 = szArg4;
            szArg4 = _wcsdup(*v31);
            free(v32);
            free(v50);
            a2a = sub_F74ED0();
            v33 = &gszNullString;
            if ( v4 )
              v33 = v4;
            szArg3 = _wcsdup(v33);
            v81 = _wcsdup(&gszNullString);
            v34 = &gszNullString;
            if ( v4 )
              v34 = v4;
            v79 = _wcsdup(v34);
            v35 = v73;
            LOBYTE(v92) = 25;
            v36 = sub_F77BE0(v52, v73, &szArg3, &pszText);
            LOBYTE(v92) = 26;
            v37 = sub_F77BE0(v56, v35, &v79, &v81);
            LOBYTE(v92) = 27;
            LOBYTE(v35) = sub_F73D40(v84, &ppv3, v37, v36, &szArg4, &v77, &v72, &v57);
            free(*v56);
            free(*v52);
            free(v79);
            free(v81);
            free(szArg3);
            if ( v35 )
            {
              if ( a4 == -1 )
              {
                v62 = _wcsdup(&gszNullString);
                v66 = _wcsdup(&gszNullString);
                v64 = _wcsdup(&gszNullString);
                v63 = _wcsdup(&gszNullString);
                v70 = _wcsdup(&gszNullString);
                v65 = _wcsdup(&gszNullString);
                v67 = _wcsdup(&gszNullString);
                v38 = &gszNullString;
                if ( v4 )
                  v38 = v4;
                v68 = _wcsdup(v38);
                v82 = _wcsdup(&gszNullString);
                v39 = &gszNullString;
                if ( v4 )
                  v39 = v4;
                v80 = _wcsdup(v39);
                v40 = v73;
                LOBYTE(v92) = 37;
                v41 = sub_F77BE0(v59, v73, &v68, &v67);
                LOBYTE(v92) = 38;
                v42 = sub_F77BE0(v54, v40, &v80, &v82);
                LOBYTE(v92) = 39;
                a4 = sub_F73FF0(v84, 0, 0xFFFFFFFF, 0, v42, v41, &v65);
                free(*v54);
                free(*v59);
                free(v80);
                free(v82);
                free(v68);
                free(v67);
                free(v65);
                free(v70);
                free(v63);
                free(v64);
                free(v66);
                free(v62);
              }
              else
              {
                v40 = v73;
              }
              a1a = _wcsdup(&gszNullString);
              v43 = &gszNullString;
              if ( v4 )
                v43 = v4;
              v69 = _wcsdup(v43);
              LOBYTE(v92) = 41;
              v44 = sub_F77BE0(v53, v40, &v69, &pszText);
              LOBYTE(v92) = 42;
              sub_F73FF0(v84, a2a, a4, 3, &ppv3, v44, &szArg4);
              free(*v53);
              free(v69);
              free(a1a);
            }
            sub_F721F0(&v46);
            free(szArg4);
            free(lpszKeyName);
            free(ppszText2);
            free(pszText);
            v10 = RegCloseKey;
            goto LABEL_28;
          }
          v20 = sub_F81520(hKey, L"ClsidExtension", 0, 0, &ppszText2);
          v45 = hKey;
          if ( v20 )
            goto LABEL_26;
          v10(hKey);
          v21 = PE_CopyString2(&pszResult, L"CLSID\\", &ppszText2);
          v22 = PE_CopyString(&ppv, v21, L"\\InprocServer32");
          v23 = lpszKeyName;
          lpszKeyName = _wcsdup(*v22);
          free(v23);
          free(ppv);
          free(pszResult);
          v24 = lpszKeyName;
          v25 = TlsGetValue(gdwTlsIndex);
          if ( !PE_OpenKey(HKEY_CLASSES_ROOT, v24, 0, v25 | 0x20019, &hKey) )
            break;
        }
LABEL_27:
        free(szArg4);
        free(lpszKeyName);
        free(ppszText2);
        free(pszText);
LABEL_28:
        v26 = ++*szArg;
        pszText = malloc(2u);
        *pszText = 0;
        ppszText2 = malloc(2u);
        *ppszText2 = 0;
        lpszKeyName = malloc(2u);
        *lpszKeyName = 0;
        szArg4 = malloc(2u);
        *szArg4 = 0;
        LOBYTE(v92) = 20;
        if ( PE_LoadKey(KeyHandle, v26, &pszText) )
          goto LABEL_29;
      }
      if ( !sub_F81520(hKey, &gszNullString, 0, 0, &lpszKeyName) )
        goto LABEL_36;
LABEL_25:
      v45 = hKey;
LABEL_26:
      v10(v45);
      goto LABEL_27;
    }
LABEL_29:
    free(szArg4);
    free(lpszKeyName);
    free(ppszText2);
    free(pszText);
    v10(KeyHandle);
  }
  free(v78);
  free(v72);
  free(v71);
  free(v77);
  free(ppv3);
  return a4;
}

//----- (00F84E10) --------------------------------------------------------
void *__cdecl sub_F84E10(int a1, void *a2, OLECHAR *psz)
{
  _bstr_t *v3; // eax
  _bstr_t *v4; // eax
  Data_t_bstr_t *v5; // esi
  Data_t_bstr_t *v6; // esi
  Data_t_bstr_t *v7; // esi
  void *v8; // eax
  void *v9; // eax
  void *v10; // esi
  void *v11; // edi
  void *v13; // [esp+10h] [ebp-1Ch]
  _bstr_t v14; // [esp+14h] [ebp-18h]
  _bstr_t v15; // [esp+18h] [ebp-14h]
  _bstr_t a1a; // [esp+1Ch] [ebp-10h]
  int v17; // [esp+28h] [ebp-4h]

  _bstr_t::_bstr_t(&v14, L"AutorunsDisabled");
  v17 = 0;
  v3 = _bstr_t::_bstr_t(&v15, L"\\");
  LOBYTE(v17) = 1;
  v4 = _bstr_t::operator+(&a1a, psz, v3);
  LOBYTE(v17) = 2;
  _bstr_t::operator+(&v4->m_Data, &v13, &v14);
  v5 = a1a.m_Data;
  if ( a1a.m_Data )
  {
    if ( !InterlockedDecrement(&a1a.m_Data->m_RefCount) && v5 )
    {
      if ( v5->m_wstr )
      {
        SysFreeString(v5->m_wstr);
        v5->m_wstr = 0;
      }
      if ( v5->m_str )
      {
        j_j__free(v5->m_str);
        v5->m_str = 0;
      }
      j__free(v5);
    }
    a1a.m_Data = 0;
  }
  v6 = v15.m_Data;
  if ( v15.m_Data )
  {
    if ( !InterlockedDecrement(&v15.m_Data->m_RefCount) && v6 )
    {
      if ( v6->m_wstr )
      {
        SysFreeString(v6->m_wstr);
        v6->m_wstr = 0;
      }
      if ( v6->m_str )
      {
        j_j__free(v6->m_str);
        v6->m_str = 0;
      }
      j__free(v6);
    }
    v15.m_Data = 0;
  }
  v7 = v14.m_Data;
  LOBYTE(v17) = 6;
  if ( v14.m_Data && !InterlockedDecrement(&v14.m_Data->m_RefCount) )
  {
    if ( v7->m_wstr )
    {
      SysFreeString(v7->m_wstr);
      v7->m_wstr = 0;
    }
    if ( v7->m_str )
    {
      j_j__free(v7->m_str);
      v7->m_str = 0;
    }
    j__free(v7);
  }
  v8 = sub_F84FF0(a1, a2, psz, 0xFFFFFFFF, 1);
  v9 = sub_F84FF0(a1, a2, psz, v8, 0);
  v10 = v13;
  v11 = v9;
  if ( v13 && !InterlockedDecrement(v13 + 2) && v10 )
  {
    if ( *v10 )
    {
      SysFreeString(*v10);
      *v10 = 0;
    }
    if ( *(v10 + 1) )
    {
      j_j__free(*(v10 + 1));
      *(v10 + 1) = 0;
    }
    j__free(v10);
  }
  return v11;
}

//----- (00F84FF0) --------------------------------------------------------
void *__cdecl sub_F84FF0(int a1, void *a2, wchar_t *psz, void *a4, char a5)
{
  void *v5; // esi
  const wchar_t *v6; // eax
  const wchar_t *v7; // eax
  unsigned __int16 **v8; // esi
  unsigned __int16 **v9; // eax
  unsigned int v10; // eax
  WCHAR *v12; // ebx
  WCHAR *v13; // edi
  int v14; // esi
  const WCHAR *v15; // eax
  wchar_t *v16; // eax
  wchar_t *v17; // esi
  unsigned int v18; // eax
  int v19; // eax
  wchar_t *v20; // esi
  const wchar_t *v21; // ecx
  const WCHAR **v22; // eax
  wchar_t *v23; // esi
  LPCWSTR *v24; // eax
  unsigned __int16 **v25; // edi
  unsigned __int16 **v26; // eax
  wchar_t *v27; // edi
  const wchar_t *v28; // eax
  const WCHAR **v29; // eax
  unsigned __int16 **v30; // esi
  unsigned __int16 **v31; // eax
  const WCHAR **v32; // eax
  wchar_t *v33; // esi
  LPCWSTR *v34; // eax
  unsigned __int16 **v35; // eax
  unsigned int v36; // eax
  wchar_t *v37; // esi
  const wchar_t *v38; // eax
  const WCHAR **v39; // eax
  HKEY v40; // edi
  unsigned __int16 **v41; // esi
  unsigned __int16 **v42; // eax
  const WCHAR **v43; // eax
  const WCHAR *v44; // eax
  wchar_t *v45; // eax
  wchar_t *v46; // edi
  const wchar_t *v47; // eax
  wchar_t *v48; // eax
  wchar_t *v49; // esi
  LPCWSTR *v50; // eax
  unsigned __int16 **v51; // eax
  int v52; // eax
  wchar_t *v53; // esi
  int v54; // [esp+10h] [ebp-528h]
  int v55; // [esp+14h] [ebp-524h]
  int v56; // [esp+18h] [ebp-520h]
  int v57; // [esp+1Ch] [ebp-51Ch]
  WCHAR v58[2]; // [esp+20h] [ebp-518h]
  WCHAR v59[2]; // [esp+24h] [ebp-514h]
  int v60; // [esp+28h] [ebp-510h]
  BYTE v61[4]; // [esp+2Ch] [ebp-50Ch]
  WCHAR v62[2]; // [esp+30h] [ebp-508h]
  wchar_t *v63; // [esp+34h] [ebp-504h]
  WCHAR v64[2]; // [esp+38h] [ebp-500h]
  WCHAR *v65; // [esp+3Ch] [ebp-4FCh]
  WCHAR *v66; // [esp+40h] [ebp-4F8h]
  WCHAR *v67; // [esp+44h] [ebp-4F4h]
  WCHAR *pszResult; // [esp+48h] [ebp-4F0h]
  WCHAR *ppv1; // [esp+4Ch] [ebp-4ECh]
  WCHAR v70[2]; // [esp+50h] [ebp-4E8h]
  WCHAR v71[2]; // [esp+54h] [ebp-4E4h]
  WCHAR *v72; // [esp+58h] [ebp-4E0h]
  WCHAR v73[2]; // [esp+5Ch] [ebp-4DCh]
  WCHAR *ppv; // [esp+60h] [ebp-4D8h]
  LPCWSTR v75; // [esp+64h] [ebp-4D4h]
  WCHAR *ppv3; // [esp+68h] [ebp-4D0h]
  LPCWSTR v77; // [esp+6Ch] [ebp-4CCh]
  LPCWSTR v78; // [esp+70h] [ebp-4C8h]
  void *v79; // [esp+74h] [ebp-4C4h]
  void *v80; // [esp+78h] [ebp-4C0h]
  LPCWSTR v81; // [esp+7Ch] [ebp-4BCh]
  void *v82; // [esp+80h] [ebp-4B8h]
  LPCWSTR v83; // [esp+84h] [ebp-4B4h]
  void *v84; // [esp+88h] [ebp-4B0h]
  void *v85; // [esp+8Ch] [ebp-4ACh]
  LPCWSTR v86; // [esp+90h] [ebp-4A8h]
  void *v87; // [esp+94h] [ebp-4A4h]
  void *v88; // [esp+98h] [ebp-4A0h]
  void *v89; // [esp+9Ch] [ebp-49Ch]
  LPCWSTR v90; // [esp+A0h] [ebp-498h]
  void *v91; // [esp+A4h] [ebp-494h]
  void *v92; // [esp+A8h] [ebp-490h]
  void *v93; // [esp+ACh] [ebp-48Ch]
  void *v94; // [esp+B0h] [ebp-488h]
  LPCWSTR v95; // [esp+B4h] [ebp-484h]
  void *v96; // [esp+B8h] [ebp-480h]
  LPCWSTR v97; // [esp+BCh] [ebp-47Ch]
  void *v98; // [esp+C0h] [ebp-478h]
  DWORD cbData; // [esp+C4h] [ebp-474h]
  HKEY__ v100; // [esp+C8h] [ebp-470h]
  WCHAR szArg[2]; // [esp+CCh] [ebp-46Ch]
  void *a1a; // [esp+D0h] [ebp-468h]
  LPCWSTR v103; // [esp+D4h] [ebp-464h]
  wchar_t *v104; // [esp+D8h] [ebp-460h]
  WCHAR *ppszText2; // [esp+DCh] [ebp-45Ch]
  LPCWSTR szArg3; // [esp+E0h] [ebp-458h]
  LPCWSTR v107; // [esp+E4h] [ebp-454h]
  int v108; // [esp+E8h] [ebp-450h]
  HKEY hKey; // [esp+ECh] [ebp-44Ch]
  LPCWSTR v110; // [esp+F0h] [ebp-448h]
  HKEY v111; // [esp+F4h] [ebp-444h]
  int v112; // [esp+F8h] [ebp-440h]
  LPCWSTR szArg4; // [esp+FCh] [ebp-43Ch]
  WCHAR *pszText; // [esp+100h] [ebp-438h]
  HKEY KeyHandle; // [esp+104h] [ebp-434h]
  HKEY__ v116; // [esp+108h] [ebp-430h]
  int v117; // [esp+10Ch] [ebp-42Ch]
  char v118; // [esp+113h] [ebp-425h]
  LPCWSTR lpszKeyName; // [esp+114h] [ebp-424h]
  wchar_t Data[260]; // [esp+118h] [ebp-420h]
  WCHAR Name; // [esp+320h] [ebp-218h]
  int v122; // [esp+534h] [ebp-4h]

  v5 = a4;
  v112 = a1;
  v111 = a2;
  v104 = psz;
  v117 = 0;
  v108 = 0;
  if ( a4 == -1 )
  {
    ppszText2 = _wcsdup(&gszNullString);
    v122 = 0;
    lpszKeyName = _wcsdup(&gszNullString);
    v103 = _wcsdup(&gszNullString);
    v107 = _wcsdup(&gszNullString);
    szArg3 = _wcsdup(&gszNullString);
    KeyHandle = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( psz )
      v6 = psz;
    pszText = _wcsdup(v6);
    v110 = _wcsdup(&gszNullString);
    v7 = &gszNullString;
    if ( psz )
      v7 = psz;
    v116.unused = _wcsdup(v7);
    LOBYTE(v122) = 9;
    v8 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v122) = 10;
    v9 = sub_F77BE0(szArg, a2, &v116, &v110);
    LOBYTE(v122) = 11;
    v5 = sub_F73FF0(v112, 0, 0xFFFFFFFF, 0, v9, v8, &KeyHandle);
    a4 = v5;
    free(*szArg);
    free(a1a);
    free(v116.unused);
    free(v110);
    free(pszText);
    free(szArg4);
    free(KeyHandle);
    free(szArg3);
    free(v107);
    free(v103);
    free(lpszKeyName);
    v122 = -1;
    free(ppszText2);
  }
  hKey = 0;
  v10 = TlsGetValue(gdwTlsIndex);
  if ( PE_OpenKey(a2, psz, 0, v10 | 0x20019, &hKey) )
    return v5;
  *szArg = 0;
  if ( !RegEnumKeyW(hKey, 0, &Name, 0x104u) )
  {
    v12 = lpszKeyName;
    do
    {
      KeyHandle = 0;
      if ( a5 )
      {
        v13 = ppszText2;
        lpszKeyName = &gszNullString;
      }
      else
      {
        v13 = _wcsdup(L"AutorunsDisabled");
        ppszText2 = v13;
        v14 = v117 | 1;
        v15 = *PE_CopyString2(&pszResult, L"\\", &ppszText2);
        v117 = v14 | 2;
        v108 = v14 | 2;
        lpszKeyName = v15;
      }
      v16 = _wcsdup(&Name);
      v17 = v16;
      v116.unused = v16;
      v122 = 14;
      lpszKeyName = *PE_CopyString(&ppv, &v116, lpszKeyName);
      LOBYTE(v122) = 15;
      v18 = TlsGetValue(gdwTlsIndex);
      v118 = PE_OpenKey(hKey, lpszKeyName, 0, v18 | 0x20019, &KeyHandle) == 0;
      free(ppv);
      free(v17);
      v19 = v117;
      if ( v117 & 2 )
      {
        v117 &= 0xFFFFFFFD;
        v108 = v117;
        free(pszResult);
        v19 = v117;
      }
      v122 = -1;
      if ( v19 & 1 )
      {
        v117 = v19 & 0xFFFFFFFE;
        v108 = v19 & 0xFFFFFFFE;
        free(v13);
      }
      if ( v118 )
      {
        cbData = 520;
        if ( !RegQueryValueExW(KeyHandle, L"Debugger", 0, 0, Data, &cbData) )
        {
          pszText = malloc(2u);
          *pszText = 0;
          v122 = 16;
          v116.unused = malloc(2u);
          *v116.unused = 0;
          v110 = malloc(2u);
          *v110 = 0;
          v54 = malloc(2u);
          *v54 = 0;
          v55 = 0;
          v56 = 0;
          v57 = 0;
          LOBYTE(v122) = 19;
          sub_F77040(Data, &v54);
          sub_F74EE0(&szArg4, v112, &v54, 0);
          LOBYTE(v122) = 20;
          v100.unused = sub_F74ED0();
          v88 = _wcsdup(&Name);
          v20 = v104;
          v21 = &gszNullString;
          if ( v104 )
            v21 = v104;
          szArg3 = _wcsdup(v21);
          v107 = _wcsdup(&gszNullString);
          v22 = &gszNullString;
          if ( v20 )
            v22 = v20;
          v103 = _wcsdup(v22);
          v23 = _wcsdup(&Name);
          lpszKeyName = v23;
          v24 = PE_CopyString(&v72, &lpszKeyName, L"\\Debugger");
          LOBYTE(v122) = 26;
          v25 = sub_F77BE0(v59, v111, &szArg3, v24);
          LOBYTE(v122) = 27;
          v26 = sub_F77BE0(v58, v111, &v103, &v107);
          LOBYTE(v122) = 28;
          v118 = sub_F73D40(v112, v26, v25, &v88, &szArg4, &pszText, &v110, &v60);
          free(*v58);
          free(*v59);
          free(v72);
          free(v23);
          free(v103);
          free(v107);
          free(szArg3);
          free(v88);
          if ( v118 )
          {
            if ( a4 == -1 )
            {
              v92 = _wcsdup(&gszNullString);
              v84 = _wcsdup(&gszNullString);
              v94 = _wcsdup(&gszNullString);
              v80 = _wcsdup(&gszNullString);
              v79 = _wcsdup(&gszNullString);
              v96 = _wcsdup(&gszNullString);
              v75 = _wcsdup(&gszNullString);
              v27 = v104;
              v28 = &gszNullString;
              if ( v104 )
                v28 = v104;
              v77 = _wcsdup(v28);
              v81 = _wcsdup(&gszNullString);
              v29 = &gszNullString;
              if ( v27 )
                v29 = v27;
              v83 = _wcsdup(v29);
              LOBYTE(v122) = 38;
              v30 = sub_F77BE0(v70, v111, &v77, &v75);
              LOBYTE(v122) = 39;
              v31 = sub_F77BE0(v64, v111, &v83, &v81);
              LOBYTE(v122) = 40;
              a4 = sub_F73FF0(v112, 0, 0xFFFFFFFF, 0, v31, v30, &v96);
              free(*v64);
              free(*v70);
              free(v83);
              free(v81);
              free(v77);
              free(v75);
              free(v96);
              free(v79);
              free(v80);
              free(v94);
              free(v84);
              free(v92);
            }
            else
            {
              v27 = v104;
            }
            v98 = _wcsdup(&gszNullString);
            v82 = _wcsdup(Data);
            v32 = &gszNullString;
            if ( v27 )
              v32 = v27;
            v90 = _wcsdup(v32);
            ppv3 = _wcsdup(&Name);
            v33 = _wcsdup(&Name);
            lpszKeyName = v33;
            v34 = PE_CopyString(&v66, &lpszKeyName, L"\\Debugger");
            LOBYTE(v122) = 46;
            v35 = sub_F77BE0(v62, v111, &v90, v34);
            LOBYTE(v122) = 47;
            sub_F73FF0(v112, v100.unused, a4, 1, &ppv3, v35, &szArg4);
            free(*v62);
            free(v66);
            free(v33);
            free(ppv3);
            free(v90);
            free(v82);
            free(v98);
          }
          free(szArg4);
          sub_F721F0(&v54);
          free(v110);
          free(v116.unused);
          v122 = -1;
          free(pszText);
        }
        RegCloseKey(KeyHandle);
      }
      v36 = TlsGetValue(gdwTlsIndex);
      if ( !PE_OpenKey(hKey, &Name, 0, v36 | 0x20019, &KeyHandle) )
      {
        cbData = 4;
        if ( !RegQueryValueExW(KeyHandle, L"GlobalFlag", 0, 0, v61, &cbData) && *v61 & 0x100 )
        {
          if ( a4 == -1 )
          {
            a1a = _wcsdup(&gszNullString);
            v122 = 48;
            v85 = _wcsdup(&gszNullString);
            v87 = _wcsdup(&gszNullString);
            v89 = _wcsdup(&gszNullString);
            v91 = _wcsdup(&gszNullString);
            v93 = _wcsdup(&gszNullString);
            v95 = _wcsdup(&gszNullString);
            v37 = v104;
            v38 = &gszNullString;
            if ( v104 )
              v38 = v104;
            v97 = _wcsdup(v38);
            v86 = _wcsdup(&gszNullString);
            v39 = &gszNullString;
            if ( v37 )
              v39 = v37;
            v78 = _wcsdup(v39);
            v40 = v111;
            LOBYTE(v122) = 57;
            v41 = sub_F77BE0(v71, v111, &v97, &v95);
            LOBYTE(v122) = 58;
            v42 = sub_F77BE0(v73, v40, &v78, &v86);
            LOBYTE(v122) = 59;
            a4 = sub_F73FF0(v112, 0, 0xFFFFFFFF, 0, v42, v41, &v93);
            free(*v73);
            free(*v71);
            free(v78);
            free(v86);
            free(v97);
            free(v95);
            free(v93);
            free(v91);
            free(v89);
            free(v87);
            free(v85);
            free(a1a);
          }
          if ( a5 )
          {
            lpszKeyName = &gszNullString;
          }
          else
          {
            v12 = _wcsdup(L"AutorunsDisabled");
            lpszKeyName = v12;
            v43 = PE_CopyString2(&v65, L"\\", &lpszKeyName);
            v117 |= 0xCu;
            v44 = *v43;
            v108 = v117;
            lpszKeyName = v44;
          }
          v45 = _wcsdup(&Name);
          v46 = v45;
          v116.unused = v45;
          v47 = &gszNullString;
          if ( v104 )
            v47 = v104;
          v48 = _wcsdup(v47);
          v49 = v48;
          v100.unused = v48;
          v50 = PE_CopyString(&v67, &v100, L"\\");
          v51 = PE_CopyStringEx(&ppv1, v50, &v116);
          PE_CopyString(&v63, v51, lpszKeyName);
          v122 = 60;
          free(ppv1);
          free(v67);
          free(v49);
          free(v46);
          v52 = v117;
          if ( v117 & 8 )
          {
            v117 &= 0xFFFFFFF7;
            v108 = v117;
            free(v65);
            v52 = v117;
          }
          if ( v52 & 4 )
          {
            v117 = v52 & 0xFFFFFFFB;
            v108 = v52 & 0xFFFFFFFB;
            free(v12);
          }
          v53 = v63;
          sub_F86A10(v112, v111, v63, L"VerifierDlls", &Name, 32, a4);
          v122 = -1;
          free(v53);
        }
        RegCloseKey(KeyHandle);
      }
      ++*szArg;
    }
    while ( !RegEnumKeyW(hKey, *szArg, &Name, 0x104u) );
  }
  RegCloseKey(hKey);
  return a4;
}

//----- (00F85E10) --------------------------------------------------------
void *__cdecl sub_F85E10(int a1, void *a2, OLECHAR *psz)
{
  _bstr_t *v3; // eax
  _bstr_t *v4; // eax
  Data_t_bstr_t *v5; // esi
  Data_t_bstr_t *v6; // esi
  Data_t_bstr_t *v7; // esi
  void *v8; // eax
  void *v9; // eax
  void *v10; // esi
  void *v11; // edi
  void *v13; // [esp+10h] [ebp-1Ch]
  _bstr_t v14; // [esp+14h] [ebp-18h]
  _bstr_t v15; // [esp+18h] [ebp-14h]
  _bstr_t a1a; // [esp+1Ch] [ebp-10h]
  int v17; // [esp+28h] [ebp-4h]

  _bstr_t::_bstr_t(&v14, L"AutorunsDisabled");
  v17 = 0;
  v3 = _bstr_t::_bstr_t(&v15, L"\\");
  LOBYTE(v17) = 1;
  v4 = _bstr_t::operator+(&a1a, psz, v3);
  LOBYTE(v17) = 2;
  _bstr_t::operator+(&v4->m_Data, &v13, &v14);
  v5 = a1a.m_Data;
  if ( a1a.m_Data )
  {
    if ( !InterlockedDecrement(&a1a.m_Data->m_RefCount) && v5 )
    {
      if ( v5->m_wstr )
      {
        SysFreeString(v5->m_wstr);
        v5->m_wstr = 0;
      }
      if ( v5->m_str )
      {
        j_j__free(v5->m_str);
        v5->m_str = 0;
      }
      j__free(v5);
    }
    a1a.m_Data = 0;
  }
  v6 = v15.m_Data;
  if ( v15.m_Data )
  {
    if ( !InterlockedDecrement(&v15.m_Data->m_RefCount) && v6 )
    {
      if ( v6->m_wstr )
      {
        SysFreeString(v6->m_wstr);
        v6->m_wstr = 0;
      }
      if ( v6->m_str )
      {
        j_j__free(v6->m_str);
        v6->m_str = 0;
      }
      j__free(v6);
    }
    v15.m_Data = 0;
  }
  v7 = v14.m_Data;
  LOBYTE(v17) = 6;
  if ( v14.m_Data && !InterlockedDecrement(&v14.m_Data->m_RefCount) )
  {
    if ( v7->m_wstr )
    {
      SysFreeString(v7->m_wstr);
      v7->m_wstr = 0;
    }
    if ( v7->m_str )
    {
      j_j__free(v7->m_str);
      v7->m_str = 0;
    }
    j__free(v7);
  }
  v8 = sub_F85FF0(a1, a2, psz, 0xFFFFFFFF, 1);
  v9 = sub_F85FF0(a1, a2, psz, v8, 0);
  v10 = v13;
  v11 = v9;
  if ( v13 && !InterlockedDecrement(v13 + 2) && v10 )
  {
    if ( *v10 )
    {
      SysFreeString(*v10);
      *v10 = 0;
    }
    if ( *(v10 + 1) )
    {
      j_j__free(*(v10 + 1));
      *(v10 + 1) = 0;
    }
    j__free(v10);
  }
  return v11;
}

//----- (00F85FF0) --------------------------------------------------------
void *__cdecl sub_F85FF0(int a1, void *a2, wchar_t *a3, void *a4, char a5)
{
  const wchar_t *v5; // eax
  const wchar_t *v6; // eax
  unsigned __int16 **v7; // esi
  unsigned __int16 **v8; // eax
  wchar_t *v9; // eax
  wchar_t *v10; // eax
  int v11; // ecx
  tagKeyName *v12; // ebx
  const WCHAR **v13; // eax
  WCHAR *v14; // eax
  WCHAR *v15; // ebx
  wchar_t *v16; // eax
  wchar_t *v17; // edi
  const wchar_t *v18; // eax
  wchar_t *v19; // esi
  LPCWSTR *v20; // eax
  unsigned __int16 **v21; // eax
  LPCWSTR *v22; // eax
  unsigned __int16 **v23; // eax
  unsigned int v24; // eax
  wchar_t *v25; // esi
  WCHAR *v26; // eax
  tagKeyName *v27; // edi
  unsigned int v28; // eax
  int v29; // eax
  const WCHAR **v30; // edi
  const WCHAR **v31; // ecx
  const WCHAR **v32; // eax
  const WCHAR **v33; // eax
  unsigned __int16 **v34; // esi
  unsigned __int16 **v35; // eax
  const WCHAR **v36; // esi
  const WCHAR **v37; // eax
  const WCHAR **v38; // eax
  unsigned __int16 **v39; // eax
  const WCHAR **v40; // eax
  unsigned __int16 **v41; // eax
  int v43; // [esp+10h] [ebp-494h]
  int v44; // [esp+20h] [ebp-484h]
  int a2a; // [esp+24h] [ebp-480h]
  DWORD cbData; // [esp+28h] [ebp-47Ch]
  HKEY KeyHandle; // [esp+2Ch] [ebp-478h]
  HKEY hKey; // [esp+30h] [ebp-474h]
  WCHAR v49[2]; // [esp+34h] [ebp-470h]
  WCHAR szArg[2]; // [esp+38h] [ebp-46Ch]
  int v51; // [esp+3Ch] [ebp-468h]
  void *v52; // [esp+40h] [ebp-464h]
  LPCWSTR szArg3; // [esp+44h] [ebp-460h]
  WCHAR *pszText; // [esp+48h] [ebp-45Ch]
  LPCWSTR v55; // [esp+4Ch] [ebp-458h]
  HKEY hRootKey; // [esp+50h] [ebp-454h]
  LPCWSTR szArg4; // [esp+54h] [ebp-450h]
  void *v58; // [esp+58h] [ebp-44Ch]
  WCHAR *v59; // [esp+5Ch] [ebp-448h]
  LPCWSTR v60; // [esp+60h] [ebp-444h]
  WCHAR *ppv3; // [esp+64h] [ebp-440h]
  LPCWSTR v62; // [esp+68h] [ebp-43Ch]
  WCHAR *ppv; // [esp+6Ch] [ebp-438h]
  WCHAR *ppv1; // [esp+70h] [ebp-434h]
  LPCWSTR v65; // [esp+74h] [ebp-430h]
  HKEY__ v66; // [esp+78h] [ebp-42Ch]
  void *a1a; // [esp+7Ch] [ebp-428h]
  char v68; // [esp+83h] [ebp-421h]
  wchar_t Data[260]; // [esp+84h] [ebp-420h]
  wchar_t v70[260]; // [esp+28Ch] [ebp-218h]
  int v71; // [esp+4A0h] [ebp-4h]

  v51 = a1;
  hRootKey = a2;
  *szArg = a3;
  if ( a4 == -1 )
  {
    v65 = _wcsdup(&gszNullString);
    v71 = 0;
    v52 = _wcsdup(&gszNullString);
    ppv1 = _wcsdup(&gszNullString);
    ppv = _wcsdup(&gszNullString);
    v60 = _wcsdup(&gszNullString);
    v58 = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v5 = &gszNullString;
    if ( a3 )
      v5 = a3;
    pszText = _wcsdup(v5);
    v55 = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( a3 )
      v6 = a3;
    szArg3 = _wcsdup(v6);
    LOBYTE(v71) = 9;
    v7 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v71) = 10;
    v8 = sub_F77BE0(&v66, a2, &szArg3, &v55);
    LOBYTE(v71) = 11;
    a4 = sub_F73FF0(v51, 0, 0xFFFFFFFF, 0, v8, v7, &v58);
    free(v66.unused);
    free(a1a);
    free(szArg3);
    free(v55);
    free(pszText);
    free(szArg4);
    free(v58);
    free(v60);
    free(ppv);
    free(ppv1);
    free(v52);
    free(v65);
  }
  v65 = malloc(2u);
  *v65 = 0;
  v71 = 12;
  hKey = 0;
  v9 = _wcsdup(a3);
  szArg3 = v9;
  v10 = wcsrchr(v9, 0x5Cu);
  *v10 = 0;
  v11 = (v10 + 1);
  *v49 = v10 + 1;
  if ( a5 )
  {
    v12 = _wcsdup(a3);
    v52 = v12;
    free(v65);
  }
  else
  {
    v13 = &gszNullString;
    if ( v11 )
      v13 = v11;
    v14 = _wcsdup(v13);
    v15 = v14;
    ppv3 = v14;
    v16 = _wcsdup(L"AutorunsDisabled");
    v17 = v16;
    a1a = v16;
    v18 = &gszNullString;
    if ( szArg3 )
      v18 = szArg3;
    v19 = _wcsdup(v18);
    v66.unused = v19;
    v20 = PE_CopyString(&ppv, &v66, L"\\");
    v21 = PE_CopyStringEx(&ppv1, v20, &a1a);
    v22 = PE_CopyString(&v62, v21, L"\\");
    v23 = PE_CopyStringEx(&v59, v22, &ppv3);
    v52 = _wcsdup(*v23);
    free(v65);
    free(v59);
    free(v62);
    free(ppv1);
    free(ppv);
    free(v19);
    free(v17);
    free(v15);
    v12 = v52;
  }
  v24 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(hRootKey, v12, 0, v24 | 0x20019, &hKey) )
  {
    KeyHandle = 0;
    cbData = 520;
    if ( !RegQueryValueExW(hKey, 0, 0, 0, Data, &cbData) )
    {
      v25 = _wcsdup(Data);
      v66.unused = v25;
      v26 = PE_CopyString2(&ppv3, L"Software\\Classes\\", &v66);
      v27 = *PE_CopyString(&a1a, v26, L"\\shell\\open\\command");
      LOBYTE(v71) = 15;
      v28 = TlsGetValue(gdwTlsIndex);
      v68 = PE_OpenKey(hRootKey, v27, 0, v28 | 0x20019, &KeyHandle) == 0;
      free(a1a);
      free(ppv3);
      LOBYTE(v71) = 12;
      free(v25);
      if ( v68 )
      {
        cbData = 520;
        if ( !RegQueryValueExW(KeyHandle, 0, 0, 0, v70, &cbData) )
        {
          v29 = wcscmp(v70, L"\"%1\" %*");
          if ( v29 )
            v29 = -(v29 < 0) | 1;
          if ( v29 )
          {
            szArg4 = malloc(2u);
            *szArg4 = 0;
            v55 = malloc(2u);
            *v55 = 0;
            pszText = malloc(2u);
            *pszText = 0;
            sub_F72170(&v43);
            LOBYTE(v71) = 19;
            sub_F77040(v70, &v43);
            sub_F74EE0(&v58, v51, &v43, 0);
            LOBYTE(v71) = 20;
            a2a = sub_F74ED0();
            v62 = _wcsdup(&gszNullString);
            v30 = *szArg;
            v31 = &gszNullString;
            if ( *szArg )
              v31 = *szArg;
            v60 = _wcsdup(v31);
            ppv = _wcsdup(&gszNullString);
            v32 = &gszNullString;
            if ( v30 )
              v32 = v30;
            ppv1 = _wcsdup(v32);
            v33 = &gszNullString;
            if ( v30 )
              v33 = v30;
            v65 = _wcsdup(v33);
            LOBYTE(v71) = 25;
            v34 = sub_F77BE0(&a1a, hRootKey, &v60, &v62);
            LOBYTE(v71) = 26;
            v35 = sub_F77BE0(&v66, hRootKey, &ppv1, &ppv);
            LOBYTE(v71) = 27;
            v68 = sub_F73D40(v51, &v65, v35, v34, &v58, &szArg4, &pszText, &v44);
            free(v66.unused);
            free(a1a);
            free(v65);
            free(ppv1);
            free(ppv);
            free(v60);
            LOBYTE(v71) = 20;
            free(v62);
            if ( v68 )
            {
              if ( a4 == -1 )
              {
                v66.unused = _wcsdup(&gszNullString);
                a1a = _wcsdup(&gszNullString);
                ppv3 = _wcsdup(&gszNullString);
                v59 = _wcsdup(&gszNullString);
                v60 = _wcsdup(&gszNullString);
                ppv = _wcsdup(&gszNullString);
                ppv1 = _wcsdup(&gszNullString);
                v36 = &gszNullString;
                v37 = &gszNullString;
                if ( v30 )
                  v37 = v30;
                v65 = _wcsdup(v37);
                v38 = &gszNullString;
                if ( *v49 )
                  v38 = *v49;
                v62 = _wcsdup(v38);
                LOBYTE(v71) = 36;
                v39 = sub_F77BE0(szArg, hRootKey, &v65, &ppv1);
                LOBYTE(v71) = 37;
                a4 = sub_F73FF0(v51, 0, 0xFFFFFFFF, 0, &v62, v39, &ppv);
                free(*szArg);
                free(v62);
                free(v65);
                free(ppv1);
                free(ppv);
                free(v60);
                free(v59);
                free(ppv3);
                free(a1a);
                free(v66.unused);
              }
              else
              {
                v36 = &gszNullString;
              }
              v62 = _wcsdup(&gszNullString);
              v59 = _wcsdup(v70);
              ppv3 = _wcsdup(&gszNullString);
              v40 = &gszNullString;
              if ( v30 )
                v40 = v30;
              a1a = _wcsdup(v40);
              if ( v30 )
                v36 = v30;
              v66.unused = _wcsdup(v36);
              LOBYTE(v71) = 42;
              v41 = sub_F77BE0(v49, hRootKey, &a1a, &ppv3);
              LOBYTE(v71) = 43;
              sub_F73FF0(v51, a2a, a4, 3, &v66, v41, &v58);
              free(*v49);
              free(v66.unused);
              free(a1a);
              free(ppv3);
              free(v59);
              free(v62);
            }
            free(v58);
            sub_F721F0(&v43);
            free(pszText);
            free(v55);
            free(szArg4);
          }
        }
        RegCloseKey(KeyHandle);
      }
    }
    RegCloseKey(hKey);
  }
  free(szArg3);
  free(v12);
  return a4;
}
// 103244C: using guessed type wchar_t a1_0[8];

//----- (00F86A10) --------------------------------------------------------
void *__cdecl sub_F86A10(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, wchar_t *a5, int a6, void *a7)
{
  unsigned int v7; // eax
  int v8; // esi
  char *v9; // ecx
  int v10; // ebx
  OLECHAR **v11; // edi
  void *v12; // esi
  const wchar_t **v13; // eax
  void *v14; // esi
  const wchar_t *v15; // ecx
  const wchar_t *v16; // eax
  const wchar_t *v17; // eax
  unsigned __int16 **v18; // esi
  unsigned __int16 **v19; // eax
  char v20; // bl
  const wchar_t *v21; // eax
  const wchar_t *v22; // eax
  const wchar_t *v23; // eax
  const wchar_t *v24; // eax
  unsigned __int16 **v25; // eax
  void *v27; // [esp+10h] [ebp-78h]
  int v28; // [esp+14h] [ebp-74h]
  int v29; // [esp+18h] [ebp-70h]
  WCHAR v30[2]; // [esp+1Ch] [ebp-6Ch]
  int a2a; // [esp+20h] [ebp-68h]
  int v32; // [esp+24h] [ebp-64h]
  void *a1a; // [esp+28h] [ebp-60h]
  WCHAR szArg[2]; // [esp+2Ch] [ebp-5Ch]
  void *v35; // [esp+30h] [ebp-58h]
  HKEY hKey; // [esp+34h] [ebp-54h]
  int v37; // [esp+38h] [ebp-50h]
  unsigned int v38; // [esp+3Ch] [ebp-4Ch]
  void *v39; // [esp+40h] [ebp-48h]
  LPCWSTR v40; // [esp+44h] [ebp-44h]
  LPCWSTR v41; // [esp+48h] [ebp-40h]
  WCHAR *ppv3; // [esp+4Ch] [ebp-3Ch]
  LPCWSTR szArg4; // [esp+50h] [ebp-38h]
  WCHAR *pszText; // [esp+54h] [ebp-34h]
  LPCWSTR v45; // [esp+58h] [ebp-30h]
  LPCWSTR szArg3; // [esp+5Ch] [ebp-2Ch]
  void *v47; // [esp+60h] [ebp-28h]
  void *v48; // [esp+64h] [ebp-24h]
  wchar_t *v49; // [esp+68h] [ebp-20h]
  void *v50; // [esp+6Ch] [ebp-1Ch]
  void *v51; // [esp+70h] [ebp-18h]
  void *v52; // [esp+74h] [ebp-14h]
  int v53; // [esp+84h] [ebp-4h]

  v52 = malloc(2u);
  *v52 = 0;
  v53 = 0;
  v50 = malloc(2u);
  *v50 = 0;
  v47 = malloc(2u);
  *v47 = 0;
  v48 = malloc(2u);
  *v48 = 0;
  v51 = malloc(2u);
  *v51 = 0;
  LOBYTE(v53) = 4;
  v7 = TlsGetValue(gdwTlsIndex);
  if ( !PE_OpenKey(a2, psz, 0, v7 | 0x20019, &hKey) )
  {
    v49 = malloc(2u);
    *v49 = 0;
    LOBYTE(v53) = 5;
    if ( !sub_F81520(hKey, lpValueName, 0, 0, &v49) && wcslen(v49) )
    {
      v27 = 0;
      v28 = 0;
      v29 = 0;
      LOBYTE(v53) = 6;
      sub_F76DD0(v49, 44, &v27, 0);
      v8 = v28;
      v9 = v27;
      v38 = 0;
      if ( (v28 - v27) >> 4 )
      {
        v10 = 0;
        v37 = 0;
        do
        {
          v11 = &v9[v10];
          v12 = v51;
          v51 = _wcsdup(**&v9[v10 + 4]);
          free(v12);
          v13 = sub_F74EE0(&v35, a1, v11, 0);
          v14 = v52;
          v52 = _wcsdup(*v13);
          free(v14);
          free(v35);
          a2a = sub_F74ED0();
          v15 = &gszNullString;
          if ( lpValueName )
            v15 = lpValueName;
          szArg4 = _wcsdup(v15);
          v16 = &gszNullString;
          if ( psz )
            v16 = psz;
          pszText = _wcsdup(v16);
          v45 = _wcsdup(&gszNullString);
          v17 = &gszNullString;
          if ( psz )
            v17 = psz;
          szArg3 = _wcsdup(v17);
          LOBYTE(v53) = 10;
          v18 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
          LOBYTE(v53) = 11;
          v19 = sub_F77BE0(szArg, a2, &szArg3, &v45);
          LOBYTE(v53) = 12;
          v20 = sub_F73D40(a1, v19, v18, v11, &v52, &v50, &v48, &v32);
          free(*szArg);
          free(a1a);
          free(szArg3);
          free(v45);
          free(pszText);
          LOBYTE(v53) = 6;
          free(szArg4);
          if ( v20 )
          {
            v21 = &gszNullString;
            if ( lpValueName )
              v21 = lpValueName;
            v39 = _wcsdup(v21);
            v22 = &gszNullString;
            if ( lpValueName )
              v22 = lpValueName;
            v40 = _wcsdup(v22);
            v23 = &gszNullString;
            if ( psz )
              v23 = psz;
            v41 = _wcsdup(v23);
            v24 = &gszNullString;
            if ( a5 )
              v24 = a5;
            ppv3 = _wcsdup(v24);
            LOBYTE(v53) = 16;
            v25 = sub_F77BE0(v30, a2, &v41, &v40);
            LOBYTE(v53) = 17;
            sub_F73FF0(a1, a2a, a7, 1, &ppv3, v25, &v52);
            free(*v30);
            free(ppv3);
            free(v41);
            free(v40);
            LOBYTE(v53) = 6;
            free(v39);
          }
          v8 = v28;
          v9 = v27;
          v10 = v37 + 16;
          ++v38;
          v37 += 16;
        }
        while ( v38 < (v28 - v27) >> 4 );
      }
      if ( v9 )
      {
        sub_F72BF0(v9, v8);
        j__free(v27);
      }
    }
    RegCloseKey(hKey);
    free(v49);
  }
  free(v51);
  free(v48);
  free(v47);
  free(v50);
  free(v52);
  return a7;
}

//----- (00F86E10) --------------------------------------------------------
void *__cdecl sub_F86E10(int a1, void *a2, OLECHAR *psz, LPCWSTR lpValueName)
{
  _bstr_t *v4; // eax
  _bstr_t *v5; // eax
  Data_t_bstr_t *v6; // esi
  Data_t_bstr_t *v7; // esi
  Data_t_bstr_t *v8; // esi
  void *v9; // eax
  wchar_t *v10; // ecx
  void *v11; // eax
  void *v12; // esi
  void *v13; // edi
  void *v15; // [esp+10h] [ebp-1Ch]
  _bstr_t v16; // [esp+14h] [ebp-18h]
  _bstr_t v17; // [esp+18h] [ebp-14h]
  _bstr_t a1a; // [esp+1Ch] [ebp-10h]
  int v19; // [esp+28h] [ebp-4h]

  _bstr_t::_bstr_t(&v16, L"AutorunsDisabled");
  v19 = 0;
  v4 = _bstr_t::_bstr_t(&v17, L"\\");
  LOBYTE(v19) = 1;
  v5 = _bstr_t::operator+(&a1a, psz, v4);
  LOBYTE(v19) = 2;
  _bstr_t::operator+(&v5->m_Data, &v15, &v16);
  v6 = a1a.m_Data;
  if ( a1a.m_Data )
  {
    if ( !InterlockedDecrement(&a1a.m_Data->m_RefCount) && v6 )
    {
      if ( v6->m_wstr )
      {
        SysFreeString(v6->m_wstr);
        v6->m_wstr = 0;
      }
      if ( v6->m_str )
      {
        j_j__free(v6->m_str);
        v6->m_str = 0;
      }
      j__free(v6);
    }
    a1a.m_Data = 0;
  }
  v7 = v17.m_Data;
  if ( v17.m_Data )
  {
    if ( !InterlockedDecrement(&v17.m_Data->m_RefCount) && v7 )
    {
      if ( v7->m_wstr )
      {
        SysFreeString(v7->m_wstr);
        v7->m_wstr = 0;
      }
      if ( v7->m_str )
      {
        j_j__free(v7->m_str);
        v7->m_str = 0;
      }
      j__free(v7);
    }
    v17.m_Data = 0;
  }
  v8 = v16.m_Data;
  LOBYTE(v19) = 6;
  if ( v16.m_Data && !InterlockedDecrement(&v16.m_Data->m_RefCount) )
  {
    if ( v8->m_wstr )
    {
      SysFreeString(v8->m_wstr);
      v8->m_wstr = 0;
    }
    if ( v8->m_str )
    {
      j_j__free(v8->m_str);
      v8->m_str = 0;
    }
    j__free(v8);
  }
  v9 = sub_F87000(a1, a2, psz, lpValueName, -1);
  if ( v15 )
    v10 = *v15;
  else
    v10 = 0;
  v11 = sub_F87000(a1, a2, v10, lpValueName, v9);
  v12 = v15;
  v13 = v11;
  if ( v15 && !InterlockedDecrement(v15 + 2) && v12 )
  {
    if ( *v12 )
    {
      SysFreeString(*v12);
      *v12 = 0;
    }
    if ( *(v12 + 1) )
    {
      j_j__free(*(v12 + 1));
      *(v12 + 1) = 0;
    }
    j__free(v12);
  }
  return v13;
}

//----- (00F87000) --------------------------------------------------------
void *__cdecl sub_F87000(int a1, void *a2, wchar_t *psz, LPCWSTR lpValueName, int a5)
{
  void *v5; // ebx
  const wchar_t *v6; // eax
  const wchar_t *v7; // eax
  const wchar_t *v8; // eax
  const wchar_t *v9; // eax
  unsigned __int16 **v10; // esi
  unsigned __int16 **v11; // eax
  LPCWSTR v13; // ebx
  wchar_t *v14; // esi
  DWORD v15; // eax
  int v16; // edi
  _WORD *v17; // eax
  WCHAR *v18; // eax
  const WCHAR **v19; // ecx
  const wchar_t *v20; // eax
  const WCHAR **v21; // eax
  const wchar_t *v22; // eax
  unsigned __int16 **v23; // edi
  unsigned __int16 **v24; // eax
  OLECHAR **v25; // ST40_4
  char v26; // bl
  const wchar_t *v27; // eax
  const wchar_t *v28; // eax
  const wchar_t *v29; // eax
  const wchar_t *v30; // eax
  unsigned __int16 **v31; // edi
  unsigned __int16 **v32; // eax
  const WCHAR **v33; // eax
  const wchar_t *v34; // eax
  unsigned __int16 **v35; // eax
  int a2a; // [esp+10h] [ebp-A4h]
  int v37; // [esp+14h] [ebp-A0h]
  int v38; // [esp+18h] [ebp-9Ch]
  int v39; // [esp+1Ch] [ebp-98h]
  WCHAR v40[2]; // [esp+20h] [ebp-94h]
  WCHAR v41[2]; // [esp+24h] [ebp-90h]
  WCHAR v42[2]; // [esp+28h] [ebp-8Ch]
  int v43; // [esp+2Ch] [ebp-88h]
  WCHAR v44[2]; // [esp+30h] [ebp-84h]
  int v45; // [esp+34h] [ebp-80h]
  WCHAR v46[2]; // [esp+38h] [ebp-7Ch]
  void *v47; // [esp+3Ch] [ebp-78h]
  void *v48; // [esp+40h] [ebp-74h]
  LPCWSTR v49; // [esp+44h] [ebp-70h]
  WCHAR *ppv3; // [esp+48h] [ebp-6Ch]
  LPCWSTR v51; // [esp+4Ch] [ebp-68h]
  void *v52; // [esp+50h] [ebp-64h]
  LPCWSTR v53; // [esp+54h] [ebp-60h]
  void *v54; // [esp+58h] [ebp-5Ch]
  LPCWSTR v55; // [esp+5Ch] [ebp-58h]
  void *v56; // [esp+60h] [ebp-54h]
  LPCWSTR v57; // [esp+64h] [ebp-50h]
  void *v58; // [esp+68h] [ebp-4Ch]
  void *a1a; // [esp+6Ch] [ebp-48h]
  HKEY hKey; // [esp+70h] [ebp-44h]
  WCHAR szArg[2]; // [esp+74h] [ebp-40h]
  LPCWSTR v62; // [esp+78h] [ebp-3Ch]
  void *v63; // [esp+7Ch] [ebp-38h]
  LPCWSTR v64; // [esp+80h] [ebp-34h]
  LPCWSTR v65; // [esp+84h] [ebp-30h]
  LPCWSTR v66; // [esp+88h] [ebp-2Ch]
  LPCWSTR v67; // [esp+8Ch] [ebp-28h]
  LPCWSTR szArg3; // [esp+90h] [ebp-24h]
  DWORD cbData; // [esp+94h] [ebp-20h]
  LPCWSTR v70; // [esp+98h] [ebp-1Ch]
  void *ppv1; // [esp+9Ch] [ebp-18h]
  WCHAR *pszText; // [esp+A0h] [ebp-14h]
  LPCWSTR szArg4; // [esp+A4h] [ebp-10h]
  int v74; // [esp+B0h] [ebp-4h]

  v5 = a5;
  ppv1 = a5;
  if ( dword_10631D8 && a5 == -1 )
  {
    v63 = _wcsdup(&gszNullString);
    v74 = 0;
    v65 = _wcsdup(&gszNullString);
    v66 = _wcsdup(&gszNullString);
    v62 = _wcsdup(&gszNullString);
    v64 = _wcsdup(&gszNullString);
    v67 = _wcsdup(&gszNullString);
    v6 = &gszNullString;
    if ( lpValueName )
      v6 = lpValueName;
    szArg4 = _wcsdup(v6);
    v7 = &gszNullString;
    if ( psz )
      v7 = psz;
    pszText = _wcsdup(v7);
    v8 = &gszNullString;
    if ( lpValueName )
      v8 = lpValueName;
    v70 = _wcsdup(v8);
    v9 = &gszNullString;
    if ( psz )
      v9 = psz;
    szArg3 = _wcsdup(v9);
    LOBYTE(v74) = 9;
    v10 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v74) = 10;
    v11 = sub_F77BE0(szArg, a2, &szArg3, &v70);
    LOBYTE(v74) = 11;
    v5 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v11, v10, &v67);
    ppv1 = v5;
    free(*szArg);
    free(a1a);
    free(szArg3);
    free(v70);
    free(pszText);
    free(szArg4);
    free(v67);
    free(v64);
    free(v62);
    free(v66);
    free(v65);
    v74 = -1;
    free(v63);
  }
  hKey = 0;
  PE_OpenKey(a2, psz, 0, 0x20019u, &hKey);
  if ( !hKey )
    return v5;
  v13 = lpValueName;
  cbData = 0;
  RegQueryValueExW(hKey, lpValueName, 0, 0, 0, &cbData);
  v14 = operator new[](2 * ((cbData >> 1) + 2));
  RegQueryValueExW(hKey, lpValueName, 0, 0, v14, &cbData);
  v15 = cbData >> 1;
  cbData = v15;
  if ( v15 > 2 )
  {
    v14[v15 - 1] = 0;
    v14[cbData] = 0;
    if ( *v14 )
    {
      v16 = a1;
      do
      {
        v17 = malloc(2u);
        a2a = v17;
        *v17 = 0;
        v37 = 0;
        v38 = 0;
        v39 = 0;
        v74 = 12;
        sub_F76CC0(v14, &a2a);
        *szArg = _wcsdup(v14);
        LOBYTE(v74) = 13;
        sub_F74EE0(&szArg4, v16, &a2a, 0);
        v18 = szArg4;
        if ( *szArg4 )
        {
          pszText = malloc(2u);
          *pszText = 0;
          szArg3 = malloc(2u);
          *szArg3 = 0;
          v70 = malloc(2u);
          *v70 = 0;
          LOBYTE(v74) = 17;
          v43 = sub_F74ED0();
          v19 = &gszNullString;
          if ( v13 )
            v19 = v13;
          v64 = _wcsdup(v19);
          v20 = &gszNullString;
          if ( psz )
            v20 = psz;
          v62 = _wcsdup(v20);
          v21 = &gszNullString;
          if ( v13 )
            v21 = v13;
          v66 = _wcsdup(v21);
          v22 = &gszNullString;
          if ( psz )
            v22 = psz;
          v65 = _wcsdup(v22);
          v63 = _wcsdup(v14);
          LOBYTE(v74) = 22;
          v23 = sub_F77BE0(v44, a2, &v62, &v64);
          LOBYTE(v74) = 23;
          v24 = sub_F77BE0(v46, a2, &v65, &v66);
          LOBYTE(v74) = 24;
          v25 = v23;
          v16 = a1;
          v26 = sub_F73D40(a1, &v63, v24, v25, &szArg4, &pszText, &v70, &v45);
          free(*v46);
          free(*v44);
          free(v63);
          free(v65);
          free(v66);
          free(v62);
          free(v64);
          if ( v26 )
          {
            if ( ppv1 == -1 )
            {
              v48 = _wcsdup(&gszNullString);
              v52 = _wcsdup(&gszNullString);
              v47 = _wcsdup(&gszNullString);
              v54 = _wcsdup(&gszNullString);
              v58 = _wcsdup(&gszNullString);
              v56 = _wcsdup(&gszNullString);
              v13 = lpValueName;
              v27 = &gszNullString;
              if ( lpValueName )
                v27 = lpValueName;
              v55 = _wcsdup(v27);
              v28 = &gszNullString;
              if ( psz )
                v28 = psz;
              v57 = _wcsdup(v28);
              v29 = &gszNullString;
              if ( lpValueName )
                v29 = lpValueName;
              v49 = _wcsdup(v29);
              v30 = &gszNullString;
              if ( psz )
                v30 = psz;
              v67 = _wcsdup(v30);
              LOBYTE(v74) = 34;
              v31 = sub_F77BE0(v42, a2, &v57, &v55);
              LOBYTE(v74) = 35;
              v32 = sub_F77BE0(v40, a2, &v67, &v49);
              LOBYTE(v74) = 36;
              ppv1 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v32, v31, &v56);
              free(*v40);
              free(*v42);
              free(v67);
              free(v49);
              free(v57);
              free(v55);
              free(v56);
              free(v58);
              free(v54);
              free(v47);
              free(v52);
              free(v48);
            }
            else
            {
              v13 = lpValueName;
            }
            a1a = _wcsdup(&gszNullString);
            v33 = &gszNullString;
            if ( v13 )
              v33 = v13;
            v51 = _wcsdup(v33);
            v34 = &gszNullString;
            if ( psz )
              v34 = psz;
            v53 = _wcsdup(v34);
            ppv3 = _wcsdup(v14);
            LOBYTE(v74) = 40;
            v35 = sub_F77BE0(v41, a2, &v53, &v51);
            v16 = a1;
            LOBYTE(v74) = 41;
            sub_F73FF0(a1, v43, ppv1, 5, &ppv3, v35, &szArg4);
            free(*v41);
            free(ppv3);
            free(v53);
            free(v51);
            free(a1a);
          }
          else
          {
            v13 = lpValueName;
          }
          free(v70);
          free(szArg3);
          free(pszText);
          v18 = szArg4;
        }
        free(v18);
        free(*szArg);
        v74 = -1;
        sub_F721F0(&a2a);
        v14 = wcschr(v14 + 1, 0) + 1;
      }
      while ( *v14 );
    }
  }
  RegCloseKey(hKey);
  return ppv1;
}
// 10631D8: using guessed type int dword_10631D8;

//----- (00F87710) --------------------------------------------------------
void __cdecl sub_F87710(int a1, void *a2, void *a3)
{
  _WORD *v3; // ST50_4
  WCHAR *v4; // esi
  void *v5; // edi
  const wchar_t **v6; // eax
  wchar_t *v7; // ST54_4

  v3 = malloc(2u);
  *v3 = 0;
  v4 = a3;
  v5 = sub_F877C0(a1, a2, *a3, 0xFFFFFFFF);
  v6 = PE_CopyString(&a3, v4, L"\\AutorunsDisabled");
  v7 = _wcsdup(*v6);
  free(v3);
  free(a3);
  sub_F877C0(a1, a2, v7, v5);
  free(v7);
}

//----- (00F877C0) --------------------------------------------------------
void *__cdecl sub_F877C0(int a1, void *a2, wchar_t *psz, void *a4)
{
  WCHAR *v4; // edi
  _WORD *v5; // ebx
  tagKeyName *v6; // esi
  const wchar_t *v7; // eax
  const wchar_t *v8; // eax
  unsigned __int16 **v9; // esi
  unsigned __int16 **v10; // eax
  LPCWSTR *v11; // ebx
  WCHAR *v12; // eax
  _WORD *v13; // edx
  WCHAR v14; // cx
  WCHAR *v15; // esi
  unsigned __int16 **v16; // eax
  WCHAR *v17; // esi
  unsigned __int16 **v18; // eax
  _WORD *v19; // eax
  const wchar_t **v20; // eax
  void *v21; // esi
  const wchar_t *v22; // eax
  const wchar_t *v23; // eax
  unsigned __int16 **v24; // esi
  unsigned __int16 **v25; // eax
  const wchar_t *v26; // eax
  const wchar_t *v27; // eax
  unsigned __int16 **v28; // esi
  unsigned __int16 **v29; // eax
  const wchar_t *v30; // eax
  unsigned __int16 **v31; // eax
  WCHAR v32; // cx
  int v34; // [esp+10h] [ebp-BCh]
  int v35; // [esp+14h] [ebp-B8h]
  int v36; // [esp+18h] [ebp-B4h]
  int v37; // [esp+1Ch] [ebp-B0h]
  WCHAR *ppv1; // [esp+20h] [ebp-ACh]
  _WORD *v39; // [esp+24h] [ebp-A8h]
  WCHAR v40[2]; // [esp+28h] [ebp-A4h]
  WCHAR v41[2]; // [esp+2Ch] [ebp-A0h]
  WCHAR v42[2]; // [esp+30h] [ebp-9Ch]
  int v43; // [esp+34h] [ebp-98h]
  void *v44; // [esp+38h] [ebp-94h]
  WCHAR v45[2]; // [esp+3Ch] [ebp-90h]
  WCHAR v46[2]; // [esp+40h] [ebp-8Ch]
  WCHAR *ppv; // [esp+44h] [ebp-88h]
  void *v48; // [esp+48h] [ebp-84h]
  LPCWSTR v49; // [esp+4Ch] [ebp-80h]
  HKEY KeyHandle; // [esp+50h] [ebp-7Ch]
  LPCWSTR v51; // [esp+54h] [ebp-78h]
  void *v52; // [esp+58h] [ebp-74h]
  void *v53; // [esp+5Ch] [ebp-70h]
  void *v54; // [esp+60h] [ebp-6Ch]
  void *v55; // [esp+64h] [ebp-68h]
  void *v56; // [esp+68h] [ebp-64h]
  HKEY hKey; // [esp+6Ch] [ebp-60h]
  void *a1a; // [esp+70h] [ebp-5Ch]
  WCHAR szArg[2]; // [esp+74h] [ebp-58h]
  void *v60; // [esp+78h] [ebp-54h]
  void *v61; // [esp+7Ch] [ebp-50h]
  WCHAR *ppv2; // [esp+80h] [ebp-4Ch]
  wchar_t *v63; // [esp+84h] [ebp-48h]
  wchar_t *v64; // [esp+88h] [ebp-44h]
  LPCWSTR v65; // [esp+8Ch] [ebp-40h]
  LPCWSTR v66; // [esp+90h] [ebp-3Ch]
  LPCWSTR v67; // [esp+94h] [ebp-38h]
  WCHAR *ppv3; // [esp+98h] [ebp-34h]
  LPCWSTR v69; // [esp+9Ch] [ebp-30h]
  LPCWSTR v70; // [esp+A0h] [ebp-2Ch]
  LPCWSTR szArg4; // [esp+A4h] [ebp-28h]
  LPCWSTR v72; // [esp+A8h] [ebp-24h]
  LPCWSTR v73; // [esp+ACh] [ebp-20h]
  WCHAR *pszText; // [esp+B0h] [ebp-1Ch]
  LPCWSTR szArg3; // [esp+B4h] [ebp-18h]
  void *v76; // [esp+B8h] [ebp-14h]
  char v77; // [esp+BFh] [ebp-Dh]
  int v78; // [esp+C8h] [ebp-4h]

  v64 = malloc(2u);
  *v64 = 0;
  v78 = 0;
  v4 = malloc(2u);
  ppv2 = v4;
  *v4 = 0;
  v63 = malloc(2u);
  *v63 = 0;
  v5 = malloc(2u);
  v39 = v5;
  *v5 = 0;
  v76 = malloc(2u);
  *v76 = 0;
  v60 = malloc(2u);
  *v60 = 0;
  v61 = malloc(2u);
  *v61 = 0;
  v56 = malloc(2u);
  *v56 = 0;
  v6 = psz;
  LOBYTE(v78) = 7;
  if ( a4 == -1 )
  {
    v70 = _wcsdup(&gszNullString);
    v65 = _wcsdup(&gszNullString);
    v67 = _wcsdup(&gszNullString);
    v69 = _wcsdup(&gszNullString);
    v72 = _wcsdup(&gszNullString);
    v73 = _wcsdup(&gszNullString);
    szArg4 = _wcsdup(&gszNullString);
    v7 = &gszNullString;
    if ( psz )
      v7 = psz;
    pszText = _wcsdup(v7);
    v66 = _wcsdup(&gszNullString);
    v8 = &gszNullString;
    if ( psz )
      v8 = psz;
    szArg3 = _wcsdup(v8);
    LOBYTE(v78) = 17;
    v9 = sub_F77BE0(&a1a, a2, &pszText, &szArg4);
    LOBYTE(v78) = 18;
    v10 = sub_F77BE0(szArg, a2, &szArg3, &v66);
    LOBYTE(v78) = 19;
    a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v10, v9, &v73);
    free(*szArg);
    free(a1a);
    free(szArg3);
    free(v66);
    free(pszText);
    free(szArg4);
    free(v73);
    free(v72);
    free(v69);
    free(v67);
    free(v65);
    LOBYTE(v78) = 7;
    free(v70);
    v6 = psz;
  }
  if ( !PE_OpenKey(ghLocalMachineKey, v6, 0, 1u, &KeyHandle) )
  {
    if ( !sub_F81520(KeyHandle, L"ProviderOrder", 0, 0, &v64) )
    {
      v11 = operator new(4u);
      if ( v11 )
        *v11 = _wcsdup(v64);
      else
        v11 = 0;
      v12 = v64;
      szArg3 = v64;
      do
      {
        v13 = *v11;
        **v11 = 0;
        v14 = *v12;
        if ( *v12 )
        {
          do
          {
            if ( v14 == 44 )
              break;
            if ( v14 == 32 )
              break;
            ++v12;
            *v13 = v14;
            ++v13;
            v14 = *v12;
          }
          while ( *v12 );
          szArg3 = v12;
        }
        *v13 = 0;
        v15 = _wcsdup(L"System\\CurrentControlSet\\Services\\");
        ppv2 = v15;
        v16 = PE_CopyStringEx(&ppv1, &ppv2, v11);
        ppv3 = v4;
        v4 = _wcsdup(*v16);
        ppv2 = v4;
        free(ppv3);
        free(ppv1);
        free(v15);
        v17 = _wcsdup(L"\\NetworkProvider");
        ppv3 = v17;
        v18 = PE_CopyStringEx(&ppv, &ppv2, &ppv3);
        LOBYTE(v78) = 21;
        v77 = PE_OpenKey(a2, *v18, 0, 1u, &hKey) == 0;
        free(ppv);
        LOBYTE(v78) = 7;
        free(v17);
        if ( v77 )
        {
          if ( !sub_F81520(hKey, L"ProviderPath", 0, 0, &v63) )
          {
            v19 = malloc(2u);
            v34 = v19;
            *v19 = 0;
            v35 = 0;
            v36 = 0;
            v37 = 0;
            LOBYTE(v78) = 22;
            sub_F77040(v63, &v34);
            *szArg = _wcsdup(v63);
            LOBYTE(v78) = 23;
            v20 = sub_F74EE0(&v44, a1, &v34, 0);
            v21 = v76;
            v76 = _wcsdup(*v20);
            free(v21);
            free(v44);
            ppv3 = sub_F74ED0();
            sub_F81520(hKey, L"Name", 0, 0, &v61);
            v69 = _wcsdup(L"ProviderOrder");
            v22 = &gszNullString;
            if ( psz )
              v22 = psz;
            v67 = _wcsdup(v22);
            v65 = _wcsdup(&gszNullString);
            v23 = &gszNullString;
            if ( psz )
              v23 = psz;
            v70 = _wcsdup(v23);
            LOBYTE(v78) = 27;
            v24 = sub_F77BE0(v42, a2, &v67, &v69);
            LOBYTE(v78) = 28;
            v25 = sub_F77BE0(v40, a2, &v70, &v65);
            LOBYTE(v78) = 29;
            v77 = sub_F73D40(a1, v11, v25, v24, &v76, &v60, &v56, &v43);
            free(*v40);
            free(*v42);
            free(v70);
            free(v65);
            free(v67);
            free(v69);
            if ( v77 )
            {
              if ( a4 == -1 )
              {
                v53 = _wcsdup(&gszNullString);
                v48 = _wcsdup(&gszNullString);
                v52 = _wcsdup(&gszNullString);
                v55 = _wcsdup(&gszNullString);
                v54 = _wcsdup(&gszNullString);
                v66 = _wcsdup(&gszNullString);
                pszText = _wcsdup(&gszNullString);
                v26 = &gszNullString;
                if ( psz )
                  v26 = psz;
                szArg4 = _wcsdup(v26);
                v73 = _wcsdup(&gszNullString);
                v27 = &gszNullString;
                if ( psz )
                  v27 = psz;
                v72 = _wcsdup(v27);
                LOBYTE(v78) = 39;
                v28 = sub_F77BE0(v45, a2, &szArg4, &pszText);
                LOBYTE(v78) = 40;
                v29 = sub_F77BE0(v46, a2, &v72, &v73);
                LOBYTE(v78) = 41;
                a4 = sub_F73FF0(a1, 0, 0xFFFFFFFF, 0, v29, v28, &v66);
                free(*v46);
                free(*v45);
                free(v72);
                free(v73);
                free(szArg4);
                free(pszText);
                free(v66);
                free(v54);
                free(v55);
                free(v52);
                free(v48);
                free(v53);
              }
              a1a = _wcsdup(&gszNullString);
              v51 = _wcsdup(L"ProviderOrder");
              v30 = &gszNullString;
              if ( psz )
                v30 = psz;
              v49 = _wcsdup(v30);
              LOBYTE(v78) = 44;
              v31 = sub_F77BE0(v41, a2, &v49, &v51);
              LOBYTE(v78) = 45;
              sub_F73FF0(a1, ppv3, a4, 5, v11, v31, &v76);
              free(*v41);
              free(v49);
              free(v51);
              free(a1a);
            }
            free(*szArg);
            LOBYTE(v78) = 7;
            sub_F721F0(&v34);
          }
          RegCloseKey(hKey);
        }
        v12 = szArg3;
        v32 = *szArg3;
        if ( !*szArg3 )
          break;
        while ( v32 == 44 || v32 == 32 )
        {
          v32 = v12[1];
          ++v12;
          szArg3 = v12;
          if ( !v32 )
            goto LABEL_42;
        }
      }
      while ( *v12 );
LABEL_42:
      v5 = v39;
    }
    RegCloseKey(KeyHandle);
  }
  free(v56);
  free(v61);
  free(v60);
  free(v76);
  free(v5);
  free(v63);
  free(v4);
  free(v64);
  return a4;
}

//----- (00F87FE0) --------------------------------------------------------
void __cdecl sub_F87FE0(int a1, HKEY hKey, WCHAR **ppszKeyName)
{
  WCHAR *v3; // ST20_4

  v3 = malloc(2u);
  *v3 = 0;
  sub_F88050(a1, hKey, *ppszKeyName, 0xFFFFFFFF);
  free(v3);
}
